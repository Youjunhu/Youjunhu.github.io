<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Details on FFT codes provided by the Numerical recipes book[2]</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="fourier_analysis.tex" /> 
<link rel="stylesheet" type="text/css" href="fourier_analysis.css" /> 
</head><body 
>
   <!--l. 1635--><div class="crosslinks"><p class="noindent">[<a 
href="fourier_analysissu25.html" >next</a>] [<a 
href="fourier_analysissu23.html" >prev</a>] [<a 
href="fourier_analysissu23.html#tailfourier_analysissu23.html" >prev-tail</a>] [<a 
href="#tailfourier_analysissu24.html">tail</a>] [<a 
href="fourier_analysisse10.html#fourier_analysissu24.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">B.3   </span> <a 
 id="x35-35000B.3"></a>Details on FFT codes provided by the Numerical recipes book<span class="cite">[<a 
href="fourier_analysisli1.html#Xpress1992">2</a>]</span></h4>
<!--l. 1637--><p class="noindent" >The following is about a speciﬁc FFT subroutine provided by the Numerical recipes
book<span class="cite">[<a 
href="fourier_analysisli1.html#Xpress1992">2</a>]</span>. This is not a general case.
</p><!--l. 1640--><p class="indent" >   The input and output of the DFT are usually complex numbers. In the
implementation of FFT algorithm provided by Numerical recipes book<span class="cite">[<a 
href="fourier_analysisli1.html#Xpress1992">2</a>]</span>, to avoid
using complex numbers, the algorithm adopts the real number representation of the
complex numbers. In this scheme, two elements of a real number array are
used to store one complex number. To store a complex array “cdata” of
length <span 
class="cmmi-10">N</span>, we will need a real number array “rdata” of length 2<span 
class="cmmi-10">N</span>. The ﬁrst
elements of array “rdata” will contain the real part of “cdata(1)”, the second
elements of “rdata” will contain the imaginary part of  “cdata(1)”, and so
on.
</p><!--l. 1650--><p class="indent" >   To test the correctness of the above statement, I generated a real number array
with length <span 
class="cmmi-10">N </span>= 2 <span 
class="cmsy-10">× </span>2<sup><span 
class="cmr-7">8</span></sup> by using a random generating routine and calculate the DFT
of the array with two methods. The real array generated by the random generator
are considered to be a real number representation of a complex array with
length <span 
class="cmmi-10">N∕</span>2. Using the real array as the input of the FFT routine (the code in
˜/project_new/ﬀt). To check the correctness of my understanding of the input
and output of the FFT, I manually convert the real number of length <span 
class="cmmi-10">N</span>
to a complex array with length <span 
class="cmmi-10">N∕</span>2, and use directly the summation in
Eq. (<a 
href="fourier_analysissu9.html#x14-13001r67">67<!--tex4ht:ref: 3-25-e3 --></a>) to calculate the DFT. The output I got is obviously a complex
array with length <span 
class="cmmi-10">N∕</span>2. Then I manually convert the complex array to a
real number array of length <span 
class="cmmi-10">N </span>and plot the output in Fig. <a 
href="#x35-350017">7<!--tex4ht:ref: 3-25-e8 --></a> with dashed
line. The results in Fig. <a 
href="#x35-350017">7<!--tex4ht:ref: 3-25-e8 --></a> indicates the results given by the FFT and the
naive method used by me agree with each other well. This proves that my
understanding of the input and output of FFT (especially the storage arrangement)
is correct.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x35-350017"></a>
                                                                  

                                                                  
<!--l. 1667--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/fft/fig1/tmp.png" alt="pict"  
 width="180.67499pt" />
<br /> </p><div class="caption" 
><span class="id">Figure 7: </span><span  
class="content">The output of a FFT routine (solid line) agrees well with those
(dashed line) calculated by directly evaluate the summation in Eq. (<a 
href="fourier_analysissu9.html#x14-13001r67">67<!--tex4ht:ref: 3-25-e3 --></a>) (the
latter is coded by me). The agreement indicates my understanding of the output
of FFT (especially the storage arrangement) is correct. Here the time domain
data is generated by a random generating routine. </span></div><!--tex4ht:label?: x35-350017 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 1676--><p class="indent" >   To clearly show the output of FFT, we recover the real and imaginary part of
DFT from the output of FFT and plots the data as a function of their corresponding
frequency. The results are given in Fig. <a 
href="#x35-350028">8<!--tex4ht:ref: 8-27-p1 --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x35-350028"></a>
                                                                  

                                                                  
<!--l. 1681--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/fft/fig3/tmp.png" alt="pict"  
 width="180.67499pt" />                                         <img 
src="my_figure/home/yj/project_new/fft/fig3/tmp2.png" alt="pict"  
 width="180.67499pt" />
<br /> </p><div class="caption" 
><span class="id">Figure 8: </span><span  
class="content">The real (left) and imaginary (right) part of the discrete Fourier
transformation as a function of the frequency. The point <span 
class="cmmi-10">n </span>= <span 
class="cmsy-10">−</span>128 corresponds
to frequency <span 
class="cmsy-10">−</span><span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">s</span></sub><span 
class="cmmi-10">∕</span>2 while the point <span 
class="cmmi-10">n </span>= 128 corresponds to frequency +<span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">s</span></sub><span 
class="cmmi-10">∕</span>2,
where <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">s</span></sub> = 1<span 
class="cmmi-10">∕</span>Δ with Δ is the sample interval in time domain. The time domain
data is the same as used in Fig. <a 
href="#x35-350017">7<!--tex4ht:ref: 3-25-e8 --></a>. Why is there a spike at zero frequency?</span></div><!--tex4ht:label?: x35-350028 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 1690--><p class="indent" >    
</p><!--l. 1692--><p class="indent" >    
                                                                  

                                                                  
</p>
   <!--l. 1694--><div class="crosslinks"><p class="noindent">[<a 
href="fourier_analysissu25.html" >next</a>] [<a 
href="fourier_analysissu23.html" >prev</a>] [<a 
href="fourier_analysissu23.html#tailfourier_analysissu23.html" >prev-tail</a>] [<a 
href="fourier_analysissu24.html" >front</a>] [<a 
href="fourier_analysisse10.html#fourier_analysissu24.html" >up</a>] </p></div>
<!--l. 1694--><p class="indent" >   <a 
 id="tailfourier_analysissu24.html"></a> </p> 
</body></html> 
