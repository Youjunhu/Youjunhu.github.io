<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>About using the FFTW library</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="fourier_analysis.tex" /> 
<meta name="date" content="2019-01-05 20:48:00" /> 
<link rel="stylesheet" type="text/css" href="fourier_analysis.css" /> 
</head><body 
>
   <!--l. 796--><div class="crosslinks"><p class="noindent">[<a 
href="fourier_analysissu12.html" >prev</a>] [<a 
href="fourier_analysissu12.html#tailfourier_analysissu12.html" >prev-tail</a>] [<a 
href="#tailfourier_analysissu13.html">tail</a>] [<a 
href="fourier_analysisse5.html#fourier_analysissu13.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">5.7   </span> <a 
 id="x19-180005.7"></a>About using the FFTW library</h4>
<!--l. 798--><p class="noindent" >I use the Fortran interface of the FFTW library. To have access to FFTW library, use
the following codes: </p><div class="alltt">
<div class="obeylines-v">            <span 
class="cmtt-10">use,</span><span 
class="cmtt-10"> intrinsic</span><span 
class="cmtt-10"> ::</span><span 
class="cmtt-10"> iso_c_binding</span>
<br /><span 
class="cmtt-10">implicit</span><span 
class="cmtt-10"> none</span>
<br /><span 
class="cmtt-10">include</span><span 
class="cmtt-10"> &#x2019;fftw3.f03&#x2019;</span>
</div>
</div>
Here the ﬁrst line uses the iso_c_binding module to interface with C in which FFTW
is written. To use the FFT subroutines in FFTW, we need to deﬁne some variables of
the desired types, such as <div class="alltt">
<div class="obeylines-v">            <span 
class="cmtt-10">type(C_PTR)</span><span 
class="cmtt-10"> ::</span><span 
class="cmtt-10"> plan1,</span><span 
class="cmtt-10"> plan2</span>
<br /><span 
class="cmtt-10">complex(C_DOUBLE_COMPLEX)</span><span 
class="cmtt-10"> ::</span><span 
class="cmtt-10"> in(0:n-1),</span><span 
class="cmtt-10"> out(0:n-1)</span>
</div>
</div>
Specify what kind of transform to be performed by calling the corresponding
“planner” routine: <div class="alltt">
<div class="obeylines-v">
<span 
class="cmtt-10">plan1</span><span 
class="cmtt-10"> =</span><span 
class="cmtt-10"> fftw_plan_dft_1d(n,</span><span 
class="cmtt-10"> in,out,</span><span 
class="cmtt-10"> FFTW_FORWARD,FFTW_ESTIMATE)</span>
</div>
</div>
Here the “planner” routine for one-dimensional DFT is called. One thing that the
“planner” routine does is to factor the matrix <span 
class="cmmi-10">M</span><sub><span 
class="cmmi-7">kj</span></sub> mentioned above, in order to
get prepared for performing the actual transform. Therefore “planner” do
not need the actual data stored in “in” array. What is neede is the length
and numerical type of “in” array. It is obvious that the “planner” routine
needes to be invoked for only once for a given type of array with the same
length.
<!--l. 825--><p class="indent" >   Store input data in the “in” arrays, then, we can perform a DFT by the following
codes: </p><div class="alltt">

<div class="obeylines-v">            <span 
class="cmtt-10">call</span><span 
class="cmtt-10"> fftw_execute_dft(plan1,</span><span 
class="cmtt-10"> in,</span><span 
class="cmtt-10"> out)</span>
</div>
</div>
Similarly, we can perform a inverse DFT by the following codes: <div class="alltt">
<div class="obeylines-v">            <span 
class="cmtt-10">plan2</span><span 
class="cmtt-10"> =</span><span 
class="cmtt-10"> fftw_plan_dft_1d(ngrids,</span><span 
class="cmtt-10"> in,out,FFTW_BACKWARD,FFTW_ESTIMATE)</span>
<br /><span 
class="cmtt-10">call</span><span 
class="cmtt-10"> fftw_execute_dft(plan2,</span><span 
class="cmtt-10"> in,</span><span 
class="cmtt-10"> out)</span>
</div>
</div>
After all the transforms are done, we need to manuual de-allocate the arrays
created by the “planner” routine by calling the “ﬀtw_destroy_plan” routine:
<div class="alltt">
<div class="obeylines-v">            <span 
class="cmtt-10">call</span><span 
class="cmtt-10"> fftw_destroy_plan(plan2)</span>
</div>
</div>
Fortran does not automatically de-allocate arrays allocated by the “acllocate()”
subroutine, so manuually de-allocate all allocated arryas is necessary for preventing
memory leak from appearing.
<!--l. 845--><p class="indent" >   Note that the forward DFT in FFTW is deﬁned by
</p>
   <table 
class="equation"><tr><td><a 
 id="x19-18001r75"></a>
   <center class="math-display" >
<img 
src="fourier_analysis78x.png" alt="     N&sum;&minus;1      (       )
Hn &equiv;     hjexp  &minus; 2&pi;inj ,
      j=0         N
" class="math-display"  /></center></td><td class="equation-label">(75)</td></tr></table>
<!--l. 849--><p class="nopar" >
and the inverse DFT is deﬁned by
</p>
   <table 
class="equation"><tr><td><a 
 id="x19-18002r76"></a>

   <center class="math-display" >
<img 
src="fourier_analysis79x.png" alt="     N&minus;1      (      )
hj = &sum;  Hn exp  2&pi;inj  ,
     n=0        N
" class="math-display"  /></center></td><td class="equation-label">(76)</td></tr></table>
<!--l. 853--><p class="nopar" >
where there is no 1<span 
class="cmmi-10">∕N </span>factor in the inverse DFT, and thus this factor should be
included by hand if we want to recover the original data from the inverse
DFT.

</p>
   <!--l. 858--><div class="crosslinks"><p class="noindent">[<a 
href="fourier_analysissu12.html" >prev</a>] [<a 
href="fourier_analysissu12.html#tailfourier_analysissu12.html" >prev-tail</a>] [<a 
href="fourier_analysissu13.html" >front</a>] [<a 
href="fourier_analysisse5.html#fourier_analysissu13.html" >up</a>] </p></div>
<!--l. 858--><p class="indent" >   <a 
 id="tailfourier_analysissu13.html"></a> </p> 
</body></html> 
