<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Transform gyrokinetic equation from (X,Î¼,ğœ€,Î±) to (X,Î¼,vâˆ¥,Î±) coordinates</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 3825--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse13.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse11.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse11.html#tailnonlinear_gyrokinetic_equationse11.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationse12.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse12.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">C   </span> <a 
 id="x13-67000C"></a>Transform gyrokinetic equation from (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Î¼,ğœ€,Î±</span>) to (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Î¼,v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">,Î±</span>) coordinates</h3>
<!--l. 3827--><p class="noindent" >The gyrokinetic equation given above is written in terms of variables (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Î¼,ğœ€,Î±</span>), where <span 
class="cmmi-10">Î±</span>
is the gyro-phase. Next, we transform it into coordinates (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,Î¼</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">,Î±</span><span 
class="cmsy-10">â€²</span>) which is deï¬ned
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67001r284"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation316x.png" alt="(    â€²
||{  Xâ€²(X,Î¼,ğœ€,Î±) = X
   Î¼â€²(X, Î¼,ğœ€,Î±) = Î¼
||(  Î± (X, Î¼,ğœ€,Î±) = Î± âˆ˜-------------
   vâˆ¥(X, Î¼,ğœ€,Î±) = Â±  2(ğœ€ âˆ’ Î¼B0 (X))
" class="math-display"  /></center></td><td class="equation-label">(284)</td></tr></table>
<!--l. 3839--><p class="nopar" >
Use this deï¬nition and the chain rule, the gradient operators in (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Î¼,ğœ€,Î±</span>) variables are written, in
terms of (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,Î¼</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">,Î±</span><span 
class="cmsy-10">â€²</span>) variables, as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation317x.png" alt="   ||           â€²      ||         â€²    ||        âˆ‚v     ||          â€²    ||
-âˆ‚-||     =   âˆ‚X--â‹…-âˆ‚-â€²||     + âˆ‚Î¼- -âˆ‚â€²||      + --âˆ¥ -âˆ‚-||      + âˆ‚Î±- -âˆ‚â€²||
âˆ‚X Î¼,ğœ€,Î±      âˆ‚X   âˆ‚X  Î¼â€²,vâˆ¥,Î±â€²  âˆ‚X  âˆ‚Î¼  Xâ€²,vâˆ¥,Î±â€²  âˆ‚X  âˆ‚vâˆ¥ Xâ€²,Î¼â€²,Î±â€²  âˆ‚X  âˆ‚Î±  Xâ€²,Î¼â€²,vâˆ¥
             -âˆ‚--   -âˆ‚-  -Î¼ âˆ‚B0-âˆ‚-    -âˆ‚-
         =   âˆ‚Xâ€² +0 âˆ‚Î¼â€² âˆ’ vâˆ¥ âˆ‚X âˆ‚vâˆ¥ + 0âˆ‚Î±â€²                               (285)
" class="math-display"  /><a 
 id="x13-67002r285"></a></center>
</div>and <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation318x.png" alt=" âˆ‚ ||         âˆ‚X â€² âˆ‚    âˆ‚Î¼â€² âˆ‚    âˆ‚vâˆ¥ âˆ‚    âˆ‚Î±â€² âˆ‚
âˆ‚-ğœ€||     =   -âˆ‚ğœ€-âˆ‚X-â€² + âˆ‚ğœ€-âˆ‚Î¼â€² + âˆ‚ğœ€-âˆ‚v + âˆ‚ğœ€-âˆ‚Î±â€²
   X,Î¼,Î±                              âˆ¥
         =   0-âˆ‚--+ 0-âˆ‚-+  1--âˆ‚-+ 0 âˆ‚--                    (286)
              âˆ‚X â€²   âˆ‚Î¼â€²   vâˆ¥âˆ‚vâˆ¥    âˆ‚Î±â€²
" class="math-display"  /></center>
</div>Then, in terms of independent variable (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,Î¼</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">,Î±</span><span 
class="cmsy-10">â€²</span>), equation (<a 
href="nonlinear_gyrokinetic_equationse5.html#x6-31001r142">142<!--tex4ht:ref: 16-10-16-2 --></a>) is written <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation319x.png" alt="[                          ]
 âˆ‚-+ (vâˆ¥eâˆ¥ + VD +Î´VD ) â‹…-âˆ‚-- Î´G0 âˆ’ (vâˆ¥eâˆ¥ + VD + Î´VD )â‹… Î¼-âˆ‚B0-âˆ‚Î´G0-
 âˆ‚t      (              âˆ‚Xâ€²)                          vâˆ¥dX  âˆ‚vâˆ¥
          âˆ‚F0-  -Î¼ âˆ‚B0âˆ‚F0-    q-âˆ‚âŸ¨Î´LâŸ©Î±âˆ‚F0-1-
= âˆ’ Î´VD â‹… âˆ‚X â€² âˆ’ vâˆ¥ dX âˆ‚vâˆ¥  âˆ’ m   âˆ‚t  âˆ‚vâˆ¥ vâˆ¥,                    (287)
" class="math-display"  /><a 
 id="x13-67004r287"></a></center>
</div>where <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> and <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´L</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub> involve the gyro-averaging operator <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">â€¦</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>. The gyro-averaging operator in
(<span 
class="cmbx-10">X</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,Î¼</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">,Î±</span><span 
class="cmsy-10">â€²</span>) coordinates is similar to that in the old coordinates since the perpendicular velocity
variable <span 
class="cmmi-10">Î¼ </span>is identical between the two coordinate systems. Also note that the perturbed guiding-center
velocity <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is given by
   <table 
class="equation"><tr><td><a 
 id="x13-67005r288"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation320x.png" alt="       eâˆ¥ Ã—âˆ‡X âŸ¨Î´Ï•âŸ©Î±     âŸ¨Î´B âŠ¥âŸ©Î±
Î´VD  = -----B0----- + vâˆ¥--B0--,
" class="math-display"  /></center></td><td class="equation-label">(288)</td></tr></table>
<!--l. 3898--><p class="nopar" >
where <span 
class="cmmi-10">âˆ‚âˆ•âˆ‚</span><span 
class="cmbx-10">X </span>(rather than <span 
class="cmmi-10">âˆ‚âˆ•âˆ‚</span><span 
class="cmbx-10">X</span><span 
class="cmsy-10">â€²</span>) is used. Since <span 
class="cmmi-10">Î´Ï•</span>(<span 
class="cmbx-10">x</span>) = <span 
class="cmmi-10">Î´Ï•</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Î¼</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,Î±</span><span 
class="cmsy-10">â€²</span>), which is independent of <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>,
then Eq. (<a 
href="#x13-67002r285">285<!--tex4ht:ref: 19-1-2-e1 --></a>) indicates that <span 
class="cmmi-10">âˆ‚Î´Ï•âˆ•âˆ‚</span><span 
class="cmbx-10">X </span>= <span 
class="cmmi-10">âˆ‚Î´Ï•âˆ•âˆ‚</span><span 
class="cmbx-10">X</span><span 
class="cmsy-10">â€²</span>.
                                                                                

                                                                                
</p><!--l. 3905--><p class="indent" >   Dropping terms of order higher than <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">2</span></sup>), equation (<a 
href="#x13-67004r287">287<!--tex4ht:ref: 18-12-17-3 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation321x.png" alt="[                           ]
  âˆ‚-+ (ve  + V  + Î´V  )â‹…-âˆ‚-- Î´G  âˆ’ e â‹…Î¼âˆ‡B  âˆ‚Î´G0-
  âˆ‚t    âˆ¥âˆ¥    D      D  âˆ‚X â€²    0   âˆ¥     0 âˆ‚vâˆ¥
         ( âˆ‚F0)   (              qâˆ‚ âŸ¨Î´L âŸ©Î± ) âˆ‚F0 1
= âˆ’ Î´VD â‹…  âˆ‚X-â€² +  Î´VD  â‹…Î¼âˆ‡B0 âˆ’ m----âˆ‚t-   âˆ‚v-v-,         (289)
                                             âˆ¥ âˆ¥
" class="math-display"  /></center>
</div>Similarly, in terms of independent variable (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,Î¼</span><span 
class="cmsy-10">â€²</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">,Î±</span><span 
class="cmsy-10">â€²</span>), equation (<a 
href="nonlinear_gyrokinetic_equationse5.html#x6-32004r147">147<!--tex4ht:ref: 17-5-13-p2 --></a>) is written as
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation322x.png" alt="[ âˆ‚                     -âˆ‚-]             âˆ‚Î´f-
 âˆ‚t + (vâˆ¥eâˆ¥ + VD + Î´VD )â‹… âˆ‚Xâ€² Î´f âˆ’ eâˆ¥ â‹…Î¼âˆ‡B0 âˆ‚v âˆ¥
        (     )        (          )
= âˆ’ Î´VD â‹… âˆ‚F0â€² + Î´VD  â‹… -Î¼âˆ‡B0 âˆ‚F0-
   [      âˆ‚X      (     vâˆ¥     âˆ‚vâˆ¥     )         ]
 -q   âˆ‚âŸ¨v-â‹…Î´AâŸ©Î±                 âŸ¨Î´B-âŠ¥âŸ©Î±            âˆ‚F0-1-
âˆ’m   âˆ’    âˆ‚t    âˆ’  vâˆ¥eâˆ¥ + VD + vâˆ¥ B0     â‹…âˆ‡X âŸ¨Î´Ï• âŸ©Î±  âˆ‚vâˆ¥ vâˆ¥,    (290)
" class="math-display"  /><a 
 id="x13-67007r290"></a></center>
</div>The guiding-center velocity in the macroscopic (equilibrium) ï¬eld is given by
   <table 
class="equation"><tr><td><a 
 id="x13-67008r291"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation323x.png" alt="           -Bâ‹†0-    --Î¼--           --1---
vâˆ¥eâˆ¥ + VD = B â‹†âˆ¥0vâˆ¥ + Î©B â‹†âˆ¥0B0 Ã— âˆ‡B0 + B0B â‹†âˆ¥0 E0 Ã— B0
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(291)</td></tr></table>
<!--l. 3946--><p class="nopar" >
where
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67009r292"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation324x.png" alt="Bâ‹†0 = B0 + B0 vâˆ¥âˆ‡ Ã— b,
            Î©
" class="math-display"  /></center></td><td class="equation-label">(292)</td></tr></table>
<!--l. 3951--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67010r293"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation325x.png" alt="               (   vâˆ¥        )
B â‹†âˆ¥ â‰¡ b â‹…Bâ‹† = B 1+ --b â‹…âˆ‡ Ã— b ,
                   Î©
" class="math-display"  /></center></td><td class="equation-label">(293)</td></tr></table>
<!--l. 3956--><p class="nopar" >
Using <span 
class="cmmi-10">B</span><sub><span 
class="cmsy-7">âˆ¥</span><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">â‹†</span></sup> <span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>, then expression (<a 
href="#x13-67008r291">291<!--tex4ht:ref: 18-12-17-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67011r294"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation326x.png" alt="                  v2
vâˆ¥e âˆ¥ + VD = vâˆ¥b + -âˆ¥âˆ‡ Ã— b + --Î¼-B0 Ã— âˆ‡B0 + -12E0 Ã— B0,
                  Î©â—Ÿ--â—â—œ--â—   Î©â—ŸB0---â—â—œ----â—  Bâ—Ÿ-0-â—â—œ---â—
                 curvaturedrift     âˆ‡B drift       EÃ—B drift
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(294)</td></tr></table>
<!--l. 3966--><p class="nopar" >
where the curvature drift, <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">B </span>drift, and <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">Ã— </span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> drift can be identiï¬ed. Note that the perturbed
guiding-center velocity <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is given by (refer to Sec. <a 
href="nonlinear_gyrokinetic_equationse13.html#x14-71000D.3">D.3<!--tex4ht:ref: 19-3-28-e1 --></a>)
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67012r295"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation327x.png" alt="       eâˆ¥-Ã—âˆ‡X-âŸ¨Î´Ï•âŸ©Î±     âŸ¨Î´B-âŠ¥âŸ©Î±-
Î´VD  =      B0      + vâˆ¥  B0  .
" class="math-display"  /></center></td><td class="equation-label">(295)</td></tr></table>
<!--l. 3974--><p class="nopar" >
Using the above results, equation (<a 
href="#x13-67007r290">290<!--tex4ht:ref: 17-5-13-p2m --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation328x.png" alt="[                          ]
 âˆ‚-+ (v e + V  + Î´V  )â‹… -âˆ‚--Î´f âˆ’ e â‹…Î¼âˆ‡B  âˆ‚Î´f-
 âˆ‚t    âˆ¥ âˆ¥    D     D   âˆ‚Xâ€²       âˆ¥     0âˆ‚v âˆ¥
        ( âˆ‚F0 )  ( eâˆ¥ Ã— âˆ‡X âŸ¨Î´Ï•âŸ©Î±   âŸ¨Î´B âŠ¥âŸ©Î±)  ( Î¼    âˆ‚F0 )
= âˆ’ Î´VD â‹… âˆ‚X-â€² +   -----B------+ vâˆ¥--B----  â‹… v-âˆ‡B0 -âˆ‚v-
    [             (      02            0       âˆ¥       âˆ¥               )         ]
 -q   âˆ‚âŸ¨v-â‹…Î´AâŸ©Î±          vâˆ¥        -Î¼--           -1-           âŸ¨Î´B-âŠ¥âŸ©Î±            âˆ‚F0-1
âˆ’m   âˆ’    âˆ‚t    âˆ’  vâˆ¥eâˆ¥ + Î© âˆ‡ Ã—b + Î©B0 B0 Ã— âˆ‡B0 + B20E0 Ã— B0 + vâˆ¥ B0     â‹…âˆ‡X âŸ¨Î´Ï•âŸ©Î±  âˆ‚v(âˆ¥2v9âˆ¥6,)
" class="math-display"  /></center>
</div>Collecting coeï¬ƒcients before <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>, we ï¬nd that the two terms involving <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> (terms in blue and
red) cancel each other, yielding <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation329x.png" alt="[                          ]
 âˆ‚-+ (v e + V  + Î´V  )â‹… -âˆ‚--Î´f âˆ’ e â‹…Î¼âˆ‡B  âˆ‚Î´f-
 âˆ‚t    âˆ¥ âˆ¥    D     D   âˆ‚Xâ€²       âˆ¥     0âˆ‚v âˆ¥
        ( âˆ‚F0 )
= âˆ’ Î´VD â‹… âˆ‚X-â€²
    [                                (       2                             )         ]
+-q  m-v âŸ¨Î´B-âŠ¥âŸ©Î±-â‹…(Î¼ âˆ‡B ) + âˆ‚âŸ¨vâ‹…Î´A-âŸ©Î±+   vb + vâˆ¥âˆ‡ Ã— b + -1-E Ã— B  + v âŸ¨Î´BâŠ¥-âŸ©Î±-  â‹…âˆ‡   âŸ¨Î´Ï•âŸ©   âˆ‚F0(219,7)
 m   q  âˆ¥  B0         0      âˆ‚t         âˆ¥   Î©         B20  0    0   âˆ¥  B0       X    Î±  âˆ‚vâˆ¥vâˆ¥
" class="math-display"  /><a 
 id="x13-67014r297"></a></center>
</div>This equation agrees with Eq. (8) in I. Holodâ€™s 2009 pop paper (gyro-averaging is wrongly
omitted in that paper) and W. Dengâ€™s 2011 NF paper. Equation (<a 
href="#x13-67014r297">297<!--tex4ht:ref: 18-9-18-e1 --></a>) drops all terms higher
than <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">2</span></sup>) and as a result the coeï¬ƒcient before <span 
class="cmmi-10">âˆ‚Î´fâˆ•âˆ‚v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> contains only the mirror force,
i.e.,
   <table 
class="equation"><tr><td><a 
 id="x13-67015r298"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation330x.png" alt="dvâˆ¥
dt = âˆ’ eâˆ¥ â‹…Î¼âˆ‡B0,
" class="math-display"  /></center></td><td class="equation-label">(298)</td></tr></table>
<!--l. 4025--><p class="nopar" >
which is independent of any perturbations.
                                                                                

                                                                                
</p>
   <!--l. 4028--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse13.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse11.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse11.html#tailnonlinear_gyrokinetic_equationse11.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse12.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse12.html" >up</a>] </p></div>
<!--l. 4028--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationse12.html"></a> </p> 
</body></html> 
