<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Transform gyrokinetic equation from (X,μ,𝜀,α) to (X,μ,v∥,α) coordinates</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 3825--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse13.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse11.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse11.html#tailnonlinear_gyrokinetic_equationse11.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationse12.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse12.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">C   </span> <a 
 id="x13-67000C"></a>Transform gyrokinetic equation from (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,μ,𝜀,α</span>) to (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,μ,v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">,α</span>) coordinates</h3>
<!--l. 3827--><p class="noindent" >The gyrokinetic equation given above is written in terms of variables (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,μ,𝜀,α</span>), where <span 
class="cmmi-10">α</span>
is the gyro-phase. Next, we transform it into coordinates (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,μ</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">,α</span><span 
class="cmsy-10">′</span>) which is deﬁned
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67001r284"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation316x.png" alt="(    ′
||{  X′(X,μ,𝜀,α) = X
   μ′(X, μ,𝜀,α) = μ
||(  α (X, μ,𝜀,α) = α ∘-------------
   v∥(X, μ,𝜀,α) = ±  2(𝜀 − μB0 (X))
" class="math-display"  /></center></td><td class="equation-label">(284)</td></tr></table>
<!--l. 3839--><p class="nopar" >
Use this deﬁnition and the chain rule, the gradient operators in (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,μ,𝜀,α</span>) variables are written, in
terms of (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,μ</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">,α</span><span 
class="cmsy-10">′</span>) variables, as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation317x.png" alt="   ||           ′      ||         ′    ||        ∂v     ||          ′    ||
-∂-||     =   ∂X--⋅-∂-′||     + ∂μ- -∂′||      + --∥ -∂-||      + ∂α- -∂′||
∂X μ,𝜀,α      ∂X   ∂X  μ′,v∥,α′  ∂X  ∂μ  X′,v∥,α′  ∂X  ∂v∥ X′,μ′,α′  ∂X  ∂α  X′,μ′,v∥
             -∂--   -∂-  -μ ∂B0-∂-    -∂-
         =   ∂X′ +0 ∂μ′ − v∥ ∂X ∂v∥ + 0∂α′                               (285)
" class="math-display"  /><a 
 id="x13-67002r285"></a></center>
</div>and <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation318x.png" alt=" ∂ ||         ∂X ′ ∂    ∂μ′ ∂    ∂v∥ ∂    ∂α′ ∂
∂-𝜀||     =   -∂𝜀-∂X-′ + ∂𝜀-∂μ′ + ∂𝜀-∂v + ∂𝜀-∂α′
   X,μ,α                              ∥
         =   0-∂--+ 0-∂-+  1--∂-+ 0 ∂--                    (286)
              ∂X ′   ∂μ′   v∥∂v∥    ∂α′
" class="math-display"  /></center>
</div>Then, in terms of independent variable (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,μ</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">,α</span><span 
class="cmsy-10">′</span>), equation (<a 
href="nonlinear_gyrokinetic_equationse5.html#x6-31001r142">142<!--tex4ht:ref: 16-10-16-2 --></a>) is written <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation319x.png" alt="[                          ]
 ∂-+ (v∥e∥ + VD +δVD ) ⋅-∂-- δG0 − (v∥e∥ + VD + δVD )⋅ μ-∂B0-∂δG0-
 ∂t      (              ∂X′)                          v∥dX  ∂v∥
          ∂F0-  -μ ∂B0∂F0-    q-∂⟨δL⟩α∂F0-1-
= − δVD ⋅ ∂X ′ − v∥ dX ∂v∥  − m   ∂t  ∂v∥ v∥,                    (287)
" class="math-display"  /><a 
 id="x13-67004r287"></a></center>
</div>where <span 
class="cmmi-10">δ</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> and <span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δL</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> involve the gyro-averaging operator <span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">…</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub>. The gyro-averaging operator in
(<span 
class="cmbx-10">X</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,μ</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">,α</span><span 
class="cmsy-10">′</span>) coordinates is similar to that in the old coordinates since the perpendicular velocity
variable <span 
class="cmmi-10">μ </span>is identical between the two coordinate systems. Also note that the perturbed guiding-center
velocity <span 
class="cmmi-10">δ</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is given by
   <table 
class="equation"><tr><td><a 
 id="x13-67005r288"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation320x.png" alt="       e∥ ×∇X ⟨δϕ⟩α     ⟨δB ⊥⟩α
δVD  = -----B0----- + v∥--B0--,
" class="math-display"  /></center></td><td class="equation-label">(288)</td></tr></table>
<!--l. 3898--><p class="nopar" >
where <span 
class="cmmi-10">∂∕∂</span><span 
class="cmbx-10">X </span>(rather than <span 
class="cmmi-10">∂∕∂</span><span 
class="cmbx-10">X</span><span 
class="cmsy-10">′</span>) is used. Since <span 
class="cmmi-10">δϕ</span>(<span 
class="cmbx-10">x</span>) = <span 
class="cmmi-10">δϕ</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,μ</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,α</span><span 
class="cmsy-10">′</span>), which is independent of <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">∥</span></sub>,
then Eq. (<a 
href="#x13-67002r285">285<!--tex4ht:ref: 19-1-2-e1 --></a>) indicates that <span 
class="cmmi-10">∂δϕ∕∂</span><span 
class="cmbx-10">X </span>= <span 
class="cmmi-10">∂δϕ∕∂</span><span 
class="cmbx-10">X</span><span 
class="cmsy-10">′</span>.
                                                                                

                                                                                
</p><!--l. 3905--><p class="indent" >   Dropping terms of order higher than <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">2</span></sup>), equation (<a 
href="#x13-67004r287">287<!--tex4ht:ref: 18-12-17-3 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation321x.png" alt="[                           ]
  ∂-+ (ve  + V  + δV  )⋅-∂-- δG  − e ⋅μ∇B  ∂δG0-
  ∂t    ∥∥    D      D  ∂X ′    0   ∥     0 ∂v∥
         ( ∂F0)   (              q∂ ⟨δL ⟩α ) ∂F0 1
= − δVD ⋅  ∂X-′ +  δVD  ⋅μ∇B0 − m----∂t-   ∂v-v-,         (289)
                                             ∥ ∥
" class="math-display"  /></center>
</div>Similarly, in terms of independent variable (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,μ</span><span 
class="cmsy-10">′</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">,α</span><span 
class="cmsy-10">′</span>), equation (<a 
href="nonlinear_gyrokinetic_equationse5.html#x6-32004r147">147<!--tex4ht:ref: 17-5-13-p2 --></a>) is written as
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation322x.png" alt="[ ∂                     -∂-]             ∂δf-
 ∂t + (v∥e∥ + VD + δVD )⋅ ∂X′ δf − e∥ ⋅μ∇B0 ∂v ∥
        (     )        (          )
= − δVD ⋅ ∂F0′ + δVD  ⋅ -μ∇B0 ∂F0-
   [      ∂X      (     v∥     ∂v∥     )         ]
 -q   ∂⟨v-⋅δA⟩α                 ⟨δB-⊥⟩α            ∂F0-1-
−m   −    ∂t    −  v∥e∥ + VD + v∥ B0     ⋅∇X ⟨δϕ ⟩α  ∂v∥ v∥,    (290)
" class="math-display"  /><a 
 id="x13-67007r290"></a></center>
</div>The guiding-center velocity in the macroscopic (equilibrium) ﬁeld is given by
   <table 
class="equation"><tr><td><a 
 id="x13-67008r291"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation323x.png" alt="           -B⋆0-    --μ--           --1---
v∥e∥ + VD = B ⋆∥0v∥ + ΩB ⋆∥0B0 × ∇B0 + B0B ⋆∥0 E0 × B0
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(291)</td></tr></table>
<!--l. 3946--><p class="nopar" >
where
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67009r292"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation324x.png" alt="B⋆0 = B0 + B0 v∥∇ × b,
            Ω
" class="math-display"  /></center></td><td class="equation-label">(292)</td></tr></table>
<!--l. 3951--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67010r293"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation325x.png" alt="               (   v∥        )
B ⋆∥ ≡ b ⋅B⋆ = B 1+ --b ⋅∇ × b ,
                   Ω
" class="math-display"  /></center></td><td class="equation-label">(293)</td></tr></table>
<!--l. 3956--><p class="nopar" >
Using <span 
class="cmmi-10">B</span><sub><span 
class="cmsy-7">∥</span><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">⋆</span></sup> <span 
class="cmsy-10">≈ </span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>, then expression (<a 
href="#x13-67008r291">291<!--tex4ht:ref: 18-12-17-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67011r294"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation326x.png" alt="                  v2
v∥e ∥ + VD = v∥b + -∥∇ × b + --μ-B0 × ∇B0 + -12E0 × B0,
                  Ω◟--◝◜--◞   Ω◟B0---◝◜----◞  B◟-0-◝◜---◞
                 curvaturedrift     ∇B drift       E×B drift
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(294)</td></tr></table>
<!--l. 3966--><p class="nopar" >
where the curvature drift, <span 
class="cmsy-10">∇</span><span 
class="cmmi-10">B </span>drift, and <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">× </span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> drift can be identiﬁed. Note that the perturbed
guiding-center velocity <span 
class="cmmi-10">δ</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is given by (refer to Sec. <a 
href="nonlinear_gyrokinetic_equationse13.html#x14-71000D.3">D.3<!--tex4ht:ref: 19-3-28-e1 --></a>)
</p>
   <table 
class="equation"><tr><td><a 
 id="x13-67012r295"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation327x.png" alt="       e∥-×∇X-⟨δϕ⟩α     ⟨δB-⊥⟩α-
δVD  =      B0      + v∥  B0  .
" class="math-display"  /></center></td><td class="equation-label">(295)</td></tr></table>
<!--l. 3974--><p class="nopar" >
Using the above results, equation (<a 
href="#x13-67007r290">290<!--tex4ht:ref: 17-5-13-p2m --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation328x.png" alt="[                          ]
 ∂-+ (v e + V  + δV  )⋅ -∂--δf − e ⋅μ∇B  ∂δf-
 ∂t    ∥ ∥    D     D   ∂X′       ∥     0∂v ∥
        ( ∂F0 )  ( e∥ × ∇X ⟨δϕ⟩α   ⟨δB ⊥⟩α)  ( μ    ∂F0 )
= − δVD ⋅ ∂X-′ +   -----B------+ v∥--B----  ⋅ v-∇B0 -∂v-
    [             (      02            0       ∥       ∥               )         ]
 -q   ∂⟨v-⋅δA⟩α          v∥        -μ--           -1-           ⟨δB-⊥⟩α            ∂F0-1
−m   −    ∂t    −  v∥e∥ + Ω ∇ ×b + ΩB0 B0 × ∇B0 + B20E0 × B0 + v∥ B0     ⋅∇X ⟨δϕ⟩α  ∂v(∥2v9∥6,)
" class="math-display"  /></center>
</div>Collecting coeﬃcients before <span 
class="cmmi-10">∂F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">∕∂v</span><sub><span 
class="cmsy-7">∥</span></sub>, we ﬁnd that the two terms involving <span 
class="cmsy-10">∇</span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> (terms in blue and
red) cancel each other, yielding <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation329x.png" alt="[                          ]
 ∂-+ (v e + V  + δV  )⋅ -∂--δf − e ⋅μ∇B  ∂δf-
 ∂t    ∥ ∥    D     D   ∂X′       ∥     0∂v ∥
        ( ∂F0 )
= − δVD ⋅ ∂X-′
    [                                (       2                             )         ]
+-q  m-v ⟨δB-⊥⟩α-⋅(μ ∇B ) + ∂⟨v⋅δA-⟩α+   vb + v∥∇ × b + -1-E × B  + v ⟨δB⊥-⟩α-  ⋅∇   ⟨δϕ⟩   ∂F0(219,7)
 m   q  ∥  B0         0      ∂t         ∥   Ω         B20  0    0   ∥  B0       X    α  ∂v∥v∥
" class="math-display"  /><a 
 id="x13-67014r297"></a></center>
</div>This equation agrees with Eq. (8) in I. Holod’s 2009 pop paper (gyro-averaging is wrongly
omitted in that paper) and W. Deng’s 2011 NF paper. Equation (<a 
href="#x13-67014r297">297<!--tex4ht:ref: 18-9-18-e1 --></a>) drops all terms higher
than <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">2</span></sup>) and as a result the coeﬃcient before <span 
class="cmmi-10">∂δf∕∂v</span><sub><span 
class="cmsy-7">∥</span></sub> contains only the mirror force,
i.e.,
   <table 
class="equation"><tr><td><a 
 id="x13-67015r298"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation330x.png" alt="dv∥
dt = − e∥ ⋅μ∇B0,
" class="math-display"  /></center></td><td class="equation-label">(298)</td></tr></table>
<!--l. 4025--><p class="nopar" >
which is independent of any perturbations.
                                                                                

                                                                                
</p>
   <!--l. 4028--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse13.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse11.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse11.html#tailnonlinear_gyrokinetic_equationse11.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse12.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse12.html" >up</a>] </p></div>
<!--l. 4028--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationse12.html"></a> </p> 
</body></html> 
