<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Poisson‚Äôs equation and polarization density</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 2284--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu23.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationsu21.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationsu21.html#tailnonlinear_gyrokinetic_equationsu21.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationsu22.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse5.html#nonlinear_gyrokinetic_equationsu22.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">5.6   </span> <a 
 id="x28-400005.6"></a>Poisson‚Äôs equation and polarization density</h4>
<!--l. 2286--><p class="noindent" >Poisson‚Äôs equation is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x28-40001r184"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation195x.png" alt="‚àí ùúÄ0‚àá2Œ¥Œ¶ = qiŒ¥ni + qeŒ¥ne,
" class="math-display"  /></center></td><td class="equation-label">(184)</td></tr></table>
<!--l. 2290--><p class="nopar" >
where <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmsy-10">‚àá</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span>is called the space-charge term. Since we consider modes with <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚â™ </span><span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, the
space-charge term is approximated as <span 
class="cmsy-10">‚àá</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚â°‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span>+ <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚âà‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶</span>. Then Eq. (<a 
href="#x28-40001r184">184<!--tex4ht:ref: 18-10-5-p4 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x28-40002r185"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation196x.png" alt="‚àí ùúÄ0‚àá2‚ä• Œ¥Œ¶ = qiŒ¥ni + qeŒ¥ne.
" class="math-display"  /></center></td><td class="equation-label">(185)</td></tr></table>
<!--l. 2299--><p class="nopar" >
This approximation eliminates the parallel plasma oscillation from the system. The perpendicular
plasma oscillations seem to be partially eliminated in system with gyrokinetic ions and drift-kinetic
electrons. There are the so-called <span 
class="cmmi-10">Œ©</span><sub><span 
class="cmmi-7">H</span></sub> modes (also called electrostatic shear Alfven wave) that appear in
the gyrokinetic system which have some similarity with the plasma oscillations but with a much smaller
frequency, <span 
class="cmmi-10">Œ©</span><sub><span 
class="cmmi-7">H</span></sub> <span 
class="cmsy-10">‚àº </span>(<span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïk</span><sub><span 
class="cmsy-7">‚ä•</span></sub>)(<span 
class="cmmi-10">Œª</span><sub><span 
class="cmmi-7">D</span></sub><span 
class="cmmi-10">‚àïœÅ</span><sub><span 
class="cmmi-7">s</span></sub>)<span 
class="cmmi-10">œâ</span><sub><span 
class="cmmi-7">pe</span></sub>.
</p><!--l. 2308--><p class="indent" >   Using expression (<a 
href="nonlinear_gyrokinetic_equationsu19.html#x25-34002r156">156<!--tex4ht:ref: 19-1-3-e2 --></a>), the perturbed number density <span 
class="cmmi-10">Œ¥n </span>is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation197x.png" alt="    ‚à´
Œ¥n =  Œ¥F dv

    ‚à´        ‚à´ [-q           ‚àÇF0-]     ‚à´ [ q        ‚àÇF0]
  =   Œ¥hdv +    m (Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶ ‚ü©Œ±) ‚àÇùúÄ  dv +    m ‚ü®v‚ãÖŒ¥A ‚ü©Œ±‚àÇ ùúÄ  dv,     (186)
" class="math-display"  /><a 
 id="x28-40003r186"></a></center>
</div>where the blue term is approximately zero for isotropic <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> and this term is usually dropped in
simulations that assume isotropic <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> and approximate <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span>as <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>. The red term in expression (<a 
href="#x28-40003r186">186<!--tex4ht:ref: 19-1-12-e1 --></a>)
is the so-called the polarization density <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">p</span></sub>, i.e.,
   <table 
class="equation"><tr><td><a 
 id="x28-40004r187"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation198x.png" alt="        ‚à´  q           ‚àÇF0
Œ¥np(x) =  m-(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)-‚àÇùúÄ-dv,
" class="math-display"  /></center></td><td class="equation-label">(187)</td></tr></table>
<!--l. 2328--><p class="nopar" >
which has an explicit dependence on <span 
class="cmmi-10">Œ¥Œ¶ </span>and is usually moved to the left hand of Poisson‚Äôs equation
when constructing the numerical solver of the Poisson equation, i.e., equation (<a 
href="#x28-40002r185">185<!--tex4ht:ref: 19-1-12-e2 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x28-40005r188"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation199x.png" alt="             ‚à´  q            ‚àÇF
‚àí ùúÄ0‚àá2‚ä•Œ¥Œ¶ ‚àí qi  -i-(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)--i0dv = qiŒ¥n‚Ä≤i + qeŒ¥ne,
               mi             ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(188)</td></tr></table>
                                                                                

                                                                                
<!--l. 2337--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmsy-10">‚Ä≤ </span>= <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">i</span></sub> <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">pi</span></sub> = <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">Œ¥h</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span>, which is evaluated by using Monte-Carlo markers. Since some parts
depending on <span 
class="cmmi-10">Œ¥Œ¶ </span>are moved from the right-hand side to the left-hand side of the Ô¨Åeld equation,
numerical solvers (for <span 
class="cmmi-10">Œ¥Œ¶</span>) based on the left-hand side of Eq. (<a 
href="#x28-40005r188">188<!--tex4ht:ref: 19-1-12-e4 --></a>) probably behaves better than the
one that is based on the left-hand side of Eq. (<a 
href="#x28-40002r185">185<!--tex4ht:ref: 19-1-12-e2 --></a>), i.e., <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶</span>.
</p><!--l. 2346--><p class="indent" >   The polarization density is part of the perturbed density that is extracted from the source term and
moved to the left-hand side of the Poisson equation. The polarization density will be evaluated without
using Monte-Carlo markers, whereas the remained density on the right-hand side will be evaluated
using Mote-Carlo markers. The two diÔ¨Äerent methods of evaluating two parts of the total perturbed
density can possibly introduce signiÔ¨Åcant errors if the two terms are expected to cancel
each other and give a small quantity that is much smaller than either of the two terms.
This is one pitfall for PIC simulations that extract some parts from the source term and
move them to the left-hand side. To remedy this, rather than directly moving a part of the
distribution function to the left-hand side, we subtract an analytic expression from both
sides of Eq. (<a 
href="#x28-40002r185">185<!--tex4ht:ref: 19-1-12-e2 --></a>). The analytical expression is evaluated based on grid values of perturbed
electromagnetic Ô¨Åelds and are independent of makers. All the original parts of the distribution
functions are kept on the right-hand side and are still evaluated by using markers, which
hopefully avoids the possible cancellation problem. This strategy is often called a cancellation
scheme.
</p><!--l. 2364--><p class="indent" >   It turns out the cancellation scheme is not necessary for Eq. (<a 
href="#x28-40005r188">188<!--tex4ht:ref: 19-1-12-e4 --></a>), but for the Ô¨Åeld solver for
Ampere‚Äôs equation (discussed later), this cancellation scheme is necessary in order to obtain stable
results.
</p><!--l. 2369--><p class="indent" >   Note that two things appear here: What motivates us to move parts of the distribution function to
the left== <span 
class="ecrm-1000">&#x003E;hopefully to make the left-hand side matrix more well-behaved (such as good condition</span>
<span 
class="ecrm-1000">number, etc.) Why do we need the cancellation scheme== &#x003E;to avoid numerical accuracy problem</span>
<span 
class="ecrm-1000">appearing when large terms cancels each other== &#x003E;iteration is needed when the cancellation</span>
<span 
class="ecrm-1000">scheme is used because the right-hand side explicitly contains unknown electromagnetic</span>
<span 
class="ecrm-1000">Ô¨Åelds.</span>
                                                                                

                                                                                
</p>
   <!--l. 2377--><div class="crosslinks"><p class="noindent"><span 
class="ecrm-1000">[</span><a 
href="nonlinear_gyrokinetic_equationsu23.html" ><span 
class="ecrm-1000">next</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationsu21.html" ><span 
class="ecrm-1000">prev</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationsu21.html#tailnonlinear_gyrokinetic_equationsu21.html" ><span 
class="ecrm-1000">prev-tail</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationsu22.html" ><span 
class="ecrm-1000">front</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationse5.html#nonlinear_gyrokinetic_equationsu22.html" ><span 
class="ecrm-1000">up</span></a><span 
class="ecrm-1000">] </span></p></div>
<!--l. 2377--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationsu22.html"></a> </p> 
</body></html> 
