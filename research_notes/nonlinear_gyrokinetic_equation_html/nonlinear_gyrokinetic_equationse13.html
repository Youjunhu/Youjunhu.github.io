<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Split-weight scheme for electrons in GEM code</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 3793--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse14.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse12.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse12.html#tailnonlinear_gyrokinetic_equationse12.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationse13.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse13.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">E   </span> <a 
 id="x14-66000E"></a>Split-weight scheme for electrons in GEM code</h3>
<!--l. 3795--><p class="noindent" >The perturbed distribution function is decomposed as given by Eq. (<a 
href="nonlinear_gyrokinetic_equationse4.html#x5-35002r174">174<!--tex4ht:ref: 19-1-3-e2 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x14-66001r306"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation345x.png" alt="δF = δh + q-(δΦ− ⟨δΦ⟩α)∂F0-+ q-⟨v⋅δA ⟩α∂F0,
          m             ∂𝜀   m         ∂ 𝜀
" class="math-display"  /></center></td><td class="equation-label">(306)</td></tr></table>
<!--l. 3803--><p class="nopar" >
where the term in blue is the so-called adiabatic response, which depends on the gyro-angle in
guiding-center coordinates. Recall that the red term <span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δ</span>Φ<span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub>, which is independent of the gyro-angle, is
introduced in order to eliminate the time derivative <span 
class="cmmi-10">∂</span><span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δ</span>Φ<span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub><span 
class="cmmi-10">∕∂t </span>term on the right-hand side of the
original Frieman-Chen gyrokinetic equation.
</p><!--l. 3811--><p class="indent" >   The so-called generalized split-weight scheme corresponds to going back to the original
Frieman-Chen gyrokinetic equation by introducing another <span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δ</span>Φ<span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> term with a free small parameter <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub>.
Speciﬁcally, <span 
class="cmmi-10">δh </span>in the above is split as
</p>
   <table 
class="equation"><tr><td><a 
 id="x14-66002r307"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation346x.png" alt="δh = δhs + 𝜖g q-⟨δΦ⟩α∂F0.
            m       ∂𝜀
" class="math-display"  /></center></td><td class="equation-label">(307)</td></tr></table>
<!--l. 3818--><p class="nopar" >
(If <span 
class="cmmi-10">𝜀</span><sub><span 
class="cmmi-7">g</span></sub> = 1, then the two <span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δ</span>Φ<span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> terms in Eq. (<a 
href="#x14-66001r306">306<!--tex4ht:ref: 22-11-13-e2 --></a>) and (<a 
href="#x14-66002r307">307<!--tex4ht:ref: 22-11-13-e1 --></a>) cancel each other.) Substituting this
expression into Eq. (), we obtain the following equation for <span 
class="cmmi-10">δh</span><sub><span 
class="cmmi-7">s</span></sub>: </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation347x.png" alt="[ ∂                       ]
 ∂t + (v∥e∥ + VD + δVD )⋅∇X δhs
         [                          ]
+𝜖g q-∂F0 ∂- +(v∥e∥ + VD + δVD ) ⋅∇X  ⟨δΦ⟩α
   m  ∂𝜀  ∂[t                         ]
   q-      -∂                         ∂F0-
+𝜖gm ⟨δΦ⟩α ∂t + (v∥e∥ + VD + δVD )⋅∇X   ∂𝜀
= − δVD ⋅∇XF0
  q                                     ∂F0
−m-[(v∥e∥ +VD  + δVD )⋅∇X (⟨v ⋅δA − δΦ⟩α)]∂𝜀-.           (308)
" class="math-display"  /><a 
 id="x14-66003r308"></a></center>
</div>Noting that <span 
class="cmmi-10">∂F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">∕∂t </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmsy-10">⋅∇</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmsy-10">∇</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">∼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we ﬁnd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">3</span></sup>) and thus can be dropped. Moving the second line to the right-hand side, the
above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation348x.png" alt="[                         ]
 ∂-+ (v e + V  + δV  )⋅∇    δh
 ∂t    ∥ ∥    D     D    X    s
= − δVD ⋅∇XF0
  q {                                         [ ∂⟨δΦ ⟩α              ]} ∂F0
−m-  (v∥e∥ + VD + δVD )⋅∇X [⟨v ⋅δA ⟩α − ⟨δΦ ⟩α]+ 𝜖g --∂t--+ VG  ⋅∇X ⟨δΦ ⟩α   (∂3𝜀09.)
" class="math-display"  /><a 
 id="x14-66004r309"></a></center>
</div>
<!--l. 3861--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">E.0.1   </span> <a 
 id="x14-67000E.0.1"></a>special case of <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub> = 1</h5>
<!--l. 3863--><p class="noindent" >For the special case of <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub> = 1 (the default and most used case in <span 
class="cmtt-10">GEM</span> code, Yang Chen said <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub> <span 
class="cmmi-10">&#x003C; </span>1 cases
are sometimes not accurate, so he gave up using it since 2009), equation (<a 
href="#x14-66004r309">309<!--tex4ht:ref: 19-1-10-7 --></a>) can be simpliﬁed as:
</p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation349x.png" alt="[ ∂                        ]
 ∂t + (v∥e∥ + VD + δVD )⋅∇X  δhs

= − δ[VD ⋅∇XF0                ]
− q- VG  ⋅∇X  ⟨v ⋅δA⟩α + ∂⟨δΦ⟩α  ∂F0,                (310)
  m                      ∂t    ∂𝜀
" class="math-display"  /><a 
 id="x14-67001r310"></a></center>
</div>where two <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub> <span 
class="cmsy-10">⋅⟨</span><span 
class="cmmi-10">δ</span>Φ<span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> terms cancel each other. Because the <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">E</span><sub><span 
class="cmsy-7">∥</span></sub> term is one of the factors that make
kinetic electron simulations diﬃcult, eliminating <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub> <span 
class="cmsy-10">⋅⟨</span><span 
class="cmmi-10">δ</span>Φ<span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> term may be beneﬁcial for obtaining stable
algorithms.
<!--l. 3883--><p class="indent" >   For <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub> = 1, <span 
class="cmmi-10">δF </span>is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation350x.png" alt="               q      ∂F     q            ∂F    q         ∂F
δF  =   δhs + 𝜀g-⟨δΦ⟩α--g0 + --(δΦ − ⟨δΦ⟩α)--0-+ --⟨v ⋅δA ⟩α --0-
               m       ∂𝜀    m            ∂ 𝜀   m         ∂𝜀
    =   δhs +-qδΦ ∂Fg0+ -q⟨v ⋅δA⟩α∂F0-,                           (311)
             m     ∂𝜀   m          ∂𝜀
" class="math-display"  /></center>
</div>where the adiabatic term will be moved to the left-hand side of the Poisson’s equation. The
descretization of this term is much easier than the polarization density. This term is already in
<span 
class="cmtt-10">GEM</span>.
<!--l. 3899--><p class="indent" >   Equation (<a 
href="#x14-67001r310">310<!--tex4ht:ref: 19-1-10-7m2 --></a>) actually goes back to the original Frieman-Chen equation. The only diﬀerence is
that <img 
src="nonlinear_gyrokinetic_equation351x.png" alt="q-
m"  class="frac" align="middle" /><span 
class="cmsy-10">⟨</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">⋅</span><span 
class="cmmi-10">δ</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub><img 
src="nonlinear_gyrokinetic_equation352x.png" alt="∂F0
∂𝜀"  class="frac" align="middle" /> is further split from the perturbed distribution function. Considering this, equation
(<a 
href="#x14-67001r310">310<!--tex4ht:ref: 19-1-10-7m2 --></a>) can also be obtained from the original Frieman-Chen equation (<a 
href="nonlinear_gyrokinetic_equationse3.html#x4-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) by writing <span 
class="cmmi-10">δG</span><sub><span 
class="cmr-7">0</span></sub>
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x14-67003r312"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation353x.png" alt="δG  = δh + -q⟨v ⋅δA ⟩ ∂F0-,
   0    s  m        α ∂𝜀
" class="math-display"  /></center></td><td class="equation-label">(312)</td></tr></table>
<!--l. 3909--><p class="nopar" >
In this case, <span 
class="cmmi-10">δF </span>is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x14-67004r313"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation354x.png" alt="δF = δh + -qδΦ ∂Fg0+ -q⟨v ⋅δA⟩ ∂F0-,
       s  m     ∂𝜀   m        α ∂𝜀
" class="math-display"  /></center></td><td class="equation-label">(313)</td></tr></table>
<!--l. 3915--><p class="nopar" >
Substituting expression (<a 
href="#x14-67003r312">312<!--tex4ht:ref: 19-1-11-1 --></a>) into equation (<a 
href="nonlinear_gyrokinetic_equationse3.html#x4-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>), we obtain the following equation for <span 
class="cmmi-10">δh</span><sub><span 
class="cmmi-7">s</span></sub>:
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation355x.png" alt="[                          ]
 ∂-+ (v∥e∥ + VD + δVD ) ⋅∇X  δhs
 ∂t    [                          ]
  q-∂F0- ∂-
+ m ∂𝜀   ∂t + (v∥e∥ + VD + δVD )⋅∇X ⟨v ⋅δA⟩α
  q        [ ∂                        ] ∂F0
+ m⟨v ⋅δA⟩α  ∂t + (v∥e∥ + VD + δVD )⋅∇X ∂-𝜀-

= − δVD ⋅∇XF0 −-q ∂⟨δΦ-−-v-⋅δA⟩α∂F0-,                   (314)
               m       ∂t       ∂𝜀
" class="math-display"  /><a 
 id="x14-67005r314"></a></center>
</div>Noting that <span 
class="cmmi-10">∂F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">∕∂t </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmsy-10">⋅∇</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmsy-10">∇</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">∼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we ﬁnd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">3</span></sup>) and thus can be dropped. Moving the second line to the right-hand side, the
above equation is written as <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation356x.png" alt="[ ∂                        ]
  ∂t + (v∥e∥ + VD + δVD )⋅∇X δhs

= − δ[VD ⋅∇XF0                              ]
− q- ∂-⟨δΦ-⟩α + (v∥e∥ + VD + δVD )⋅∇X ⟨v ⋅δA ⟩α ∂F0-,        (315)
  m     ∂t                                   ∂𝜀
" class="math-display"  /><a 
 id="x14-67006r315"></a></center>
</div>which agrees with Eq. (<a 
href="#x14-67001r310">310<!--tex4ht:ref: 19-1-10-7m2 --></a>).
<!--l. 3953--><p class="indent" >   In GEM, the split weight method is used only for electrons, and <span 
class="cmmi-10">∂</span><span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δ</span>Φ<span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub><span 
class="cmmi-10">∕∂t </span>is approximated by
<span 
class="cmmi-10">∂δ</span>Φ<span 
class="cmmi-10">∕∂t</span>, which is obtained from the vorticity equation (rather than from time-diﬀerence
scheme).
</p><!--l. 3958--><p class="indent" >    
</p><!--l. 3960--><p class="indent" >   When using the split weight scheme, a <span 
class="cmmi-10">∂δϕ∕∂t </span>terms appear in the right-hand-side of the weight
evolution equation. GEM makes use of the vorticity equation (time derivative of the Poissson equation)
to evaluate <span 
class="cmmi-10">∂δϕ∕∂t</span>.
                                                                                

                                                                                
</p>
   <!--l. 3965--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse14.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse12.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse12.html#tailnonlinear_gyrokinetic_equationse12.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse13.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse13.html" >up</a>] </p></div>
<!--l. 3965--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationse13.html"></a>  </p> 
</body></html> 
