<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Parallel Ampere‚Äôs Law</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 2679--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse6.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse4.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse4.html#tailnonlinear_gyrokinetic_equationse4.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationse5.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse5.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x6-390005"></a>Parallel Ampere‚Äôs Law</h3>
   <table 
class="equation"><tr><td><a 
 id="x6-39001r215"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation255x.png" alt="‚àí ‚àá2‚ä• Œ¥A(‚à•n+1)= Œº0(Œ¥J (n||i+1)+ Œ¥J(|n|e+1)),
" class="math-display"  /></center></td><td class="equation-label">(215)</td></tr></table>
<!--l. 2684--><p class="nopar" >
where the parallel currents are given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-39002r216"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation256x.png" alt="                         ‚à´         q2          ‚àÇF
Œ¥J(n||i+1)= Œ¥J|‚Ä≤|i(Œ¥œï(n),Œ¥A(‚à•n)) +  (v(‚à•n+1))2-i-‚ü®Œ¥A (n‚à•+1)‚ü©Œ±--i0dv,
                                   mi           ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(216)</td></tr></table>
<!--l. 2692--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-39003r217"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation257x.png" alt="                       ‚à´
        ‚Ä≤   (n)   (n)       (n+1) 2 q2e   (n+1)  ‚àÇFe0
Œ¥J||e = Œ¥J||e(Œ¥œï  ,Œ¥A ‚à• )+   (v‚à•   ) me‚ü®Œ¥A ‚à•   ‚ü©Œ±  ‚àÇùúÄ dv,
" class="math-display"  /></center></td><td class="equation-label">(217)</td></tr></table>
<!--l. 2698--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥J</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">i</span></sub><span 
class="cmsy-10">‚Ä≤ </span>and <span 
class="cmmi-10">Œ¥J</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">e</span></sub><span 
class="cmsy-10">‚Ä≤ </span>is the parallel current carried by the distribution function <span 
class="cmmi-10">Œ¥h </span>in Eq. (<a 
href="nonlinear_gyrokinetic_equationse4.html#x5-37002r203">203<!--tex4ht:ref: 19-1-3-e2 --></a>), which
are updated from the value at the <span 
class="cmmi-10">n</span>th time step to the (<span 
class="cmmi-10">n </span>+ 1)th time step using an explicit scheme
and therefore does not depends on the Ô¨Åeld at the (<span 
class="cmmi-10">n </span>+ 1)th step. The blue terms ¬†in Eqs. (<a 
href="#x6-39002r216">216<!--tex4ht:ref: 19-3-21-4 --></a>)
and (<a 
href="#x6-39003r217">217<!--tex4ht:ref: 19-3-21-5 --></a>) are sometimes called ‚Äúskin current‚Äù, which depend on the unknown Ô¨Åeld at the
(<span 
class="cmmi-10">n </span>+ 1)th step and thus need to be moved to the left-hand side of Ampere‚Äôs law (<a 
href="#x6-39001r215">215<!--tex4ht:ref: 19-3-21-6 --></a>) if we
want to solve this equation by direct methods. In this case, equation (<a 
href="#x6-39001r215">215<!--tex4ht:ref: 19-3-21-6 --></a>) is written as
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation258x.png" alt="               ‚à´
‚àí ‚àá2 Œ¥A (n+1)‚àí Œº  (v(n+1))2 q2i-‚ü®Œ¥A (n+1)‚ü© ‚àÇFi0dv
   ‚ä•   ‚à•      0    ‚à•     mi    ‚à•    Œ± ‚àÇùúÄ
   ‚à´   (n+1)2 q2e   (n+1)  ‚àÇFe0
‚àí Œº0 (v‚à•   ) me-‚ü®Œ¥A ‚à•   ‚ü©Œ±-‚àÇùúÄ-dv.
= Œº (Œ¥J‚Ä≤ +Œ¥J ‚Ä≤)                                        (218)
   0   ‚à•i    ||e
" class="math-display"  /></center>
</div>Then we need to put the blue terms into matrix form. If we put the bule terms into martrix form by
using numerical spatial grid integration (as we do for the polarization density), then there arises the
cancellation propblem (i.e., the two parts of the distribution are evaluated by diÔ¨Äerent methods,one
is grid-based and the other is MC marker based, there is a risk that the sum of the two
terms will be inaccurate when the two terms are of opposite signs and large amplitudes, and
the Ô¨Ånal result amplitude is expected to be much smaller than the amplituded of the two
terms). If we get the matrix form by evaluating it numerically using MC markers (which
can avoid the cancellation problem), the corresponding matrix will depends on markers
and thus needs to be re-constructed and inverted each time-step, which is computationally
expensive.
<!--l. 2733--><p class="noindent" >Therefore we go back to Eq. (<a 
href="#x6-39001r215">215<!--tex4ht:ref: 19-3-21-6 --></a>) and try to solve it using iterative methods. However, it is found
numerically that directly using Eq. (<a 
href="#x6-39001r215">215<!--tex4ht:ref: 19-3-21-6 --></a>) as an iterative scheme is usually divergent. To obtain a
convergent iterative scheme, we need to have an approximate form for the blue terms, which is
independent of markers and so that it is easy to construct its matrix, and then subtract this
approximate form from both sides. After doing this, the iterative scheme has better chance to be
convergent (partially due to that the right-hand side becomes smaller). An approximate form is that
derived by neglecting the FLR eÔ¨Äect given in Sec. <a 
href="nonlinear_gyrokinetic_equationse4.html#x5-380004.6">4.6<!--tex4ht:ref: 19-3-21-8 --></a>. Using this, the iterative scheme for solving Eq.
(<a 
href="#x6-39001r215">215<!--tex4ht:ref: 19-3-21-6 --></a>) is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation259x.png" alt="             (  œâ2          œâ2        )
‚àí ‚àá2‚ä•Œ¥A (n‚à•+1)‚àí  ‚àí-pi2 Œ¥A(‚à•n+1)‚àí-pe2 Œ¥A (n‚à•+1)
                 c           c
= Œº0(Œ¥J‚Ä≤‚à•i + Œ¥J‚Ä≤||e)
   ‚à´          2
+Œº0  (v(‚à•n+1))2 qi‚ü®Œ¥A (n‚à•+1)‚ü©Œ± ‚àÇFi0dv
   ‚à´         mi           ‚àÇùúÄ
+Œº   (v(n+1))2 q2e-‚ü®Œ¥A (n+1)‚ü© ‚àÇFe0dv
  0    ‚à•     me    ‚à•    Œ± ‚àÇùúÄ
 (   œâ2pi  (n+1)  œâ2pe   (n+1))
‚àí  ‚àí -2 Œ¥A ‚à•  ‚àí --2 Œ¥A ‚à•   .                         (219)
     c           c
" class="math-display"  /><a 
 id="x6-39005r219"></a></center>
</div>In the drift-kinetic limit (i.e., neglecting the FLR eÔ¨Äect), the blue and red terms on the
right-hand side of the above equation cancel each other exactly. Even in this case, it is
found numerically that these terms need to be retained and the blue terms are evaluated
using markers. Otherwise, numerical inaccuracy can give numerical instabilities, which is
the so-called cancellation problem. The explanation for this is as follows. The blue terms
are part of the current. The remained part of the current carried by <span 
class="cmmi-10">Œ¥h </span>is computed by
using Monte-Carlo integration over markers. If the blue terms are evaluated analytically,
rather than using Monte-Carlo integration over markers, then the cancellation between this
analytical part and Monte-Carlo part can have large error (assume that there are two large
contribution that have opposite signs in the two parts) because the two parts are evaluated
using diÔ¨Äerent methods and thus have diÔ¨Äerent accuracy, which makes the cancellation less
accurate.
<!--l. 2774--><p class="indent" >   Because the ion skin current is less than its electron counterpart by a factor of <span 
class="cmmi-10">m</span><sub><span 
class="cmmi-7">e</span></sub><span 
class="cmmi-10">‚àïm</span><sub><span 
class="cmmi-7">i</span></sub>, its accuracy
is not important. The cancellation error is not a problem and hence can be neglected. In this case,
equation (<a 
href="#x6-39005r219">219<!--tex4ht:ref: 19-3-21-p1 --></a>) is simpliÔ¨Åed as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation260x.png" alt="             (                        )
   2   (n+1)     œâ2pi  (n+1)  œâ2pe   (n+1)
‚àí ‚àá ‚ä•Œ¥A ‚à•  ‚àí   ‚àí c2 Œ¥A‚à•   ‚àí  c2 Œ¥A ‚à•
       ‚Ä≤    ‚Ä≤
= Œº0‚à´(Œ¥J‚à•i + Œ¥J||e)
       (n+1)2-qe2   (n+1) ‚àÇFe0
+Œº0   (v‚à•   ) me ‚ü®Œ¥A‚à•   ‚ü©Œ± ‚àÇùúÄ dv
 (   œâ2       )
‚àí  ‚àí -p2eŒ¥A (‚à•n+1)  .                                    (220)
     c
" class="math-display"  /><a 
 id="x6-39006r220"></a></center>
</div>Note that the blue term will be evaluated using Monte-Carlo markers.
                                                                                

                                                                                
   <!--l. 2792--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse6.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse4.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse4.html#tailnonlinear_gyrokinetic_equationse4.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse5.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse5.html" >up</a>] </p></div>
<!--l. 2792--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationse5.html"></a> </p> 
</body></html> 
