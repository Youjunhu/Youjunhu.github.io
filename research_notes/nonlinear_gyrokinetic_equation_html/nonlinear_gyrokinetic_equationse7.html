<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Poisson‚Äôs equation and polarization density</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 2408--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse8.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse6.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse6.html#tailnonlinear_gyrokinetic_equationse6.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationse7.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse7.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x8-420007"></a>Poisson‚Äôs equation and polarization density</h3>
<!--l. 2410--><p class="noindent" >Poisson‚Äôs equation is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-42001r188"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation199x.png" alt="‚àí ùúÄ0‚àá2Œ¥Œ¶ = qiŒ¥ni + qeŒ¥ne,
" class="math-display"  /></center></td><td class="equation-label">(188)</td></tr></table>
<!--l. 2414--><p class="nopar" >
where <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmsy-10">‚àá</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥</span>Œ¶ is called the space-charge term. Since we consider modes with <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚â™ </span><span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, the
space-charge term is approximated as <span 
class="cmsy-10">‚àá</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥</span>Œ¶ <span 
class="cmsy-10">‚â°‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥</span>Œ¶ + <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥</span>Œ¶ <span 
class="cmsy-10">‚âà‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥</span>Œ¶. Then Eq. (<a 
href="#x8-42001r188">188<!--tex4ht:ref: 18-10-5-p4 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-42002r189"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation200x.png" alt="     2
‚àí ùúÄ0‚àá‚ä•Œ¥Œ¶ = qiŒ¥ni + qeŒ¥ne.
" class="math-display"  /></center></td><td class="equation-label">(189)</td></tr></table>
<!--l. 2423--><p class="nopar" >
This approximation eliminates the parallel plasma oscillation from the system. The perpendicular
plasma oscillations seem to be only partially eliminated in the system consisting of gyrokinetic ions and
drift-kinetic electrons. There are the so-called Œ©<sub><span 
class="cmmi-7">H</span></sub> modes (also called electrostatic shear Alfven wave)
that appear in the gyrokinetic system which have some similarity with the plasma oscillations but with
a much smaller frequency, Œ©<sub><span 
class="cmmi-7">H</span></sub> <span 
class="cmsy-10">‚àº </span>(<span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïk</span><sub><span 
class="cmsy-7">‚ä•</span></sub>)(<span 
class="cmmi-10">Œª</span><sub><span 
class="cmmi-7">D</span></sub><span 
class="cmmi-10">‚àïœÅ</span><sub><span 
class="cmmi-7">s</span></sub>)<span 
class="cmmi-10">œâ</span><sub><span 
class="cmmi-7">pe</span></sub>.
</p><!--l. 2432--><p class="indent" >   Using expression (<a 
href="nonlinear_gyrokinetic_equationse5.html#x6-35002r160">160<!--tex4ht:ref: 19-1-3-e2 --></a>), the perturbed number density <span 
class="cmmi-10">Œ¥n </span>is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation201x.png" alt="       ‚à´
Œ¥n  =     Œ¥Fdv
       ‚à´        ‚à´ [                 ]     ‚à´ [              ]
    =     Œ¥hdv+     q-(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)‚àÇF0- dv+    -q‚ü®v ‚ãÖŒ¥A‚ü©Œ±‚àÇF0- dv,    (190)
                    m            ‚àÇùúÄ          m          ‚àÇùúÄ
" class="math-display"  /><a 
 id="x8-42003r190"></a></center>
</div>where the blue term is approximately zero for isotropic <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> and this term is usually dropped in
simulations that assume isotropic <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> and approximate <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span>as <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>. The red term in expression (<a 
href="#x8-42003r190">190<!--tex4ht:ref: 19-1-12-e1 --></a>)
is the so-called the polarization density <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">p</span></sub>, i.e.,
   <table 
class="equation"><tr><td><a 
 id="x8-42004r191"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation202x.png" alt="        ‚à´  q           ‚àÇF
Œ¥np(x ) =  --(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶ ‚ü©Œ±)---0dv,
          m             ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(191)</td></tr></table>
<!--l. 2452--><p class="nopar" >
which has an explicit dependence on <span 
class="cmmi-10">Œ¥</span>Œ¶ and is usually moved to the left hand of Poisson‚Äôs equation
when constructing the numerical solver of the Poisson equation, i.e., equation (<a 
href="#x8-42002r189">189<!--tex4ht:ref: 19-1-12-e2 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-42005r192"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation203x.png" alt="             ‚à´  q            ‚àÇF
‚àí ùúÄ0‚àá2‚ä•Œ¥Œ¶ ‚àí qi  -i-(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)--i0dv = qiŒ¥n‚Ä≤i + qeŒ¥ne,
               mi             ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(192)</td></tr></table>
                                                                                

                                                                                
<!--l. 2461--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmsy-10">‚Ä≤ </span>= <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">i</span></sub> <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">pi</span></sub> = <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">Œ¥h</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span>, which is evaluated by using Monte-Carlo markers. Since some parts
depending on <span 
class="cmmi-10">Œ¥</span>Œ¶ are moved from the right-hand side to the left-hand side of the Ô¨Åeld equation,
numerical solvers (for <span 
class="cmmi-10">Œ¥</span>Œ¶) based on the left-hand side of Eq. (<a 
href="#x8-42005r192">192<!--tex4ht:ref: 19-1-12-e4 --></a>) probably behaves better than the
one that is based on the left-hand side of Eq. (<a 
href="#x8-42002r189">189<!--tex4ht:ref: 19-1-12-e2 --></a>), i.e., <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥</span>Œ¶.
</p><!--l. 2470--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.1   </span> <a 
 id="x8-430007.1"></a>Discussion on cancellation scheme</h4>
<!--l. 2472--><p class="noindent" >The polarization density is part of the perturbed density that is extracted from the source term and
moved to the left-hand side of the Poisson equation. The polarization density will be evaluated without
using Monte-Carlo markers, whereas the remained density on the right-hand side will be
evaluated using Mote-Carlo markers. The two diÔ¨Äerent methods of evaluating two parts of
the total perturbed density can possibly introduce signiÔ¨Åcant errors if the two terms are
expected to cancel each other and give a small quantity that is much smaller than either of
the two terms. This is one pitfall for PIC simulations that extract some parts from the
source term and move them to the left-hand side. To remedy this, rather than directly
moving a part of the distribution function to the left-hand side, we subtract an (approximate)
analytic expression from both sides of Eq. (<a 
href="#x8-42002r189">189<!--tex4ht:ref: 19-1-12-e2 --></a>). The analytical expressions on both sides are
evaluated based on grid values of perturbed electromagnetic Ô¨Åelds and are independent of
makers. All the original parts of the distribution functions are kept on the right-hand side
and are still evaluated by using markers, which hopefully avoids the possible cancellation
problem. This strategy is often called a cancellation scheme. Since unknown perturbed
electromagnetic Ô¨Åelds appear on the right-hand side, iteration is needed to solve the Ô¨Åeld
equation.
</p><!--l. 2492--><p class="indent" >   Note that two things appear here: What motivates us to move parts of the distribution function to
the left? It is the goal of hopefully making the left-hand side matrix more well-behaved (such as good
condition number, etc.) Why do we need the cancellation scheme? Because we want to avoid the
numerical inaccuracy that appears when large terms cancels each other. Note that iteration is needed
when the cancellation scheme is used because the right-hand side explicitly contains unknown
electromagnetic Ô¨Åelds.
</p><!--l. 2500--><p class="indent" >   It turns out that the cancellation scheme is not necessary for Eq. (<a 
href="#x8-42005r192">192<!--tex4ht:ref: 19-1-12-e4 --></a>), but for the Ô¨Åeld solver for
Ampere‚Äôs equation (discussed later), this cancellation scheme is necessary in order to obtain stable
results.
</p><!--l. 2505--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.2   </span> <a 
 id="x8-440007.2"></a>Adiabatic electron response ** need to check the derivation</h4>
<!--l. 2507--><p class="noindent" >Assume that the total electron density satisÔ¨Åes the Boltzmann distribution in the presence of the
perturbed potential, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-44001r193"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation204x.png" alt="          (      )      (        )
             qeŒ¥Œ¶            qeŒ¥Œ¶
ne = Ne exp ‚àí Te   ‚âà Ne  1 ‚àí  Te   ,
" class="math-display"  /></center></td><td class="equation-label">(193)</td></tr></table>
<!--l. 2512--><p class="nopar" >
where <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">e</span></sub> is a radial function. Note that this does not that imply the equilibrium density is <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">e</span></sub> (it just
implies that the total density is <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">e</span></sub> at the location where <span 
class="cmmi-10">Œ¥</span>Œ¶ = 0, which can still be diÔ¨Äerent from the
equilibrium density).
</p><!--l. 2518--><p class="indent" >   Further assume that the magnetic surface average of <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">e</span></sub> = <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span></sub> <span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span><span 
class="cmr-7">0</span></sub> is zero, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-44002r194"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation205x.png" alt="‚ü®ne ‚àí ne0‚ü© = 0,
" class="math-display"  /></center></td><td class="equation-label">(194)</td></tr></table>
<!--l. 2522--><p class="nopar" >
where <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span><span 
class="cmr-7">0</span></sub> is the equilibrium electron density. Using Eq. (<a 
href="#x8-44001r193">193<!--tex4ht:ref: 23-2-13-1 --></a>) in the above condition, we
get
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-44003r195"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation206x.png" alt="                      (          )
Ne = ne0----1----‚âà ne0  1+ qe‚ü®Œ¥Œ¶-‚ü© .
        1‚àí  qe‚ü®TŒ¥Œ¶e‚ü©-            Te
" class="math-display"  /></center></td><td class="equation-label">(195)</td></tr></table>
<!--l. 2529--><p class="nopar" >
Then <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span></sub> in expression (<a 
href="#x8-44001r193">193<!--tex4ht:ref: 23-2-13-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-44004r196"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation207x.png" alt="        (    q‚ü®Œ¥Œ¶‚ü©) (    q Œ¥Œ¶)      (    q ‚ü®Œ¥Œ¶ ‚ü©  q Œ¥Œ¶ )
ne = ne0 1 + -e----   1‚àí -e--  ‚âà ne0  1+ -e----‚àí -e--
              Te          Te               Te     Te
" class="math-display"  /></center></td><td class="equation-label">(196)</td></tr></table>
<!--l. 2536--><p class="nopar" >
Then <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">e</span></sub> = <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span></sub> <span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span><span 
class="cmr-7">0</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-44005r197"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation208x.png" alt="         q (Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©)
Œ¥ne = ‚àí n0e-e---------.
              Te
" class="math-display"  /></center></td><td class="equation-label">(197)</td></tr></table>
<!--l. 2541--><p class="nopar" >
</p><!--l. 2543--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.3   </span> <a 
 id="x8-450007.3"></a>Poisson‚Äôs equation with adiabatic electron response</h4>
<!--l. 2545--><p class="noindent" >Pluging expression (<a 
href="#x8-44005r197">197<!--tex4ht:ref: 23-3-10-1 --></a>) into the Poisson equation (<a 
href="#x8-42005r192">192<!--tex4ht:ref: 19-1-12-e4 --></a>), we get
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-45001r198"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation209x.png" alt="             ‚à´
‚àí ùúÄ‚àá2 Œ¥Œ¶ ‚àí q   -qi-(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü© )‚àÇFi0dv +n  q2e(Œ¥Œ¶-‚àí-‚ü®Œ¥Œ¶-‚ü©) = qŒ¥n‚Ä≤
   0 ‚ä•      i  mi          Œ±  ‚àÇùúÄ       0e     Te         i i
" class="math-display"  /></center></td><td class="equation-label">(198)</td></tr></table>
                                                                                

                                                                                
<!--l. 2555--><p class="nopar" >
When solving the Poisson equation, the equation is Fourier expanded in toroidal harmonics and each
harmonic is independent of each other, so that they can be solved independently. For <span 
class="cmmi-10">n</span><span 
class="cmmi-10">‚â†</span>0 harmonics,
the <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥</span>Œ¶<span 
class="cmsy-10">‚ü© </span>terms is zero and thus it is trivial to treat the electron term. Only for the <span 
class="cmmi-10">n </span>= 0 harmonic, the
<span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥</span>Œ¶<span 
class="cmsy-10">‚ü© </span>term is nonzero and needs special treatment. I use the following method to obtain <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥</span>Œ¶<span 
class="cmsy-10">‚ü©</span>. First
slove the <span 
class="cmmi-10">n </span>= 0 harmonic of the following equation
</p>
   <table 
class="equation"><tr><td><a 
 id="x8-45002r199"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation210x.png" alt="             ‚à´
‚àí ùúÄ ‚àá2 Œ¥Œ¶‚Ä≤ ‚àí q -qi(Œ¥Œ¶ ‚Ä≤ ‚àí ‚ü®Œ¥Œ¶ ‚Ä≤‚ü© )‚àÇFi0dv = qŒ¥n‚Ä≤,
  0  ‚ä•      i  mi           Œ±  ‚àÇùúÄ       i i
" class="math-display"  /></center></td><td class="equation-label">(199)</td></tr></table>
<!--l. 2570--><p class="nopar" >
(i.e., Eq. (<a 
href="#x8-45001r198">198<!--tex4ht:ref: 23-2-13-3 --></a>) with electron term dropped), and then take the magnetic surface average of the solution
<span 
class="cmmi-10">Œ¥</span>Œ¶<span 
class="cmsy-10">‚Ä≤ </span>to get <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥</span>Œ¶<span 
class="cmsy-10">‚Ä≤‚ü©</span>. It can be proved that <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥</span>Œ¶<span 
class="cmsy-10">‚Ä≤‚ü© </span>is equal to <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥</span>Œ¶<span 
class="cmsy-10">‚ü©</span>. Then solving Eq. (<a 
href="#x8-45001r198">198<!--tex4ht:ref: 23-2-13-3 --></a>) becomes easier
since <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥</span>Œ¶<span 
class="cmsy-10">‚ü© </span>term can be moved to the right-hand side and be treated as a known source
term.
                                                                                

                                                                                
</p>
   <!--l. 2578--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse8.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse6.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse6.html#tailnonlinear_gyrokinetic_equationse6.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse7.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse7.html" >up</a>] </p></div>
<!--l. 2578--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationse7.html"></a>  </p> 
</body></html> 
