<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Poloarition density expression using Œ¥Œ¶ at gridpoints </title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 2822--><div class="crosslinks"><p class="noindent"><span 
class="ecrm-1000">[</span><a 
href="nonlinear_gyrokinetic_equationse8.html" ><span 
class="ecrm-1000">next</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationse6.html" ><span 
class="ecrm-1000">prev</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationse6.html#tailnonlinear_gyrokinetic_equationse6.html" ><span 
class="ecrm-1000">prev-tail</span></a><span 
class="ecrm-1000">] [</span><a 
href="#tailnonlinear_gyrokinetic_equationse7.html"><span 
class="ecrm-1000">tail</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse7.html" ><span 
class="ecrm-1000">up</span></a><span 
class="ecrm-1000">] </span></p></div>
   <h3 class="sectionHead"><span class="titlemark"><span 
class="ecrm-1000">A   </span></span> <a 
 id="x32-52000A"></a><span 
class="ecrm-1000">Poloarition density expression using </span><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="ecrm-1000">at gridpoints </span></h3>
<!--l. 2824--><p class="noindent" ><span 
class="ecrm-1000">In Sec. </span><a 
href="nonlinear_gyrokinetic_equationsu23.html#x29-410005.7"><span 
class="ecrm-1000">5.7</span><!--tex4ht:ref: 21-8-22-a3 --></a><span 
class="ecrm-1000">, when evaluating the polarization density, the potential </span><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="ecrm-1000">is Fourier expanded in space and</span>
<span 
class="ecrm-1000">then the double gyro-angle integration of each harmonic is expressed as the Bessel function. Are these</span>
<span 
class="ecrm-1000">formulas scaring to beginners? Does this make gyrokinetic theory less accessible to general readers? I</span>
<span 
class="ecrm-1000">think so.</span>
</p><!--l. 2830--><p class="indent" >   <span 
class="ecrm-1000">In this section, we avoid using the Fourier expansion at the Ô¨Årst place, and directly express the</span>
<span 
class="ecrm-1000">double gyro-angle integral as linear combination of values of </span><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="ecrm-1000">at spatial gridpoints.</span>
</p><!--l. 2834--><p class="indent" >   <span 
class="ecrm-1000">The integral we try to evaluate is given by</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x32-52001r239"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation261x.png" alt="        ‚à´  q        ‚àÇFi0
A (x) = ‚àí   m-‚ü®Œ¥Œ¶(x)‚ü©Œ±-‚àÇùúÄ-dv,
" class="math-display"  /></center></td><td class="equation-label">(239)</td></tr></table>
<!--l. 2838--><p class="nopar" >
<span 
class="ecrm-1000">Using </span><span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">dŒ± </span><span 
class="ecrm-1000">and the deÔ¨Ånition of gyro-averaging, the above integral is written</span>
<span 
class="ecrm-1000">as</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x32-52002r240"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation262x.png" alt="         q ‚à´ ‚àû    ‚à´ ‚àû    ‚àÇF     ‚à´ 2œÄ   ( 1 ‚à´ 2œÄ       )
A (x) = ‚àí--    dv‚à•    dv‚ä•---i0v‚ä•     dŒ±  ---   Œ¥Œ¶ (x )dŒ±
         m  ‚àí‚àû     0      ‚àÇùúÄ     0      2œÄ 0
" class="math-display"  /></center></td><td class="equation-label">(240)</td></tr></table>
                                                                                

                                                                                
<!--l. 2846--><p class="nopar" >
<span 
class="ecrm-1000">Note that the gyro-averaging is performed in the guiding-center space and is performed by keeping the</span>
<span 
class="ecrm-1000">value of the guiding-center variable </span><span 
class="cmbx-10">X </span><span 
class="ecrm-1000">constant. So we need to transform </span><span 
class="cmbx-10">x </span><span 
class="ecrm-1000">to </span><span 
class="cmbx-10">X</span><span 
class="ecrm-1000">. Using the relation</span>
<span 
class="ecrm-1000">between particle location and guiding-center location</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x32-52003r241"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation263x.png" alt="                        e‚à•(X-)-
x = X + œÅ(x,v ) ‚âà X ‚àí v√ó Œ©(X ),
" class="math-display"  /></center></td><td class="equation-label">(241)</td></tr></table>
<!--l. 2855--><p class="nopar" >
<span 
class="cmmi-10">A</span>(<span 
class="cmbx-10">x</span>) <span 
class="ecrm-1000">is written as</span> </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation264x.png" alt="          ‚à´       ‚à´            ‚à´      [   ‚à´     (             )   ]
        -q  ‚àû       ‚àû    ‚àÇFi0    2œÄ    1-- 2œÄ            e‚à•(X)-
A(x) = ‚àí m ‚àí ‚àû dv‚à•  0  dv‚ä•  ‚àÇùúÄ v‚ä• 0  dŒ±  2œÄ  0  Œ¥Œ¶  X  ‚àí v √ó Œ© (X) dŒ±
          ‚à´       ‚à´            ‚à´      ‚åä   N     (               )‚åã
    = ‚àí -q  ‚àû  dv   ‚àû dv  ‚àÇFi0v   2œÄdŒ± ‚åà-1-‚àë 2Œ¥Œ¶  X ‚àí v   √ó e‚à•(X-)-‚åâ   (242)
        m  ‚àí ‚àû  ‚à•  0   ‚ä•  ‚àÇùúÄ  ‚ä• 0      N2 j=1         ‚ä•j   Œ©(X )
" class="math-display"  /></center>
</div><span 
class="ecrm-1000">where the summation is over the gyro-angle of </span><span 
class="cmbx-10">v</span><span 
class="ecrm-1000">, and </span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmmi-7">j</span></sub> = <span 
class="cmbx-10">v</span>(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">j</span></sub>) <span 
class="ecrm-1000">denotes a perpendicular velocity</span>
<span 
class="ecrm-1000">corresponding to a discrete gyro-angle.</span>
<!--l. 2875--><p class="indent" >   <span 
class="ecrm-1000">Next, in order to perform the remaining velocity space integration, transform back to the particle</span>
<span 
class="ecrm-1000">coordinates (because the velocity integration is performed in the particle coordinaes and is performed</span>
<span 
class="ecrm-1000">by keeping the particle coordinate </span><span 
class="cmbx-10">x </span><span 
class="ecrm-1000">constant):</span> </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation265x.png" alt="                                      ‚åä                                     ‚åã
        q ‚à´ ‚àû     ‚à´ ‚àû    ‚àÇFi0  ‚à´ 2œÄ     1 N‚àë2    (       e‚à•(X )        e‚à•(X ))
A(x) = ‚àí m     dv‚à•    dv‚ä• -‚àÇùúÄ-v‚ä•    dŒ± ‚åàN--   Œ¥Œ¶  x +v √ó Œ©-(X)-‚àí v‚ä•j √ó Œ©(X-)-‚åâ
           ‚àí ‚àû     0            0        2j=1
          ‚à´ ‚àû     ‚à´ ‚àû          ‚à´ 2œÄ   ‚åä   N‚àë2    (                         )‚åã
    ‚âà ‚àí q-     dv‚à•    dv‚ä• ‚àÇFi0v‚ä•    dŒ± ‚åà-1-   Œ¥Œ¶  x +v √ó e‚à•(x)‚àí v‚ä•j √ó e‚à•(x) ‚åâ
        m  ‚àí ‚àû     0      ‚àÇùúÄ    0      N2 j=1           Œ© (x)        Œ© (x )
        q ‚à´ ‚àû     ‚à´ ‚àû    ‚àÇF
    = ‚àí --     dv‚à•    dv‚ä• --i0v‚ä•
        m  ‚àí ‚àû     0      ‚àÇùúÄ
       2œÄ-N‚àë1 -1-N‚àë2   (                e‚à•(x)-             e‚à•(x))
    √ó  N1    N2    Œ¥Œ¶  x+ v‚ä• (v‚ä•,Œ±i) √ó Œ©(x) ‚àí v‚ä•(v‚ä•,Œ±j)√ó Œ© (x)  .          (243)
          i=1    j=1
" class="math-display"  /><a 
 id="x32-52005r243"></a></center>
</div><span 
class="ecrm-1000">For notation ease, deÔ¨Åne</span>
   <table 
class="equation"><tr><td><a 
 id="x32-52006r244"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation266x.png" alt="Œî œÅij(x,v‚ä•,Œ±i,Œ±j) = v‚ä•(v‚ä•,Œ±i)√ó e‚à•(x)‚àí v‚ä• (v‚ä•, Œ±j)√ó e‚à•(x-),
                             Œ© (x)              Œ© (x)
" class="math-display"  /></center></td><td class="equation-label">(244)</td></tr></table>
<!--l. 2911--><p class="nopar" >
<span 
class="ecrm-1000">where </span><span 
class="cmmi-10">ŒîœÅ</span><sub><span 
class="cmmi-7">ij</span></sub> <span 
class="ecrm-1000">is a function of </span>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">j</span></sub>)<span 
class="ecrm-1000">. Then Eq. (</span><a 
href="#x32-52005r243"><span 
class="ecrm-1000">243</span><!--tex4ht:ref: 21-9-16-a4 --></a><span 
class="ecrm-1000">) is written as</span> </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation267x.png" alt="          ‚à´       ‚à´
        -q  ‚àû       ‚àû    ‚àÇFi0  -2œÄ‚àëN1 1--N‚àë2
A(x) = ‚àím   ‚àí‚àû dv‚à• 0  dv‚ä• ‚àÇùúÄ v‚ä•N1     N2    Œ¥Œ¶(x+ Œî œÅij).       (245)
                                   i=1    j=1
" class="math-display"  /></center>
</div><span 
class="ecrm-1000">The guiding-center transform and the inverse one involved in the above is illustrated in Fig. </span><a 
href="#x32-520082"><span 
class="ecrm-1000">2</span><!--tex4ht:ref: 21-8-22-a1 --></a><span 
class="ecrm-1000">, which</span>
<span 
class="ecrm-1000">also shows how to evaluate the double gyro-angle integration using the discrete values of</span>
<span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">ij</span></sub><span 
class="ecrm-1000">.</span>
<!--l. 2925--><p class="indent" >   <span 
class="ecrm-1000">¬†</span>
</p>
                                                                                

                                                                                
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x32-520082"></a>
                                                                                

                                                                                
<!--l. 2928--><p class="noindent" > <img 
src="nonlinear_gyrokinetic_equation-1-.png" alt="PIC"  
width="237" height="230"  />
<br /> </p><div class="caption" 
><span class="id">Fig. 2:  </span><span  
class="content">Given  a  <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>,  then  the  double  gyro-angle  integration  (<a 
href="#x32-52002r240">240<!--tex4ht:ref: 21-8-22-e1 --></a>)  at  a  particle  location  <span 
class="cmbx-10">x</span>
is  evaluated  by  the  following  steps:  Use  the  guiding  center  transform  to  get  guiding-center
locations (four locations are shown in this case, namely <span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">i</span></sub> with <span 
class="cmmi-10">i </span>= 1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span>3<span 
class="cmmi-10">,</span>4, corresponding
gyro-angle  <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">i</span></sub>  with  <span 
class="cmmi-10">i  </span>=   1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span>3<span 
class="cmmi-10">,</span>4;  2.)  For  each  guiding-center  location,  use  the  inverse
guiding-center  transform  to  calculate  points  on  the  corresponding  gyro-ring  (four  points
are  shown  for  each  guiding-center  <span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">i</span></sub>  in  this  case,  namely  <span 
class="cmbx-10">x</span><sub><span 
class="cmmi-7">ij</span></sub>  with  <span 
class="cmmi-10">j   </span>=   1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span>3<span 
class="cmmi-10">,</span>4,
corresponding  gyro  angle  <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub>  with  <span 
class="cmmi-10">j  </span>=   1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span>3<span 
class="cmmi-10">,</span>4.)  Then  the  double  gyro-angle  integral
appearing  in  the  polarization  density,  namely  <span 
class="cmex-10">‚à´</span>
  <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmr-7">2</span><span 
class="cmmi-7">œÄ</span></sup><span 
class="cmmi-10">dŒ±</span><img 
src="nonlinear_gyrokinetic_equation268x.png" alt="(‚à´2œÄ       )
  0 Œ¥Œ¶(x)dŒ±"  class="left" align="middle" />,  is  approximated  as
<span 
class="cmex-10">‚à´</span>
  <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmr-7">2</span><span 
class="cmmi-7">œÄ</span></sup><span 
class="cmmi-10">dŒ±</span><img 
src="nonlinear_gyrokinetic_equation269x.png" alt="(‚à´          )
  02œÄŒ¥Œ¶(x)dŒ±"  class="left" align="middle" /> <span 
class="cmsy-10">‚âà</span> <img 
src="nonlinear_gyrokinetic_equation270x.png" alt="   2
(N21œÄN)2"  class="frac" align="middle" /> <span 
class="cmex-10">‚àë</span>
      <sub><span 
class="cmmi-7">i</span><span 
class="cmr-7">=1</span></sub><sup><span 
class="cmmi-7">N</span><sub><span 
class="cmr-5">1</span></sub></sup> <span 
class="cmex-10">‚àë</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">=1</span></sub><sup><span 
class="cmmi-7">N</span><sub><span 
class="cmr-5">2</span></sub></sup><span 
class="cmmi-10">Œ¥Œ¶</span>(<span 
class="cmbx-10">x</span><sub><span 
class="cmmi-7">ij</span></sub>)<span 
class="cmmi-10">, </span>where <span 
class="cmmi-10">N</span><sub><span 
class="cmr-7">1</span></sub> = 4<span 
class="cmmi-10">,N</span><sub><span 
class="cmr-7">2</span></sub> = 4 for the case
shown here.</span></div><!--tex4ht:label?: x32-520082 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 2948--><p class="indent" >   <span 
class="ecrm-1000">The spatial points </span><span 
class="cmbx-10">x</span><sub><span 
class="cmmi-7">ij</span></sub> <span 
class="ecrm-1000">appearing in Eq. (</span><a 
href="#x32-520082"><span 
class="ecrm-1000">2</span><!--tex4ht:ref: 21-9-2-a1 --></a><span 
class="ecrm-1000">) are not necessarily grid points. Linear interpolations are</span>
<span 
class="ecrm-1000">used to express </span><span 
class="cmmi-10">Œ¥Œ¶</span>(<span 
class="cmbx-10">x</span><sub><span 
class="cmmi-7">ij</span></sub>) <span 
class="ecrm-1000">as linear combination of values of </span><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="ecrm-1000">on gridpoints.</span>
</p><!--l. 2953--><p class="indent" >   <span 
class="ecrm-1000">¬†</span>
</p>
   <div class="subsectionTOCS">
   <span 
class="ecrm-1000">¬†</span><span 
class="ecrm-1000">¬†</span><span class="subsectionToc" ><span 
class="ecrm-1000">A.1 </span><a 
href="nonlinear_gyrokinetic_equationsu25.html#x33-53000A.1"><span 
class="ecrm-1000">Performing the parallel velocity integration</span></a></span>
<br />   <span 
class="ecrm-1000">¬†</span><span 
class="ecrm-1000">¬†</span><span class="subsectionToc" ><span 
class="ecrm-1000">A.2 </span><a 
href="nonlinear_gyrokinetic_equationsu26.html#x34-54000A.2"><span 
class="ecrm-1000">Toroidal Fourier transform of polarization density in Ô¨Åeld-aligned coordinates</span></a></span>
   </div>

                                                                                

                                                                                
   <!--l. 3034--><div class="crosslinks"><p class="noindent"><span 
class="ecrm-1000">[</span><a 
href="nonlinear_gyrokinetic_equationse8.html" ><span 
class="ecrm-1000">next</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationse6.html" ><span 
class="ecrm-1000">prev</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationse6.html#tailnonlinear_gyrokinetic_equationse6.html" ><span 
class="ecrm-1000">prev-tail</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equationse7.html" ><span 
class="ecrm-1000">front</span></a><span 
class="ecrm-1000">] [</span><a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse7.html" ><span 
class="ecrm-1000">up</span></a><span 
class="ecrm-1000">] </span></p></div>
<!--l. 3034--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationse7.html"></a> </p> 
</body></html> 
