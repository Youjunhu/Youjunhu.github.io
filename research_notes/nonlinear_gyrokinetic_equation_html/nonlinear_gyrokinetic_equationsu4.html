<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Choosing velocity coordinates</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 255--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu5.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationsu3.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationsu3.html#tailnonlinear_gyrokinetic_equationsu3.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationsu4.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse2.html#nonlinear_gyrokinetic_equationsu4.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x7-60002.2"></a>Choosing velocity coordinates</h4>
<!--l. 257--><p class="noindent" >The guiding-center transformations (<a 
href="nonlinear_gyrokinetic_equationsu3.html#x6-5001r8">8<!--tex4ht:ref: 16-9-21-1 --></a>) and (<a 
href="nonlinear_gyrokinetic_equationsu3.html#x6-5003r10">10<!--tex4ht:ref: 19-1-19-p2 --></a>) involve the particle velocity <span 
class="cmbx-10">v</span>. It is the cross product
between <span 
class="cmbx-10">v </span>and <span 
class="cmmib-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">x</span>) or <span 
class="cmmib-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">X</span>) that is actually used. Therefore, only the perpendicular velocity (which
is deÔ¨Åned by <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>) enters the transform. A natural choice of coordinates for the
perpendicular velocity is (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span>), where <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmsy-10">|</span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">| </span>and <span 
class="cmmi-10">Œ± </span>is the azimuthal angle of the perpendicular
velocity in the local perpendicular plane.
</p><!--l. 268--><p class="indent" >   The parallel direction is fully determined by <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>), but there are degrees of freedom in choosing one
of the two perpendicular basis vectors. In order to make the azimuthal angle <span 
class="cmmi-10">Œ± </span>fully deÔ¨Åned, we need to
choose a way to deÔ¨Åne one of the two perpendicular directions. In GEM simulations, one of the
perpendicular direction is chosen as the direction perpendicular to the magnetic surface, which is fully
determined at each spatial point. (We need to deÔ¨Åne the perpendicular direction at each spatial
location to make <span 
class="cmmi-10">‚àÇŒ±‚àï‚àÇ</span><span 
class="cmbx-10">x</span><span 
class="cmsy-10">|</span><sub><span 
class="cmbx-7">v</span></sub> deÔ¨Åned, which is needed in the Vlasov diÔ¨Äerential operators. However, it
seems that terms related to <span 
class="cmmi-10">‚àÇŒ±‚àï‚àÇ</span><span 
class="cmbx-10">x</span><span 
class="cmsy-10">|</span><sub><span 
class="cmbx-7">v</span></sub> are Ô¨Ånally dropped due to that they are of higher
order**check.)
</p><!--l. 281--><p class="indent" >   In the following, <span 
class="cmmi-10">Œ± </span>will be called the ‚Äúgyro-angle‚Äù . [Note that, in the guiding-center
coordinates (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span>), <span 
class="cmmi-10">Œ± </span>is a velocity coordinate rather than a spatial coordinate. When
transformed back to particle coordinates, <span 
class="cmmi-10">Œ± </span>is both a velocity coordinate and a spatial coordinate.
Consider a series of points in terms of guiding-center coordinates (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span>) with (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>)
Ô¨Åxed but with <span 
class="cmmi-10">Œ± </span>changing. Using the inverse guiding-center transform (<a 
href="nonlinear_gyrokinetic_equationsu3.html#x6-5003r10">10<!--tex4ht:ref: 19-1-19-p2 --></a>), we know that
the above points form a gyro-ring in space, i.e., <span 
class="cmmi-10">Œ± </span>inÔ¨Çuences both particle velocity and
location.]
</p><!--l. 292--><p class="indent" >   The gyro-angle is an important variable we will stick to because we need to directly perform
averaging over this variable (with <span 
class="cmbx-10">X </span>Ô¨Åxed) in deriving the gyrokinetic equation. We have more than one
choice for the remaining velocity coordinates , such as ¬†(<span 
class="cmmi-10">v,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>), or (<span 
class="cmmi-10">v,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>), or (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>). In
Frieman-Chen‚Äôs paper, the velocity coordinates other than <span 
class="cmmi-10">Œ± </span>are chosen to be (<span 
class="cmmi-10">ùúÄ,Œº</span>) deÔ¨Åned
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x7-6001r11"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation13x.png" alt="            v2  qŒ¶  (x)
ùúÄ = ùúÄ(v,x) ‚â° --+ ---0--,
            2     m
" class="math-display"  /></center></td><td class="equation-label">(11)</td></tr></table>
<!--l. 302--><p class="nopar" >
and
                                                                                

                                                                                
</p>
   <table 
class="equation"><tr><td><a 
 id="x7-6002r12"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation14x.png" alt="             --v2‚ä•--
Œº = Œº(v‚ä•,x) ‚â° 2B0(x),
" class="math-display"  /></center></td><td class="equation-label">(12)</td></tr></table>
<!--l. 307--><p class="nopar" >
where <span 
class="cmmi-10">Œ¶</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) is the equilibrium (macroscopic) electrical potential.
</p><!--l. 311--><p class="indent" >   Note that (<span 
class="cmmi-10">ùúÄ,Œº,Œ±</span>) is not suÔ¨Écient in uniquely determining a velocity vector. An additional
parameter <span 
class="cmmi-10">œÉ </span>= sign(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) is needed to determine the sign of <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>. In the following, the dependence
of the distribution function on <span 
class="cmmi-10">œÉ </span>is often not explicitly shown in the variable list (i.e., <span 
class="cmmi-10">œÉ </span>is
hidden/suppressed), which, however, does not mean that the distribution function is independent of
<span 
class="cmmi-10">œÉ</span>.
</p><!--l. 319--><p class="indent" >   Another frequently used velocity coordinates are (<span 
class="cmmi-10">Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>). In the following, I will derive
the gyrokinetic equation in (<span 
class="cmmi-10">ùúÄ,Œº,Œ±</span>) coordinates. After that, I transform it to (<span 
class="cmmi-10">Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>)
coordinates.
</p><!--l. 324--><p class="indent" >   One important thing to note about the above velocity coordinates is that they are deÔ¨Åned relative
to the local magnetic Ô¨Åeld. If the Ô¨Åeld itself is spatially varying (such as in tokamaks), the above
velocity coordinates are also spatially varying for a Ô¨Åxed velocity <span 
class="cmbx-10">v</span>. SpeciÔ¨Åcally, the following
derivatives are nonzero:
</p>
   <table 
class="equation"><tr><td><a 
 id="x7-6003r13"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation15x.png" alt="‚àÇŒ±-  ‚àÇv‚ä•-  ‚àÇv‚à•   ‚àÇŒº-
‚àÇx|v, ‚àÇx |v, ‚àÇx |v,‚àÇx |v.
" class="math-display"  /></center></td><td class="equation-label">(13)</td></tr></table>
<!--l. 335--><p class="nopar" >
                                                                                

                                                                                
</p>
   <!--l. 337--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu5.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationsu3.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationsu3.html#tailnonlinear_gyrokinetic_equationsu3.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationsu4.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equationse2.html#nonlinear_gyrokinetic_equationsu4.html" >up</a>] </p></div>
<!--l. 337--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationsu4.html"></a> </p> 
</body></html> 
