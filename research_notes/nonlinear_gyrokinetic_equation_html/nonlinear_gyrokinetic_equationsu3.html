<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Guiding-center transformation</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 197--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu4.html" >next</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationsu3.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse2.html#nonlinear_gyrokinetic_equationsu3.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x6-50002.1"></a>Guiding-center transformation</h4>
<!--l. 199--><p class="noindent" >In a magnetic ﬁeld, given a particle location and velocity (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), we know how to calculate its
guiding-center location <span 
class="cmbx-10">X</span>, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-5001r8"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation10x.png" alt="                e (x)
X (x,v) = x+ v × -∥---,
                Ω (x )
" class="math-display"  /></center></td><td class="equation-label">(8)</td></tr></table>
<!--l. 205--><p class="nopar" >
where <span 
class="cmmib-10">e</span><sub><span 
class="cmsy-7">∥</span></sub> = <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">∕B</span><sub><span 
class="cmr-7">0</span></sub>, <span 
class="cmmi-10">Ω </span>= <span 
class="cmmi-10">qB</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">∕m</span>, <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) is the equilibrium (macroscopic) magnetic ﬁeld at the
particle position. We will consider Eq. (<a 
href="#x6-5001r8">8<!--tex4ht:ref: 16-9-21-1 --></a>) as a transform and call it guiding-center transform<span class="cite">[<a 
href="nonlinear_gyrokinetic_equationli1.html#XCatto1978">1</a>]</span>. Note
that the transform (<a 
href="#x6-5001r8">8<!--tex4ht:ref: 16-9-21-1 --></a>) involves both position and velocity of particles.
                                                                                

                                                                                
</p><!--l. 213--><p class="indent" >   For later use, deﬁne <span 
class="cmmib-10">ρ</span> <span 
class="cmsy-10">≡−</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">× </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">∕Ω</span>, which is the vector gyro-radius pointing from the the
guiding-center to the particle position.
</p><!--l. 217--><p class="indent" >   Given (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), it is straightforward to obtain <span 
class="cmbx-10">X </span>by using Eq. (<a 
href="#x6-5001r8">8<!--tex4ht:ref: 16-9-21-1 --></a>). On the other hand, the inverse
transform, i.e., given (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), to ﬁnd <span 
class="cmbx-10">x</span>, which is in principle not easy because <span 
class="cmmi-10">Ω </span>and <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub> depend on <span 
class="cmbx-10">x</span>,
which usually requires solving for the root of a nonlinear equation. Numerically, one can
use
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-5002r9"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation11x.png" alt="xn+1 = X − v×  e∥(xn),
               Ω(xn)
" class="math-display"  /></center></td><td class="equation-label">(9)</td></tr></table>
<!--l. 226--><p class="nopar" >
as an iteration scheme to compute <span 
class="cmbx-10">x</span>, with the initial guess chosen as <span 
class="cmbx-10">x</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmbx-10">X</span>. The equilibrium
magnetic ﬁeld we will consider has spatial scale length much larger than the thermal gyro
radius <span 
class="cmmib-10">ρ</span>. In this case the diﬀerence between the values of <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub>(<span 
class="cmbx-10">x</span>)<span 
class="cmmi-10">∕Ω</span>(<span 
class="cmbx-10">x</span>) and <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub>(<span 
class="cmbx-10">X</span>)<span 
class="cmmi-10">∕Ω</span>(<span 
class="cmbx-10">X</span>) is
small and thus can be neglected. Then the inverse guiding-center transform can be written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-5003r10"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation12x.png" alt="           e (X )
x ≈ X − v× -∥----,
            Ω(X )
" class="math-display"  /></center></td><td class="equation-label">(10)</td></tr></table>
<!--l. 237--><p class="nopar" >
which can also be considered as using the iterative scheme (<a 
href="#x6-5002r9">9<!--tex4ht:ref: 18-9-13-p1 --></a>) to computer <span 
class="cmbx-10">x </span>with initial guess of <span 
class="cmbx-10">x</span>
being <span 
class="cmbx-10">X </span>and stopping at the ﬁrst iteration. [The diﬀerence between equilibrium ﬁeld values evaluated
at <span 
class="cmbx-10">X </span>and <span 
class="cmbx-10">x </span>is always neglected in gyrokinetic theory. Therefore it does not matter whether the above
<span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">∕Ω </span>is evaluated at <span 
class="cmbx-10">x </span>or <span 
class="cmbx-10">X</span>. What matters is where the perturbed ﬁelds are evaluated:
at <span 
class="cmbx-10">x </span>or at <span 
class="cmbx-10">X</span>. The values of perturbed ﬁelds at <span 
class="cmbx-10">x </span>or at <span 
class="cmbx-10">X </span>are diﬀerent and this is called
the ﬁnite Larmor radius (FLR) eﬀect, which is almost all that the gyrokinetic theory is
about.]
                                                                                

                                                                                
</p><!--l. 250--><p class="indent" >   The inverse guiding-center transformation (<a 
href="#x6-5003r10">10<!--tex4ht:ref: 19-1-19-p2 --></a>) needs to be performed numerically in gyrokinetic
PIC simulations when we deposit markers to grids or when we calculate the gyro-averaged ﬁeld to be
used in pushing guiding-centers.
                                                                                

                                                                                
</p>
   <!--l. 255--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu4.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationsu3.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equationse2.html#nonlinear_gyrokinetic_equationsu3.html" >up</a>] </p></div>
<!--l. 255--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationsu3.html"></a> </p> 
</body></html> 
