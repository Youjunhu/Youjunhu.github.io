<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Gyrokinetic equation in forms amenable to numerical computation</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 1615--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse5.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse3.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse3.html#tailnonlinear_gyrokinetic_equationse3.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationse4.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse4.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x5-300004"></a>Gyrokinetic equation in forms amenable to numerical computation</h3>
<!--l. 1618--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x5-310004.1"></a>Eliminate <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´Ï•</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>term on the right-hand side of Eq. (136)</h4>
<!--l. 1620--><p class="noindent" >Note that the coeï¬ƒcient before <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚ğœ€</span> in Eq. (<a 
href="nonlinear_gyrokinetic_equationse3.html#x4-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) involves the time derivative of <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´Ï•</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>, which is
problematic if treated by using explicit ï¬nite diï¬€erence in particle simulations (I test the algorithm that
treats this term by implicit scheme, the result roughly agrees with the standard method discussed in
Sec. <a 
href="nonlinear_gyrokinetic_equationse6.html#x7-380006">6<!--tex4ht:ref: 19-1-4-1 --></a>). It turns out that <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>can be eliminated by deï¬ning another gyro-phase independent
function <span 
class="cmmi-10">Î´f </span>by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-31001r139"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation147x.png" alt="     q-     âˆ‚F0-
Î´f = m âŸ¨Î´Î¦ âŸ©Î± âˆ‚ğœ€  +Î´G0.
" class="math-display"  /></center></td><td class="equation-label">(139)</td></tr></table>
<!--l. 1631--><p class="nopar" >
Substituting this into Eq. (<a 
href="nonlinear_gyrokinetic_equationse3.html#x4-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>), we obtain the equation for <span 
class="cmmi-10">Î´f</span>: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation148x.png" alt="[                          ]
 -âˆ‚ + (ve  + V  + Î´V  )â‹…âˆ‡   Î´f
 âˆ‚t    âˆ¥ âˆ¥    D      D    X
  q-âˆ‚F0-[ âˆ‚                        ]
âˆ’ m  âˆ‚ğœ€  âˆ‚t + (vâˆ¥eâˆ¥ + VD + Î´VD ) â‹…âˆ‡X âŸ¨Î´Î¦âŸ©Î±
  q      [ âˆ‚                        ] âˆ‚F
âˆ’ --âŸ¨Î´Î¦ âŸ©Î± -- + (vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X  ---0
  m       âˆ‚t                          âˆ‚ğœ€
= âˆ’ Î´VD â‹…âˆ‡XF0  âˆ’ q-âˆ‚âŸ¨Î´LâŸ©Î±âˆ‚F0-.                        (140)
                 m   âˆ‚t   âˆ‚ğœ€
" class="math-display"  /></center>
</div>Noting that <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚ğœ€ </span><span 
class="cmsy-10">â‰ˆâˆ’</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">mâˆ•T</span>, we ï¬nd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">3</span></sup>) (after both sides being divided by <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>Î©). Therefore the third line can be
dropped. Moving the second line to the right-hand side and noting that <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´L</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub> = <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´Ï• </span><span 
class="cmsy-10">âˆ’ </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>, the
above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation149x.png" alt="[ âˆ‚                       ]
 --+ (vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X  Î´f
 âˆ‚t
= âˆ’ Î´[VD â‹…âˆ‡XF0                               ]
âˆ’-q âˆ’ âˆ‚âŸ¨v-â‹…Î´AâŸ©Î± âˆ’ (v e + VD  + Î´VD )â‹…âˆ‡X âŸ¨Î´Î¦ âŸ©Î± âˆ‚F0-,        (141)
 m        âˆ‚t       âˆ¥ âˆ¥                        âˆ‚ğœ€
" class="math-display"  /><a 
 id="x5-31003r141"></a></center>
</div>where two <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Ï•</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>terms cancel each other. Note that the right-hand side of Eq. (<a 
href="#x5-31003r141">141<!--tex4ht:ref: 17-5-13-p2 --></a>) contains a
nonlinear term <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> <span 
class="cmsy-10">â‹…âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>. This is diï¬€erent from the original Frieman-Chen equation, where all
nonlinear terms appear on the left-hand side. For the electrostatic limit, this term disappears because
<span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is perpendicular to <span 
class="cmsy-10">âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>.
<!--l. 1678--><p class="indent" >   [Equation (<a 
href="#x5-31003r141">141<!--tex4ht:ref: 17-5-13-p2 --></a>) corresponds to Eq. (A8) in Yang Chenâ€™s paper<span class="cite">[<a 
href="nonlinear_gyrokinetic_equationli1.html#Xychen2009">2</a>]</span> (where the ï¬rst minus on the
right-hand side is wrong and should be replaced with <span 
class="cmmi-10">qâˆ•m</span>; one <span 
class="cmmi-10">q </span>is missing before <span 
class="cmmi-10">âˆ‚</span>(<span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span>)<span 
class="cmmi-10">âˆ•âˆ‚t </span>in
A9).]
</p><!--l. 1683--><p class="indent" >   Â 
</p><!--l. 1687--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2   </span> <a 
 id="x5-320004.2"></a>Eliminate <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>term on the right-hand side of GK equation</h4>
<!--l. 1689--><p class="noindent" >Similar to the method of eliminating <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´Ï•</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t</span>, we deï¬ne another gyro-phase independent function
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-32001r142"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation150x.png" alt="          q        âˆ‚F
Î´h = Î´f âˆ’--âŸ¨v â‹…Î´A âŸ©Î±--0-.
         m          âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(142)</td></tr></table>
<!--l. 1696--><p class="nopar" >
Most gyrokinetic simulations approximate the vector potential as <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A </span><span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>. Let us simplify Eq.
(<a 
href="#x5-32006r147">147<!--tex4ht:ref: 19-1-4-e1 --></a>) for this case. Then <span 
class="cmsy-10">âŸ¨</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-32002r143"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation151x.png" alt="âŸ¨v â‹…Î´AâŸ©Î± â‰ˆ âŸ¨vâˆ¥Î´A âˆ¥âŸ©Î±.
" class="math-display"  /></center></td><td class="equation-label">(143)</td></tr></table>
<!--l. 1705--><p class="nopar" >
Then expression (<a 
href="#x5-32001r142">142<!--tex4ht:ref: 23-11-15-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-32003r144"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation152x.png" alt="         -q        âˆ‚F0-
Î´h = Î´f âˆ’ m âŸ¨vâˆ¥Î´Aâˆ¥âŸ©Î± âˆ‚ğœ€ .
" class="math-display"  /></center></td><td class="equation-label">(144)</td></tr></table>
<!--l. 1710--><p class="nopar" >
Then Eq. (<a 
href="#x5-31003r141">141<!--tex4ht:ref: 17-5-13-p2 --></a>) is written in terms of <span 
class="cmmi-10">Î´h </span>as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation153x.png" alt="[ âˆ‚                        ]
 âˆ‚t + (vâˆ¥eâˆ¥ + VD +Î´VD ) â‹…âˆ‡X Î´h
       [(                     )    ]
+-q âˆ‚F0-  âˆ‚-+ vâˆ¥eâˆ¥ + VD + Î´VD   â‹…âˆ‡X   âŸ¨vâˆ¥Î´A âˆ¥âŸ©Î±
 m  âˆ‚ğœ€    âˆ‚t                (    )
 -q                          âˆ‚F0-
+m âŸ¨vâˆ¥Î´Aâˆ¥âŸ©Î±[(VD  + Î´VD )â‹…âˆ‡X ]  âˆ‚ğœ€
= âˆ’ Î´VD â‹…âˆ‡XF0
  q [ âˆ‚ âŸ¨vâˆ¥Î´Aâˆ¥âŸ©Î±                             ] âˆ‚F
âˆ’--  âˆ’--------- âˆ’ (vâˆ¥eâˆ¥ +VD  + Î´VD )â‹…âˆ‡X âŸ¨Î´Î¦âŸ©Î± ---0,        (145)
 m        âˆ‚t                                  âˆ‚ğœ€
" class="math-display"  /></center>
</div>where use has been made of that <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>= 0 and <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0. Further noting that <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">âˆ¼ </span><span 
class="cmmi-10">Î´</span>Î¦,
<span 
class="cmmi-10">qÎ´</span>Î¦<span 
class="cmmi-10">âˆ•T </span><span 
class="cmsy-10">âˆ¼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">1</span></sup>), <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚ğœ€ </span><span 
class="cmsy-10">âˆ¼âˆ’</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">mâˆ•T</span>, and <span 
class="cmmi-10">Ï</span><span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">âˆ¼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we ï¬nd that the red term of the above
equation (after divided by Î©<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>) is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">3</span></sup>) and hence can be dropped. Move the second line to
the right-hand side, giving <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation154x.png" alt="[ âˆ‚                        ]
 âˆ‚t +(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X  Î´h
= âˆ’ Î´V  â‹…âˆ‡  F
      D   X  0
+ q-[(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X (âŸ¨Î´Î¦ âˆ’ vâˆ¥Î´A âˆ¥âŸ©Î±)]âˆ‚F0,           (146)
  m                                    âˆ‚ ğœ€
" class="math-display"  /><a 
 id="x5-32005r146"></a></center>
</div>where <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>terms cancel each other. Further note that <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> (given by Eq. (<a 
href="nonlinear_gyrokinetic_equationse3.html#x4-29003r138">138<!--tex4ht:ref: 19-1-3-1 --></a>)) is
perpendicular to <span 
class="cmsy-10">âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦ <span 
class="cmsy-10">âˆ’ </span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>. Therefore the blue term in Eq. (<a 
href="#x5-32005r146">146<!--tex4ht:ref: 19-1-3-e1 --></a>) is zero, then Eq. (<a 
href="#x5-32005r146">146<!--tex4ht:ref: 19-1-3-e1 --></a>)
simpliï¬es to <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation155x.png" alt="[                         ]
 âˆ‚-+ (v e + V  + Î´V  )â‹…âˆ‡    Î´h
 âˆ‚t    âˆ¥ âˆ¥    D     D    X
= âˆ’ Î´VD â‹…âˆ‡XF0
 -q                             âˆ‚F0-
+m [(vâˆ¥eâˆ¥ +VD ) â‹…âˆ‡X âŸ¨Î´Î¦ âˆ’ vâˆ¥Î´Aâˆ¥âŸ©Î±]âˆ‚ğœ€ .               (147)
" class="math-display"  /><a 
 id="x5-32006r147"></a></center>
</div>Note that in terms of (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ğœ€,Î¼,Î±,Ïƒ</span>) coordinates, <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> is written as
   <table 
class="equation"><tr><td><a 
 id="x5-32007r148"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation156x.png" alt="      âˆ˜ ---------
vâˆ¥ = Ïƒ  2ğœ€âˆ’ 2Î¼B0,
" class="math-display"  /></center></td><td class="equation-label">(148)</td></tr></table>
<!--l. 1768--><p class="nopar" >
where <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) = <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X </span>+ <span 
class="cmmib-10">Ï</span>) with <span 
class="cmmib-10">Ï</span> = <span 
class="cmmib-10">Ï</span>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ğœ€,Î¼,Î±</span>). Since the scale length of <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> is much larger than the
thermal Larmor radius, <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) <span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X</span>) and hence <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> can be approximated as a constant when
gyro-angle <span 
class="cmmi-10">Î± </span>changes. Then <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> can be taken out of the gyro-averaging in expression (<a 
href="#x5-32002r143">143<!--tex4ht:ref: 19-3-26-e1 --></a>),
yielding
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-32008r149"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation157x.png" alt="âŸ¨vâˆ¥Î´Aâˆ¥âŸ©Î± â‰ˆ vâˆ¥âŸ¨Î´A âˆ¥âŸ©Î±.
" class="math-display"  /></center></td><td class="equation-label">(149)</td></tr></table>
<!--l. 1779--><p class="nopar" >
Using this, the term related to <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> in (<a 
href="#x5-32006r147">147<!--tex4ht:ref: 19-1-4-e1 --></a>) can be further written as </p><div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation158x.png" alt="(vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X âŸ¨vâˆ¥Î´A âˆ¥âŸ©Î± =   (vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X (vâˆ¥âŸ¨Î´Aâˆ¥âŸ©Î±)
                        =   âŸ¨Î´A âˆ¥âŸ©Î±(vâˆ¥eâˆ¥ + VD ) â‹…âˆ‡X (vâˆ¥)+ vâˆ¥(vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X âŸ¨Î´Aâˆ¥(âŸ©1Î±5.0)
" class="math-display"  /></center>
</div>Using expression (<a 
href="#x5-32007r148">148<!--tex4ht:ref: 19-3-27-1 --></a>), (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> + <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub>) <span 
class="cmsy-10">â‹…âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub>(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation159x.png" alt="âŸ¨Î´A âŸ© (ve  + V  )â‹…âˆ‡  (v )  â‰ˆ  âŸ¨Î´A âŸ© (v e )â‹…âˆ‡  (v )
   âˆ¥ Î± âˆ¥ âˆ¥    D    X  âˆ¥         âˆ¥ Î±  âˆ¥ âˆ¥   X (âˆ¥âˆ˜ ---------)
                          =  âŸ¨Î´Aâˆ¥âŸ©Î±(vâˆ¥eâˆ¥)â‹…âˆ‡X  Ïƒ  2ğœ€âˆ’ 2Î¼B0
                                              (âˆ˜ ---------)
                          =  âŸ¨Î´Aâˆ¥âŸ©Î±Ïƒ(vâˆ¥eâˆ¥)â‹…âˆ‡X    2ğœ€âˆ’ 2Î¼B0
                                      âˆ’ 2Î¼eâˆ¥ â‹…âˆ‡XB0
                          =  âŸ¨Î´Aâˆ¥âŸ©Î±Ïƒvâˆ¥-2âˆš2ğœ€-âˆ’-2Î¼B---
                                                 0
                          =  âŸ¨Î´Aâˆ¥âŸ©Î±vâˆ¥âˆ’-2Î¼eâˆ¥ â‹…âˆ‡XB0-
                                          2vâˆ¥
                          =  âˆ’ âŸ¨Î´A âˆ¥âŸ©Î± Î¼eâˆ¥ â‹…âˆ‡XB0.                  (151)
" class="math-display"  /></center>
</div>(We can also obtain <span 
class="cmsy-10">âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub>(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>) = <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Î¼</span>(<span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>)<span 
class="cmmi-10">âˆ•v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> by using Eq. (<a 
href="nonlinear_gyrokinetic_equationse16.html#x17-74002r341">341<!--tex4ht:ref: 19-1-2-e1 --></a>)). Using the above results, equation
(<a 
href="#x5-32006r147">147<!--tex4ht:ref: 19-1-4-e1 --></a>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation160x.png" alt="[                          ]
 -âˆ‚ + (vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X  Î´h
 âˆ‚t
= âˆ’ Î´VD â‹…âˆ‡XF0
  q-                     âˆ‚F0-
+ m [(vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X âŸ¨Î´Î¦âŸ©Î±]âˆ‚ ğœ€ ,
  q-                                         âˆ‚F0-
âˆ’ m [vâˆ¥(vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X âŸ¨Î´Aâˆ¥âŸ©Î±âˆ’ âŸ¨Î´Aâˆ¥âŸ©Î±Î¼eâˆ¥ â‹…âˆ‡XB0 ]âˆ‚ğœ€ ,       (152)
" class="math-display"  /><a 
 id="x5-32011r152"></a></center>
                                                                                

                                                                                
</div>which agrees with the so-called <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> formulation given in <span 
class="cmtt-10">GEM</span> code manual (the ï¬rst line of Eq. 28). (It is
said that <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> formulation uses <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> + <span 
class="cmmi-10">q</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•m </span>as an independent variable, but I can not relate this
explanation to my derivation given above.)
<!--l. 1837--><p class="indent" >   Â 
</p><!--l. 1839--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.2.1   </span> <a 
 id="x5-330004.2.1"></a>Mixed variable pullback method<span class="cite">[<a 
href="nonlinear_gyrokinetic_equationli1.html#XMISHCHENKO2019194">4</a>]</span></h5>
<!--l. 1841--><p class="noindent" >Deï¬ne <span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33001r153"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation161x.png" alt="  (h)       q-     (h)  âˆ‚F0-
Î´f   = Î´f âˆ’ m âŸ¨vâˆ¥Î´A âˆ¥ âŸ©Î±âˆ‚ ğœ€ ,
" class="math-display"  /></center></td><td class="equation-label">(153)</td></tr></table>
<!--l. 1846--><p class="nopar" >
where <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is a part of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33002r154"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation162x.png" alt="Î´A  = Î´A(s)+ Î´A (h),
  âˆ¥     âˆ¥      âˆ¥
" class="math-display"  /></center></td><td class="equation-label">(154)</td></tr></table>
<!--l. 1851--><p class="nopar" >
with <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> determined by an evolution equation:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33003r155"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation163x.png" alt="   (s)
âˆ‚Î´Aâˆ¥--= 0,
  âˆ‚t
" class="math-display"  /></center></td><td class="equation-label">(155)</td></tr></table>
<!--l. 1856--><p class="nopar" >
or
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33004r156"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation164x.png" alt="âˆ‚Î´A (sâˆ¥)
--âˆ‚t-- = âˆ’ b â‹…âˆ‡Î´Î¦.
" class="math-display"  /></center></td><td class="equation-label">(156)</td></tr></table>
<!--l. 1861--><p class="nopar" >
Following the same procedure as the above, we obtain an evoluation equation for <span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>:
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation165x.png" alt="[ âˆ‚                       ]   (h)
 âˆ‚t + (vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X Î´f
                q                            âˆ‚F
= âˆ’ Î´VD â‹…âˆ‡XF0 + --[(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X âŸ¨Î´Î¦ âŸ©Î± ]--0,
  q             m                             âˆ‚ğœ€       âˆ‚F
âˆ’--[vâˆ¥(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X âŸ¨Î´A (hâˆ¥)âŸ©Î± âˆ’ âŸ¨Î´A(âˆ¥h)âŸ©Î±(Î¼eâˆ¥ â‹…âˆ‡XB0 )]--0,   (157)
 m                                                      âˆ‚ğœ€
" class="math-display"  /><a 
 id="x5-33005r157"></a></center>
</div>if we adopt Eq. (<a 
href="#x5-33003r155">155<!--tex4ht:ref: 23-11-16-1 --></a>) for <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup>; or <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation166x.png" alt="[ âˆ‚                        ]
 âˆ‚t + (vâˆ¥eâˆ¥ + VD +Î´VD ) â‹…âˆ‡X  Î´f(h)

= âˆ’ Î´VD â‹…âˆ‡XF0 + -q[(VD  + Î´VD )â‹…âˆ‡X âŸ¨Î´Î¦âŸ©Î±]âˆ‚F0-,
                m                       âˆ‚ğœ€
âˆ’-q[vâˆ¥(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X âŸ¨Î´A(âˆ¥h)âŸ©Î± âˆ’ âŸ¨Î´A(âˆ¥h)âŸ©Î±(Î¼eâˆ¥ â‹…âˆ‡XB0 )]âˆ‚F0-,  (158)
 m                                                      âˆ‚ğœ€
" class="math-display"  /></center>
</div>if we adopt Eq. (<a 
href="#x5-33004r156">156<!--tex4ht:ref: 23-11-16-2 --></a>) for <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup>.simulations, disappear on the right-hand side of the evolution equation
of <span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>.
<!--l. 1896--><p class="indent" >   In terms of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>, the Ampereâ€™s law is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33007r159"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation167x.png" alt="(     2      )
 âˆ‘   Ï‰psâˆ’ âˆ‡2   Î´A(h) = Î¼0âˆ‘  Î´J(h)+ âˆ‡2 Î´A(s),
  s  c2    âŠ¥     âˆ¥       s   ||s    âŠ¥   âˆ¥
" class="math-display"  /></center></td><td class="equation-label">(159)</td></tr></table>
<!--l. 1901--><p class="nopar" >
where <span 
class="cmmi-10">Î´J</span><sub><span 
class="cmsy-7">||</span><span 
class="cmmi-7">s</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is the parallel current carried by the distrbution funciton <span 
class="cmmi-10">Î´f</span><sub><span 
class="cmmi-7">s</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>, where <span 
class="cmmi-10">s </span>is species index.
Here <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> has been moved to the right-hand side since its value is already known when we solve the
Ampereâ€™s law for <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>.
</p><!--l. 1908--><p class="indent" >   Compared with the <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> formulation, the improvement of the above procedure is that a part of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> is
solved from an evolution equation (userâ€™s choice) and the remainder is solved from the Ampereâ€™s law.
We hope that the former is the dominant part of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> so that the remainder solved from the Ampereâ€™s
law is small and hence the cancellation problem of the Ampereâ€™s law become less signiï¬cant.
While a wise choice of the evolution equation for <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> may help ensure that <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> remain
dominant over the entire simulation duration, we have a simple and eï¬ƒcient way to make
<span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> remain dominant: collect both <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> and <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> into <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> at the end of each time
step:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33008r160"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation168x.png" alt="   (s)      (s)     (h)
Î´A âˆ¥new = Î´Aâˆ¥old + Î´Aâˆ¥old.
" class="math-display"  /></center></td><td class="equation-label">(160)</td></tr></table>
<!--l. 1923--><p class="nopar" >
Then, to make <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> untouched (so that electromagnetic ï¬eld remain unchanged), we need set <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> to
zero:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33009r161"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation169x.png" alt="Î´A (h)  = 0.
  âˆ¥new
" class="math-display"  /></center></td><td class="equation-label">(161)</td></tr></table>
<!--l. 1928--><p class="nopar" >
Here â€œoldâ€ and â€œnewâ€ refers to before and after the re-spliting, respectively. Note that this re-spliting is
made at the end of each time step and does not correspond to any time evolution. This re-splitting
keeps the value of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> untouched and hence does not inï¬‚uence the electromagnetic ï¬eld.
Meanwhile, the deï¬nition of Eq. (<a 
href="#x5-33001r153">153<!--tex4ht:ref: 23-11-16-p1 --></a>) indicates that, for a given <span 
class="cmmi-10">Î´f</span>, the re-splitting will make the
value of <span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> increase by Î” = <img 
src="nonlinear_gyrokinetic_equation170x.png" alt="qm-"  class="frac" align="middle" /><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span><span 
class="cmr-7">old</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmsy-10">âŸ©</span><sub>
<span 
class="cmmi-7">Î±</span></sub><img 
src="nonlinear_gyrokinetic_equation171x.png" alt="âˆ‚Fâˆ‚0ğœ€"  class="frac" align="middle" /> since <span 
class="cmmi-10">Î´A</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is reduced by <span 
class="cmmi-10">Î´A</span><sub>
<span 
class="cmr-7">old</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>. In
other words, to keep <span 
class="cmmi-10">Î´f </span>unchanged, which is what we need to ensure, we must add Î” to
<span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33010r162"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation172x.png" alt="Î´f(h) = Î´f(h) + q-âŸ¨v Î´A (h)âŸ© âˆ‚F0-.
  new     old   m  âˆ¥   âˆ¥old Î± âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(162)</td></tr></table>
                                                                                

                                                                                
<!--l. 1945--><p class="nopar" >
After the operations in (<a 
href="#x5-33008r160">160<!--tex4ht:ref: 23-11-16-p3 --></a>) (<a 
href="#x5-33009r161">161<!--tex4ht:ref: 23-11-16-p4 --></a>) and (<a 
href="#x5-33010r162">162<!--tex4ht:ref: 23-11-16-p5 --></a>), both the electromagnetic ï¬eld and the distribution
function <span 
class="cmmi-10">Î´f </span>remain unchanged. Therefore we do not change any physical process of the system. Hence
the above operations can only have eï¬€ects on numerical round-oï¬€ errors. As mentioned above, we hope
the numerical eï¬€ects will reduce the cancellation errors.
</p><!--l. 1953--><p class="indent" >   Deï¬ne
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33011r163"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation173x.png" alt=" --  q Î´Î¦  -(h)  quvuÎ´A(âˆ¥h)  -(s)   quvuÎ´A (sâˆ¥)  -(h)   Î´J(âˆ¥ss)
Î´Î¦ = -u--,Î´Aâˆ¥  = ---------,Î´Aâˆ¥  = --------,Î´J||s = -------,
      Tu            Tu               Tu           nuquvns
" class="math-display"  /></center></td><td class="equation-label">(163)</td></tr></table>
<!--l. 1960--><p class="nopar" >
where <span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,n</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,T</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,m</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">u</span></sub> are chosen units, <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">ns</span></sub> is a velocity unit, whose value is diï¬€erent among diï¬€erent
species. Then the Ampereâ€™s law (<a 
href="#x5-33007r159">159<!--tex4ht:ref: 23-12-4-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33012r164"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation174x.png" alt="(âˆ‘    2      )           2   2 âˆ‘
     Ï‰psâˆ’ âˆ‡2âŠ¥  Î´A(âˆ¥h)= -Ï‰-pu--vu    vnsÎ´J(|h|s)+ âˆ‡2âŠ¥Î´A-(sâˆ¥),
  s  c2               Tuâˆ•mu c2  s vu
" class="math-display"  /></center></td><td class="equation-label">(164)</td></tr></table>
<!--l. 1969--><p class="nopar" >
where use has been made of <span 
class="cmmi-10">Î¼</span><sub><span 
class="cmr-7">0</span></sub> = 1<span 
class="cmmi-10">âˆ•</span>(<span 
class="cmmi-10">c</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">ğœ€</span><sub><span 
class="cmr-7">0</span></sub>) and <span 
class="cmmi-10">Ï‰</span><sub><span 
class="cmmi-7">pu</span></sub><sup><span 
class="cmr-7">2</span></sup> = <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">âˆ•</span>(<span 
class="cmmi-10">m</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">ğœ€</span><sub><span 
class="cmr-7">0</span></sub>).
</p><!--l. 1973--><p class="indent" >   <span 
class="cmmi-10">Î´f </span>pullback: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation175x.png" alt="                             (   )
Î´f(nhe)w  =  Î´f(ohld)+ q-âŸ¨vâˆ¥Î´A (hâˆ¥o)ldâŸ©Î±  âˆ’ m- F0
           (h)  qm    (h)       T
       =  fold âˆ’ T-âŸ¨vâˆ¥Î´Aâˆ¥oldâŸ©Î±F0
           (h)  q - vn  -(h)
       =  fold âˆ’ --vâˆ¥v-âŸ¨Î´Aâˆ¥oldâŸ©Î±F0
                T    u
" class="math-display"  /></center>
</div>In terms of units used in TEK, Eq. (<a 
href="#x5-33004r156">156<!--tex4ht:ref: 23-11-16-2 --></a>) is written as
   <table 
class="equation-star"><tr><td>
                         <img 
src="nonlinear_gyrokinetic_equation176x.png" alt="  --
âˆ‚Î´A(âˆ¥s)
--âˆ‚t--"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation177x.png" alt=" Tu
quvni-"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation178x.png" alt=" 1
tni"  class="frac" align="middle" /> = <span 
class="cmsy-10">âˆ’</span><img 
src="nonlinear_gyrokinetic_equation179x.png" alt=" Tu
quLn-"  class="frac" align="middle" /><span 
class="cmbx-10">b </span><span 
class="cmsy-10">â‹…</span><span class="overline"><span 
class="cmsy-10">âˆ‡</span></span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmmi-10">,</span>
</td></tr></table>
<!--l. 1989--><p class="nopar" >
where <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">ni</span></sub> and <span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">ni</span></sub> are units of velocity and time for the main ion species. Then the above equation is
written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33014r165"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation180x.png" alt="âˆ‚Î´A-(s)       --
----âˆ¥- = âˆ’ b â‹…âˆ‡Î´Î¦,
  âˆ‚t
" class="math-display"  /></center></td><td class="equation-label">(165)</td></tr></table>
<!--l. 1995--><p class="nopar" >
i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33015r166"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation181x.png" alt="  --(s)
âˆ‚Î´A-âˆ¥- = âˆ’ (bâ‹…âˆ‡z )âˆ‚Î´Î¦-.
  âˆ‚t              âˆ‚z
" class="math-display"  /></center></td><td class="equation-label">(166)</td></tr></table>
<!--l. 2001--><p class="nopar" >
</p><!--l. 2003--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.3   </span> <a 
 id="x5-340004.3"></a>Discretizing Laplacian operator </h4>
<!--l. 2005--><p class="noindent" >The Laplacian operator is approximated as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-34001r167"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation182x.png" alt="         âˆ‚2Î´Aâˆ¥       âˆ‚2Î´A âˆ¥       âˆ‚2Î´Aâˆ¥
âˆ‡2âŠ¥ Î´Aâˆ¥ â‰ˆ -âˆ‚2x-|âˆ‡x|2 +-âˆ‚2y--|âˆ‡y |2 + âˆ‚xâˆ‚y-2âˆ‡x â‹…âˆ‡y.
" class="math-display"  /></center></td><td class="equation-label">(167)</td></tr></table>
<!--l. 2012--><p class="nopar" >
To approximate <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> of zero boundary condition <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>(<span 
class="cmmi-10">x </span>= 0) = <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>(<span 
class="cmmi-10">x </span>= <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">x</span></sub>) = 0, the sine expansion can
be adopted. In the <span 
class="cmmi-10">y </span>direction, full Fourier expansion is needed. Then, at each value of <span 
class="cmmi-10">z</span>, <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>(<span 
class="cmmi-10">x,y,z</span>) is
approximated by the following two-dimensional expansion:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-34002r168"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation183x.png" alt="              Nâˆ‘yâˆ•2     (  2Ï€  )Nxâˆ‘âˆ’1          ( m Ï€       )
Î´A âˆ¥(x,y,z) â‰ˆ       exp  in--y       Am,n(z)sin  ---(xâˆ’ x0) ,
            n=âˆ’ Nyâˆ•2       Ly    m=1            Lx
" class="math-display"  /></center></td><td class="equation-label">(168)</td></tr></table>
<!--l. 2022--><p class="nopar" >
Using this expression, Eq. (<a 
href="#x5-34001r167">167<!--tex4ht:ref: 23-12-16-3 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation184x.png" alt="                       (      )
   2          Nyâˆ‘âˆ•2        -2Ï€   Nâˆ‘xâˆ’1
âˆ’ âˆ‡ âŠ¥Î´Aâˆ¥ =          exp inLy y      Î´Am,n(z)
             n{=[âˆ’Nyâˆ•2            m=1       ]                                                     }
               ( m-Ï€)2    2  (  2Ï€-)2    2    (m-Ï€       )     2Ï€-( mÏ€-)           ( mÏ€-       )
         Ã—       Lx    |âˆ‡x | +  nLy   |âˆ‡y|  sin   Lx (x âˆ’ x0) âˆ’ inLy   Lx  2âˆ‡x â‹…âˆ‡y cos  Lx (x âˆ’ x0)
" class="math-display"  /></center>
</div>At <span 
class="cmmi-10">x </span>= <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub>, with <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub> <span 
class="cmsy-10">âˆ’ </span><span 
class="cmmi-10">x</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmmi-10">j</span>Î” and <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">x</span></sub><span 
class="cmmi-10">âˆ•</span>Î” = <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">x</span></sub>, the above expression is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation185x.png" alt="              Nyâˆ‘âˆ•2     (      ) Nâˆ‘xâˆ’1
âˆ’ âˆ‡2âŠ¥Î´Aâˆ¥ =          exp in-2Ï€y      Î´Am,n(z)
             n=âˆ’Nyâˆ•2      Ly    m=1
             {[(    )2       (     )2     ]   (    )        (    )           (     )}
         Ã—       m-Ï€   |âˆ‡x |2 +  n2Ï€-  |âˆ‡y|2 sin  jm-Ï€  âˆ’ in2Ï€-  mÏ€- 2âˆ‡x â‹…âˆ‡y cos  jmÏ€(169,)
                 Lx             Ly              Nx       Ly   Lx               Nx
" class="math-display"  /><a 
 id="x5-34004r169"></a></center>
</div>where <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">x </span>and <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y </span>are evaluated at <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub>. Plugging the DST coeï¬ƒcients
   <table 
class="equation"><tr><td><a 
 id="x5-34005r170"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation186x.png" alt="             Nxâˆ’ 1           (     )
Î´A   (z) =-2- âˆ‘   A (x â€²,z)sin  jâ€²m-Ï€- ,
  m,n     Nx  jâ€²=1  n  j        Nx
" class="math-display"  /></center></td><td class="equation-label">(170)</td></tr></table>
<!--l. 2051--><p class="nopar" >
into expression (<a 
href="#x5-34004r169">169<!--tex4ht:ref: 23-12-16-1 --></a>) gives </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation187x.png" alt="              Nyâˆ‘âˆ•2     (   2Ï€ ) Nâˆ‘xâˆ’1 2 Nxâˆ‘âˆ’1            (jâ€²mÏ€ )
âˆ’ âˆ‡2âŠ¥Î´Aâˆ¥ =          exp in---y      ---     An(xjâ€²,z)sin  -----
             n=âˆ’Nyâˆ•2      Ly    m=1 Nx  jâ€²=1              Nx
             {[( m Ï€)2       (  2Ï€ )2     ]   (jm Ï€)     2Ï€ ( mÏ€ )           ( jmÏ€ )}
         Ã—       ---   |âˆ‡x |2 +  n---  |âˆ‡y|2 sin  ----  âˆ’ in---  --- 2âˆ‡x â‹…âˆ‡y cos  ----
                 Lx             Ly              Nx       Ly   Lx               Nx
" class="math-display"  /></center>
</div>For a single toroidal harmonic, the above expression reduces to <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation188x.png" alt="    Nxâˆ’1   Nxâˆ’1            (     )
    âˆ‘   -2- âˆ‘   A (x â€²,z)sin  jâ€²mÏ€-
    m=1 Nx  jâ€²=1  n  j        Nx
    {[(    )2       (     )2     ]   (    )        (    )           (     )}
Ã—       m-Ï€   |âˆ‡x |2 +  n2Ï€-  |âˆ‡y|2 sin  jm-Ï€  âˆ’ in2Ï€-  mÏ€- 2âˆ‡x â‹…âˆ‡y cos  jmÏ€(171)
        Lx             Ly              Nx       Ly   Lx               Nx
" class="math-display"  /><a 
 id="x5-34007r171"></a></center>
</div>Deï¬ne <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation189x.png" alt="          Nxâˆ‘âˆ’ 1      ( â€²   )
Mjjâ€²,n  â‰¡       -2-sin  j-mÏ€-
           m=1 Nx      Nx
          { [( mÏ€ )2       (  2Ï€)2     ]    (jm Ï€)     2Ï€ (m Ï€)            (jm Ï€) }
       Ã—       ---  |âˆ‡x|2 +  n---  |âˆ‡y |2 sin  ----  âˆ’ in--- ---  2âˆ‡x â‹…âˆ‡y cos ----
               Lx             Ly              Nx       Ly   Lx               Nx
" class="math-display"  /></center>
</div>then expression (<a 
href="#x5-34007r171">171<!--tex4ht:ref: 23-12-27-e1 --></a>) is written as
   <table 
class="equation"><tr><td><a 
 id="x5-34009r172"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation190x.png" alt="Nxâˆ‘ âˆ’1
  â€²  Mjjâ€²,nAn (xjâ€²,z).
 j=1
" class="math-display"  /></center></td><td class="equation-label">(172)</td></tr></table>
<!--l. 2087--><p class="nopar" >
</p><!--l. 2090--><p class="indent" >   Â 
</p><!--l. 2092--><p class="indent" >   Â 
</p><!--l. 2094--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.4   </span> <a 
 id="x5-350004.4"></a>Summary of distribution function split</h4>
<!--l. 2096--><p class="noindent" >In simulations, the seemingly trivial thing on how to split the distribution function is often considered
to be a big deal. Separating the perturbation from the total distribution function gets the famous name
â€œ<span 
class="cmmi-10">Î´f </span>particle methodâ€, in contrast to the conventional particle method which is now called full-f particle
method.
</p><!--l. 2102--><p class="indent" >   In the above, the perturbed part of the distribution function, <span 
class="cmmi-10">Î´F</span>, is split at least three times in
order to (1) simplify the gyrokinetic equation by splitting out the adiabatic response; (2) eliminate
the time derivatives, <span 
class="cmmi-10">âˆ‚Î´Ï•âˆ•âˆ‚t</span>, and (3) <span 
class="cmmi-10">âˆ‚Î´</span><span 
class="cmbx-10">A</span><span 
class="cmmi-10">âˆ•âˆ‚t</span>, on the right-hand. To avoid confusion, I
summarize the split of the distribution function here. The total distribution function <span 
class="cmmi-10">F </span>is split
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35001r173"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation191x.png" alt="F = F0 +Î´F,
" class="math-display"  /></center></td><td class="equation-label">(173)</td></tr></table>
<!--l. 2111--><p class="nopar" >
where <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is the equilibrium distribution function and <span 
class="cmmi-10">Î´F </span>is the perturbed part of the total distribution
function. <span 
class="cmmi-10">Î´F </span>is further split as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35002r174"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation192x.png" alt="          q-           âˆ‚F0-  q-        âˆ‚F0-
Î´F = Î´h + m (Î´Î¦âˆ’ âŸ¨Î´Î¦âŸ©Î±) âˆ‚ğœ€ + m âŸ¨vâ‹…Î´A âŸ©Î±âˆ‚ ğœ€ ,
" class="math-display"  /></center></td><td class="equation-label">(174)</td></tr></table>
<!--l. 2120--><p class="nopar" >
where <span 
class="cmmi-10">Î´h </span>satisï¬es the gyrokinetic equation (<a 
href="#x5-32006r147">147<!--tex4ht:ref: 19-1-4-e1 --></a>) or (<a 
href="#x5-32011r152">152<!--tex4ht:ref: 19-1-4-5 --></a>). In PIC simulations, <span 
class="cmmi-10">Î´h </span>is evolved by using
markers and its moment in the phase-space is evaluated via Monte-Carlo integration.
</p><!--l. 2125--><p class="indent" >   Â 
</p><!--l. 2127--><p class="indent" >   The integration of the red and blue terms can be approximated analytically in terms of <span 
class="cmmi-10">Î´</span>Î¦ and <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span>.
But this can also be evaluated using markers, i.e., using Monte-Carlo method, to avoid
the inaccurate cancellation between the integration of these parts and the integration of
<span 
class="cmmi-10">Î´h</span>.
</p><!--l. 2133--><p class="indent" >   Â 
</p><!--l. 2135--><p class="indent" >   Another issue is how to accurately solve for <span 
class="cmmi-10">Î´</span>Î¦ from the Poisson equation and <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A </span>from the
Ampereâ€™s law. To make the solution accurate, one need to have a large term that is explictly dependent
on <span 
class="cmmi-10">Î´</span>Î¦ and <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A </span>to appear on the left-hand side of the equations and small terms appear on the
right-hand side.
</p><!--l. 2141--><p class="indent" >   The red term in expression (<a 
href="#x5-35002r174">174<!--tex4ht:ref: 19-1-3-e2 --></a>) gives â€œthe polarization densityâ€ when integrated in the velocity
space (discussed in Sec. <a 
href="nonlinear_gyrokinetic_equationse6.html#x7-380006">6<!--tex4ht:ref: 19-1-4-1 --></a>). The reason for the name â€œpolarizationâ€ is that (<span 
class="cmmi-10">Î´</span>Î¦ <span 
class="cmsy-10">âˆ’âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>) is the
diï¬€erence between the local value and the averaged value on a gyro-ring, expressing a kind of
â€œseparationâ€.
</p><!--l. 2148--><p class="indent" >   Â 
</p><!--l. 2150--><p class="indent" >   are also needed to be evaluated using Monte-Carlo markers.
</p><!--l. 2152--><p class="indent" >   Â 
</p><!--l. 2154--><p class="indent" >   This term is moved to the left-hand side of the Poisson equation and is utilized in solving the
Poisson equation. The blue term also has an explicit dependence on <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span>, which, however, will cause
numerical problems in particle simulations if it is moved to the left-hand side of the Ampere
                                                                                

                                                                                
equation. This is the â€œcancellation problemâ€ in gyrokinetic simulations discussed in Sec.
<a 
href="#x5-350004.4">4.4<!--tex4ht:ref: 2023-10-31-p1 --></a>.
</p><!--l. 2161--><p class="indent" >   Â 
</p><!--l. 2163--><p class="indent" >   The blue and red terms in the above expression explicitly depends on the perturbed ï¬eld. The
velocity integrations of these two terms can be performed analytically. However, in some cases, the
phase space integration of the blue terms must be evaluated using markers, i.e., using Monte-Carlo
method, to avoid the inaccurate cancellation between the integration of these parts and the
integration of <span 
class="cmmi-10">Î´h </span>(the latter is computed using Monte-Carlo method). When will the inaccurate
cancellation is signiï¬cant depends on the problem being investigated and thus can only be
determined by actual numerical experiments. Electromagnetic particle simulation experiments
indicate that the parallel current carried by the blue term must be evaluated via Monte-Carlo
method, otherwise inaccurate cancellation between this term and <span 
class="cmmi-10">Î´h </span>will give rise to numerical
instabilities.
</p><!--l. 2178--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.5   </span> <a 
 id="x5-360004.5"></a>Velocity space moment of <img 
src="nonlinear_gyrokinetic_equation193x.png" alt="-q
m"  class="frac" align="middle" /><span 
class="cmsy-10">âŸ¨</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><img 
src="nonlinear_gyrokinetic_equation194x.png" alt="âˆ‚F0
âˆ‚ğœ€"  class="frac" align="middle" /></h4>
<!--l. 2180--><p class="noindent" >Consider the approximation <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A </span><span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>, then the blue term in Eq. (<a 
href="#x5-35002r174">174<!--tex4ht:ref: 19-1-3-e2 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36001r175"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation195x.png" alt="q         âˆ‚F0
m-âŸ¨vâˆ¥Î´A âˆ¥âŸ©Î± âˆ‚ğœ€-.
" class="math-display"  /></center></td><td class="equation-label">(175)</td></tr></table>
<!--l. 2186--><p class="nopar" >
Notice that <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> can be taken out of the gyro-averaging. Then the above equation is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36002r176"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation196x.png" alt="q         âˆ‚F0
m-vâˆ¥âŸ¨Î´A âˆ¥âŸ©Î± âˆ‚ğœ€-.
" class="math-display"  /></center></td><td class="equation-label">(176)</td></tr></table>
                                                                                

                                                                                
<!--l. 2192--><p class="nopar" >
If we neglect the FLR eï¬€ect, then the above expression is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36003r177"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation197x.png" alt="-qv Î´A âˆ‚F0-.
m  âˆ¥  âˆ¥ âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(177)</td></tr></table>
<!--l. 2197--><p class="nopar" >
The zeroth order moment (number density) is then written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36004r178"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation198x.png" alt="           âˆ«
Î´n = q-Î´A    v âˆ‚F0dv,
     m   âˆ¥    âˆ¥âˆ‚ ğœ€
" class="math-display"  /></center></td><td class="equation-label">(178)</td></tr></table>
<!--l. 2202--><p class="nopar" >
which is zero if <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is Maxwellian. Next, consider the parallel current carried by distribution (<a 
href="#x5-36003r177">177<!--tex4ht:ref: 19-2-20-5 --></a>),
which is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36005r179"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation199x.png" alt="           âˆ«
Î´j = q2Î´A    v2âˆ‚F0-dv.
  âˆ¥  m    âˆ¥   âˆ¥ âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(179)</td></tr></table>
                                                                                

                                                                                
<!--l. 2208--><p class="nopar" >
If <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is a Maxwellian distribution given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36006r180"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation200x.png" alt="                   (     )
      ( -m--)3âˆ•2       mv2-
F0 = n0 2Ï€T    exp  âˆ’ 2T   .
" class="math-display"  /></center></td><td class="equation-label">(180)</td></tr></table>
<!--l. 2213--><p class="nopar" >
then
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36007r181"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation201x.png" alt="âˆ‚F0-   m-
âˆ‚ğœ€  = âˆ’T F0.
" class="math-display"  /></center></td><td class="equation-label">(181)</td></tr></table>
<!--l. 2217--><p class="nopar" >
Then expression (<a 
href="#x5-36005r179">179<!--tex4ht:ref: 19-2-20-1 --></a>) is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36008r182"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation202x.png" alt="                        âˆ«       (     )
       q2   (-m--)3âˆ•2       2       mv2-
Î´jâˆ¥ = âˆ’ T n0 2Ï€T    Î´A âˆ¥  vâˆ¥exp  âˆ’ 2T   dv.
" class="math-display"  /></center></td><td class="equation-label">(182)</td></tr></table>
                                                                                

                                                                                
<!--l. 2223--><p class="nopar" >
Working in the spherical coordinates, then <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> = <span 
class="cmmi-10">v</span> cos<span 
class="cmmi-10">ğœƒ </span>and <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= <span 
class="cmmi-10">v</span><sup><span 
class="cmr-7">2</span></sup> sin<span 
class="cmmi-10">ğœƒdvdğœƒdÏ•</span>. Then expression (<a 
href="#x5-36008r182">182<!--tex4ht:ref: 19-2-20-4 --></a>)
is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation203x.png" alt="              (    )      âˆ«            (      )
Î´j  =   âˆ’ q2-n  -m-- 3âˆ•2Î´A    v2cos2ğœƒ exp âˆ’ mv2- v2 sinğœƒdvdğœƒdÏ•
  âˆ¥       T  0 2Ï€T       âˆ¥                 2T
          q2   ( m  )3âˆ•2   4Ï€ âˆ«  4   (   mv2)
    =   âˆ’ T-n0 2Ï€T-    Î´Aâˆ¥-3-  v exp  âˆ’ 2T-- dv
          2   (  )3âˆ•2         âˆ«
    =   âˆ’ q-n0 -1    2T-Î´A 4Ï€-  x4exp(âˆ’ x2)dx
          T    Ï€      m   âˆ¥ 3
          q2   ( 1)3âˆ•2 2T   4Ï€ 3âˆšÏ€-
    =   âˆ’ T-n0 Ï€-    -m-Î´Aâˆ¥-3--8--
          2
    =   âˆ’ q-n0Î´A âˆ¥.                                               (183)
          m
" class="math-display"  /></center>
</div>Using <span 
class="cmmi-10">c </span>= 1<span 
class="cmmi-10">âˆ•</span><img 
src="nonlinear_gyrokinetic_equation204x.png" alt="âˆš----
 Î¼0ğœ€0"  class="sqrt"  /> and <span 
class="cmmi-10">Ï‰</span><sub><span 
class="cmmi-7">p</span></sub><sup><span 
class="cmr-7">2</span></sup> = <span 
class="cmmi-10">n</span><sub>
<span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">q</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">âˆ•</span>(<span 
class="cmmi-10">mğœ€</span><sub>
<span 
class="cmr-7">0</span></sub>), the above expression can be written as
   <table 
class="equation"><tr><td><a 
 id="x5-36010r184"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation205x.png" alt="          2
Î¼0Î´jâˆ¥ = âˆ’ Ï‰pÎ´A âˆ¥,
         c2
" class="math-display"  /></center></td><td class="equation-label">(184)</td></tr></table>
<!--l. 2246--><p class="nopar" >
where the <span 
class="cmmi-10">câˆ•Ï‰</span><sub><span 
class="cmmi-7">ps</span></sub> is often called the skin depth of species â€œsâ€. The skin current can also be written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36011r185"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation206x.png" alt="         Î²
Î¼0Î´jâˆ¥ = âˆ’-2Î´A âˆ¥,
         Ï
" class="math-display"  /></center></td><td class="equation-label">(185)</td></tr></table>
<!--l. 2251--><p class="nopar" >
where <span 
class="cmmi-10">Ï </span>= <img 
src="nonlinear_gyrokinetic_equation207x.png" alt="âˆ˜ -----
  2Tâˆ•m"  class="sqrt"  /><span 
class="cmmi-10">âˆ•</span>Î© is the thermal Larmor radius.
                                                                                

                                                                                
</p>
   <!--l. 2254--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse5.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse3.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse3.html#tailnonlinear_gyrokinetic_equationse3.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse4.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse4.html" >up</a>] </p></div>
<!--l. 2254--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationse4.html"></a>  </p> 
</body></html> 
