<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Gyrokinetic equation in forms amenable to numerical computation</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 1618--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse5.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse3.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse3.html#tailnonlinear_gyrokinetic_equationse3.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationse4.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse4.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x5-300004"></a>Gyrokinetic equation in forms amenable to numerical computation</h3>
<!--l. 1621--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x5-310004.1"></a>Eliminate <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´Ï•</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>term on the right-hand side of Eq. (136)</h4>
<!--l. 1623--><p class="noindent" >Note that the coeï¬ƒcient before <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚ğœ€</span> in Eq. (<a 
href="nonlinear_gyrokinetic_equationse3.html#x4-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) involves the time derivative of <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´Ï•</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>, which is
problematic if treated by using explicit ï¬nite diï¬€erence in particle simulations (I test the algorithm that
treats this term by implicit scheme, the result roughly agrees with the standard method discussed in
Sec. <a 
href="nonlinear_gyrokinetic_equationse6.html#x7-400006">6<!--tex4ht:ref: 19-1-4-1 --></a>). It turns out that <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>can be eliminated by deï¬ning another gyro-phase independent
function <span 
class="cmmi-10">Î´f </span>by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-31001r139"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation147x.png" alt="     q-     âˆ‚F0-
Î´f = m âŸ¨Î´Î¦ âŸ©Î± âˆ‚ğœ€  +Î´G0.
" class="math-display"  /></center></td><td class="equation-label">(139)</td></tr></table>
<!--l. 1634--><p class="nopar" >
Substituting this into Eq. (<a 
href="nonlinear_gyrokinetic_equationse3.html#x4-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>), we obtain the equation for <span 
class="cmmi-10">Î´f</span>: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation148x.png" alt="[                          ]
 -âˆ‚ + (ve  + V  + Î´V  )â‹…âˆ‡   Î´f
 âˆ‚t    âˆ¥ âˆ¥    D      D    X
  q-âˆ‚F0-[ âˆ‚                        ]
âˆ’ m  âˆ‚ğœ€  âˆ‚t + (vâˆ¥eâˆ¥ + VD + Î´VD ) â‹…âˆ‡X âŸ¨Î´Î¦âŸ©Î±
  q      [ âˆ‚                        ] âˆ‚F
âˆ’ --âŸ¨Î´Î¦ âŸ©Î± -- + (vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X  ---0
  m       âˆ‚t                          âˆ‚ğœ€
= âˆ’ Î´VD â‹…âˆ‡XF0  âˆ’ q-âˆ‚âŸ¨Î´LâŸ©Î±âˆ‚F0-.                        (140)
                 m   âˆ‚t   âˆ‚ğœ€
" class="math-display"  /></center>
</div>Noting that <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚ğœ€ </span><span 
class="cmsy-10">â‰ˆâˆ’</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">mâˆ•T</span>, we ï¬nd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">3</span></sup>) (after both sides being divided by <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>Î©). Therefore the third line can be
dropped. Moving the second line to the right-hand side and noting that <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´L</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub> = <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´Ï• </span><span 
class="cmsy-10">âˆ’ </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>, the
above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation149x.png" alt="[ âˆ‚                       ]
 --+ (vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X  Î´f
 âˆ‚t
= âˆ’ Î´[VD â‹…âˆ‡XF0                               ]
âˆ’-q âˆ’ âˆ‚âŸ¨v-â‹…Î´AâŸ©Î± âˆ’ (v e + VD  + Î´VD )â‹…âˆ‡X âŸ¨Î´Î¦ âŸ©Î± âˆ‚F0-,        (141)
 m        âˆ‚t       âˆ¥ âˆ¥                        âˆ‚ğœ€
" class="math-display"  /><a 
 id="x5-31003r141"></a></center>
</div>where two <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Ï•</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>terms cancel each other. Note that the right-hand side of Eq. (<a 
href="#x5-31003r141">141<!--tex4ht:ref: 17-5-13-p2 --></a>) contains a
nonlinear term <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> <span 
class="cmsy-10">â‹…âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>. This is diï¬€erent from the original Frieman-Chen equation, where all
nonlinear terms appear on the left-hand side. For the electrostatic limit, this term disappears because
<span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is perpendicular to <span 
class="cmsy-10">âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>.
<!--l. 1681--><p class="indent" >   [Equation (<a 
href="#x5-31003r141">141<!--tex4ht:ref: 17-5-13-p2 --></a>) corresponds to Eq. (A8) in Yang Chenâ€™s paper<span class="cite">[<a 
href="nonlinear_gyrokinetic_equationli1.html#Xychen2009">2</a>]</span> (where the ï¬rst minus on the
right-hand side is wrong and should be replaced with <span 
class="cmmi-10">qâˆ•m</span>; one <span 
class="cmmi-10">q </span>is missing before <span 
class="cmmi-10">âˆ‚</span>(<span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span>)<span 
class="cmmi-10">âˆ•âˆ‚t </span>in
A9).]
</p><!--l. 1686--><p class="indent" >   Â 
</p><!--l. 1690--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2   </span> <a 
 id="x5-320004.2"></a>Eliminate <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>term on the right-hand side of GK equation</h4>
<!--l. 1692--><p class="noindent" >Similar to the method of eliminating <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´Ï•</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t</span>, we deï¬ne another gyro-phase independent function
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-32001r142"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation150x.png" alt="          q        âˆ‚F
Î´h = Î´f âˆ’--âŸ¨v â‹…Î´A âŸ©Î±--0-.
         m          âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(142)</td></tr></table>
<!--l. 1699--><p class="nopar" >
Most gyrokinetic simulations approximate the vector potential as <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A </span><span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>. Let us simplify Eq.
(<a 
href="#x5-32006r147">147<!--tex4ht:ref: 19-1-4-e1 --></a>) for this case. Then <span 
class="cmsy-10">âŸ¨</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-32002r143"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation151x.png" alt="âŸ¨v â‹…Î´AâŸ©Î± â‰ˆ âŸ¨vâˆ¥Î´A âˆ¥âŸ©Î±.
" class="math-display"  /></center></td><td class="equation-label">(143)</td></tr></table>
<!--l. 1708--><p class="nopar" >
Then expression (<a 
href="#x5-32001r142">142<!--tex4ht:ref: 23-11-15-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-32003r144"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation152x.png" alt="         -q        âˆ‚F0-
Î´h = Î´f âˆ’ m âŸ¨vâˆ¥Î´Aâˆ¥âŸ©Î± âˆ‚ğœ€ .
" class="math-display"  /></center></td><td class="equation-label">(144)</td></tr></table>
<!--l. 1713--><p class="nopar" >
Then Eq. (<a 
href="#x5-31003r141">141<!--tex4ht:ref: 17-5-13-p2 --></a>) is written in terms of <span 
class="cmmi-10">Î´h </span>as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation153x.png" alt="[ âˆ‚                        ]
 âˆ‚t + (vâˆ¥eâˆ¥ + VD +Î´VD ) â‹…âˆ‡X Î´h
       [(                     )    ]
+-q âˆ‚F0-  âˆ‚-+ vâˆ¥eâˆ¥ + VD + Î´VD   â‹…âˆ‡X   âŸ¨vâˆ¥Î´A âˆ¥âŸ©Î±
 m  âˆ‚ğœ€    âˆ‚t                (    )
 -q                          âˆ‚F0-
+m âŸ¨vâˆ¥Î´Aâˆ¥âŸ©Î±[(VD  + Î´VD )â‹…âˆ‡X ]  âˆ‚ğœ€
= âˆ’ Î´VD â‹…âˆ‡XF0
  q [ âˆ‚ âŸ¨vâˆ¥Î´Aâˆ¥âŸ©Î±                             ] âˆ‚F
âˆ’--  âˆ’--------- âˆ’ (vâˆ¥eâˆ¥ +VD  + Î´VD )â‹…âˆ‡X âŸ¨Î´Î¦âŸ©Î± ---0,        (145)
 m        âˆ‚t                                  âˆ‚ğœ€
" class="math-display"  /></center>
</div>where use has been made of that <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>= 0 and <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0. Further noting that <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">âˆ¼ </span><span 
class="cmmi-10">Î´</span>Î¦,
<span 
class="cmmi-10">qÎ´</span>Î¦<span 
class="cmmi-10">âˆ•T </span><span 
class="cmsy-10">âˆ¼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">1</span></sup>), <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚ğœ€ </span><span 
class="cmsy-10">âˆ¼âˆ’</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">mâˆ•T</span>,    <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub><span 
class="cmmi-10">âˆ•v</span><sub><span 
class="cmmi-7">t</span></sub> <span 
class="cmsy-10">âˆ¼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">1</span></sup>), <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub><span 
class="cmmi-10">âˆ•v</span><sub><span 
class="cmmi-7">t</span></sub> <span 
class="cmsy-10">âˆ¼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">1</span></sup>), and <span 
class="cmmi-10">Ï</span><span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">âˆ¼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we
ï¬nd that the red term of the above equation (after divided by Î©<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>) is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span><sup><span 
class="cmr-7">3</span></sup>), hence can be dropped.
Move the second line to the right-hand side, giving <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation154x.png" alt="[ âˆ‚                        ]
 âˆ‚t +(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X  Î´h
= âˆ’ Î´V  â‹…âˆ‡  F
      D   X  0
+ q-[(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X (âŸ¨Î´Î¦ âˆ’ vâˆ¥Î´A âˆ¥âŸ©Î±)]âˆ‚F0,           (146)
  m                                    âˆ‚ ğœ€
" class="math-display"  /><a 
 id="x5-32005r146"></a></center>
</div>where <span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•âˆ‚t </span>terms cancel each other. Further note that <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> (given by Eq. (<a 
href="nonlinear_gyrokinetic_equationse3.html#x4-29003r138">138<!--tex4ht:ref: 19-1-3-1 --></a>)) is
perpendicular to <span 
class="cmsy-10">âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦ <span 
class="cmsy-10">âˆ’ </span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>. Therefore the blue term in Eq. (<a 
href="#x5-32005r146">146<!--tex4ht:ref: 19-1-3-e1 --></a>) is zero, then Eq. (<a 
href="#x5-32005r146">146<!--tex4ht:ref: 19-1-3-e1 --></a>)
simpliï¬es to <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation155x.png" alt="[                         ]
 âˆ‚-+ (v e + V  + Î´V  )â‹…âˆ‡    Î´h
 âˆ‚t    âˆ¥ âˆ¥    D     D    X
= âˆ’ Î´VD â‹…âˆ‡XF0
 -q                             âˆ‚F0-
+m [(vâˆ¥eâˆ¥ +VD ) â‹…âˆ‡X âŸ¨Î´Î¦ âˆ’ vâˆ¥Î´Aâˆ¥âŸ©Î±]âˆ‚ğœ€ .               (147)
" class="math-display"  /><a 
 id="x5-32006r147"></a></center>
</div>Note that in terms of (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ğœ€,Î¼,Î±,Ïƒ</span>) coordinates, <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> is written as
   <table 
class="equation"><tr><td><a 
 id="x5-32007r148"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation156x.png" alt="      âˆ˜ ---------
vâˆ¥ = Ïƒ  2ğœ€âˆ’ 2Î¼B0,
" class="math-display"  /></center></td><td class="equation-label">(148)</td></tr></table>
<!--l. 1772--><p class="nopar" >
where <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) = <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X </span>+ <span 
class="cmmib-10">Ï</span>) with <span 
class="cmmib-10">Ï</span> = <span 
class="cmmib-10">Ï</span>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ğœ€,Î¼,Î±</span>). Since the scale length of <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> is much larger than the
thermal Larmor radius, <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) <span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X</span>) and hence <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> can be approximated as a constant when
gyro-angle <span 
class="cmmi-10">Î± </span>changes. Then <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> can be taken out of the gyro-averaging in expression (<a 
href="#x5-32002r143">143<!--tex4ht:ref: 19-3-26-e1 --></a>),
yielding
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-32008r149"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation157x.png" alt="âŸ¨vâˆ¥Î´Aâˆ¥âŸ©Î± â‰ˆ vâˆ¥âŸ¨Î´A âˆ¥âŸ©Î±.
" class="math-display"  /></center></td><td class="equation-label">(149)</td></tr></table>
<!--l. 1783--><p class="nopar" >
Using this, the term related to <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> in (<a 
href="#x5-32006r147">147<!--tex4ht:ref: 19-1-4-e1 --></a>) can be further written as </p><div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation158x.png" alt="(vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X âŸ¨vâˆ¥Î´A âˆ¥âŸ©Î± =   (vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X (vâˆ¥âŸ¨Î´Aâˆ¥âŸ©Î±)
                        =   âŸ¨Î´A âˆ¥âŸ©Î±(vâˆ¥eâˆ¥ + VD ) â‹…âˆ‡X (vâˆ¥)+ vâˆ¥(vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X âŸ¨Î´Aâˆ¥(âŸ©1Î±5.0)
" class="math-display"  /></center>
</div>Using expression (<a 
href="#x5-32007r148">148<!--tex4ht:ref: 19-3-27-1 --></a>), (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> + <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub>) <span 
class="cmsy-10">â‹…âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub>(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation159x.png" alt="âŸ¨Î´A âŸ© (ve  + V  )â‹…âˆ‡  (v )  â‰ˆ  âŸ¨Î´A âŸ© (v e )â‹…âˆ‡  (v )
   âˆ¥ Î± âˆ¥ âˆ¥    D    X  âˆ¥         âˆ¥ Î±  âˆ¥ âˆ¥   X (âˆ¥âˆ˜ ---------)
                          =  âŸ¨Î´Aâˆ¥âŸ©Î±(vâˆ¥eâˆ¥)â‹…âˆ‡X  Ïƒ  2ğœ€âˆ’ 2Î¼B0
                                              (âˆ˜ ---------)
                          =  âŸ¨Î´Aâˆ¥âŸ©Î±Ïƒ(vâˆ¥eâˆ¥)â‹…âˆ‡X    2ğœ€âˆ’ 2Î¼B0
                                      âˆ’ 2Î¼eâˆ¥ â‹…âˆ‡XB0
                          =  âŸ¨Î´Aâˆ¥âŸ©Î±Ïƒvâˆ¥-2âˆš2ğœ€-âˆ’-2Î¼B---
                                                 0
                          =  âŸ¨Î´Aâˆ¥âŸ©Î±vâˆ¥âˆ’-2Î¼eâˆ¥ â‹…âˆ‡XB0-
                                          2vâˆ¥
                          =  âˆ’ âŸ¨Î´A âˆ¥âŸ©Î± Î¼eâˆ¥ â‹…âˆ‡XB0.                  (151)
" class="math-display"  /></center>
</div>(We can also obtain <span 
class="cmsy-10">âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub>(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>) = <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Î¼</span>(<span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>)<span 
class="cmmi-10">âˆ•v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> by using Eq. (<a 
href="nonlinear_gyrokinetic_equationse16.html#x17-76002r370">370<!--tex4ht:ref: 19-1-2-e1 --></a>)). Using the above results, equation
(<a 
href="#x5-32006r147">147<!--tex4ht:ref: 19-1-4-e1 --></a>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation160x.png" alt="   [                          ]
    âˆ‚- + (vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X  Î´h
    âˆ‚t
                 -q                     âˆ‚F0-
=  âˆ’ Î´VD â‹…âˆ‡XF0 + m [(vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X âŸ¨Î´Î¦ âŸ©Î±]âˆ‚ğœ€
   -q                                          âˆ‚F0-
âˆ’  m [vâˆ¥(vâˆ¥eâˆ¥ + VD )â‹…âˆ‡X âŸ¨Î´Aâˆ¥âŸ©Î±âˆ’ âŸ¨Î´A âˆ¥âŸ©Î±(Î¼eâˆ¥ â‹…âˆ‡XB0 )]âˆ‚ğœ€ ,       (152)
" class="math-display"  /><a 
 id="x5-32011r152"></a></center>
</div>which agrees with the so-called <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> formulation given in the <span 
class="cmtt-10">GEM</span> manual (the ï¬rst line of Eq. 28). (It is
                                                                                

                                                                                
said that <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> formulation uses <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> + <span 
class="cmmi-10">q</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><span 
class="cmmi-10">âˆ•m </span>as an independent variable, but I can not relate this
explanation to my derivation given above.)
<!--l. 1841--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.3   </span> <a 
 id="x5-330004.3"></a>Mixed-variable pullback method<span class="cite">[<a 
href="nonlinear_gyrokinetic_equationli1.html#XMISHCHENKO2019194">4</a>]</span></h4>
<!--l. 1843--><p class="noindent" >Deï¬ne <span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33001r153"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation161x.png" alt="  (h)       q      (h)  âˆ‚F0
Î´f   = Î´f âˆ’ m-âŸ¨vâˆ¥Î´A âˆ¥ âŸ©Î±âˆ‚-ğœ€ ,
" class="math-display"  /></center></td><td class="equation-label">(153)</td></tr></table>
<!--l. 1848--><p class="nopar" >
where <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is a part of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33002r154"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation162x.png" alt="        (s)     (h)
Î´Aâˆ¥ = Î´Aâˆ¥ + Î´A âˆ¥ ,
" class="math-display"  /></center></td><td class="equation-label">(154)</td></tr></table>
<!--l. 1853--><p class="nopar" >
with <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> determined by an evolution equation:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33003r155"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation163x.png" alt="âˆ‚Î´A (sâˆ¥)
------ = âˆ’ b â‹…âˆ‡Î´Î¦.
  âˆ‚t
" class="math-display"  /></center></td><td class="equation-label">(155)</td></tr></table>
<!--l. 1858--><p class="nopar" >
Following the same procedure in Sec. <a 
href="#x5-320004.2">4.2<!--tex4ht:ref: 24-3-21-p1 --></a>, we obtain the following evoluation equation for <span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>:
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation164x.png" alt="[ âˆ‚                        ]  (h)
 âˆ‚t + (vâˆ¥eâˆ¥ + VD +Î´VD ) â‹…âˆ‡X  Î´f

= âˆ’ Î´VD â‹…âˆ‡XF0 + -q[(VD  + Î´VD )â‹…âˆ‡X âŸ¨Î´Î¦âŸ©Î±]âˆ‚F0-
                m                       âˆ‚ğœ€
âˆ’-q[vâˆ¥(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡X âŸ¨Î´A(âˆ¥h)âŸ©Î± âˆ’ âŸ¨Î´A(âˆ¥h)âŸ©Î±(Î¼eâˆ¥ â‹…âˆ‡XB0 )]âˆ‚F0-.  (156)
 m                                                      âˆ‚ğœ€
" class="math-display"  /><a 
 id="x5-33004r156"></a></center>
</div>Next, consider the special case that <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is a local Maxwellian given by
   <table 
class="equation"><tr><td><a 
 id="x5-33005r157"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation165x.png" alt="               (        )3âˆ•2   [       ]
F0(X,ğœ€) = n0(X ) --m-----   exp âˆ’ -m-ğœ€-- ,
                 2Ï€T0(X )          T0(X)
" class="math-display"  /></center></td><td class="equation-label">(157)</td></tr></table>
<!--l. 1879--><p class="nopar" >
Then <span 
class="cmmi-10">âˆ‚F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">âˆ•âˆ‚ğœ€ </span>and <span 
class="cmsy-10">âˆ‡</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> are written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-33006r158"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation166x.png" alt="âˆ‚F    (  m )
---0=  âˆ’ --  F0,
 âˆ‚ğœ€      T
" class="math-display"  /></center></td><td class="equation-label">(158)</td></tr></table>
<!--l. 1884--><p class="nopar" >
and </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation167x.png" alt="         âˆ‚F0       âˆ‚F0
âˆ‡F0   =  -âˆ‚n0âˆ‡n0 + âˆ‚T-âˆ‡T0
            âˆ‡n      ( mv2   3) âˆ‡T
      =  F0 --0-+ F0  ----âˆ’ -  ---0
            n0[     (  2T0   2)   T]0
      =  âˆ’ F  Îº  +  mv2- âˆ’ 3  Îº  ,                   (159)
            0  n     2T0   2   T
" class="math-display"  /><a 
 id="x5-33007r159"></a></center>
</div>where <span 
class="cmmib-10">Îº</span><sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmsy-10">âˆ’</span><img 
src="nonlinear_gyrokinetic_equation168x.png" alt="âˆ‡nn00"  class="frac" align="middle" />, and <span 
class="cmmib-10">Îº</span><sub><span 
class="cmmi-7">T</span></sub> = <span 
class="cmsy-10">âˆ’</span><img 
src="nonlinear_gyrokinetic_equation169x.png" alt="âˆ‡TT00"  class="frac" align="middle" />. Consider the case that <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ğœ€</span>) is independent of <span 
class="cmmi-10">ğœƒ </span>and <span 
class="cmmi-10">Î±</span>, then
<span 
class="cmmib-10">Îº</span><sub><span 
class="cmmi-7">n</span></sub> and <span 
class="cmmib-10">Îº</span><sub><span 
class="cmmi-7">T</span></sub>are written as <span 
class="cmmib-10">Îº</span><sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmmi-10">Îº</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">r </span>and <span 
class="cmmib-10">Îº</span><sub><span 
class="cmmi-7">T</span></sub> = <span 
class="cmmi-10">Îº</span><sub><span 
class="cmmi-7">T</span></sub><span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">r</span>, where <span 
class="cmmi-10">Îº</span><sub><span 
class="cmmi-7">n</span></sub> <span 
class="cmsy-10">â‰¡âˆ’</span><img 
src="nonlinear_gyrokinetic_equation170x.png" alt="-1
n0"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation171x.png" alt="dn0
 dr"  class="frac" align="middle" />, <span 
class="cmmi-10">Îº</span><sub><span 
class="cmmi-7">T</span></sub> <span 
class="cmsy-10">â‰¡âˆ’</span><img 
src="nonlinear_gyrokinetic_equation172x.png" alt="1-
T0"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation173x.png" alt="dT0-
dr"  class="frac" align="middle" />, and <span 
class="cmmi-10">r </span>is
chosen to be the minor radius at the low ï¬eld side.
<!--l. 1903--><p class="indent" >   Using the above results, Eq. (<a 
href="#x5-33004r156">156<!--tex4ht:ref: 17-6-21-3 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation174x.png" alt="                      [     (        )   ]
dÎ´f(h)             -dr       mv2-   3          q-
  dt    =  Î´VD â‹…âˆ‡ ÏˆdÏˆ  Îºn +   2T0 âˆ’ 2  ÎºT F0 âˆ’ T[(VD + Î´VD )â‹…âˆ‡ âŸ¨Î´Î¦ âŸ©]F0
           q-                         (h)     (h)
        +  T [vâˆ¥(vâˆ¥eâˆ¥ + VD + Î´VD )â‹…âˆ‡ âŸ¨Î´Aâˆ¥ âŸ©âˆ’ âŸ¨Î´Aâˆ¥ âŸ©(Î¼eâˆ¥ â‹…âˆ‡B0 )]F0.      (160)
" class="math-display"  /><a 
 id="x5-33008r160"></a></center>
</div>
                                                                                

                                                                                
<!--l. 1917--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.1   </span> <a 
 id="x5-340004.3.1"></a>Weight evolution equation</h5>
<!--l. 1919--><p class="noindent" >The weight of the <span 
class="cmmi-10">j</span> th marker is deï¬ned by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-34001r161"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation175x.png" alt="w  = Î´f(h)(X ,v ,t)V   ,
 j         j  j   pj0
" class="math-display"  /></center></td><td class="equation-label">(161)</td></tr></table>
<!--l. 1922--><p class="nopar" >
where <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span><span 
class="cmr-7">0</span></sub> is the phase space volume occupied by the <span 
class="cmmi-10">j</span>th marker. Multiplying both sides of Eq. (<a 
href="#x5-33008r160">160<!--tex4ht:ref: 21-8-8-a1 --></a>)
by <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span><span 
class="cmr-7">0</span></sub>, and noting that <span 
class="cmmi-10">d</span>(<span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span><span 
class="cmr-7">0</span></sub>)<span 
class="cmmi-10">âˆ•dt </span>= 0, we obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation176x.png" alt="                    [    (   2    )   ]
dwj- =  Î´VD  â‹…âˆ‡Ïˆ dr- Îºn +  mv--âˆ’ 3  ÎºT Vpj0F0 âˆ’ q[(VD  + Î´VD )â‹…âŸ¨âˆ‡Î´Î¦ âŸ©]Vpj0F0.
dt               dÏˆ        2T0   2              T
     +  -q[vâˆ¥(vâˆ¥eâˆ¥ + VD + Î´VD  )â‹…âŸ¨âˆ‡ Î´A(h)âŸ© âˆ’ âŸ¨Î´A (h)âŸ©(Î¼eâˆ¥ â‹…âˆ‡B0 )]Vpj0F0,         (162)
        T                          âˆ¥        âˆ¥
" class="math-display"  /><a 
 id="x5-34002r162"></a></center>
</div>where use has been made of <span 
class="cmsy-10">âˆ‡âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ© </span>= <span 
class="cmsy-10">âŸ¨âˆ‡</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ© </span>and <span 
class="cmsy-10">âˆ‡âŸ¨</span><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmsy-10">âŸ© </span>= <span 
class="cmsy-10">âŸ¨âˆ‡</span><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmsy-10">âŸ©</span>.
<!--l. 1980--><p class="indent" >   Note that <span 
class="cmsy-10">âˆ‡â‰¡ </span><span 
class="cmmi-10">âˆ‚âˆ•âˆ‚</span><span 
class="cmbx-10">X</span>. Using <span 
class="cmbx-10">x </span>= <span 
class="cmbx-10">X </span>+ <span 
class="cmmi-10">Ï</span>, we obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation177x.png" alt="âˆ‚Î´Î¦g(X,Î±,vâŠ¥-) =   âˆ‚Î´Î¦p(X-+-Ï(X,Î±,vâŠ¥-))-
     âˆ‚X                   âˆ‚X
              =   âˆ‚Î´Î¦p(x) = âˆ‚Î´Î¦p(x) â‹… âˆ‚x-
                    âˆ‚X     (  âˆ‚x  )  âˆ‚X
                  âˆ‚Î´Î¦p(x)      -âˆ‚Ï
              =     âˆ‚x    â‹… 1+ âˆ‚X
                  âˆ‚Î´Î¦p(x)
              â‰ˆ   --âˆ‚x---,                             (163)
" class="math-display"  /></center>
</div>which is accurate up to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Î»</span>) in gyrokinetic ordering. Note that ï¬eld values on a regular <span 
class="cmbx-10">X </span>grid are not
available in our simulation because <span 
class="cmbx-10">X </span>is sampled by random markers rather than by a regular grid.
This fact makes it diï¬€cult to numerical compute <span 
class="cmmi-10">âˆ‚âˆ•âˆ‚</span><span 
class="cmbx-10">X</span>. Then the relation <span 
class="cmmi-10">âˆ‚Î´</span>Î¦<sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">âˆ•âˆ‚</span><span 
class="cmbx-10">X </span><span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">âˆ‚Î´</span>Î¦<sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">âˆ•âˆ‚</span><span 
class="cmbx-10">x</span>,
becomes useful because we can use <span 
class="cmmi-10">Î´</span>Î¦ deï¬ned on <span 
class="cmbx-10">x </span>grid (which is available in simulations) to compute
Â <span 
class="cmmi-10">âˆ‚Î´</span>Î¦<sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">âˆ•âˆ‚</span><span 
class="cmbx-10">x </span>at <span 
class="cmbx-10">x </span>grid-points (using ï¬nite-diï¬€erence), and then interpolate it to particle position.
Â Similarly, we have <span 
class="cmmi-10">âˆ‚Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">âˆ•âˆ‚</span><span 
class="cmbx-10">X </span><span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">âˆ‚Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">âˆ•âˆ‚</span><span 
class="cmbx-10">x</span>.
<!--l. 1980--><p class="indent" >   Also note that <span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<sub><span 
class="cmmi-7">g</span></sub><span 
class="cmsy-10">âŸ© </span>is not known on <span 
class="cmbx-10">X </span>grid (it is known on random markers). So, to calculate
<span 
class="cmmi-10">âˆ‚</span><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<sub><span 
class="cmmi-7">g</span></sub><span 
class="cmsy-10">âŸ©</span><span 
class="cmmi-10">âˆ•âˆ‚</span><span 
class="cmbx-10">X</span>, we need to exchange the operation order:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-34004r164"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation178x.png" alt="Î´âŸ¨Î´Î¦g-âŸ©   âˆ‚Î´Î¦g-    âˆ‚Î´Î¦p-
 âˆ‚X   = âŸ¨ âˆ‚X  âŸ© â‰ˆ âŸ¨ âˆ‚x âŸ©.
" class="math-display"  /></center></td><td class="equation-label">(164)</td></tr></table>
<!--l. 1980--><p class="nopar" >
For notation ease, the subscripts <span 
class="cmmi-10">g </span>and <span 
class="cmmi-10">p </span>will be dropped in the following.
</p><!--l. 1982--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.3.2   </span> <a 
 id="x5-350004.3.2"></a>In ï¬eld-aligned coordinates</h5>
<!--l. 1984--><p class="noindent" >In ï¬eld-aligned coordinates (<span 
class="cmmi-10">x,y,z</span>), Â <img 
src="nonlinear_gyrokinetic_equation179x.png" alt="âˆ‚Î´Î¦
 âˆ‚x"  class="frac" align="middle" /> can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35001r165"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation180x.png" alt="âˆ‚Î´Î¦- = âˆ‚Î´Î¦âˆ‡x +  âˆ‚Î´Î¦âˆ‡y + âˆ‚-Î´Î¦-âˆ‡z.
 âˆ‚x    âˆ‚x       âˆ‚y       âˆ‚z
" class="math-display"  /></center></td><td class="equation-label">(165)</td></tr></table>
<!--l. 1991--><p class="nopar" >
Note that the direction of <span 
class="cmmi-10">âˆ‚</span><span 
class="cmbx-10">r</span><span 
class="cmmi-10">âˆ•âˆ‚x </span>at <span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>is diï¬€erent from that of <span 
class="cmmi-10">âˆ‚</span><span 
class="cmbx-10">r</span><span 
class="cmmi-10">âˆ•âˆ‚x </span>at <span 
class="cmmi-10">ğœƒ </span>= +<span 
class="cmmi-10">Ï€</span>. This implies that
<span 
class="cmmi-10">âˆ‚Î´</span>Î¦<span 
class="cmmi-10">âˆ•âˆ‚x </span>is a non-periodic function of <span 
class="cmmi-10">ğœƒ</span>. Similarly, <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y </span>is also a non-perioidic functon of <span 
class="cmmi-10">ğœƒ</span>. Then both
<span 
class="cmmi-10">âˆ‚Î´</span>Î¦<span 
class="cmmi-10">âˆ•âˆ‚x </span>and <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y </span>are discontinuous across the <span 
class="cmmi-10">ğœƒ </span>cut (<span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">Â±</span><span 
class="cmmi-10">Ï€</span>).
</p><!--l. 2000--><p class="indent" >   The gyro-average of expression (<a 
href="#x5-35001r165">165<!--tex4ht:ref: 23-11-29-p1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35002r166"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation181x.png" alt="âŸ¨âˆ‚Î´Î¦-âŸ© â‰ˆ âŸ¨âˆ‚Î´Î¦-âŸ©âˆ‡x + âŸ¨âˆ‚Î´Î¦-âŸ©âˆ‡y + âŸ¨âˆ‚Î´Î¦âŸ©âˆ‡z,
  âˆ‚x      âˆ‚x        âˆ‚y        âˆ‚z
" class="math-display"  /></center></td><td class="equation-label">(166)</td></tr></table>
<!--l. 2006--><p class="nopar" >
where we approximate <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">x</span>, <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y</span>, and <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">z </span>as constants when performing the gyro-averge since they
are determined by the equilibrim magnetic ï¬eld, which is nearly constant on the Larmor
radius scale. As is mentioned above, <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y </span>is not continuous at the <span 
class="cmmi-10">ğœƒ </span>cut. Do we need to worry
about this? We do not. This is because we must stick to the same branch when we perform
gryo-average on it, and hence <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y </span>is always continous. Then, do we need to worry about
the disconunity of <span 
class="cmmi-10">âˆ‚Î´</span>Î¦<span 
class="cmmi-10">âˆ•âˆ‚x </span>across the <span 
class="cmmi-10">ğœƒ </span>cut when performing the gyro-averge on it? We
do not either. The reason is the same: we must stick to a single branch. The disconunity
is just irrelevant here. The discontinuity only manifest itself when we need to infer value
on <span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>from that on <span 
class="cmmi-10">ğœƒ </span>= +<span 
class="cmmi-10">Ï€ </span>(vice versa), i.e., when across branch communication is
explicitly needed. In TEK, the ï¬eld equations are not solved at <span 
class="cmmi-10">ğœƒ </span>= +<span 
class="cmmi-10">Ï€ </span>and hence the ï¬eld
values are not directly obtained. Instead, the ï¬eld values at <span 
class="cmmi-10">ğœƒ </span>= +<span 
class="cmmi-10">Ï€ </span>are infered from the
ï¬eld values at <span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>using the coninuity of <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">Î´</span>Î¦. At the <span 
class="cmmi-10">ğœƒ </span>cut, the continuity of <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">Î´</span>Î¦
requires
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35003r167"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation182x.png" alt="âŸ¨âˆ‚Î´Î¦-âŸ©+âˆ‡x + âŸ¨âˆ‚Î´Î¦âŸ©âˆ‡y+  = âŸ¨âˆ‚Î´Î¦âŸ©âˆ’ âˆ‡x + âŸ¨âˆ‚Î´Î¦-âŸ©âˆ‡yâˆ’ ,
  âˆ‚x         âˆ‚y          âˆ‚x          âˆ‚y
" class="math-display"  /></center></td><td class="equation-label">(167)</td></tr></table>
<!--l. 2029--><p class="nopar" >
where the superscript â€œ+â€ and â€œ<span 
class="cmsy-10">âˆ’</span>â€ refer to the location <span 
class="cmmi-10">ğœƒ </span>= +<span 
class="cmmi-10">Ï€ </span>and <span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€</span>, respectively. Dotting the
above by <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">x</span>, we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35004r168"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation183x.png" alt=" âˆ‚Î´Î¦- +   âˆ‚-Î´Î¦- âˆ’   âˆ‚-Î´Î¦- âˆ‡y-âˆ’ â‹…âˆ‡x-âˆ’-âˆ‡y+-â‹…âˆ‡x--
âŸ¨ âˆ‚x âŸ© = âŸ¨ âˆ‚x âŸ©  +âŸ¨ âˆ‚y âŸ©       |âˆ‡x |2      ,
" class="math-display"  /></center></td><td class="equation-label">(168)</td></tr></table>
<!--l. 2039--><p class="nopar" >
which is used in TEK to infer the value of <span 
class="cmsy-10">âŸ¨</span><img 
src="nonlinear_gyrokinetic_equation184x.png" alt="âˆ‚Î´Î¦
 âˆ‚x"  class="frac" align="middle" /><span 
class="cmsy-10">âŸ©</span><sup><span 
class="cmr-7">+</span></sup> from that of <span 
class="cmsy-10">âŸ¨</span><img 
src="nonlinear_gyrokinetic_equation185x.png" alt="âˆ‚Î´Î¦
 âˆ‚x"  class="frac" align="middle" /><span 
class="cmsy-10">âŸ©</span><sup><span 
class="cmsy-7">âˆ’</span></sup>.
</p><!--l. 2044--><p class="indent" >   Similarly, for <span 
class="cmmi-10">âˆ‚Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmmi-10">âˆ•âˆ‚</span><span 
class="cmbx-10">x</span>, we obtain:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35005r169"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation186x.png" alt="âˆ‚Î´A(h)   âˆ‚Î´A(h)      âˆ‚Î´A(h)     âˆ‚Î´A(h)
---âˆ¥--=  ---âˆ¥-âˆ‡x +  ---âˆ¥-âˆ‡y +  ---âˆ¥-âˆ‡z.
  âˆ‚x      âˆ‚x         âˆ‚y         âˆ‚z
" class="math-display"  /></center></td><td class="equation-label">(169)</td></tr></table>
<!--l. 2053--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35006r170"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation187x.png" alt="    (h)       (h)          (h)          (h)
âŸ¨âˆ‚Î´Aâˆ¥--âŸ© â‰ˆ âŸ¨âˆ‚Î´Aâˆ¥-âŸ©âˆ‡x + âŸ¨âˆ‚Î´Aâˆ¥-âŸ©âˆ‡y + âŸ¨âˆ‚Î´A-âˆ¥-âŸ©âˆ‡z
   âˆ‚x        âˆ‚x          âˆ‚y           âˆ‚z
" class="math-display"  /></center></td><td class="equation-label">(170)</td></tr></table>
<!--l. 2061--><p class="nopar" >
Using these, Eq. (<a 
href="#x5-34002r162">162<!--tex4ht:ref: 17-7-25-1m --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation188x.png" alt="                    [     (   2    )   ]
dwj-  =  Î´VD  â‹…âˆ‡ Ïˆ dr-Îºn +   mv--âˆ’ 3  ÎºT Vpj0F0
 dt        [      dÏˆ        2T0   2                     ]
         -q  âˆ‚Î´Î¦- dX-â€²       âˆ‚Î´Î¦-dX-â€²       âˆ‚Î´Î¦- dXâ€²-
      âˆ’  T  âŸ¨ âˆ‚x âŸ© dt â‹…âˆ‡x + âŸ¨âˆ‚y âŸ© dt â‹…âˆ‡y + âŸ¨ âˆ‚z âŸ©dt â‹…âˆ‡z  Vpj0F0
             (     (h)              (h)              (h)       )
         -q  (  âˆ‚Î´Aâˆ¥-- dX-       âˆ‚Î´Aâˆ¥-- dX-       âˆ‚Î´Aâˆ¥-- dX-   )
      +  T vâˆ¥  âŸ¨ âˆ‚x   âŸ©dt â‹…âˆ‡x + âŸ¨  âˆ‚y  âŸ©dt â‹…âˆ‡y + âŸ¨  âˆ‚z  âŸ©dt â‹…âˆ‡z  Vpj0F0
          q
      âˆ’  --âŸ¨Î´A(âˆ¥h)âŸ©(Î¼b â‹…âˆ‡B0 )Vpj0F0,                                      (171)
         T
" class="math-display"  /></center>
</div>where <img 
src="nonlinear_gyrokinetic_equation189x.png" alt="dX-
dt"  class="frac" align="middle" /> <span 
class="cmsy-10">â‰¡ </span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmbx-10">b </span>+ <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> + <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> and <img 
src="nonlinear_gyrokinetic_equation190x.png" alt="dXâ€²
 dt"  class="frac" align="middle" /> <span 
class="cmsy-10">â‰¡ </span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> + <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub>. Deï¬ne
   <table 
class="equation"><tr><td><a 
 id="x5-35008r172"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation191x.png" alt="                  q v Î´A(h)
Î´Î¦-= quÎ´Î¦-,Î´A(âˆ¥h) = -u-u--âˆ¥-,
      Tu             Tu
" class="math-display"  /></center></td><td class="equation-label">(172)</td></tr></table>
<!--l. 2088--><p class="nopar" >
Then, a typical term of the above is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation192x.png" alt="        (h)                            -(h)  --
qvâˆ¥âŸ¨âˆ‚Î´A-âˆ¥-âŸ©dX-â‹…âˆ‡xtn   =  q--Tu-vnvâˆ¥âŸ¨âˆ‚Î´Aâˆ¥--âŸ©dX-â‹…âˆ‡x
T     âˆ‚x    dt           T quvu       âˆ‚x   dt
                          qâˆ•q  v    âˆ‚Î´A-(h) dX- --
                      =  ---u--nvâˆ¥âŸ¨----âˆ¥-âŸ©---â‹…âˆ‡x,
                         T âˆ•Tuvu     âˆ‚x   dt
" class="math-display"  /></center>
</div>where <img 
src="nonlinear_gyrokinetic_equation193x.png" alt="qâˆ•qu
Tâˆ•Tu"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation194x.png" alt="vn
vu"  class="frac" align="middle" /> is the normlizing factor needed when coding. The mirror force term: <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation195x.png" alt="q    (h)                 q  Tu Bn Î¼n  -(h) --  ---
T-âŸ¨Î´A âˆ¥ âŸ©(Î¼b â‹…âˆ‡B0 )tn =   T-quvu-Ln--âŸ¨Î´Aâˆ¥ âŸ©(Î¼b â‹…âˆ‡B0 )tn          (173)
                                   2  --       ---
                    =   qâˆ•qu-1--BnvnâŸ¨Î´A(âˆ¥h)âŸ©(Î¼b â‹…âˆ‡B0 )tn
                        Tâˆ•Tu vuLnBn
                    =   qâˆ•qu-vnâŸ¨Î´A(h)âŸ©(Î¼b â‹…âˆ‡B- )
                        Tâˆ•Tu vu   âˆ¥          0
" class="math-display"  /></center>
</div>where <img 
src="nonlinear_gyrokinetic_equation196x.png" alt="qTâˆ•âˆ•quTu"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation197x.png" alt=" vvnu"  class="frac" align="middle" /> is the normlizing factor needed when coding.
<!--l. 2119--><p class="indent" >   The pullback: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation198x.png" alt="                               (    )
-qâŸ¨vâˆ¥Î´A(h)âŸ©âˆ‚F0-Vp =   q-âŸ¨vâˆ¥Î´A (h)âŸ© âˆ’ m- F0Vp
m      âˆ¥   âˆ‚ğœ€        m      âˆ¥     T
                 â‰ˆ   âˆ’-qvâˆ¥âŸ¨Î´A(âˆ¥h)âŸ©F0Vp
                      T
                 =   âˆ’-qâˆ•quvâˆ¥âŸ¨Î´A-(hâˆ¥)âŸ©F0Vp
                      T âˆ•Tuvu
" class="math-display"  /></center>
</div>The <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">E </span><span 
class="cmsy-10">Ã— </span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> drift term is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation199x.png" alt="  âˆ‚Î´Î¦                (                             )
âˆ’ âŸ¨-âˆ‚x âŸ©Ã—2-B0 =  âˆ’ -12 âŸ¨âˆ‚Î´Î¦-âŸ©âˆ‡x + âŸ¨âˆ‚Î´Î¦âŸ©âˆ‡y + âŸ¨âˆ‚Î´Î¦-âŸ©âˆ‡z   Ã— B0
     B0           B0    âˆ‚x        âˆ‚y         âˆ‚z
             =  âˆ’ âŸ¨âˆ‚Î´Î¦âŸ©-1-âˆ‡x Ã— B  âˆ’ âŸ¨âˆ‚Î´Î¦âŸ©-1-âˆ‡y Ã— B  âˆ’ âŸ¨âˆ‚Î´Î¦âŸ©-1-âˆ‡z Ã— B .
                   âˆ‚x  B20       0   âˆ‚y  B20      0    âˆ‚z  B20      0
" class="math-display"  /></center>
</div>The <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">x</span>, <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y</span>, and <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">z </span>components of the above expression are written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation200x.png" alt="âˆ’ âŸ¨âˆ‚Î´âˆ‚Î¦x âŸ©Ã—-B0-â‹…âˆ‡x =  âˆ’ âŸ¨âˆ‚Î´Î¦âŸ©-1-âˆ‡y Ã— B  â‹…âˆ‡x âˆ’ âŸ¨âˆ‚Î´Î¦âŸ©-1-âˆ‡z Ã— B  â‹…âˆ‡x
     B20                âˆ‚y  B20      0        âˆ‚z  B20      0
                       âˆ‚Î´Î¦--1-               âˆ‚Î´Î¦--1-
                 =  âˆ’ âŸ¨âˆ‚y âŸ©B2 âˆ‡x Ã— âˆ‡y â‹…B0 âˆ’ âŸ¨âˆ‚z âŸ©B2 âˆ‡x Ã— âˆ‡z â‹…B0.   (174)
                             0                     0
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation201x.png" alt="  âŸ¨âˆ‚Î´Î¦-âŸ©Ã— B             âˆ‚Î´Î¦  1                âˆ‚Î´Î¦  1
âˆ’ -âˆ‚x--2--0-â‹…âˆ‡y  =  âˆ’ âŸ¨----âŸ©-2âˆ‡x Ã— B0 â‹…âˆ‡y âˆ’ âŸ¨---âŸ©--2âˆ‡z Ã— B0 â‹…âˆ‡y
     B 0                âˆ‚x  B0                âˆ‚z B 0
                 =  âŸ¨âˆ‚-Î´Î¦-âŸ©-1-âˆ‡x Ã— âˆ‡y â‹…B0 âˆ’ âŸ¨âˆ‚Î´Î¦-âŸ©-1-âˆ‡y Ã— âˆ‡z â‹…B0    (175)
                      âˆ‚x  B20               âˆ‚z  B20
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation202x.png" alt="   âˆ‚Î´Î¦-
âˆ’ âŸ¨âˆ‚x-âŸ©Ã—-B0-â‹…âˆ‡z  =  âˆ’ âŸ¨âˆ‚Î´Î¦-âŸ© 1-âˆ‡x Ã— B0 â‹…âˆ‡z âˆ’ âŸ¨âˆ‚Î´Î¦âŸ©-1-âˆ‡y Ã— B0 â‹…âˆ‡z
     B20                âˆ‚x  B20               âˆ‚y  B20
                     âˆ‚-Î´Î¦- -1-              âˆ‚Î´Î¦- -1-
                 =  âŸ¨ âˆ‚x âŸ©B20âˆ‡x Ã— âˆ‡z â‹…B0 + âŸ¨ âˆ‚y âŸ©B20 âˆ‡y Ã—âˆ‡z â‹…B0     (176)
" class="math-display"  /></center>
</div>
<!--l. 2186--><p class="indent" >   Using
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35016r177"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation203x.png" alt="dx= V   â‹…âˆ‡x,
dt    G
" class="math-display"  /></center></td><td class="equation-label">(177)</td></tr></table>
<!--l. 2189--><p class="nopar" >
i.e.,
</p>
                                                                                

                                                                                
   <table 
class="equation"><tr><td><a 
 id="x5-35017r178"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation204x.png" alt="dx-= t V  â‹…âˆ‡x
dt   n  G
" class="math-display"  /></center></td><td class="equation-label">(178)</td></tr></table>
<!--l. 2193--><p class="nopar" >
To get the normalizing factor, consider only the contribution from <span 
class="cmmi-10">E </span><span 
class="cmsy-10">Ã—</span><span 
class="cmmi-10">B </span>drift. Then a typical term is
written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation205x.png" alt="dx- =   âˆ’ tnâŸ¨âˆ‚Î´Î¦-âŸ© 1-âˆ‡x Ã— âˆ‡y â‹…B0
dt           âˆ‚y  B20 --
          Tu--tn-- âˆ‚Î´Î¦- 1---   --  --
    =   âˆ’ quBnL2nâŸ¨ âˆ‚y âŸ©B2âˆ‡x Ã— âˆ‡y â‹…B0
                      --0
    =   âˆ’ Tu---1---âŸ¨âˆ‚Î´Î¦-âŸ© 1-âˆ‡x Ã— âˆ‡y â‹…B0,               (179)
          quBnvnLn   âˆ‚y  B20
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">T</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">âˆ•</span>(<span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub>) is the normlizing factor we need when coding.
<!--l. 2211--><p class="indent" >   The magnetic ï¬‚uttering term is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation206x.png" alt="                          âŸ¨    (                           ) âŸ©
âˆ’-vâˆ¥âŸ¨bÃ— âˆ‡  (Î´A )âŸ© =   âˆ’-vâˆ¥-  bÃ—   âˆ‚Î´Aâˆ¥âˆ‡x +  âˆ‚Î´Aâˆ¥âˆ‡y + âˆ‚Î´A-âˆ¥âˆ‡z
 B0       x   âˆ¥        B0         âˆ‚x        âˆ‚y       âˆ‚z
                       -vâˆ¥-   (  âˆ‚Î´Aâˆ¥-      âˆ‚Î´Aâˆ¥-      âˆ‚Î´A-âˆ¥   )
                  â‰ˆ   âˆ’B0 bÃ—   âŸ¨ âˆ‚x âŸ©âˆ‡x + âŸ¨ âˆ‚y  âŸ©âˆ‡y + âŸ¨ âˆ‚z  âŸ©âˆ‡z
" class="math-display"  /></center>
</div>The <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">x</span>, <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y</span>, and <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">z </span>components of the above expression are written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation207x.png" alt="                                 (                     )
 -vâˆ¥                       -vâˆ¥      âˆ‚Î´Aâˆ¥-      âˆ‚Î´Aâˆ¥-
âˆ’B0 âŸ¨bÃ— âˆ‡x (Î´Aâˆ¥)âŸ©â‹…âˆ‡x  =   âˆ’B0 b Ã—  âŸ¨ âˆ‚y âŸ©âˆ‡y + âŸ¨ âˆ‚z  âŸ©âˆ‡z   â‹…âˆ‡x
                          vâˆ¥ ( âˆ‚Î´A âˆ¥           âˆ‚ Î´A âˆ¥        )
                      =   B2- âŸ¨-âˆ‚y--âŸ©âˆ‡x Ã— âˆ‡y +âŸ¨--âˆ‚z-âŸ©âˆ‡x Ã— âˆ‡z  â‹…B0   (180)
                           0
" class="math-display"  /></center>
</div><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation208x.png" alt="  vâˆ¥-                      -vâˆ¥   (  âˆ‚Î´Aâˆ¥-      âˆ‚Î´A-âˆ¥   )
âˆ’ B0âŸ¨bÃ— âˆ‡x (Î´Aâˆ¥)âŸ©â‹…âˆ‡y  =   âˆ’B0 b Ã—  âŸ¨ âˆ‚x âŸ©âˆ‡x + âŸ¨ âˆ‚z  âŸ©âˆ‡z   â‹…âˆ‡y
                          v  ( âˆ‚Î´A             âˆ‚ Î´A          )
                      =   -âˆ¥2- âŸ¨----âˆ¥âŸ©âˆ‡y Ã—âˆ‡x  +âŸ¨----âˆ¥âŸ©âˆ‡y Ã— âˆ‡z  â‹…B0   (181)
                          B0    âˆ‚x               âˆ‚z
" class="math-display"  /></center>
</div><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation209x.png" alt="                                 (                     )
âˆ’ vâˆ¥âŸ¨bÃ— âˆ‡  (Î´A )âŸ©â‹…âˆ‡z  =   âˆ’-vâˆ¥b Ã—  âŸ¨âˆ‚Î´Aâˆ¥âŸ©âˆ‡x + âŸ¨âˆ‚Î´A-âˆ¥âŸ©âˆ‡y   â‹…âˆ‡z
  B0      x   âˆ¥            B0        âˆ‚x         âˆ‚y
                          vâˆ¥-( âˆ‚Î´A-âˆ¥           âˆ‚Î´A-âˆ¥        )
                      =   B2  âŸ¨ âˆ‚x  âŸ©âˆ‡z Ã— âˆ‡x + âŸ¨ âˆ‚y âŸ©âˆ‡z Ã— âˆ‡y  â‹…B0   (182)
                           0
" class="math-display"  /></center>
</div>
<!--l. 2264--><p class="indent" >   Also to get the normalizing factor needed in the code, consider a typical term: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation210x.png" alt="dx-       vâˆ¥-âˆ‚Î´A-âˆ¥
dt  =   tn B20âŸ¨ âˆ‚y  âŸ©âˆ‡x Ã— âˆ‡y â‹…B0
         T     v   v   âˆ‚Î´A- --   --  --
    =   --u-tn-2n---âˆ¥2âŸ¨---âˆ¥âŸ©âˆ‡x Ã— âˆ‡y â‹…B0
        quvu  LnBn B 0 -âˆ‚y
         Tu   1   vâˆ¥ âˆ‚Î´Aâˆ¥ --   --  --
    =   quvuLnBn---2âŸ¨-âˆ‚y--âŸ©âˆ‡x Ã— âˆ‡y â‹…B0                  (183)
                 B 0
" class="math-display"  /></center>
</div>
<!--l. 2281--><p class="indent" >   where <span 
class="cmmi-10">T</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">âˆ•</span>(<span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub>) is the normlizing factor I need when coding.
</p><!--l. 2283--><p class="indent" >   The basic terms involved in the above expressions can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35024r184"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation211x.png" alt="                B2
(âˆ‡x Ã— âˆ‡y )â‹…B0 = -0â€²,
                Î¨
" class="math-display"  /></center></td><td class="equation-label">(184)</td></tr></table>
<!--l. 2286--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35025r185"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation212x.png" alt="               ( âˆ‚x âˆ‚z   âˆ‚x âˆ‚z )
(âˆ‡x  Ã—âˆ‡z )â‹…B0 =   ------âˆ’ ------  BÏ• â‰¡ W 14
                 âˆ‚Z âˆ‚R   âˆ‚R âˆ‚Z
" class="math-display"  /></center></td><td class="equation-label">(185)</td></tr></table>
<!--l. 2292--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35026r186"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation213x.png" alt="               -- ( 1 âˆ‚Î± âˆ‚ğœƒ)   -- ( âˆ‚Î± âˆ‚ğœƒ   âˆ‚Î± âˆ‚ğœƒ )   -- (  1 âˆ‚Î± âˆ‚ğœƒ)
(âˆ‡y Ã— âˆ‡z)â‹…B0 = BR   R-âˆ‚Ï•-âˆ‚Z- + B Ï•  âˆ‚Z-âˆ‚R-âˆ’ âˆ‚R-âˆ‚Z-  + BZ  âˆ’ R-âˆ‚Ï•-âˆ‚R- â‰¡ W 15
" class="math-display"  /></center></td><td class="equation-label">(186)</td></tr></table>
<!--l. 2304--><p class="nopar" >
</p><!--l. 2307--><p class="indent" >   Â 
</p><!--l. 2309--><p class="indent" >   Â 
</p><!--l. 2311--><p class="indent" >   Â 
</p><!--l. 2313--><p class="indent" >   Â 
</p><!--l. 2315--><p class="indent" >   In terms of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>, the Ampereâ€™s law is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35027r187"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation214x.png" alt="(âˆ‘   Ï‰2      )          âˆ‘
     -p2sâˆ’ âˆ‡2âŠ¥   Î´A(âˆ¥h) = Î¼0   Î´J(||hs)+ âˆ‡2âŠ¥ Î´A(âˆ¥s),
  s  c                   s
" class="math-display"  /></center></td><td class="equation-label">(187)</td></tr></table>
                                                                                

                                                                                
<!--l. 2320--><p class="nopar" >
where <span 
class="cmmi-10">Î´J</span><sub><span 
class="cmsy-7">||</span><span 
class="cmmi-7">s</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is the parallel current carried by the distrbution funciton <span 
class="cmmi-10">Î´f</span><sub><span 
class="cmmi-7">s</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>, where the subscript <span 
class="cmmi-10">s </span>is
species index (do not confuse it with the superscript <span 
class="cmmi-10">s </span>of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup>). Here <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> has been moved to
the right-hand side since its value is already known when we solve the Ampereâ€™s law for
<span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>.
</p><!--l. 2328--><p class="indent" >   Compared with the <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> formulation, the improvement of the above procedure is that a part of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> is
solved from an evolution equation (which is chosen by some physical consideration) and the remainder
is solved from the Ampereâ€™s law. We hope that the former is the dominant part of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> so that the
remainder solved from the Ampereâ€™s law is small and hence the cancellation problem (of the Ampereâ€™s
law) become less signiï¬cant. While a wise choice of the evolution equation for <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> may help ensure
that <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> remain dominant over the entire simulation duration, we have another simple way to make
<span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> remain dominant: collect both <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> and <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> into <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> at the end of each time
step:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35028r188"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation215x.png" alt="   (s)      (s)     (h)
Î´A âˆ¥new = Î´Aâˆ¥old + Î´Aâˆ¥old.
" class="math-display"  /></center></td><td class="equation-label">(188)</td></tr></table>
<!--l. 2343--><p class="nopar" >
Then, to make <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> untouched (so that electromagnetic ï¬eld remain unchanged), we set <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> to
zero:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35029r189"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation216x.png" alt="Î´A (h)  = 0.
  âˆ¥new
" class="math-display"  /></center></td><td class="equation-label">(189)</td></tr></table>
<!--l. 2348--><p class="nopar" >
Here â€œoldâ€ and â€œnewâ€ refers to before and after the re-spliting, respectively. Note that this re-spliting is
made at the end of each time step and does not correspond to any time evolution. This re-splitting
keeps the value of <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> untouched and hence does not inï¬‚uence the electromagnetic ï¬eld.
Meanwhile, the deï¬nition of Eq. (<a 
href="#x5-33001r153">153<!--tex4ht:ref: 23-11-16-p1 --></a>) indicates that, for a given <span 
class="cmmi-10">Î´f</span>, the re-splitting will make the
                                                                                

                                                                                
value of <span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> increase by Î” = <img 
src="nonlinear_gyrokinetic_equation217x.png" alt="q-
m"  class="frac" align="middle" /><span 
class="cmsy-10">âŸ¨</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span><span 
class="cmr-7">old</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmsy-10">âŸ©</span><sub>
<span 
class="cmmi-7">Î±</span></sub><img 
src="nonlinear_gyrokinetic_equation218x.png" alt="âˆ‚F0
 âˆ‚ğœ€"  class="frac" align="middle" /> since <span 
class="cmmi-10">Î´A</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is reduced by <span 
class="cmmi-10">Î´A</span><sub>
<span 
class="cmr-7">old</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>. In
other words, to keep <span 
class="cmmi-10">Î´f </span>unchanged, which is what we need to ensure, we must add Î” to
<span 
class="cmmi-10">Î´f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35030r190"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation219x.png" alt="Î´f(h) = Î´f(h) + q-âŸ¨v Î´A (h)âŸ© âˆ‚F0-.
  new     old   m  âˆ¥   âˆ¥old Î± âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(190)</td></tr></table>
<!--l. 2365--><p class="nopar" >
After the operations in (<a 
href="#x5-35028r188">188<!--tex4ht:ref: 23-11-16-p3 --></a>) (<a 
href="#x5-35029r189">189<!--tex4ht:ref: 23-11-16-p4 --></a>) and (<a 
href="#x5-35030r190">190<!--tex4ht:ref: 23-11-16-p5 --></a>), both the electromagnetic ï¬eld and the distribution
function <span 
class="cmmi-10">Î´f </span>remain unchanged. Therefore we do not change any physical process of the system. Hence
the above operations can only have eï¬€ects on numerical round-oï¬€ errors. As mentioned above, we hope
the numerical eï¬€ects will reduce the cancellation errors.
</p><!--l. 2373--><p class="indent" >   Deï¬ne
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35031r191"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation220x.png" alt=" --  quÎ´Î¦  -(h)  quvuÎ´A(âˆ¥h)  -(s)   quvuÎ´A (sâˆ¥)  -(h)   Î´J(âˆ¥ss)
Î´Î¦ = -T--,Î´Aâˆ¥  = ---T-----,Î´Aâˆ¥  = ---T----,Î´J||s = n-q-v--,
       u              u               u            u u ns
" class="math-display"  /></center></td><td class="equation-label">(191)</td></tr></table>
<!--l. 2380--><p class="nopar" >
where <span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,n</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,T</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">u</span></sub> are chosen units, <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">ns</span></sub> is a velocity unit for a species, whose value is diï¬€erent among
diï¬€erent species [<span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">ns</span></sub> = <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">âˆ•</span>(2<span 
class="cmmi-10">Ï€âˆ•</span>(<span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmsy-10">|</span><span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">s</span></sub><span 
class="cmsy-10">|</span><span 
class="cmmi-10">âˆ•m</span><sub><span 
class="cmmi-7">s</span></sub>))]. In <span 
class="cmtt-10">TEK</span>, <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">u</span></sub> is chosen as <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">ns</span></sub> of the ï¬rst ion
species.
</p><!--l. 2386--><p class="indent" >   Then the Ampereâ€™s law (<a 
href="#x5-35027r187">187<!--tex4ht:ref: 23-12-4-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35032r192"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation221x.png" alt="(     2      )           2   2
 âˆ‘   Ï‰psâˆ’ âˆ‡2   Î´A(h)= -Ï‰-pu--vu âˆ‘  vnsÎ´J(h)+ âˆ‡2Î´A-(s),
  s  c2     âŠ¥    âˆ¥    Tuâˆ•mu c2  s vu   ||s    âŠ¥   âˆ¥
" class="math-display"  /></center></td><td class="equation-label">(192)</td></tr></table>
<!--l. 2392--><p class="nopar" >
where <span 
class="cmmi-10">Ï‰</span><sub><span 
class="cmmi-7">pu</span></sub><sup><span 
class="cmr-7">2</span></sup> = <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">âˆ•</span>(<span 
class="cmmi-10">m</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">ğœ€</span><sub><span 
class="cmr-7">0</span></sub>), <span 
class="cmmi-10">m</span><sub><span 
class="cmmi-7">u</span></sub> is a mass unit, and use has been made of <span 
class="cmmi-10">Î¼</span><sub><span 
class="cmr-7">0</span></sub> = 1<span 
class="cmmi-10">âˆ•</span>(<span 
class="cmmi-10">c</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">ğœ€</span><sub><span 
class="cmr-7">0</span></sub>).
</p><!--l. 2396--><p class="indent" >   <span 
class="cmmi-10">Î´f </span>pullback in Eq. (<a 
href="#x5-35030r190">190<!--tex4ht:ref: 23-11-16-p5 --></a>) is now written as (for the case of <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> being Maxwellian): </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation222x.png" alt="                 q           (  m)
Î´f(nhe)w  =  Î´f(ohld)+ --âŸ¨vâˆ¥Î´A (hâˆ¥o)ldâŸ©Î±  âˆ’ -- F0
           (h)  qm    (h)       T
       =  fold âˆ’ T-âŸ¨vâˆ¥Î´Aâˆ¥oldâŸ©Î±F0
           (h)  q - vn  -(h)
       =  fold âˆ’ T-vâˆ¥vuâŸ¨Î´Aâˆ¥oldâŸ©Î±F0                      (193)
" class="math-display"  /></center>
</div>In terms of units used in <span 
class="cmtt-10">TEK</span>, Eq. (<a 
href="#x5-33003r155">155<!--tex4ht:ref: 23-11-16-2 --></a>) is written as
   <table 
class="equation-star"><tr><td>
                          <img 
src="nonlinear_gyrokinetic_equation223x.png" alt="  --(s)
âˆ‚Î´A-âˆ¥-
  âˆ‚t"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation224x.png" alt="-Tu-
quvu"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation225x.png" alt="-1
tu"  class="frac" align="middle" /> = <span 
class="cmsy-10">âˆ’</span><img 
src="nonlinear_gyrokinetic_equation226x.png" alt="-Tu--
quLn"  class="frac" align="middle" /><span 
class="cmbx-10">b </span><span 
class="cmsy-10">â‹…</span><span class="overline"><span 
class="cmsy-10">âˆ‡</span></span><span 
class="cmmi-10">Î´</span><span class="overline">Î¦</span><span 
class="cmmi-10">,</span>
</td></tr></table>
<!--l. 2413--><p class="nopar" >
where <span class="overline"><span 
class="cmmi-10">t</span></span> = <span 
class="cmmi-10">tâˆ•t</span><sub><span 
class="cmmi-7">u</span></sub>, <span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">u</span></sub> = <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">âˆ•v</span><sub><span 
class="cmmi-7">u</span></sub>. Then the above equation is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35034r194"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation227x.png" alt="  --(s)
âˆ‚Î´A-âˆ¥- = âˆ’ b â‹…âˆ‡Î´Î¦,
  âˆ‚t
" class="math-display"  /></center></td><td class="equation-label">(194)</td></tr></table>
<!--l. 2419--><p class="nopar" >
i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-35035r195"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation228x.png" alt="âˆ‚Î´A-(sâˆ¥)       --  âˆ‚Î´Î¦-
------ = âˆ’ (bâ‹…âˆ‡z )-âˆ‚z-.
  âˆ‚t
" class="math-display"  /></center></td><td class="equation-label">(195)</td></tr></table>
<!--l. 2425--><p class="nopar" >
</p><!--l. 2428--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.4   </span> <a 
 id="x5-360004.4"></a>Discretizing Laplacian operator </h4>
<!--l. 2430--><p class="noindent" >The Laplacian operator is approximated as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36001r196"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation229x.png" alt="          2           2            2
âˆ‡2 Î´Aâˆ¥ â‰ˆ âˆ‚-Î´Aâˆ¥|âˆ‡x|2 + âˆ‚-Î´A-âˆ¥|âˆ‡y |2 + âˆ‚-Î´Aâˆ¥2âˆ‡x â‹…âˆ‡y.
 âŠ¥        âˆ‚2x         âˆ‚2y         âˆ‚xâˆ‚y
" class="math-display"  /></center></td><td class="equation-label">(196)</td></tr></table>
                                                                                

                                                                                
<!--l. 2437--><p class="nopar" >
To approximate <span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> of zero boundary condition <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>(<span 
class="cmmi-10">x </span>= 0) = <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>(<span 
class="cmmi-10">x </span>= <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">x</span></sub>) = 0, the sine expansion can
be adopted. In the <span 
class="cmmi-10">y </span>direction, full Fourier expansion is needed. Then, at each value of <span 
class="cmmi-10">z</span>, <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>(<span 
class="cmmi-10">x,y,z</span>) is
approximated by the following two-dimensional expansion:
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-36002r197"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation230x.png" alt="              Nâˆ‘yâˆ•2     (  2Ï€  )Nxâˆ‘âˆ’1          ( m Ï€       )
Î´A âˆ¥(x,y,z) â‰ˆ       exp  in--y       Am,n(z)sin  ---(xâˆ’ x0) ,
            n=âˆ’ Nyâˆ•2       Ly    m=1            Lx
" class="math-display"  /></center></td><td class="equation-label">(197)</td></tr></table>
<!--l. 2447--><p class="nopar" >
Using this expression, Eq. (<a 
href="#x5-36001r196">196<!--tex4ht:ref: 23-12-16-3 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation231x.png" alt="                       (      )
   2          Nyâˆ‘âˆ•2        -2Ï€   Nâˆ‘xâˆ’1
âˆ’ âˆ‡ âŠ¥Î´Aâˆ¥ =          exp inLy y      Î´Am,n(z)
             n{=[âˆ’Nyâˆ•2            m=1       ]                                                     }
               ( m-Ï€)2    2  (  2Ï€-)2    2    (m-Ï€       )     2Ï€-( mÏ€-)           ( mÏ€-       )
         Ã—       Lx    |âˆ‡x | +  nLy   |âˆ‡y|  sin   Lx (x âˆ’ x0) âˆ’ inLy   Lx  2âˆ‡x â‹…âˆ‡y cos  Lx (x âˆ’ x0)
" class="math-display"  /></center>
</div>At <span 
class="cmmi-10">x </span>= <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub>, with <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub> <span 
class="cmsy-10">âˆ’ </span><span 
class="cmmi-10">x</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmmi-10">j</span>Î” and <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">x</span></sub><span 
class="cmmi-10">âˆ•</span>Î” = <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">x</span></sub>, the above expression is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation232x.png" alt="   2          Nyâˆ‘âˆ•2     (   2Ï€ ) Nâˆ‘xâˆ’1
âˆ’ âˆ‡ âŠ¥Î´Aâˆ¥ =          exp inL--y      Î´Am,n(z)
             n{=[âˆ’Nyâˆ•2        y   m=1       ]                                         }
               ( m Ï€)2       (  2Ï€ )2         (jm Ï€)     2Ï€ ( mÏ€ )           ( jmÏ€ )
         Ã—       L--   |âˆ‡x |2 +  nL--  |âˆ‡y|2 sin  -N--  âˆ’ inL--  L-- 2âˆ‡x â‹…âˆ‡y cos  N--(198,)
                   x              y               x       y    x                 x
" class="math-display"  /><a 
 id="x5-36004r198"></a></center>
</div>where <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">x </span>and <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">y </span>are evaluated at <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub>. Plugging the DST coeï¬ƒcients
   <table 
class="equation"><tr><td><a 
 id="x5-36005r199"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation233x.png" alt="             N âˆ’ 1           (     )
Î´A   (z) =-2- âˆ‘x  A (x â€²,z)sin  jâ€²m-Ï€- ,
  m,n     Nx  jâ€²=1  n  j        Nx
" class="math-display"  /></center></td><td class="equation-label">(199)</td></tr></table>
<!--l. 2476--><p class="nopar" >
into expression (<a 
href="#x5-36004r198">198<!--tex4ht:ref: 23-12-16-1 --></a>) gives </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation234x.png" alt="              Nyâˆ‘âˆ•2     (   2Ï€ ) Nâˆ‘xâˆ’1 2 Nxâˆ‘âˆ’1            (jâ€²mÏ€ )
âˆ’ âˆ‡2âŠ¥Î´Aâˆ¥ =          exp in---y      ---     An(xjâ€²,z)sin  -----
             n=âˆ’Nyâˆ•2      Ly    m=1 Nx  jâ€²=1              Nx
             {[(    )2       (     )2     ]   (    )        (    )           (     )}
         Ã—       m-Ï€   |âˆ‡x |2 +  n2Ï€-  |âˆ‡y|2 sin  jm-Ï€  âˆ’ in2Ï€-  mÏ€- 2âˆ‡x â‹…âˆ‡y cos  jmÏ€-
                 Lx             Ly              Nx       Ly   Lx               Nx
" class="math-display"  /></center>
</div>For a single toroidal harmonic, the above expression reduces to <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation235x.png" alt="    Nâˆ‘xâˆ’1   Nxâˆ‘âˆ’1            ( â€²   )
        -2-     An(xjâ€²,z)sin  j-mÏ€-
    m=1 Nx  jâ€²=1              Nx
    {[(    )2       (     )2     ]   (    )        (    )           (     )}
Ã—       m-Ï€   |âˆ‡x |2 +  n2Ï€-  |âˆ‡y|2 sin  jm-Ï€  âˆ’ in2Ï€-  mÏ€- 2âˆ‡x â‹…âˆ‡y cos  jmÏ€(200)
        Lx             Ly              Nx       Ly   Lx               Nx
" class="math-display"  /><a 
 id="x5-36007r200"></a></center>
</div>Deï¬ne <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation236x.png" alt="                     (     )
          Nxâˆ‘âˆ’ 1-2-    jâ€²mÏ€-
Mjjâ€²,n  â‰¡       Nx sin   Nx
          {m=[1(    )2       (    )2     ]    (    )        (   )            (    ) }
       Ã—       mÏ€-  |âˆ‡x|2 +  n2Ï€-  |âˆ‡y |2 sin  jm-Ï€  âˆ’ in2Ï€- m-Ï€  2âˆ‡x â‹…âˆ‡y cos jm-Ï€
               Lx             Ly              Nx       Ly   Lx               Nx
" class="math-display"  /></center>
</div>then expression (<a 
href="#x5-36007r200">200<!--tex4ht:ref: 23-12-27-e1 --></a>) is written as
   <table 
class="equation"><tr><td><a 
 id="x5-36009r201"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation237x.png" alt="Nxâˆ‘ âˆ’1
     Mjjâ€²,nAn (xjâ€²,z).
 jâ€²=1
" class="math-display"  /></center></td><td class="equation-label">(201)</td></tr></table>
<!--l. 2512--><p class="nopar" >
</p><!--l. 2515--><p class="indent" >   Â 
                                                                                

                                                                                
</p><!--l. 2517--><p class="indent" >   Â 
</p><!--l. 2519--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.5   </span> <a 
 id="x5-370004.5"></a>Summary of distribution function split</h4>
<!--l. 2521--><p class="noindent" >In simulations, the seemingly trivial thing on how to split the distribution function is often considered
to be a big deal. Separating the perturbation from the total distribution function gets the famous name
â€œ<span 
class="cmmi-10">Î´f </span>particle methodâ€, in contrast to the conventional particle method which is now called full-f particle
method.
</p><!--l. 2527--><p class="indent" >   In the above, the perturbed part of the distribution function, <span 
class="cmmi-10">Î´F</span>, is split at least three times in
order to (1) simplify the gyrokinetic equation by splitting out the adiabatic response; (2) eliminate
the time derivatives, <span 
class="cmmi-10">âˆ‚Î´Ï•âˆ•âˆ‚t</span>, and (3) <span 
class="cmmi-10">âˆ‚Î´</span><span 
class="cmbx-10">A</span><span 
class="cmmi-10">âˆ•âˆ‚t</span>, on the right-hand. To avoid confusion, I
summarize the split of the distribution function here. The total distribution function <span 
class="cmmi-10">F </span>is split
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-37001r202"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation238x.png" alt="F = F0 +Î´F,
" class="math-display"  /></center></td><td class="equation-label">(202)</td></tr></table>
<!--l. 2536--><p class="nopar" >
where <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is the equilibrium distribution function and <span 
class="cmmi-10">Î´F </span>is the perturbed part of the total distribution
function. <span 
class="cmmi-10">Î´F </span>is further split as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-37002r203"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation239x.png" alt="          q-           âˆ‚F0-  q-        âˆ‚F0-
Î´F = Î´h + m (Î´Î¦âˆ’ âŸ¨Î´Î¦âŸ©Î±) âˆ‚ğœ€ + m âŸ¨vâ‹…Î´A âŸ©Î±âˆ‚ ğœ€ ,
" class="math-display"  /></center></td><td class="equation-label">(203)</td></tr></table>
<!--l. 2545--><p class="nopar" >
where <span 
class="cmmi-10">Î´h </span>satisï¬es the gyrokinetic equation (<a 
href="#x5-32006r147">147<!--tex4ht:ref: 19-1-4-e1 --></a>) or (<a 
href="#x5-32011r152">152<!--tex4ht:ref: 19-1-4-5 --></a>). In PIC simulations, <span 
class="cmmi-10">Î´h </span>is evolved by using
markers and its moment in the phase-space is evaluated via Monte-Carlo integration.
                                                                                

                                                                                
</p><!--l. 2550--><p class="indent" >   Â 
</p><!--l. 2552--><p class="indent" >   The integration of the red and blue terms can be approximated analytically in terms of <span 
class="cmmi-10">Î´</span>Î¦ and <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span>.
But this can also be evaluated using markers, i.e., using Monte-Carlo method, to avoid
the inaccurate cancellation between the integration of these parts and the integration of
<span 
class="cmmi-10">Î´h</span>.
</p><!--l. 2558--><p class="indent" >   Â 
</p><!--l. 2560--><p class="indent" >   Another issue is how to accurately solve for <span 
class="cmmi-10">Î´</span>Î¦ from the Poisson equation and <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A </span>from the
Ampereâ€™s law. To make the solution accurate, one need to have a large term that is explictly dependent
on <span 
class="cmmi-10">Î´</span>Î¦ and <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A </span>to appear on the left-hand side of the equations and small terms appear on the
right-hand side.
</p><!--l. 2566--><p class="indent" >   The red term in expression (<a 
href="#x5-37002r203">203<!--tex4ht:ref: 19-1-3-e2 --></a>) gives â€œthe polarization densityâ€ when integrated in the velocity
space (discussed in Sec. <a 
href="nonlinear_gyrokinetic_equationse6.html#x7-400006">6<!--tex4ht:ref: 19-1-4-1 --></a>). The reason for the name â€œpolarizationâ€ is that (<span 
class="cmmi-10">Î´</span>Î¦ <span 
class="cmsy-10">âˆ’âŸ¨</span><span 
class="cmmi-10">Î´</span>Î¦<span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub>) is the
diï¬€erence between the local value and the averaged value on a gyro-ring, expressing a kind of
â€œseparationâ€.
</p><!--l. 2573--><p class="indent" >   Â 
</p><!--l. 2575--><p class="indent" >   are also needed to be evaluated using Monte-Carlo markers.
</p><!--l. 2577--><p class="indent" >   Â 
</p><!--l. 2579--><p class="indent" >   This term is moved to the left-hand side of the Poisson equation and is utilized in solving the
Poisson equation. The blue term also has an explicit dependence on <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span>, which, however, will cause
numerical problems in particle simulations if it is moved to the left-hand side of the Ampere
equation. This is the â€œcancellation problemâ€ in gyrokinetic simulations discussed in Sec.
<a 
href="#x5-370004.5">4.5<!--tex4ht:ref: 2023-10-31-p1 --></a>.
</p><!--l. 2586--><p class="indent" >   Â 
</p><!--l. 2588--><p class="indent" >   The blue and red terms in the above expression explicitly depends on the perturbed ï¬eld. The
velocity integrations of these two terms can be performed analytically. However, in some cases, the
phase space integration of the blue terms must be evaluated using markers, i.e., using Monte-Carlo
method, to avoid the inaccurate cancellation between the integration of these parts and the
integration of <span 
class="cmmi-10">Î´h </span>(the latter is computed using Monte-Carlo method). When will the inaccurate
cancellation is signiï¬cant depends on the problem being investigated and thus can only be
determined by actual numerical experiments. Electromagnetic particle simulation experiments
indicate that the parallel current carried by the blue term must be evaluated via Monte-Carlo
method, otherwise inaccurate cancellation between this term and <span 
class="cmmi-10">Î´h </span>will give rise to numerical
instabilities.
</p><!--l. 2603--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.6   </span> <a 
 id="x5-380004.6"></a>Velocity space moment of <img 
src="nonlinear_gyrokinetic_equation240x.png" alt="-q
m"  class="frac" align="middle" /><span 
class="cmsy-10">âŸ¨</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">â‹… </span><span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">âŸ©</span><sub><span 
class="cmmi-7">Î±</span></sub><img 
src="nonlinear_gyrokinetic_equation241x.png" alt="âˆ‚F0
âˆ‚ğœ€"  class="frac" align="middle" /></h4>
<!--l. 2605--><p class="noindent" >Consider the approximation <span 
class="cmmi-10">Î´</span><span 
class="cmbx-10">A </span><span 
class="cmsy-10">â‰ˆ </span><span 
class="cmmi-10">Î´A</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">âˆ¥</span></sub>, then the blue term in Eq. (<a 
href="#x5-37002r203">203<!--tex4ht:ref: 19-1-3-e2 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38001r204"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation242x.png" alt="q-âŸ¨vÎ´A  âŸ© âˆ‚F0.
m  âˆ¥   âˆ¥Î± âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(204)</td></tr></table>
<!--l. 2611--><p class="nopar" >
Notice that <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> can be taken out of the gyro-averaging. Then the above equation is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38002r205"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation243x.png" alt="q-v âŸ¨Î´A  âŸ© âˆ‚F0.
m  âˆ¥   âˆ¥Î± âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(205)</td></tr></table>
<!--l. 2617--><p class="nopar" >
If we neglect the FLR eï¬€ect, then the above expression is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38003r206"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation244x.png" alt="-qv Î´A âˆ‚F0-.
m  âˆ¥  âˆ¥ âˆ‚ğœ€
" class="math-display"  /></center></td><td class="equation-label">(206)</td></tr></table>
<!--l. 2622--><p class="nopar" >
The zeroth order moment (number density) is then written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38004r207"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation245x.png" alt="           âˆ«
Î´n = q-Î´A    v âˆ‚F0dv,
     m   âˆ¥    âˆ¥âˆ‚ ğœ€
" class="math-display"  /></center></td><td class="equation-label">(207)</td></tr></table>
<!--l. 2627--><p class="nopar" >
which is zero if <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is Maxwellian. Next, consider the parallel current carried by distribution (<a 
href="#x5-38003r206">206<!--tex4ht:ref: 19-2-20-5 --></a>),
which is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38005r208"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation246x.png" alt="           âˆ«
     q2       2âˆ‚F0-
Î´jâˆ¥ = m Î´A âˆ¥ vâˆ¥ âˆ‚ğœ€ dv.
" class="math-display"  /></center></td><td class="equation-label">(208)</td></tr></table>
<!--l. 2633--><p class="nopar" >
If <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is a Maxwellian distribution given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38006r209"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation247x.png" alt="                   (     )
      ( -m--)3âˆ•2       mv2-
F0 = n0 2Ï€T    exp  âˆ’ 2T   .
" class="math-display"  /></center></td><td class="equation-label">(209)</td></tr></table>
<!--l. 2638--><p class="nopar" >
then
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38007r210"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation248x.png" alt="âˆ‚F0-= âˆ’ m-F .
âˆ‚ğœ€     T  0
" class="math-display"  /></center></td><td class="equation-label">(210)</td></tr></table>
<!--l. 2642--><p class="nopar" >
Then expression (<a 
href="#x5-38005r208">208<!--tex4ht:ref: 19-2-20-1 --></a>) is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38008r211"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation249x.png" alt="                        âˆ«       (     )
       q2   (-m--)3âˆ•2       2       mv2-
Î´jâˆ¥ = âˆ’ T n0 2Ï€T    Î´A âˆ¥  vâˆ¥exp  âˆ’ 2T   dv.
" class="math-display"  /></center></td><td class="equation-label">(211)</td></tr></table>
<!--l. 2648--><p class="nopar" >
Working in the spherical coordinates, then <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> = <span 
class="cmmi-10">v</span> cos<span 
class="cmmi-10">ğœƒ </span>and <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= <span 
class="cmmi-10">v</span><sup><span 
class="cmr-7">2</span></sup> sin<span 
class="cmmi-10">ğœƒdvdğœƒdÏ•</span>. Then expression (<a 
href="#x5-38008r211">211<!--tex4ht:ref: 19-2-20-4 --></a>)
is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation250x.png" alt="              (    )      âˆ«            (      )
Î´j  =   âˆ’ q2-n  -m-- 3âˆ•2Î´A    v2cos2ğœƒ exp âˆ’ mv2- v2 sinğœƒdvdğœƒdÏ•
  âˆ¥       T  0 2Ï€T       âˆ¥                 2T
          q2   ( m  )3âˆ•2   4Ï€ âˆ«  4   (   mv2)
    =   âˆ’ T-n0 2Ï€T-    Î´Aâˆ¥-3-  v exp  âˆ’ 2T-- dv
          2   (  )3âˆ•2         âˆ«
    =   âˆ’ q-n0 -1    2T-Î´Aâˆ¥4Ï€-  x4exp(âˆ’ x2)dx
          T    Ï€      m     3
          q2   ( 1)3âˆ•2 2T   4Ï€ 3âˆšÏ€-
    =   âˆ’ T-n0 Ï€-    -m-Î´Aâˆ¥-3--8--
          2
    =   âˆ’ q-n0Î´A âˆ¥.                                               (212)
          m
" class="math-display"  /></center>
</div>Using <span 
class="cmmi-10">c </span>= 1<span 
class="cmmi-10">âˆ•</span><img 
src="nonlinear_gyrokinetic_equation251x.png" alt="âˆš----
 Î¼0ğœ€0"  class="sqrt"  /> and <span 
class="cmmi-10">Ï‰</span><sub><span 
class="cmmi-7">p</span></sub><sup><span 
class="cmr-7">2</span></sup> = <span 
class="cmmi-10">n</span><sub>
<span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">q</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">âˆ•</span>(<span 
class="cmmi-10">mğœ€</span><sub>
<span 
class="cmr-7">0</span></sub>), the above expression can be written as
   <table 
class="equation"><tr><td><a 
 id="x5-38010r213"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation252x.png" alt="          2
Î¼0Î´jâˆ¥ = âˆ’ Ï‰p2 Î´A âˆ¥,
         c
" class="math-display"  /></center></td><td class="equation-label">(213)</td></tr></table>
<!--l. 2671--><p class="nopar" >
where the <span 
class="cmmi-10">câˆ•Ï‰</span><sub><span 
class="cmmi-7">ps</span></sub> is often called the skin depth of species â€œsâ€. The skin current can also be written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-38011r214"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation253x.png" alt="Î¼0Î´jâˆ¥ = âˆ’ Î²2Î´A âˆ¥,
         Ï
" class="math-display"  /></center></td><td class="equation-label">(214)</td></tr></table>
<!--l. 2676--><p class="nopar" >
where <span 
class="cmmi-10">Ï </span>= <img 
src="nonlinear_gyrokinetic_equation254x.png" alt="âˆ˜ -----
  2Tâˆ•m"  class="sqrt"  /><span 
class="cmmi-10">âˆ•</span>Î© is the thermal Larmor radius.
                                                                                

                                                                                
</p>
   <!--l. 2679--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationse5.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationse3.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationse3.html#tailnonlinear_gyrokinetic_equationse3.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse4.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equation.html#nonlinear_gyrokinetic_equationse4.html" >up</a>] </p></div>
<!--l. 2679--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationse4.html"></a>  </p> 
</body></html> 
