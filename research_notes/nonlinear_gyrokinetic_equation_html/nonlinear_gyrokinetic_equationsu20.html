<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Generalized split-weight scheme for electrons</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 2087--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu21.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationsu19.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationsu19.html#tailnonlinear_gyrokinetic_equationsu19.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationsu20.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse5.html#nonlinear_gyrokinetic_equationsu20.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">5.4   </span> <a 
 id="x26-370005.4"></a>Generalized split-weight scheme for electrons</h4>
<!--l. 2089--><p class="noindent" >The perturbed distribution function is decomposed as given by Eq. (<a 
href="nonlinear_gyrokinetic_equationsu19.html#x25-34002r156">156<!--tex4ht:ref: 19-1-3-e2 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x26-37001r173"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation182x.png" alt="Œ¥F = Œ¥h + q-(Œ¥Œ¶‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)‚àÇF0-+ q-‚ü®v‚ãÖŒ¥A ‚ü©Œ± ‚àÇF0,
         m             ‚àÇùúÄ   m         ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(173)</td></tr></table>
<!--l. 2097--><p class="nopar" >
where the term in blue is the so-called adiabatic response, which depends on the gyro-angle. Recall that
the red term <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub>, which is independent of the gyro-angle, is introduced in order to eliminate the time
derivative <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>term on the right-hand side of the original Frieman-Chen gyrokinetic
equation.
</p><!--l. 2105--><p class="indent" >   The so-called generalized split-weight scheme corresponds to going back to the original
Frieman-Chen gyrokinetic equation by introducing another <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> term with a free small parameter <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub>.
SpeciÔ¨Åcally, <span 
class="cmmi-10">Œ¥h </span>in the above is split as
</p>
   <table 
class="equation"><tr><td><a 
 id="x26-37002r174"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation183x.png" alt="            q      ‚àÇF
Œ¥h = Œ¥hs + ùúñg-‚ü®Œ¥Œ¶‚ü©Œ±--0.
            m      ‚àÇ ùúÄ
" class="math-display"  /></center></td><td class="equation-label">(174)</td></tr></table>
<!--l. 2112--><p class="nopar" >
(If <span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmmi-7">g</span></sub> = 1, then the two <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> terms in Eq. (<a 
href="#x26-37001r173">173<!--tex4ht:ref: 22-11-13-e2 --></a>) and (<a 
href="#x26-37002r174">174<!--tex4ht:ref: 22-11-13-e1 --></a>) cancel each other.) Substituting this
expression into Eq. (<a 
href="nonlinear_gyrokinetic_equationsu18.html#x24-32005r148">148<!--tex4ht:ref: 19-3-30-1 --></a>), we obtain the following equation for <span 
class="cmmi-10">Œ¥h</span><sub><span 
class="cmmi-7">s</span></sub>: </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation184x.png" alt="[                          ]
 -‚àÇ + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  Œ¥hs
 ‚àÇt       [                         ]
    q-‚àÇF0- ‚àÇ-
+ ùúñgm ‚àÇùúÄ   ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX ‚ü®Œ¥Œ¶ ‚ü©Œ±
    q      [ ‚àÇ                       ] ‚àÇF0
+ ùúñgm-‚ü®Œ¥Œ¶‚ü©Œ±  ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX -‚àÇùúÄ-

= ‚àí Œ¥VD ‚ãÖ‚àáXF0
‚àí q-[(v‚à•e‚à• + VD + Œ¥VD ) ‚ãÖ‚àáX (‚ü®v ‚ãÖŒ¥A ‚àí Œ¥Œ¶ ‚ü©Œ± )]‚àÇF0-.            (175)
  m                                      ‚àÇùúÄ
" class="math-display"  /><a 
 id="x26-37003r175"></a></center>
</div>Noting that <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we Ô¨Ånd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">3</span></sup>) and thus can be dropped. Moving the second line to the right-hand side, the
above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation185x.png" alt="[                          ]
  ‚àÇ-+ (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  Œ¥hs
  ‚àÇt
= ‚àí Œ¥VD ‚ãÖ‚àáXF0
  -q{                                          [‚àÇ-‚ü®Œ¥Œ¶‚ü©Œ±               ]} ‚àÇF0-
‚àí m   (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX [‚ü®v ‚ãÖŒ¥A‚ü©Œ± ‚àí ‚ü®Œ¥Œ¶ ‚ü©Œ±]+ ùúñg   ‚àÇt   + VG ‚ãÖ‚àáX ‚ü®Œ¥Œ¶‚ü©Œ±    ‚àÇ(ùúÄ1 .76)
" class="math-display"  /><a 
 id="x26-37004r176"></a></center>
</div>
   <h5 class="subsubsectionHead"><a 
 id="x26-380005.4"></a>special case of <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub> = 1</h5>
<!--l. 2157--><p class="noindent" >For the special case of <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub> = 1 (the default and most used case in GEM code, Yang Chen said <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub> <span 
class="cmmi-10">&#x003C; </span>1
cases are sometimes not accurate, so he gave up using it since 2009), equation (<a 
href="#x26-37004r176">176<!--tex4ht:ref: 19-1-10-7 --></a>) can be simpliÔ¨Åed
as: </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation186x.png" alt="[ ‚àÇ                        ]
 ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  Œ¥hs

= ‚àí Œ¥V[D ‚ãÖ‚àáXF0                ]
‚àí q- VG ‚ãÖ‚àáX ‚ü®v ‚ãÖŒ¥A ‚ü©Œ± + ‚àÇ-‚ü®Œ¥Œ¶-‚ü©Œ± ‚àÇF0-,                 (177)
  m                     ‚àÇt     ‚àÇùúÄ
" class="math-display"  /><a 
 id="x26-38001r177"></a></center>
</div>where two <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub> <span 
class="cmsy-10">‚ãÖ‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> terms cancel each other. Because the <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">E</span><sub><span 
class="cmsy-7">‚à•</span></sub> term is one of the factors that make
kinetic electron simulations diÔ¨Écult, eliminating <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub> <span 
class="cmsy-10">‚ãÖ‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> term may be beneÔ¨Åcial for obtaining stable
algorithms.
<!--l. 2177--><p class="indent" >   For <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub> = 1, <span 
class="cmmi-10">Œ¥F </span>is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation187x.png" alt="Œ¥F = Œ¥hs + ùúÄg q-‚ü®Œ¥Œ¶ ‚ü©Œ± ‚àÇFg0+-q(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶ ‚ü©Œ±)‚àÇF0-+-q‚ü®v ‚ãÖŒ¥A ‚ü©Œ±‚àÇF0-
            m       ‚àÇùúÄ   m             ‚àÇùúÄ   m          ‚àÇùúÄ
   = Œ¥hs + q-Œ¥Œ¶‚àÇFg0 + q-‚ü®v‚ãÖŒ¥A ‚ü©Œ±‚àÇF0,                            (178)
          m    ‚àÇùúÄ    m          ‚àÇùúÄ
" class="math-display"  /></center>
</div>where the polarization density term is partially canceled, yielding only the pure adiabatic
response. The adiabatic term will be moved to the left-hand side of the Poisson‚Äôs equation. The
descretization of this term is much easier than the polarization density. This term is already in
GEM.
<!--l. 2194--><p class="indent" >   Equation (<a 
href="#x26-38001r177">177<!--tex4ht:ref: 19-1-10-7m2 --></a>) actually goes back to the original Frieman-Chen equation. The only diÔ¨Äerence is
that <img 
src="nonlinear_gyrokinetic_equation188x.png" alt="q-
m"  class="frac" align="middle" /><span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><img 
src="nonlinear_gyrokinetic_equation189x.png" alt="‚àÇF0
‚àÇùúÄ"  class="frac" align="middle" /> is further split from the perturbed distribution function. Considering this, equation
(<a 
href="#x26-38001r177">177<!--tex4ht:ref: 19-1-10-7m2 --></a>) can also be obtained from the original Frieman-Chen equation (<a 
href="nonlinear_gyrokinetic_equationse5.html#x22-30001r138">138<!--tex4ht:ref: 16-10-16-2 --></a>) by writing <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">0</span></sub>
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x26-38003r179"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation190x.png" alt="Œ¥G  = Œ¥h + -q‚ü®v ‚ãÖŒ¥A ‚ü© ‚àÇF0-,
   0    s  m        Œ± ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(179)</td></tr></table>
<!--l. 2204--><p class="nopar" >
In this case, <span 
class="cmmi-10">Œ¥F </span>is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x26-38004r180"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation191x.png" alt="           q   ‚àÇF     q        ‚àÇF
Œ¥F = Œ¥hs +--Œ¥Œ¶ --g0+ --‚ü®v ‚ãÖŒ¥A‚ü©Œ±---0,
          m     ‚àÇùúÄ   m          ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(180)</td></tr></table>
<!--l. 2210--><p class="nopar" >
Substituting expression (<a 
href="#x26-38003r179">179<!--tex4ht:ref: 19-1-11-1 --></a>) into equation (<a 
href="nonlinear_gyrokinetic_equationse5.html#x22-30001r138">138<!--tex4ht:ref: 16-10-16-2 --></a>), we obtain the following equation for <span 
class="cmmi-10">Œ¥h</span><sub><span 
class="cmmi-7">s</span></sub>:
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation192x.png" alt="[                          ]
  ‚àÇ-+ (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  Œ¥hs
  ‚àÇt    [                          ]
  -q‚àÇF0- -‚àÇ
+ m  ‚àÇùúÄ  ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  ‚ü®v ‚ãÖŒ¥A ‚ü©Œ±
   q        [ ‚àÇ                        ] ‚àÇF0
+ m-‚ü®v‚ãÖŒ¥A ‚ü©Œ± ‚àÇt + (v‚à•e‚à• +VD  + Œ¥VD )‚ãÖ‚àáX  -‚àÇùúÄ-

= ‚àí Œ¥VD ‚ãÖ‚àáXF0 ‚àí q-‚àÇ‚ü®Œ¥Œ¶-‚àí-v‚ãÖŒ¥A-‚ü©Œ±-‚àÇF0,                     (181)
                m       ‚àÇt       ‚àÇùúÄ
" class="math-display"  /><a 
 id="x26-38005r181"></a></center>
</div>Noting that <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we Ô¨Ånd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">3</span></sup>) and thus can be dropped. Moving the second line to the right-hand side, the
above equation is written as <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation193x.png" alt="[ ‚àÇ                        ]
  ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX Œ¥hs

= ‚àí Œ¥[VD ‚ãÖ‚àáXF0                               ]
‚àí -q  ‚àÇ‚ü®Œ¥Œ¶-‚ü©Œ±-+ [(v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX ]‚ü®v ‚ãÖŒ¥A‚ü©Œ±  ‚àÇF0,          (182)
  m     ‚àÇt                                    ‚àÇùúÄ
" class="math-display"  /><a 
 id="x26-38006r182"></a></center>
</div>which agrees with Eq. (<a 
href="#x26-38001r177">177<!--tex4ht:ref: 19-1-10-7m2 --></a>).
<!--l. 2248--><p class="indent" >   In GEM, the split weight method is used only for electrons and the <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>is approximated by
<span 
class="cmmi-10">‚àÇŒ¥Œ¶‚àï‚àÇt </span>and this term is obtained from the vorticity equation (rather than from an implicit
iteration).
                                                                                

                                                                                
</p>
   <!--l. 2253--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu21.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationsu19.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationsu19.html#tailnonlinear_gyrokinetic_equationsu19.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationsu20.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equationse5.html#nonlinear_gyrokinetic_equationsu20.html" >up</a>] </p></div>
<!--l. 2253--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationsu20.html"></a>  </p> 
</body></html> 
