<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Generalized split-weight scheme for electrons</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
   <!--l. 2087--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu21.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationsu19.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationsu19.html#tailnonlinear_gyrokinetic_equationsu19.html" >prev-tail</a>] [<a 
href="#tailnonlinear_gyrokinetic_equationsu20.html">tail</a>] [<a 
href="nonlinear_gyrokinetic_equationse5.html#nonlinear_gyrokinetic_equationsu20.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">5.4   </span> <a 
 id="x26-370005.4"></a>Generalized split-weight scheme for electrons</h4>
<!--l. 2089--><p class="noindent" >The perturbed distribution function is decomposed as given by Eq. (<a 
href="nonlinear_gyrokinetic_equationsu19.html#x25-34002r156">156<!--tex4ht:ref: 19-1-3-e2 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x26-37001r173"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation182x.png" alt="δF = δh + q-(δΦ− ⟨δΦ⟩α)∂F0-+ q-⟨v⋅δA ⟩α ∂F0,
         m             ∂𝜀   m         ∂𝜀
" class="math-display"  /></center></td><td class="equation-label">(173)</td></tr></table>
<!--l. 2097--><p class="nopar" >
where the term in blue is the so-called adiabatic response, which depends on the gyro-angle. Recall that
the red term <span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δΦ</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub>, which is independent of the gyro-angle, is introduced in order to eliminate the time
derivative <span 
class="cmmi-10">∂</span><span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δΦ</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub><span 
class="cmmi-10">∕∂t </span>term on the right-hand side of the original Frieman-Chen gyrokinetic
equation.
</p><!--l. 2105--><p class="indent" >   The so-called generalized split-weight scheme corresponds to going back to the original
Frieman-Chen gyrokinetic equation by introducing another <span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δΦ</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> term with a free small parameter <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub>.
Speciﬁcally, <span 
class="cmmi-10">δh </span>in the above is split as
</p>
   <table 
class="equation"><tr><td><a 
 id="x26-37002r174"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation183x.png" alt="            q      ∂F
δh = δhs + 𝜖g-⟨δΦ⟩α--0.
            m      ∂ 𝜀
" class="math-display"  /></center></td><td class="equation-label">(174)</td></tr></table>
<!--l. 2112--><p class="nopar" >
(If <span 
class="cmmi-10">𝜀</span><sub><span 
class="cmmi-7">g</span></sub> = 1, then the two <span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δΦ</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> terms in Eq. (<a 
href="#x26-37001r173">173<!--tex4ht:ref: 22-11-13-e2 --></a>) and (<a 
href="#x26-37002r174">174<!--tex4ht:ref: 22-11-13-e1 --></a>) cancel each other.) Substituting this
expression into Eq. (<a 
href="nonlinear_gyrokinetic_equationsu18.html#x24-32005r148">148<!--tex4ht:ref: 19-3-30-1 --></a>), we obtain the following equation for <span 
class="cmmi-10">δh</span><sub><span 
class="cmmi-7">s</span></sub>: </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation184x.png" alt="[                          ]
 -∂ + (v∥e∥ + VD + δVD )⋅∇X  δhs
 ∂t       [                         ]
    q-∂F0- ∂-
+ 𝜖gm ∂𝜀   ∂t + (v∥e∥ + VD + δVD )⋅∇X ⟨δΦ ⟩α
    q      [ ∂                       ] ∂F0
+ 𝜖gm-⟨δΦ⟩α  ∂t + (v∥e∥ + VD + δVD )⋅∇X -∂𝜀-

= − δVD ⋅∇XF0
− q-[(v∥e∥ + VD + δVD ) ⋅∇X (⟨v ⋅δA − δΦ ⟩α )]∂F0-.            (175)
  m                                      ∂𝜀
" class="math-display"  /><a 
 id="x26-37003r175"></a></center>
</div>Noting that <span 
class="cmmi-10">∂F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">∕∂t </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmsy-10">⋅∇</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmsy-10">∇</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">∼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we ﬁnd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">3</span></sup>) and thus can be dropped. Moving the second line to the right-hand side, the
above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation185x.png" alt="[                          ]
  ∂-+ (v∥e∥ + VD + δVD )⋅∇X  δhs
  ∂t
= − δVD ⋅∇XF0
  -q{                                          [∂-⟨δΦ⟩α               ]} ∂F0-
− m   (v∥e∥ + VD + δVD )⋅∇X [⟨v ⋅δA⟩α − ⟨δΦ ⟩α]+ 𝜖g   ∂t   + VG ⋅∇X ⟨δΦ⟩α    ∂(𝜀1 .76)
" class="math-display"  /><a 
 id="x26-37004r176"></a></center>
</div>
   <h5 class="subsubsectionHead"><a 
 id="x26-380005.4"></a>special case of <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub> = 1</h5>
<!--l. 2157--><p class="noindent" >For the special case of <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub> = 1 (the default and most used case in GEM code, Yang Chen said <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub> <span 
class="cmmi-10">&#x003C; </span>1
cases are sometimes not accurate, so he gave up using it since 2009), equation (<a 
href="#x26-37004r176">176<!--tex4ht:ref: 19-1-10-7 --></a>) can be simpliﬁed
as: </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation186x.png" alt="[ ∂                        ]
 ∂t + (v∥e∥ + VD + δVD )⋅∇X  δhs

= − δV[D ⋅∇XF0                ]
− q- VG ⋅∇X ⟨v ⋅δA ⟩α + ∂-⟨δΦ-⟩α ∂F0-,                 (177)
  m                     ∂t     ∂𝜀
" class="math-display"  /><a 
 id="x26-38001r177"></a></center>
</div>where two <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub> <span 
class="cmsy-10">⋅⟨</span><span 
class="cmmi-10">δΦ</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> terms cancel each other. Because the <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">E</span><sub><span 
class="cmsy-7">∥</span></sub> term is one of the factors that make
kinetic electron simulations diﬃcult, eliminating <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub> <span 
class="cmsy-10">⋅⟨</span><span 
class="cmmi-10">δΦ</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub> term may be beneﬁcial for obtaining stable
algorithms.
<!--l. 2177--><p class="indent" >   For <span 
class="cmmi-10">𝜖</span><sub><span 
class="cmmi-7">g</span></sub> = 1, <span 
class="cmmi-10">δF </span>is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation187x.png" alt="δF = δhs + 𝜀g q-⟨δΦ ⟩α ∂Fg0+-q(δΦ − ⟨δΦ ⟩α)∂F0-+-q⟨v ⋅δA ⟩α∂F0-
            m       ∂𝜀   m             ∂𝜀   m          ∂𝜀
   = δhs + q-δΦ∂Fg0 + q-⟨v⋅δA ⟩α∂F0,                            (178)
          m    ∂𝜀    m          ∂𝜀
" class="math-display"  /></center>
</div>where the polarization density term is partially canceled, yielding only the pure adiabatic
response. The adiabatic term will be moved to the left-hand side of the Poisson’s equation. The
descretization of this term is much easier than the polarization density. This term is already in
GEM.
<!--l. 2194--><p class="indent" >   Equation (<a 
href="#x26-38001r177">177<!--tex4ht:ref: 19-1-10-7m2 --></a>) actually goes back to the original Frieman-Chen equation. The only diﬀerence is
that <img 
src="nonlinear_gyrokinetic_equation188x.png" alt="q-
m"  class="frac" align="middle" /><span 
class="cmsy-10">⟨</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">⋅</span><span 
class="cmmi-10">δ</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub><img 
src="nonlinear_gyrokinetic_equation189x.png" alt="∂F0
∂𝜀"  class="frac" align="middle" /> is further split from the perturbed distribution function. Considering this, equation
(<a 
href="#x26-38001r177">177<!--tex4ht:ref: 19-1-10-7m2 --></a>) can also be obtained from the original Frieman-Chen equation (<a 
href="nonlinear_gyrokinetic_equationse5.html#x22-30001r138">138<!--tex4ht:ref: 16-10-16-2 --></a>) by writing <span 
class="cmmi-10">δG</span><sub><span 
class="cmr-7">0</span></sub>
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x26-38003r179"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation190x.png" alt="δG  = δh + -q⟨v ⋅δA ⟩ ∂F0-,
   0    s  m        α ∂𝜀
" class="math-display"  /></center></td><td class="equation-label">(179)</td></tr></table>
<!--l. 2204--><p class="nopar" >
In this case, <span 
class="cmmi-10">δF </span>is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x26-38004r180"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation191x.png" alt="           q   ∂F     q        ∂F
δF = δhs +--δΦ --g0+ --⟨v ⋅δA⟩α---0,
          m     ∂𝜀   m          ∂𝜀
" class="math-display"  /></center></td><td class="equation-label">(180)</td></tr></table>
<!--l. 2210--><p class="nopar" >
Substituting expression (<a 
href="#x26-38003r179">179<!--tex4ht:ref: 19-1-11-1 --></a>) into equation (<a 
href="nonlinear_gyrokinetic_equationse5.html#x22-30001r138">138<!--tex4ht:ref: 16-10-16-2 --></a>), we obtain the following equation for <span 
class="cmmi-10">δh</span><sub><span 
class="cmmi-7">s</span></sub>:
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation192x.png" alt="[                          ]
  ∂-+ (v∥e∥ + VD + δVD )⋅∇X  δhs
  ∂t    [                          ]
  -q∂F0- -∂
+ m  ∂𝜀  ∂t + (v∥e∥ + VD + δVD )⋅∇X  ⟨v ⋅δA ⟩α
   q        [ ∂                        ] ∂F0
+ m-⟨v⋅δA ⟩α ∂t + (v∥e∥ +VD  + δVD )⋅∇X  -∂𝜀-

= − δVD ⋅∇XF0 − q-∂⟨δΦ-−-v⋅δA-⟩α-∂F0,                     (181)
                m       ∂t       ∂𝜀
" class="math-display"  /><a 
 id="x26-38005r181"></a></center>
</div>Noting that <span 
class="cmmi-10">∂F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">∕∂t </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmsy-10">⋅∇</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmsy-10">∇</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">∼ </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we ﬁnd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">λ</span><sup><span 
class="cmr-7">3</span></sup>) and thus can be dropped. Moving the second line to the right-hand side, the
above equation is written as <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation193x.png" alt="[ ∂                        ]
  ∂t + (v∥e∥ + VD + δVD )⋅∇X δhs

= − δ[VD ⋅∇XF0                               ]
− -q  ∂⟨δΦ-⟩α-+ [(v∥e∥ + VD + δVD )⋅∇X ]⟨v ⋅δA⟩α  ∂F0,          (182)
  m     ∂t                                    ∂𝜀
" class="math-display"  /><a 
 id="x26-38006r182"></a></center>
</div>which agrees with Eq. (<a 
href="#x26-38001r177">177<!--tex4ht:ref: 19-1-10-7m2 --></a>).
<!--l. 2248--><p class="indent" >   In GEM, the split weight method is used only for electrons and the <span 
class="cmmi-10">∂</span><span 
class="cmsy-10">⟨</span><span 
class="cmmi-10">δΦ</span><span 
class="cmsy-10">⟩</span><sub><span 
class="cmmi-7">α</span></sub><span 
class="cmmi-10">∕∂t </span>is approximated by
<span 
class="cmmi-10">∂δΦ∕∂t </span>and this term is obtained from the vorticity equation (rather than from an implicit
iteration).
                                                                                

                                                                                
</p>
   <!--l. 2253--><div class="crosslinks"><p class="noindent">[<a 
href="nonlinear_gyrokinetic_equationsu21.html" >next</a>] [<a 
href="nonlinear_gyrokinetic_equationsu19.html" >prev</a>] [<a 
href="nonlinear_gyrokinetic_equationsu19.html#tailnonlinear_gyrokinetic_equationsu19.html" >prev-tail</a>] [<a 
href="nonlinear_gyrokinetic_equationsu20.html" >front</a>] [<a 
href="nonlinear_gyrokinetic_equationse5.html#nonlinear_gyrokinetic_equationsu20.html" >up</a>] </p></div>
<!--l. 2253--><p class="indent" >   <a 
 id="tailnonlinear_gyrokinetic_equationsu20.html"></a>  </p> 
</body></html> 
