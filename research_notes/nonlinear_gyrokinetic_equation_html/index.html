<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head>
   <title>Nonlinear gyrokinetic equation</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="nonlinear_gyrokinetic_equation.tex" /> 
<link rel="stylesheet" type="text/css" href="nonlinear_gyrokinetic_equation.css" /> 
</head><body 
>
<!--l. 21--><p class="noindent" >¬†
</p>
   <div class="maketitle">
                                                                                

                                                                                
   <a 
 id="likesection.1"></a><a 
 id="x1-2r1"></a>
                                                                                

                                                                                
                                                                                

                                                                                

<h2 class="titleHead">Nonlinear gyrokinetic equation</h2>
<div class="author" >Youjun Hu<span 
class="cmr-7">1</span></div>
<div class="institute"> <span 
class="cmr-9">Institute of Plasma Physics, Chinese Academy of Sciences</span><br />
<span 
class="cmr-9">Email: yjhu@ipp.cas.cn </span></div>
<a 
 id="Q1-1-1"></a>
<a 
 id="Q1-1-2"></a>
   </div>
   <div 
class="abstract" 
>
     <span 
class="cmbx-9">Abstract.</span> <span 
class="cmr-9">The nonlinear </span><span 
class="cmmi-9">Œ¥f </span><span 
class="cmr-9">gyrokinetic equation in Frieman-Chen‚Äôs paper</span><span class="cite"><span 
class="cmr-9">[</span><a 
href="#Xfrieman1982"><span 
class="cmr-9">3</span></a><span 
class="cmr-9">]</span></span> <span 
class="cmr-9">is re-derived</span>
     <span 
class="cmr-9">in this note, giving more details. Numerical implementation of the gyrokinetic model using</span>
     <span 
class="cmr-9">the PIC method is also discussed.</span>
</div>
   <div class="tableofcontents">
   ¬†<span class="sectionToc" >1 <a 
href="#x1-10001" id="QQ2-1-3">Introduction</a></span>
<br />   ¬†<span class="sectionToc" >2 <a 
href="#x1-50002" id="QQ2-1-7">Transform Vlasov equation from particle coordinates to guiding-center coordinates</a></span>
<br />   ¬†<span class="sectionToc" >3 <a 
href="#x1-140003" id="QQ2-1-16"><span 
class="cmmi-10">Œ¥f </span>form of Vlasov equation in guiding-center variables</a></span>
<br />   ¬†<span class="sectionToc" >4 <a 
href="#x1-300004" id="QQ2-1-32">Gyrokinetic equation suitable for numerical simulation</a></span>
<br />   ¬†<span class="sectionToc" >5 <a 
href="#x1-380005" id="QQ2-1-40">Parallel Ampere‚Äôs Law</a></span>
<br />   ¬†<span class="sectionToc" >6 <a 
href="#x1-400006" id="QQ2-1-42">Poisson‚Äôs equation and polarization density</a></span>
<br />   ¬†<span class="sectionToc" >7 <a 
href="#x1-420007" id="QQ2-1-44">Polarization density expressed as local Fourier expansion</a></span>
<br />   ¬†<span class="sectionToc" >8 <a 
href="#x1-520008" id="QQ2-1-55">Polarization density matrix obtained by numerically integrating in phase
space using grid</a></span>
<br />   ¬†<span class="sectionToc" >A <a 
href="#x1-57000A" id="QQ2-1-61">Adiabatic electron response</a></span>
<br />   ¬†<span class="sectionToc" >B <a 
href="#x1-59000B" id="QQ2-1-63">Characteristic curves of Frieman-Chen nonlinear gyrokinetic equation</a></span>
<br />   ¬†<span class="sectionToc" >C <a 
href="#x1-61000C" id="QQ2-1-65">From (<span 
class="cmmi-10">Œ¥Œ¶,Œ¥</span><span 
class="cmbx-10">A</span>) to (<span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span><span 
class="cmmi-10">,Œ¥</span><span 
class="cmbx-10">B</span>)</a></span>
<br />   ¬†<span class="sectionToc" >D <a 
href="#x1-67000D" id="QQ2-1-71">Split-weight scheme for electrons in GEM code</a></span>
<br />   ¬†<span class="sectionToc" >E <a 
href="#x1-69000E" id="QQ2-1-73">Coordinate system and grid in <span 
class="cmtt-10">TEK</span> code</a></span>
<br />   ¬†<span class="sectionToc" >F <a 
href="#x1-73000F" id="QQ2-1-80">Implementation of gyrokinetics in particle-in-cell (PIC) codes</a></span>
<br />   ¬†<span class="sectionToc" >G <a 
href="#x1-78000G" id="QQ2-1-86">Diamagnetic Ô¨Çow **check**</a></span>
<br />   ¬†<span class="sectionToc" >H <a 
href="#x1-79000H" id="QQ2-1-87">Transform gyrokinetic equation from (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,ùúÄ,Œ±</span>) to (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>) coordinates</a></span>
<br />   ¬†<span class="sectionToc" >I <a 
href="#x1-81000I" id="QQ2-1-89">Drift-kinetic limit</a></span>
<br />   ¬†<span class="sectionToc" >J <a 
href="#x1-89000J" id="QQ2-1-97">Derivation of Eq. (123), not Ô¨Ånished</a></span>
<br />   ¬†<span class="sectionToc" >K <a 
href="#x1-90000K" id="QQ2-1-98">Modern view of gyrokinetic equation</a></span>
<br />   ¬†<span class="sectionToc" >L <a 
href="#x1-91000L" id="QQ2-1-99">About this document</a></span>
<br />   ¬†<span class="likesectionToc" ><a 
href="#x1-92000L" id="QQ2-1-100">References</a></span>
   </div>
                                                                                

                                                                                
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Introduction</h3>
<!--l. 43--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-20001.1"></a>Gyrokinetic?</h4>
<!--l. 45--><p class="noindent" >Electromagnetic perturbations of frequency lower than the ion cyclotron frequency are widely believed
to be more important than high-frequency ones in transporting plasma in tokamaks. (This assumption
can be veriÔ¨Åed numerically when we are able to do a full simulation including both low-frequency and
high-frequency perturbations. This kind of veriÔ¨Åcation is not possible at present due to computation
costs.)
</p><!--l. 52--><p class="indent" >   If we assume that only low-frequency perturbations are present, the Vlasov equation can be
simpliÔ¨Åed. SpeciÔ¨Åcally, symmetry of the particle distribution function in the phase space can be
established if we choose suitable phase-space coordinates and split the distribution function in a proper
way. The symmetry is along the so-called gyro-angle <span 
class="cmmi-10">Œ± </span>in the guiding-center coordinates
(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,ùúÄ,Œ±</span>). In obtaining the equation for the gyro-angle independent part of the distribution
function, we need to average the equation over the gyro-angle <span 
class="cmmi-10">Œ± </span>and thus this model is called
‚Äúgyrokinetic‚Äù.
</p><!--l. 62--><p class="indent" >   In deriving the gyrokinetic equation, the perturbed electromagnetic Ô¨Åeld is assumed to be known
and of low-frequency. To do a kinetic simulation, we need to solve the Ô¨Åeld equation to obtain the
perturbed electromagnetic Ô¨Åeld. It is still possible that high frequency modes (e.g., compressional
Alfven waves and <span 
class="cmmi-10">Œ©</span><sub><span 
class="cmmi-7">H</span></sub> modes) appear in a gyrokinetic simulation. If the amplitude of high frequency
modes is large, then the simulation is invalid since the gyrokinetic model is invalid in this
case.
</p><!--l. 70--><p class="indent" >   Our starting point is the Vlasov equation in terms of particle coordinates (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>):
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-2001r1"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation0x.png" alt="‚àÇf-+ v ‚ãÖ ‚àÇf-+ q-(E+ v √ó B) ‚ãÖ ‚àÇf-= 0,
‚àÇt      ‚àÇx   m             ‚àÇv
" class="math-display"  /></center></td><td class="equation-label">(1)</td></tr></table>
<!--l. 76--><p class="nopar" >
where <span 
class="cmmi-10">f </span>= <span 
class="cmmi-10">f</span>(<span 
class="cmmi-10">t,</span><span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) is the particle distribution function, <span 
class="cmbx-10">x </span>and <span 
class="cmbx-10">v </span>are the location and velocity of
particles. The distribution function <span 
class="cmmi-10">f </span>depends on 6 phase-space variables (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), besides the time
<span 
class="cmmi-10">t</span>.
</p><!--l. 82--><p class="noindent" >
</p>
                                                                                

                                                                                
   <h4 class="subsectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-30001.2"></a>Guiding-center coordinates: a simple example</h4>
<!--l. 84--><p class="noindent" >Choose Cartesian coordinates (<span 
class="cmmi-10">x,y,z</span>) for the conÔ¨Åguration space <span 
class="cmbx-10">x</span>. Consider a simple case where the
electromagnetic Ô¨Åeld is a time-independent Ô¨Åeld given by <span 
class="cmbx-10">B </span>= <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmmi-10">x,y,z</span>)<img 
src="nonlinear_gyrokinetic_equation1x.png" alt="ÀÜz"  class="circ"  /> and <span 
class="cmbx-10">E </span>= 0. Let us examine
the Vlasov equation in this case and see whether there is any coordinate system that can simplify the
Vlasov equation.
</p><!--l. 90--><p class="indent" >   Describe the velocity space using a right-handed cylindrical coordinates (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>), where
<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmbx-10">e</span><sub><span 
class="cmmi-7">z</span></sub> is the unit vector along the magnetic Ô¨Åeld, <span 
class="cmmi-10">Œ± </span>is the azimuthal angle of
the perpendicular velocity (<span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmmi-7">z</span></sub>) relative to <span 
class="cmbx-10">e</span><sub><span 
class="cmmi-7">x</span></sub>. Note that these coordinates
are deÔ¨Åned relative to the local magnetic Ô¨Åeld, which, in more general cases, may vary in
space.
</p><!--l. 99--><p class="indent" >   Next, let us express the spatial gradient of <span 
class="cmmi-10">f </span>in terms of partial derivatives: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation2x.png" alt="‚àÇf||    ‚àÇf||      ‚àÇf||      ‚àÇf-||
‚àÇx|| =  ‚àÇx|| ex + ‚àÇy|| ey + ‚àÇz || ez.                    (2)
   v      v        v        v
" class="math-display"  /><a 
 id="x1-3001r2"></a></center>
</div>Note that this gradient is taken by holding <span 
class="cmbx-10">v </span>constant (i.e., (<span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">x</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">y</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">z</span></sub>) constant rather than (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>)
constant). So, we need do the following coordinate transform:
   <table 
class="equation"><tr><td><a 
 id="x1-3002r3"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation3x.png" alt="                 (  ‚Ä≤     ‚Ä≤     ‚Ä≤        ‚àò -2---2-                      )
(x,y,z,vx,vy,vz) ‚áí  x = x,y = y,z = z,v‚ä• =   vx + vy,Œ± = atan 2(vy,vx),v‚à• = vz
" class="math-display"  /></center></td><td class="equation-label">(3)</td></tr></table>
<!--l. 115--><p class="nopar" >
Using chain rule, expression (<a 
href="#x1-3001r2">2<!--tex4ht:ref: 23-11-7-e1 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation4x.png" alt="   |                    |         |          |
‚àÇf-|| = ‚àÇf-‚àÇx‚Ä≤ + ‚àÇf--‚àÇv‚ä•-|| + ‚àÇf-‚àÇŒ±-|| + ‚àÇf- ‚àÇv‚à•|| .             (4)
‚àÇx |v   ‚àÇx‚Ä≤‚àÇx    ‚àÇv‚ä•  ‚àÇx |v   ‚àÇŒ± ‚àÇx |v   ‚àÇv‚à• ‚àÇx |v
       ‚àÇf
     ‚âà ‚àÇx‚Ä≤.                                                  (5)
" class="math-display"  /></center>
</div>Note that the partial derivatives
   <table 
class="equation"><tr><td><a 
 id="x1-3004r6"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation5x.png" alt="    ||     ||  ‚àÇv ||
‚àÇv‚ä•-|| , ‚àÇŒ±-||,--‚à•||
 ‚àÇx v  ‚àÇx v  ‚àÇx  v
" class="math-display"  /></center></td><td class="equation-label">(6)</td></tr></table>
<!--l. 132--><p class="nopar" >
are generally nonzero since the deÔ¨Åntion of (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) depends on the local magnetic Ô¨Åeld direction. In
our simple case, they are zero since the magnetic Ô¨Åeld direction is uniform. Similarly, we
obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-3005r7"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation6x.png" alt="‚àÇf||    ‚àÇf
‚àÇy||  ‚âà ‚àÇy‚Ä≤
   v
" class="math-display"  /></center></td><td class="equation-label">(7)</td></tr></table>
<!--l. 140--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-3006r8"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation7x.png" alt="‚àÇf||    ‚àÇf
--||  = --‚Ä≤
‚àÇz v   ‚àÇz
" class="math-display"  /></center></td><td class="equation-label">(8)</td></tr></table>
<!--l. 145--><p class="nopar" >
Then, in (<span 
class="cmmi-10">x</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,y</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,z</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) coordinates, the spatial gradient of <span 
class="cmmi-10">f </span>is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-3007r9"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation8x.png" alt="‚àÇf ||   ‚àÇf      ‚àÇf     ‚àÇf
---|| ‚âà --‚Ä≤ex + --‚Ä≤ey +--‚Ä≤ez.
‚àÇx v   ‚àÇx      ‚àÇy     ‚àÇz
" class="math-display"  /></center></td><td class="equation-label">(9)</td></tr></table>
<!--l. 152--><p class="nopar" >
Next, consider the gradient in velocity space </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation9x.png" alt="‚àÇf-   ‚àÇf-    -‚àÇf     ‚àÇf-
‚àÇv =  ‚àÇvxex + ‚àÇvyey + ‚àÇvzez
      ‚àÇf      ‚àÇf      1 ‚àÇf
   =  ---e1 +--- ez +-----eŒ±,                      (10)
      ‚àÇv‚ä•    ‚àÇv ‚à•    v‚ä• ‚àÇŒ±
" class="math-display"  /><a 
 id="x1-3008r10"></a></center>
</div>where <span 
class="cmbx-10">e</span><sub><span 
class="cmr-7">1</span></sub> = <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">‚àï</span><span 
class="cmsy-10">|</span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">|</span>, <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚àí </span>(<span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmbx-10">e</span><sub><span 
class="cmmi-7">z</span></sub>)<span 
class="cmbx-10">e</span><sub><span 
class="cmmi-7">z</span></sub>, and <span 
class="cmbx-10">e</span><sub><span 
class="cmmi-7">Œ±</span></sub> = <span 
class="cmbx-10">e</span><sub><span 
class="cmmi-7">z</span></sub> <span 
class="cmsy-10">√ó</span><span 
class="cmbx-10">e</span><sub><span 
class="cmr-7">1</span></sub>. Using Eq. (<a 
href="#x1-3008r10">10<!--tex4ht:ref: 22-12-8-1 --></a>), <img 
src="nonlinear_gyrokinetic_equation10x.png" alt="-q
m"  class="frac" align="middle" />(<span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó</span><span 
class="cmbx-10">B</span>) <span 
class="cmsy-10">‚ãÖ</span><img 
src="nonlinear_gyrokinetic_equation11x.png" alt="‚àÇf
‚àÇv"  class="frac" align="middle" /> is written as
<div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation12x.png" alt="q         ‚àÇf   q            ( ‚àÇf      ‚àÇf     1  ‚àÇf  )
-(v √ó B)‚ãÖ ---= --(v‚ä•e1 √ó B )‚ãÖ----e1 +---ez + -----eŒ±
m         ‚àÇv   m            (‚àÇv‚ä•     ‚àÇ)v‚à•     v‚ä• ‚àÇŒ±
             = q-(v e √ó B )‚ãÖ -1-‚àÇf-e
               m   ‚ä• 1       v‚ä• ‚àÇŒ±  Œ±
               Bq-‚àÇf-
             = m  ‚àÇŒ±(e1 √ó ez)‚ãÖeŒ±
                  ( ‚àÇf)
             = ‚àí Œ©  ‚àÇŒ±- ,                                      (11)
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">Œ© </span>= <span 
class="cmmi-10">Bq‚àïm </span>is the gyro-frequency. Then the Vlasov equation (<a 
href="#x1-2001r1">1<!--tex4ht:ref: 22-11-12-1 --></a>) is written as
   <table 
class="equation"><tr><td><a 
 id="x1-3010r12"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation13x.png" alt="‚àÇf      ‚àÇf     ‚àÇf
-‚àÇt + v ‚ãÖ‚àÇx-‚àí Œ© ‚àÇŒ±-= 0,
" class="math-display"  /></center></td><td class="equation-label">(12)</td></tr></table>
<!--l. 187--><p class="nopar" >
i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-3011r13"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation14x.png" alt="‚àÇf     ‚àÇf          ‚àÇf          ‚àÇf    ‚àÇf
--+ v‚à•--‚Ä≤ + v‚ä• cosŒ±---‚Ä≤ + v‚ä•sin Œ±-‚Ä≤ ‚àí Œ©---= 0.
‚àÇt    ‚àÇz          ‚àÇx          ‚àÇy     ‚àÇŒ±
" class="math-display"  /></center></td><td class="equation-label">(13)</td></tr></table>
<!--l. 194--><p class="nopar" >
DeÔ¨Åne the following coordinates transform (guiding-center transform):
                                                                                

                                                                                
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-3012r14"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation15x.png" alt="(
|| X = x‚Ä≤ + v‚ä•-siŒ©nŒ±,
|||| Y = y‚Ä≤ ‚àí v‚ä•cŒ©osŒ±,
||{ Z = z‚Ä≤,
  Œ±‚Ä≤ = Œ±,
|||| v‚Ä≤‚à• = v‚à•,
|||| v‚Ä≤‚ä• = v‚ä•,
( t‚Ä≤ = t
" class="math-display"  /></center></td><td class="equation-label">(14)</td></tr></table>
<!--l. 206--><p class="nopar" >
Next, we express the partial derivatives of <span 
class="cmmi-10">f </span>appearing in Eq. (<a 
href="#x1-3011r13">13<!--tex4ht:ref: 22-11-16-1 --></a>) in terms of the guiding-center
coordinates. Using the chain rule, we obtain
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation16x.png" alt="                                              ‚Ä≤
-‚àÇf = ‚àÇf-‚àÇX- + ‚àÇf-‚àÇY-+ ‚àÇf-‚àÇZ- + ‚àÇf-‚àÇŒ±‚Ä≤ + ‚àÇf-‚àÇv‚à• + ‚àÇf-‚àÇv-‚Ä≤‚ä•+  ‚àÇf‚àÇt‚Ä≤
‚àÇ Œ±   ‚àÇX ‚àÇŒ±    ‚àÇY ‚àÇŒ±   ‚àÇZ ‚àÇ Œ±   ‚àÇŒ±‚Ä≤‚àÇŒ±    ‚àÇv‚Ä≤‚à•‚àÇŒ±    ‚àÇv‚Ä≤‚ä• ‚àÇŒ±    ‚àÇt‚Ä≤‚àÇ Œ±
      ‚àÇf ‚àÇX    ‚àÇf ‚àÇY    ‚àÇf
    = ‚àÇX-‚àÇŒ±- + ‚àÇY-‚àÇŒ±-+ ‚àÇŒ±-‚Ä≤
      ‚àÇf v  cosŒ±    ‚àÇf v sin Œ±   ‚àÇf
    = --‚Ä≤-‚ä•-----+ ---‚Ä≤‚ä•------+ --‚Ä≤.                                  (15)
      ‚àÇx    Œ©     ‚àÇy    Œ©      ‚àÇŒ±
" class="math-display"  /></center>
</div>Similarly, for other derivatives, we obtain
   <table 
class="equation"><tr><td><a 
 id="x1-3014r16"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation17x.png" alt="‚àÇf-= ‚àÇf,
‚àÇt   ‚àÇt‚Ä≤
" class="math-display"  /></center></td><td class="equation-label">(16)</td></tr></table>
<!--l. 232--><p class="nopar" >
and </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation18x.png" alt="‚àÇf    ‚àÇf ‚àÇX    ‚àÇf ‚àÇY   ‚àÇf ‚àÇZ    ‚àÇf ‚àÇŒ±‚Ä≤   ‚àÇf ‚àÇv‚Ä≤‚à•   ‚àÇf  ‚àÇv‚Ä≤   ‚àÇf ‚àÇt‚Ä≤
‚àÇz‚Ä≤ = ‚àÇX-‚àÇz‚Ä≤ + ‚àÇY-‚àÇz‚Ä≤ + ‚àÇZ-‚àÇz‚Ä≤ + ‚àÇŒ±‚Ä≤‚àÇz‚Ä≤ + ‚àÇv‚Ä≤‚àÇz‚Ä≤ + ‚àÇv‚Ä≤-‚àÇz‚ä•‚Ä≤-+ ‚àÇt‚Ä≤‚àÇz-‚Ä≤
                                           ‚à•        ‚ä•
    ‚âà ‚àÇf-√ó 0 + ‚àÇf-√ó 0+ -‚àÇf,                                          (17)
      ‚àÇX       ‚àÇY      ‚àÇZ
" class="math-display"  /></center>
</div>where we have assumed that the dependence of <span 
class="cmmi-10">X </span>and <span 
class="cmmi-10">Y </span>on <span 
class="cmmi-10">z</span><span 
class="cmsy-10">‚Ä≤ </span>(via <span 
class="cmmi-10">Œ©</span>) is weak enough to be neglected.
And also <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation19x.png" alt="‚àÇf-   ‚àÇf-‚àÇX-   ‚àÇf-‚àÇY-  ‚àÇf-‚àÇZ-   ‚àÇf-‚àÇŒ±‚Ä≤   ‚àÇf-‚àÇv‚Ä≤‚à•   ‚àÇf--‚àÇv‚Ä≤‚ä•-  ‚àÇf-‚àÇt‚Ä≤
‚àÇx‚Ä≤ = ‚àÇX ‚àÇx‚Ä≤ + ‚àÇY ‚àÇx‚Ä≤ + ‚àÇZ ‚àÇx‚Ä≤ + ‚àÇŒ±‚Ä≤‚àÇx‚Ä≤ + ‚àÇv‚Ä≤‚àÇx‚Ä≤ + ‚àÇv‚Ä≤ ‚àÇx‚Ä≤ + ‚àÇt‚Ä≤‚àÇx‚Ä≤
                                           ‚à•        ‚ä•
   =  ‚àÇf-‚àÇX‚Ä≤ + ‚àÇf-‚àÇY‚Ä≤
      ‚àÇX ‚àÇx    ‚àÇY ‚àÇx
   ‚âà  ‚àÇf-√ó 1+  ‚àÇf-√ó 0,                                               (18)
      ‚àÇX       ‚àÇY
" class="math-display"  /></center>
</div>
   <table 
class="equation"><tr><td><a 
 id="x1-3017r19"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation20x.png" alt=" ‚àÇf   ‚àÇf
‚àÇy-‚Ä≤ ‚âà ‚àÇY
" class="math-display"  /></center></td><td class="equation-label">(19)</td></tr></table>
<!--l. 264--><p class="nopar" >
Using the above results, ¬†equation (<a 
href="#x1-3011r13">13<!--tex4ht:ref: 22-11-16-1 --></a>) in the guiding-center coordinates is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-3018r20"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation21x.png" alt="                                       (                            )
‚àÇf-+ v‚Ä≤‚à• ‚àÇf-+ v‚Ä≤‚ä•cosŒ±‚Ä≤ ‚àÇf +v‚Ä≤‚ä• sin Œ±‚Ä≤ ‚àÇf-‚àí Œ© -‚àÇf v‚ä•cosŒ±-+ ‚àÇf-v‚ä•-sinŒ±-+ -‚àÇf  = 0.
‚àÇt‚Ä≤     ‚àÇZ          ‚àÇX           ‚àÇY      ‚àÇX    Œ©      ‚àÇY    Œ©     ‚àÇŒ± ‚Ä≤
" class="math-display"  /></center></td><td class="equation-label">(20)</td></tr></table>
<!--l. 274--><p class="nopar" >
Here we Ô¨Ånd some terms cancel each other, giving
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-3019r21"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation22x.png" alt="‚àÇf     ‚àÇf     ( ‚àÇf)
‚àÇt‚Ä≤-+ v‚Ä≤‚à•‚àÇZ-‚àí Œ©  ‚àÇŒ±-‚Ä≤ = 0.
" class="math-display"  /></center></td><td class="equation-label">(21)</td></tr></table>
<!--l. 280--><p class="nopar" >
Equation (<a 
href="#x1-3019r21">21<!--tex4ht:ref: 22-11-16-3 --></a>) is the equation for <span 
class="cmmi-10">f </span>in the guiding-center coordinates (<span 
class="cmmi-10">X,Y,Z,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,Œ±</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚Ä≤</span>).
                                                                                

                                                                                
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-40001.2"></a>Gyro-averaging</h5>
<!--l. 286--><p class="noindent" >DeÔ¨Åne gyro-phase averaging operator
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-4001r22"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation23x.png" alt="          ‚àí1‚à´ 2œÄ      ‚Ä≤
‚ü®...‚ü© ‚â° (2œÄ)     (...)dŒ± .
             0
" class="math-display"  /></center></td><td class="equation-label">(22)</td></tr></table>
<!--l. 290--><p class="nopar" >
Then averaging Eq. (<a 
href="#x1-3019r21">21<!--tex4ht:ref: 22-11-16-3 --></a>) over <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤</span>, we get
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-4002r23"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation24x.png" alt="‚àÇ‚ü®f‚ü©    ‚àÇ‚ü®f‚ü©        ‚à´ 2œÄ  ( ‚àÇf )
--‚Ä≤-+ v‚Ä≤‚à•---- ‚àí (2œÄ)‚àí1   Œ©   --‚Ä≤  dŒ±‚Ä≤ = 0.
 ‚àÇt      ‚àÇZ           0     ‚àÇŒ±
" class="math-display"  /></center></td><td class="equation-label">(23)</td></tr></table>
<!--l. 297--><p class="nopar" >
As is assumed above, <span 
class="cmmi-10">Œ© </span>is approximately independent of <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤ </span>and thus <span 
class="cmmi-10">Œ© </span>in Eq. (<a 
href="#x1-4002r23">23<!--tex4ht:ref: 22-12-6-1 --></a>) can be moved
outside of the gyro-angle integration, giving
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-4003r24"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation25x.png" alt="                      ‚à´ 2œÄ(    )
‚àÇ‚ü®f‚ü©‚Ä≤ + v‚Ä≤‚à•‚àÇ‚ü®f‚ü© ‚àí Œ©(2œÄ)‚àí1     ‚àÇf‚Ä≤  dŒ±‚Ä≤ = 0.
 ‚àÇt      ‚àÇZ            0    ‚àÇŒ±
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(24)</td></tr></table>
<!--l. 306--><p class="nopar" >
Peforming the integration, we get
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-4004r25"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation26x.png" alt="‚àÇ‚ü®f‚ü©   ‚Ä≤‚àÇ‚ü®f‚ü©       ‚àí 1   ‚Ä≤          ‚Ä≤
‚àÇt‚Ä≤ + v‚à• ‚àÇZ ‚àí Œ© (2œÄ) [f(Œ± = 2œÄ)‚àí f (Œ±  = 0)] = 0.
" class="math-display"  /></center></td><td class="equation-label">(25)</td></tr></table>
<!--l. 312--><p class="nopar" >
Since <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤ </span>= 2<span 
class="cmmi-10">œÄ </span>and <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤ </span>= 0 correspond to the same phase space location, the corresponding values of the
distribution function must be equal. Then the above equation reduces to
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-4005r26"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation27x.png" alt="‚àÇ‚ü®f-‚ü©   ‚Ä≤‚àÇ‚ü®f‚ü©
‚àÇt‚Ä≤ + v‚à•‚àÇZ  = 0,
" class="math-display"  /></center></td><td class="equation-label">(26)</td></tr></table>
<!--l. 319--><p class="nopar" >
which is an equation for the gyro-angle independent part of the distribution function.
</p><!--l. 323--><p class="indent" >   Next let us investigate whether the guiding-center transform can be made use of to simplify
the kinetic equation for more general cases where we have a (weakly) non-uniform static
magnetic Ô¨Åeld, plus electromagnetic perturbations of low frequency (and of small amplitude and
<span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">i</span></sub> <span 
class="cmsy-10">‚â™ </span>1). And we will include the eÔ¨Äect that <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> depends on <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤</span>, i.e., grad-B and curvature
drift.
</p><!--l. 331--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-50002"></a>Transform Vlasov equation from particle coordinates to guiding-center coordinates</h3>
<!--l. 333--><p class="noindent" >Next, we deÔ¨Åne the guiding-center transform and then transform the Vlasov equation from the particle
coordinates (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) to the guiding-center coordinates, i.e., express the gradient operators <span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">x </span>and <span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">v</span>
in terms of the guiding-center coordinates.
                                                                                

                                                                                
</p><!--l. 339--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-60002.1"></a>Guiding-center transformation</h4>
<!--l. 341--><p class="noindent" >In a magnetic Ô¨Åeld, given a particle location and velocity (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), we know how to calculate its
guiding-center location <span 
class="cmbx-10">X</span>, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-6001r27"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation28x.png" alt="            e‚à•(x)-
X = x + v √ó Œ©(x),
" class="math-display"  /></center></td><td class="equation-label">(27)</td></tr></table>
<!--l. 347--><p class="nopar" >
where <span 
class="cmmib-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àïB</span><sub><span 
class="cmr-7">0</span></sub>, <span 
class="cmmi-10">Œ© </span>= <span 
class="cmmi-10">qB</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àïm</span>, <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) is the equilibrium (macroscopic) magnetic Ô¨Åeld at the
particle position. We will consider Eq. (<a 
href="#x1-6001r27">27<!--tex4ht:ref: 16-9-21-1 --></a>) as a transform and call it guiding-center transform<span class="cite">[<a 
href="#XCatto1978">1</a>]</span>. Note
that the transform (<a 
href="#x1-6001r27">27<!--tex4ht:ref: 16-9-21-1 --></a>) involves both position and velocity of particles.
</p><!--l. 355--><p class="indent" >   Given (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), it is straightforward to obtain <span 
class="cmbx-10">X </span>by using Eq. (<a 
href="#x1-6001r27">27<!--tex4ht:ref: 16-9-21-1 --></a>). On the other hand, the inverse
transform (i.e., given (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), to Ô¨Ånd <span 
class="cmbx-10">x</span>) is in principle not easy because <span 
class="cmmi-10">Œ© </span>and <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub> depend on
<span 
class="cmbx-10">x</span>, which usually requires solving a nonlinear equation for its root. Numerically, one can
use
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-6002r28"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation29x.png" alt="               e (xn)
xn+1 = X ‚àí v√ó  -‚à•---,
               Œ©(xn)
" class="math-display"  /></center></td><td class="equation-label">(28)</td></tr></table>
<!--l. 364--><p class="nopar" >
as an iteration scheme to compute <span 
class="cmbx-10">x</span>, with the initial guess chosen as <span 
class="cmbx-10">x</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmbx-10">X</span>. If we stop at the Ô¨Årst
iteration, then
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-6003r29"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation30x.png" alt="           e‚à•(X )
x ‚âà X ‚àí v√ó -Œ©(X-).
" class="math-display"  /></center></td><td class="equation-label">(29)</td></tr></table>
<!--l. 370--><p class="nopar" >
In gyrokinetic PIC simulation, Eq. (<a 
href="#x1-6003r29">29<!--tex4ht:ref: 19-1-19-p2 --></a>) is used as the inverse guiding-center transformation. This
transformation needs to be performed numerically when we deposit markers to grids, or when we
calculate the gyro-averaged Ô¨Åeld to be used in pushing guiding-centers.
</p><!--l. 376--><p class="indent" >   [The equilibrium magnetic Ô¨Åeld we will consider has spatial scale length much larger than the
thermal gyro radius <span 
class="cmmi-10">œÅ</span>. In this case the diÔ¨Äerence between the values of <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">x</span>)<span 
class="cmmi-10">‚àïŒ©</span>(<span 
class="cmbx-10">x</span>) and <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">X</span>)<span 
class="cmmi-10">‚àïŒ©</span>(<span 
class="cmbx-10">X</span>) is
negligible. The diÔ¨Äerence between equilibrium Ô¨Åeld values evaluated at <span 
class="cmbx-10">X </span>and <span 
class="cmbx-10">x </span>is usually neglected in
gyrokinetic theory (except in deriving the gradient/curvature drift). Therefore it does not matter
whether the above <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïŒ© </span>is evaluated at <span 
class="cmbx-10">x </span>or <span 
class="cmbx-10">X</span>. What matters is where the perturbed Ô¨Åelds are
evaluated: at <span 
class="cmbx-10">x </span>or at <span 
class="cmbx-10">X</span>. The values of perturbed Ô¨Åelds at <span 
class="cmbx-10">x </span>or at <span 
class="cmbx-10">X </span>are diÔ¨Äerent and this is called the
Ô¨Ånite Larmor radius (FLR) eÔ¨Äect.]
</p><!--l. 389--><p class="indent" >   For later use, deÔ¨Åne <span 
class="cmmib-10">œÅ</span> <span 
class="cmsy-10">‚â°‚àí</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïŒ©</span>, which is the vector gyro-radius pointing from the the
guiding-center to the particle position.
</p><!--l. 393--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-70002.2"></a>Choosing velocity coordinates</h4>
<!--l. 395--><p class="noindent" >The guiding-center transformations (<a 
href="#x1-6001r27">27<!--tex4ht:ref: 16-9-21-1 --></a>) and (<a 
href="#x1-6003r29">29<!--tex4ht:ref: 19-1-19-p2 --></a>) involve the particle velocity <span 
class="cmbx-10">v</span>. It is the cross product
between <span 
class="cmbx-10">v </span>and <span 
class="cmmib-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">x</span>) or <span 
class="cmmib-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">X</span>) that is actually used. Therefore, only the perpendicular velocity (which
is deÔ¨Åned by <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>) enters the transform. A natural choice of coordinates for the
perpendicular velocity is (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span>), where <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmsy-10">|</span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">| </span>and <span 
class="cmmi-10">Œ± </span>is the azimuthal angle of the perpendicular
velocity in the local perpendicular plane.
</p><!--l. 406--><p class="indent" >   The parallel direction is fully determined by <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>), but there are degrees of freedom in choosing one
of the two perpendicular basis vectors. In order to make the azimuthal angle <span 
class="cmmi-10">Œ± </span>fully deÔ¨Åned, we need to
choose a way to deÔ¨Åne one of the two perpendicular directions. In <span 
class="cmtt-10">GEM</span> simulations, one of the
perpendicular direction is chosen as the direction perpendicular to the magnetic surface, which is fully
determined at each spatial point. (We need to deÔ¨Åne the perpendicular direction at each spatial
location to make <span 
class="cmmi-10">‚àÇŒ±‚àï‚àÇ</span><span 
class="cmbx-10">x</span><span 
class="cmsy-10">|</span><sub><span 
class="cmbx-7">v</span></sub> deÔ¨Åned, which is needed in the Vlasov diÔ¨Äerential operators. However, it
seems that terms related to <span 
class="cmmi-10">‚àÇŒ±‚àï‚àÇ</span><span 
class="cmbx-10">x</span><span 
class="cmsy-10">|</span><sub><span 
class="cmbx-7">v</span></sub> are Ô¨Ånally dropped due to that they are of higher
order**check.)
</p><!--l. 419--><p class="indent" >   In the following, <span 
class="cmmi-10">Œ± </span>will be called the ‚Äúgyro-angle‚Äù . [Note that, in the guiding-center coordinates
(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span>), <span 
class="cmmi-10">Œ± </span>is a velocity coordinate rather than a spatial coordinate. When transformed back to
particle coordinates, <span 
class="cmmi-10">Œ± </span>aÔ¨Äects both the velocity coordinate and the spatial coordinate. Consider a
series of points in terms of guiding-center coordinates (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span>) with (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>) Ô¨Åxed
but with <span 
class="cmmi-10">Œ± </span>changing. Using the inverse guiding-center transform (<a 
href="#x1-6003r29">29<!--tex4ht:ref: 19-1-19-p2 --></a>), we know that the
above points form a gyro-ring in space, i.e., <span 
class="cmmi-10">Œ± </span>inÔ¨Çuences spatial location, in addtion to
velocity.]
                                                                                

                                                                                
</p><!--l. 430--><p class="indent" >   The gyro-angle is an important variable we will stick to because we need to directly perform
averaging over this variable (with <span 
class="cmbx-10">X </span>Ô¨Åxed) in deriving the gyrokinetic equation. We have multiple
options for the remaining velocity coordinates , such as ¬†(<span 
class="cmmi-10">v,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>), or (<span 
class="cmmi-10">v,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>), or (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>). In
Frieman-Chen‚Äôs paper, the velocity coordinates other than <span 
class="cmmi-10">Œ± </span>are chosen to be (<span 
class="cmmi-10">ùúÄ,Œº</span>) deÔ¨Åned
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-7001r30"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation31x.png" alt="             2
ùúÄ = ùúÄ(v,x) ‚â° v-+ qŒ¶0-(x),
            2     m
" class="math-display"  /></center></td><td class="equation-label">(30)</td></tr></table>
<!--l. 440--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-7002r31"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation32x.png" alt="               v2
Œº = Œº(v‚ä•,x) ‚â° 2B-‚ä•(x),
               0
" class="math-display"  /></center></td><td class="equation-label">(31)</td></tr></table>
<!--l. 445--><p class="nopar" >
where <span 
class="cmmi-10">Œ¶</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) is the equilibrium (macroscopic) electrical potential. Choosing <span 
class="cmmi-10">Œº </span>as one of the phase
space coordinates is nontrivial because it turns out a constant of motion. And this choice
seems to be important in sucessfully getting the Ô¨Ånal gyrokinetic equation (I need to check
this).
</p><!--l. 452--><p class="indent" >   Note that (<span 
class="cmmi-10">ùúÄ,Œº,Œ±</span>) is not suÔ¨Écient in uniquely determining a velocity vector. An additional
parameter <span 
class="cmmi-10">œÉ </span>= sign(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) is needed to determine the sign of <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>. In the following, the dependence
of the distribution function on <span 
class="cmmi-10">œÉ </span>is often not explicitly shown in the variable list (i.e., <span 
class="cmmi-10">œÉ </span>is
hidden/suppressed), which, however, does not mean that the distribution function is independent of
<span 
class="cmmi-10">œÉ</span>.
</p><!--l. 460--><p class="indent" >   Another frequently used velocity coordinates are (<span 
class="cmmi-10">Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>). In the following, I will derive
the gyrokinetic equation in (<span 
class="cmmi-10">ùúÄ,Œº,Œ±</span>) coordinates. After that, I transform it to (<span 
class="cmmi-10">Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>)
coordinates.
                                                                                

                                                                                
</p><!--l. 465--><p class="indent" >   One important thing to note about the above velocity coordinates is that they are deÔ¨Åned relative
to the local magnetic Ô¨Åeld. If the Ô¨Åeld itself is spatially varying (such as in tokamaks), the above
velocity coordinates are also spatially varying for a Ô¨Åxed velocity <span 
class="cmbx-10">v</span>. SpeciÔ¨Åcally, the following
derivatives are nonzero:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-7003r32"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation33x.png" alt="‚àÇŒ±-  ‚àÇv‚ä•-  ‚àÇv‚à•   ‚àÇŒº-
‚àÇx|v, ‚àÇx |v, ‚àÇx |v,‚àÇx |v.
" class="math-display"  /></center></td><td class="equation-label">(32)</td></tr></table>
<!--l. 476--><p class="nopar" >
</p><!--l. 478--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-80002.3"></a>Summary of the phase-space coordinate transform</h4>
<!--l. 480--><p class="noindent" >The transform from particle variables (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) to guiding-center variables (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,Œ±,œÉ</span>) is given
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-8001r33"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation34x.png" alt="(             e‚à•(x)
|||| X = x + v√ó  Œ©(x)-
||{ ùúÄ = |v|22+ qŒ¶0m(x)
  Œº = |v‚àí-v‚ãÖe‚à•(x)|2
||||       2B0(x)
||( Œ± = (anglebetweenv‚ä• and locale‚ä•)
  œÉ = sign(v‚ãÖe‚à•(x))
" class="math-display"  /></center></td><td class="equation-label">(33)</td></tr></table>
<!--l. 496--><p class="nopar" >
As mentioned above, the dependence of the distribution function on <span 
class="cmmi-10">œÉ </span>will not be explicitly indicated in
the following.
                                                                                

                                                                                
</p><!--l. 500--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-90002.4"></a>Distribution function in terms of guiding-center variables</h4>
<!--l. 502--><p class="noindent" >Denote the particle distribution function expressed in particle coordinates (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) by <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">p</span></sub>, and the same
distribution expressed in the guiding-center variables (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,Œ±</span>) by <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub>. Then
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-9001r34"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation35x.png" alt="f (X, ùúÄ,Œº,Œ±) = f (x,v),
 g             p
" class="math-display"  /></center></td><td class="equation-label">(34)</td></tr></table>
<!--l. 509--><p class="nopar" >
where (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) and (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,Œ±</span>) are related to each other by the guiding-center transform (<a 
href="#x1-6003r29">29<!--tex4ht:ref: 19-1-19-p2 --></a>).
Equation (<a 
href="#x1-9001r34">34<!--tex4ht:ref: 17-8-19-p1 --></a>) along the guiding-center transform can be considered as the deÔ¨Ånition of
<span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub>.
</p><!--l. 515--><p class="indent" >   As is conventionally adopted in multi-variables calculus, both <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">p</span></sub> and <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub> are often denoted by the
same symbol, say <span 
class="cmmi-10">f</span>. Which set of independent variables are actually assumed is inferred from the
context. This is one subtle thing for gyrokinetic theory in particular and for multi-variables calculus in
general. (Sometimes, it may be better to use subscript notation on <span 
class="cmmi-10">f </span>to identify which
coordinates are assumed. One example where this distinguishing is important is encountered
when we try to express the diamagnetic Ô¨Çow in terms of <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub>, which is discussed in Appendix
<a 
href="#x1-78000G">G<!--tex4ht:ref: 17-8-19-e1 --></a>.)
</p><!--l. 525--><p class="indent" >   In practice, <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub> is often called the guiding-center distribution function whereas <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">p</span></sub> is called the
particle distribution function. However, they are actually the same distribution function expressed in
diÔ¨Äerent variables. The name ‚Äúguiding-center distribution function‚Äù is misleading because it may imply
that we can count the number of guiding-centers to obtain this distribution function but this
implication is wrong.
</p><!--l. 532--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5   </span> <a 
 id="x1-100002.5"></a>Spatial gradient operator in guiding-center coordinates</h4>
<!--l. 534--><p class="noindent" >Using the chain-rule, the spatial gradient <span 
class="cmmi-10">‚àÇf</span><sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">x </span>is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-10001r35"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation36x.png" alt="‚àÇfp     ‚àÇX  ‚àÇfg   ‚àÇùúÄ ‚àÇfg  ‚àÇ Œº‚àÇfg   ‚àÇŒ± ‚àÇfg
‚àÇx-|v = ‚àÇx-‚ãÖ‚àÇX- + ‚àÇx-‚àÇùúÄ-+ ‚àÇx-‚àÇ-Œº + ‚àÇx-‚àÇŒ±-.
" class="math-display"  /></center></td><td class="equation-label">(35)</td></tr></table>
<!--l. 544--><p class="nopar" >
From the deÔ¨Ånition of <span 
class="cmbx-10">X</span>, Eq. (<a 
href="#x1-6001r27">27<!--tex4ht:ref: 16-9-21-1 --></a>), we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-10002r36"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation37x.png" alt="                (  )
‚àÇX- = I+ v √ó ‚àÇ-- e‚à•  ,
 ‚àÇx          ‚àÇx  Œ©
" class="math-display"  /></center></td><td class="equation-label">(36)</td></tr></table>
<!--l. 550--><p class="nopar" >
where <span 
class="cmbx-10">I </span>is the unit dyad. From the deÔ¨Ånition of <span 
class="cmmi-10">ùúÄ</span>, we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-10003r37"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation38x.png" alt="‚àÇùúÄ     q
‚àÇx-= ‚àí m-E0,
" class="math-display"  /></center></td><td class="equation-label">(37)</td></tr></table>
<!--l. 556--><p class="nopar" >
where <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">‚àÇŒ¶</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">x</span>. Using the above results, equation (<a 
href="#x1-10001r35">35<!--tex4ht:ref: 16-9-17-e1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-10004r38"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation39x.png" alt="‚àÇf      ‚àÇf   [     ‚àÇ (e ) ] ‚àÇf    q   ‚àÇf    ‚àÇŒº ‚àÇf    ‚àÇŒ±‚àÇf
--p |v = --g+  v √ó --- -‚à•   ‚ãÖ--g ‚àí --E0--g + -----g+  ----g .
 ‚àÇx     ‚àÇX        ‚àÇx   Œ©    ‚àÇX    m    ‚àÇùúÄ   ‚àÇx ‚àÇŒº    ‚àÇx ‚àÇŒ±
" class="math-display"  /></center></td><td class="equation-label">(38)</td></tr></table>
<!--l. 569--><p class="nopar" >
As mentioned above, the partial derivative <span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">x </span>is taken by holding <span 
class="cmbx-10">v </span>constant. Since <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> is
spatially varying, <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> is spatially varying when holding <span 
class="cmbx-10">v </span>constant. Therefore <img 
src="nonlinear_gyrokinetic_equation40x.png" alt="‚àÇŒº
‚àÇx-"  class="frac" align="middle" /> and <img 
src="nonlinear_gyrokinetic_equation41x.png" alt="‚àÇŒ±
‚àÇx"  class="frac" align="middle" /> are
generally nonzero. The explicit expressions of these two derivatives are needed later in the
derivation of the gyrokinetic equation and is discussed in Appendix <a 
href="#x1-89000J">J<!--tex4ht:ref: 21-8-25-p1 --></a>. For notation ease,
deÔ¨Åne
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-10005r39"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation42x.png" alt="      [       (e ) ]
ŒªB1 =  v √ó -‚àÇ- -‚à•   ‚ãÖ-‚àÇ-,
           ‚àÇx  Œ©     ‚àÇX
" class="math-display"  /></center></td><td class="equation-label">(39)</td></tr></table>
<!--l. 583--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-10006r40"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation43x.png" alt="      ‚àÇŒº ‚àÇ    ‚àÇŒ± ‚àÇ
ŒªB2 = -----+  -----,
      ‚àÇx ‚àÇŒº   ‚àÇx‚àÇ Œ±
" class="math-display"  /></center></td><td class="equation-label">(40)</td></tr></table>
<!--l. 589--><p class="nopar" >
then expression (<a 
href="#x1-10004r38">38<!--tex4ht:ref: 22-9-24-p1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-10007r41"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation44x.png" alt="‚àÇfp|v = ‚àÇfg + [ŒªB1 + ŒªB2]fg ‚àí-qE0 ‚àÇfg.
‚àÇx      ‚àÇX                 m    ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(41)</td></tr></table>
<!--l. 596--><p class="nopar" >
Note that <span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">X </span>is a shorthand for
</p>
   <table 
class="equation-star"><tr><td>
                                    <img 
src="nonlinear_gyrokinetic_equation45x.png" alt="‚àÇ--
‚àÇX"  class="frac" align="middle" /><span 
class="cmsy-10">|</span><sub><span 
class="cmmi-7">ùúÄ,Œº,Œ±</span></sub>
</td></tr></table>
<!--l. 599--><p class="nopar" >
i.e., it is taken by holding (<span 
class="cmmi-10">ùúÄ,Œº,Œ±</span>) constant (rather than holding <span 
class="cmbx-10">v </span>constant). For notation ease, <span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">X</span>
is sometimes denoted by <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">X</span></sub> or simply <span 
class="cmsy-10">‚àá</span>.
</p><!--l. 604--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.6   </span> <a 
 id="x1-110002.6"></a>Velocity gradient operator in guiding-center coordinates</h4>
<!--l. 606--><p class="noindent" >Next, let us express the velocity gradient <span 
class="cmmi-10">‚àÇf‚àï‚àÇ</span><span 
class="cmbx-10">v </span>in terms of the guiding-center variables. Using the
chain rule, <span 
class="cmmi-10">‚àÇf‚àï‚àÇ</span><span 
class="cmbx-10">v </span>is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-11001r42"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation46x.png" alt="‚àÇfp| =  ‚àÇX-‚ãÖ ‚àÇfg + ‚àÇùúÄ-‚àÇfg+ ‚àÇ-Œº‚àÇfg + ‚àÇŒ±-‚àÇfg.
‚àÇv  x   ‚àÇv  ‚àÇX    ‚àÇv ‚àÇùúÄ   ‚àÇv ‚àÇ Œº   ‚àÇv ‚àÇŒ±
" class="math-display"  /></center></td><td class="equation-label">(42)</td></tr></table>
<!--l. 617--><p class="nopar" >
From the deÔ¨Ånition of <span 
class="cmbx-10">X</span>, we obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation47x.png" alt="         (      )
‚àÇX-   ‚àÇ-- v-√ó-e‚à•
‚àÇv =  ‚àÇv    Œ©
      ‚àÇv   e‚à•
   =  ‚àÇv-√ó Œ©-
         e‚à•
   = I √ó Œ©-.                                 (43)
" class="math-display"  /></center>
</div>From the deÔ¨Ånition of <span 
class="cmmi-10">ùúÄ</span>, we obtain
   <table 
class="equation"><tr><td><a 
 id="x1-11003r44"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation48x.png" alt="‚àÇ ùúÄ
‚àÇv-= v,
" class="math-display"  /></center></td><td class="equation-label">(44)</td></tr></table>
<!--l. 630--><p class="nopar" >
From the deÔ¨Ånition of <span 
class="cmmi-10">Œº</span>, we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-11004r45"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation49x.png" alt="‚àÇ-Œº = v‚ä•,
‚àÇv    B0
" class="math-display"  /></center></td><td class="equation-label">(45)</td></tr></table>
<!--l. 634--><p class="nopar" >
From the deÔ¨Ånition of <span 
class="cmmi-10">Œ±</span>, we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-11005r46"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation50x.png" alt="        (       )
‚àÇŒ±-= -1- e‚à• √ó v‚ä•- =  eŒ±,
‚àÇv   v‚ä•       v‚ä•     v‚ä•
" class="math-display"  /></center></td><td class="equation-label">(46)</td></tr></table>
<!--l. 640--><p class="nopar" >
where <span 
class="cmbx-10">e</span><sub><span 
class="cmmi-7">Œ±</span></sub> is deÔ¨Åned by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-11006r47"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation51x.png" alt="e  = e √ó  v‚ä•.
 Œ±    ‚à•   v‚ä•
" class="math-display"  /></center></td><td class="equation-label">(47)</td></tr></table>
<!--l. 645--><p class="nopar" >
Using the above results, expression (<a 
href="#x1-11001r42">42<!--tex4ht:ref: 16-9-16-e2 --></a>) is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-11007r48"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation52x.png" alt="‚àÇfp    I√ó-e‚à•- ‚àÇfg    ‚àÇfg   v‚ä•-‚àÇfg  eŒ±-‚àÇfg
‚àÇv |x =   Œ©   ‚ãÖ‚àÇX  + v‚àÇ ùúÄ + B0 ‚àÇŒº + v‚ä• ‚àÇŒ± .
" class="math-display"  /></center></td><td class="equation-label">(48)</td></tr></table>
<!--l. 654--><p class="nopar" >
</p><!--l. 656--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.7   </span> <a 
 id="x1-120002.7"></a>Time derivatives in guiding-center coordinates</h4>
<!--l. 658--><p class="noindent" >In terms of the guiding-center variables, the time partial derivative <span 
class="cmmi-10">‚àÇf</span><sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>appearing in Vlasov
equation is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-12001r49"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation53x.png" alt="‚àÇf       ‚àÇf        ‚àÇX  ‚àÇf    ‚àÇV  ‚àÇf
--p|x,v = --g|X,V + ---‚ãÖ--g + ---‚ãÖ---g,
 ‚àÇt       ‚àÇt       ‚àÇt  ‚àÇX    ‚àÇt   ‚àÇV
" class="math-display"  /></center></td><td class="equation-label">(49)</td></tr></table>
<!--l. 666--><p class="nopar" >
where <span 
class="cmbx-10">V </span>= (<span 
class="cmmi-10">ùúÄ,Œº,Œ±</span>). Here <span 
class="cmmi-10">‚àÇ</span><span 
class="cmbx-10">X</span><span 
class="cmmi-10">‚àï‚àÇt </span>and <span 
class="cmmi-10">‚àÇ</span><span 
class="cmbx-10">V</span><span 
class="cmmi-10">‚àï‚àÇt </span>are not necessarily zero because the equilibrium quantities
involved in the deÔ¨Ånition of the guiding-center transformation are in general time dependent. This time
dependence is assumed to be very slow in the gyrokinetic ordering discussed later. In the following,
<span 
class="cmmi-10">‚àÇ</span><span 
class="cmbx-10">X</span><span 
class="cmmi-10">‚àï‚àÇt </span>and <span 
class="cmmi-10">‚àÇ</span><span 
class="cmbx-10">V</span><span 
class="cmmi-10">‚àï‚àÇt </span>will be dropped, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-12002r50"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation54x.png" alt="‚àÇf    ‚àÇf
--p ‚âà --g.
‚àÇt    ‚àÇt
" class="math-display"  /></center></td><td class="equation-label">(50)</td></tr></table>
<!--l. 676--><p class="nopar" >
                                                                                

                                                                                
</p><!--l. 678--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.8   </span> <a 
 id="x1-130002.8"></a>Final form of Vlasov equation in guiding-center coordinates</h4>
<!--l. 680--><p class="noindent" >Using the above results, the Vlasov equation in guiding-center coordinates is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation55x.png" alt="           [                           ]
   ‚àÇfg+ v ‚ãÖ ‚àÇfg+ [ŒªB1 + ŒªB2]fg ‚àí q-E0‚àÇfg
   ‚àÇt       ‚àÇX  (               m    ‚àÇùúÄ             )
   q-             I√ó-e‚à•- ‚àÇfg    ‚àÇfg  v‚ä•-‚àÇfg   eŒ±-‚àÇfg
+  m(E + v √óB )‚ãÖ    Œ©  ‚ãÖ ‚àÇX + v ‚àÇùúÄ + B0  ‚àÇŒº + v‚ä• ‚àÇŒ±
= 0                                                            (51)
" class="math-display"  /><a 
 id="x1-13001r51"></a></center>
</div>Using tensor identity <span 
class="cmbx-10">a </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmbx-10">I </span><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">b </span>= <span 
class="cmbx-10">a </span><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">b</span>, equation (<a 
href="#x1-13001r51">51<!--tex4ht:ref: 16-9-21-p1 --></a>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation56x.png" alt="          [                            ]
  ‚àÇfg + v‚ãÖ  ‚àÇfg+ [ŒªB1 + ŒªB2 ]fg ‚àí-qE0 ‚àÇfg
   ‚àÇt       ‚àÇX                 m    ‚àÇùúÄ (      )
  -q             (e‚à•)  ‚àÇfg   q-         eŒ±-‚àÇfg
+ m (E + v√ó B )√ó  Œ©   ‚ãÖ‚àÇX  + m (v √ó B) ‚ãÖ v‚ä• ‚àÇŒ±
   q   (  ‚àÇfg  v ‚ä•‚àÇfg   eŒ± ‚àÇfg)
+ m-E ‚ãÖ v ‚àÇùúÄ-+ -B--‚àÇŒº + v--‚àÇŒ±-
                 0       ‚ä•
= 0,                                                        (52)
" class="math-display"  /><a 
 id="x1-13002r52"></a></center>
</div>This is the Vlasov equation in guiding-center coordinates.
<!--l. 716--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-140003"></a><span 
class="cmmi-10">Œ¥f </span>form of Vlasov equation in guiding-center variables</h3>
                                                                                

                                                                                
<!--l. 718--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-150003.1"></a>Electromagnetic Ô¨Åeld perturbation</h4>
<!--l. 720--><p class="noindent" >Since the deÔ¨Ånition of the guiding-center variables (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,Œ±</span>) involves the equilibrium Ô¨Åelds <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> and
<span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub>, to further simplify Eq. (<a 
href="#x1-13002r52">52<!--tex4ht:ref: 16-10-2-p1 --></a>), we need to separate electromagnetic Ô¨Åeld into equilibrium and
perturbation parts. Writing the electromagnetic Ô¨Åeld as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-15001r53"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation57x.png" alt="E = E0 + Œ¥E
" class="math-display"  /></center></td><td class="equation-label">(53)</td></tr></table>
<!--l. 727--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-15002r54"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation58x.png" alt="B = B0 + Œ¥B,
" class="math-display"  /></center></td><td class="equation-label">(54)</td></tr></table>
<!--l. 731--><p class="nopar" >
then substituting these expressions into equation (<a 
href="#x1-13002r52">52<!--tex4ht:ref: 16-10-2-p1 --></a>) and moving all terms involving the Ô¨Åeld
perturbations to the right-hand side, we obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation59x.png" alt="                  [                      ]
  ‚àÇfg + v‚ãÖ ‚àÇfg + v‚ãÖ [Œª  + Œª  ]f ‚àí q-E ‚àÇfg
   ‚àÇt     ‚àÇX         B1    B2 g   m  0 ‚àÇùúÄ
  q-              ( e‚à•)  ‚àÇfg  -q         ( eŒ±‚àÇfg)
+ m (E0 + v √ó B0)√ó  Œ©  ‚ãÖ ‚àÇX + m (v √ó B0)‚ãÖ  v‚ä• ‚àÇŒ±
  q     ( ‚àÇf    v  ‚àÇf    e ‚àÇf  )
+ --E0 ‚ãÖ v---g+ -‚ä•---g + -Œ±---g
  m        ‚àÇùúÄ   B0 ‚àÇ Œº   v‚ä• ‚àÇŒ±
= Œ¥Rfg,                                                      (55)
" class="math-display"  /><a 
 id="x1-15003r55"></a></center>
</div>where <span 
class="cmmi-10">Œ¥R </span>is deÔ¨Åned by <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation60x.png" alt="                       (  )                  (      )
Œ¥R = ‚àí -q(Œ¥E +v √ó Œ¥B) √ó  e‚à•  ‚ãÖ-‚àÇ-‚àí -q(v √ó Œ¥B )‚ãÖ  eŒ±-‚àÇ-
      m     (           Œ©    ‚àÇX  )m            v‚ä•‚àÇ Œ±
      -q       ‚àÇ-- v-‚ä•-‚àÇ-  eŒ±--‚àÇ-
    ‚àí m Œ¥E ‚ãÖ v ‚àÇùúÄ + B0 ‚àÇŒº + v‚ä• ‚àÇŒ± .                            (56)
" class="math-display"  /><a 
 id="x1-15004r56"></a></center>
</div>Next, let us simplify the left-hand side of Eq. (<a 
href="#x1-15003r55">55<!--tex4ht:ref: 16-10-2-p2 --></a>). Note that <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation61x.png" alt="           (       )
 q-          eŒ±-‚àÇfg
 m (v √ó B0)‚ãÖ  v‚ä• ‚àÇŒ±
   q          e‚à• √ó v‚ä• ‚àÇfg
=  m-(v √ó B0)‚ãÖ --v2---‚àÇŒ±-
                 ‚ä•
= ‚àí Œ© ‚àÇfg.                                      (57)
      ‚àÇŒ±
" class="math-display"  /><a 
 id="x1-15005r57"></a></center>
</div>Note that
   <table 
class="equation"><tr><td><a 
 id="x1-15006r58"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation62x.png" alt="       (  )         (       )
-qE0 √ó  e‚à•  ‚ãÖ ‚àÇfg = c E0-√ó-e‚à• ‚ãÖ ‚àÇfg = vE0 ‚ãÖ ‚àÇfg,
m       Œ©    ‚àÇX         B0     ‚àÇX         ‚àÇX
" class="math-display"  /></center></td><td class="equation-label">(58)</td></tr></table>
<!--l. 782--><p class="nopar" >
where <span 
class="cmbx-10">v</span><sub><span 
class="cmbx-7">E</span><span 
class="cmr-7">0</span></sub> is deÔ¨Åned by <span 
class="cmbx-10">v</span><sub><span 
class="cmbx-7">E</span><span 
class="cmr-7">0</span></sub> = <span 
class="cmmi-10">c</span><span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïB</span><sub><span 
class="cmr-7">0</span></sub>, which is the <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> drift. Further note that
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation63x.png" alt="           (e )
q-v-√ó-B0 √ó  -‚à•  ‚ãÖ ‚àÇfg = [(v√ó e‚à•)√ó e‚à•]‚ãÖ ‚àÇfg
m    c      Œ©    ‚àÇX                 ‚àÇX
                     = [v‚à•e‚à• ‚àí v]‚ãÖ ‚àÇfg ,                 (59)
                                ‚àÇX
" class="math-display"  /><a 
 id="x1-15007r59"></a></center>
</div>which can be combined with <span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">‚àÇf</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X </span>term, yielding <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">‚àÇf</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X</span>.
<!--l. 799--><p class="indent" >   Using Eqs. (<a 
href="#x1-15006r58">58<!--tex4ht:ref: 16-10-2-e5 --></a>), ¬†(<a 
href="#x1-15007r59">59<!--tex4ht:ref: 16-10-2-e7 --></a>), and ¬†(<a 
href="#x1-15005r57">57<!--tex4ht:ref: 16-10-2-e9 --></a>), the left-hand side of equation (<a 
href="#x1-15003r55">55<!--tex4ht:ref: 16-10-2-p2 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation64x.png" alt="  ‚àÇfg               ‚àÇfg                      ‚àÇfg
  -‚àÇt + (v‚à•e‚à• + VE0)‚ãÖ-‚àÇX + v ‚ãÖ[ŒªB1 + ŒªB2]fg ‚àí Œ© ‚àÇŒ±
   q    (v  ‚àÇf    e  ‚àÇf )
+ --E0 ‚ãÖ --‚ä•--g + -Œ±---g  ‚â° Lgfg,                           (60)
  m       B0 ‚àÇŒº   v‚ä• ‚àÇŒ±
" class="math-display"  /><a 
 id="x1-15008r60"></a></center>
</div>where <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub> is often called the unperturbed Vlasov propagator in guiding-center coordinates
(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,Œ±</span>).
<!--l. 816--><p class="indent" >   [Equation (<a 
href="#x1-15008r60">60<!--tex4ht:ref: 16-9-22-1b --></a>), corresponds to Eq. (7) in Frieman-Chen‚Äôs paper<span class="cite">[<a 
href="#Xfrieman1982">3</a>]</span>. In Frieman-Chen‚Äôs equation (7),
there is a term
</p>
                                                                                

                                                                                
   <table 
class="equation-star"><tr><td>
                               <img 
src="nonlinear_gyrokinetic_equation65x.png" alt="q-
m"  class="frac" align="middle" />(<span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">mac</span></sub> <span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub>) <span 
class="cmsy-10">‚ãÖ </span><span 
class="cmbx-10">v</span><img 
src="nonlinear_gyrokinetic_equation66x.png" alt="‚àÇ--
‚àÇùúÄ"  class="frac" align="middle" />
</td></tr></table>
<!--l. 819--><p class="nopar" >
where <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">mac</span></sub> is a given macroscopic electric Ô¨Åeld introduced when deÔ¨Åning the guiding-center
transformation. In my derivation ¬†<span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">mac</span></sub> is chosen to be equal to the equilibrium electric Ô¨Åeld, and thus
the above term is zero.]
</p><!--l. 825--><p class="indent" >   Using the above results, Eq. (<a 
href="#x1-15003r55">55<!--tex4ht:ref: 16-10-2-p2 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-15009r61"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation67x.png" alt="Lgfg = Œ¥Rfg,
" class="math-display"  /></center></td><td class="equation-label">(61)</td></tr></table>
<!--l. 828--><p class="nopar" >
i.e. </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation68x.png" alt="‚àÇfg + (v‚à•e‚à• + VE0)‚ãÖ ‚àÇfg‚àí Œ© ‚àÇfg
 ‚àÇt [              ‚àÇX     ‚àÇŒ±          ]
+v ‚ãÖ v √ó -‚àÇ-(e‚à•) ‚ãÖ ‚àÇfg + ‚àÇŒº‚àÇfg + ‚àÇŒ±-‚àÇfg
         ‚àÇx  Œ©    ‚àÇX    ‚àÇx ‚àÇŒº   ‚àÇx ‚àÇŒ±
  q    ( v‚ä• ‚àÇfg   eŒ±‚àÇfg)
+ m-E0 ‚ãÖ B0-‚àÇŒº- + v‚ä•-‚àÇŒ±
                    ( e )                  (      )
= ‚àí q-(Œ¥E + v √ó Œ¥B)√ó   -‚à• ‚ãÖ ‚àÇfg‚àí -q(v√ó Œ¥B )‚ãÖ  eŒ±‚àÇfg
    m  (              Œ©    ‚àÇX ) m            v‚ä• ‚àÇŒ±
‚àí q-Œ¥E ‚ãÖ v‚àÇfg + v‚ä•-‚àÇfg + eŒ±‚àÇfg  .                             (62)
  m        ‚àÇùúÄ   B0 ‚àÇŒº    v‚ä• ‚àÇŒ±
" class="math-display"  /><a 
 id="x1-15010r62"></a></center>
</div>It is instructive to consider some special cases of the above complicated equation. Consider the case
that the equilibrium magnetic Ô¨Åeld <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> is uniform and time-independent, <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> = 0, and the electrostatic
limit <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">B </span>= 0, then equation (<a 
href="#x1-15010r62">62<!--tex4ht:ref: 18-12-16-1 --></a>) is simpliÔ¨Åed as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation69x.png" alt=" ‚àÇf        ‚àÇf      ‚àÇf
 --g+ v‚à•e‚à• ‚ãÖ-g ‚àí Œ© --g
 ‚àÇt        ‚àÇX(e  )  ‚àÇŒ±
= ‚àí q-(Œ¥E)√ó  -‚à•  ‚ãÖ ‚àÇfg                              (63)
    m   (     Œ©   ‚àÇX           )
‚àí q-Œ¥E ‚ãÖ v‚àÇfg + v‚ä•-‚àÇfg + eŒ±‚àÇfg                      (64)
  m        ‚àÇùúÄ   B0 ‚àÇ Œº   v‚ä• ‚àÇŒ±
" class="math-display"  /></center>
</div>If neglecting the <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E </span>perturbation, the above equation reduces to
   <table 
class="equation"><tr><td><a 
 id="x1-15012r65"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation70x.png" alt="‚àÇf         ‚àÇf     ‚àÇf
--g + v‚à•e‚à• ‚ãÖ--g‚àí Œ© --g = 0,
 ‚àÇt        ‚àÇX     ‚àÇ Œ±
" class="math-display"  /></center></td><td class="equation-label">(65)</td></tr></table>
                                                                                

                                                                                
<!--l. 878--><p class="nopar" >
which agrees with Eq. (<a 
href="#x1-3019r21">21<!--tex4ht:ref: 22-11-16-3 --></a>) discussed in Sec. <a 
href="#x1-30001.2">1.2<!--tex4ht:ref: 19-4-23-p1 --></a>.
</p><!--l. 881--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-160003.2"></a>Distribution function perturbation</h4>
<!--l. 883--><p class="noindent" >Expand the distribution function <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub> as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-16001r66"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation71x.png" alt="fg = Fg + Œ¥Fg,
" class="math-display"  /></center></td><td class="equation-label">(66)</td></tr></table>
<!--l. 886--><p class="nopar" >
where <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span></sub> is assumed to be an equilibrium distribution function, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-16002r67"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation72x.png" alt="LgFg = 0.
" class="math-display"  /></center></td><td class="equation-label">(67)</td></tr></table>
<!--l. 890--><p class="nopar" >
Using Eqs. (<a 
href="#x1-16001r66">66<!--tex4ht:ref: 21-8-9-p1 --></a>) and (<a 
href="#x1-16002r67">67<!--tex4ht:ref: 16-10-15-1 --></a>) in Eq. (<a 
href="#x1-15009r61">61<!--tex4ht:ref: 16-9-22-p1 --></a>), we obtain an equation for <span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">g</span></sub>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-16003r68"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation73x.png" alt="Lg Œ¥Fg = Œ¥RFg + Œ¥RŒ¥Fg.
" class="math-display"  /></center></td><td class="equation-label">(68)</td></tr></table>
<!--l. 895--><p class="nopar" >
</p><!--l. 897--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-170003.3"></a>Gyrokinetic ordering</h4>
<!--l. 899--><p class="noindent" >To facilitate the simpliÔ¨Åcation of the Vlasov equation in the low-frequency regime, we assume the
following orderings (some of which are roughly based on experiment measure of Ô¨Çuctuations responsible
for tokamak plasma transport, some of which can be invalid in some interesting cases.) These ordering
are often called the standard gyrokinetic orderings.
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-180003.3"></a>Assumptions for equilibrium quantities</h5>
<!--l. 907--><p class="noindent" >DeÔ¨Åne the spatial scale length <span 
class="cmmi-10">L</span><sub><span 
class="cmr-7">0</span></sub> of equilibrium quantities by <span 
class="cmmi-10">L</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï</span><span 
class="cmsy-10">|‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmsy-10">|</span>. Assume that <span 
class="cmmi-10">L</span><sub><span 
class="cmr-7">0</span></sub> is
much larger than the thermal gyro-radius <span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">i</span></sub> <span 
class="cmsy-10">‚â° </span><span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub><span 
class="cmmi-10">‚àïŒ©</span>, i.e., <span 
class="cmmi-10">Œª </span><span 
class="cmsy-10">‚â° </span><span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmmi-10">‚àïL</span><sub><span 
class="cmr-7">0</span></sub> is a small parameter, where
<span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub> = <img 
src="nonlinear_gyrokinetic_equation74x.png" alt="‚àò -----
  2T ‚àïm"  class="sqrt"  /> is the thermal velocity. That is
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-18001r69"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation75x.png" alt="1--             1
FgœÅi|‚àáXFg | ‚àº O (Œª ),
" class="math-display"  /></center></td><td class="equation-label">(69)</td></tr></table>
<!--l. 914--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-18002r70"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation76x.png" alt="-1-œÅ |‚àá  B | ‚àº O(Œª1).
B0  i  X  0
" class="math-display"  /></center></td><td class="equation-label">(70)</td></tr></table>
<!--l. 918--><p class="nopar" >
The equilibrium <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> Ô¨Çow, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-18003r71"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation77x.png" alt="vE0 = E0 √ó e‚à•‚àïB0 = ‚àí ‚àá Œ¶0 √ó e‚à•‚àïB0,
" class="math-display"  /></center></td><td class="equation-label">(71)</td></tr></table>
<!--l. 923--><p class="nopar" >
is assumed to be weak with
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-18004r72"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation78x.png" alt="|v  |
--E0-‚àº  O(Œª1),
  vt
" class="math-display"  /></center></td><td class="equation-label">(72)</td></tr></table>
<!--l. 927--><p class="nopar" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-190003.3"></a>Assumptions for perturbations</h5>
<!--l. 931--><p class="noindent" >We assume that the amplitudes of perturbations are small. SpeciÔ¨Åcally, we assume
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19001r73"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation79x.png" alt="Œ¥Fg-‚àº qŒ¥Œ¶-‚àº |Œ¥B-|‚àº O (Œª1),
F0     T     B0
" class="math-display"  /></center></td><td class="equation-label">(73)</td></tr></table>
<!--l. 936--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥Œ¶ </span>is the perturbed scalar potential deÔ¨Åned later in Eq. (<a 
href="#x1-19007r79">79<!--tex4ht:ref: 18-3-6-a7 --></a>).
</p><!--l. 940--><p class="indent" >   We consider low frequency perturbations with <span 
class="cmmi-10">œâ‚àïŒ© </span><span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>), then
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19002r74"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation80x.png" alt="-1--1‚àÇŒ¥Fg-      1
Œ¥FgŒ©  ‚àÇt  ‚àº O (Œª ).
" class="math-display"  /></center></td><td class="equation-label">(74)</td></tr></table>
<!--l. 945--><p class="nopar" >
The perturbation is assumed to have a long wavelength (much longer than <span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">i</span></sub>) in the parallel
direction
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19003r75"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation81x.png" alt=" 1
---|œÅie‚à• ‚ãÖ‚àáX Œ¥Fg| ‚àº O(Œª1),
Œ¥Fg
" class="math-display"  /></center></td><td class="equation-label">(75)</td></tr></table>
<!--l. 951--><p class="nopar" >
and have a short wavelength comparable to the thermal gyro-radius in the perpendicular
direction
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19004r76"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation82x.png" alt="-1-|œÅ ‚àá   Œ¥F | ‚àº O(Œª0).
Œ¥Fg  i X‚ä•   g
" class="math-display"  /></center></td><td class="equation-label">(76)</td></tr></table>
<!--l. 957--><p class="nopar" >
[Combining Eq. (<a 
href="#x1-19003r75">75<!--tex4ht:ref: 16-10-9-1 --></a>) and (<a 
href="#x1-19004r76">76<!--tex4ht:ref: 16-10-9-2 --></a>), we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19005r77"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation83x.png" alt="k‚à•-‚âà  e‚à• ‚ãÖ‚àáX-‚àº O(Œª),
k‚ä•     ‚àáX‚ä•
" class="math-display"  /></center></td><td class="equation-label">(77)</td></tr></table>
<!--l. 962--><p class="nopar" >
i.e., the parallel wave number is one order smaller than the perpendicular wave-number.]
</p><!--l. 966--><p class="indent" >   In terms of the scalar and vector potentials <span 
class="cmmi-10">Œ¥Œ¶ </span>and <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span>, the perturbed electromagnetic Ô¨Åeld is
written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19006r78"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation84x.png" alt="Œ¥B = ‚àáx √ó Œ¥A,
" class="math-display"  /></center></td><td class="equation-label">(78)</td></tr></table>
<!--l. 970--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19007r79"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation85x.png" alt="             ‚àÇŒ¥A
Œ¥E = ‚àí ‚àáxŒ¥Œ¶ ‚àí -‚àÇt-.
" class="math-display"  /></center></td><td class="equation-label">(79)</td></tr></table>
<!--l. 975--><p class="nopar" >
Then
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19008r80"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation86x.png" alt="              (    )
Œ¥E‚à• = ‚àí ‚àá‚à•Œ¥Œ¶ ‚àí ‚àÇ-Œ¥A-
                ‚àÇt   ‚à•
" class="math-display"  /></center></td><td class="equation-label">(80)</td></tr></table>
<!--l. 980--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19009r81"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation87x.png" alt="               (‚àÇŒ¥A )
Œ¥E ‚ä• = ‚àí ‚àá ‚ä•Œ¥Œ¶ ‚àí -‚àÇt-   ,
                      ‚ä•
" class="math-display"  /></center></td><td class="equation-label">(81)</td></tr></table>
<!--l. 985--><p class="nopar" >
Using the above orderings, it is ready see that <span 
class="cmmi-10">Œ¥E</span><sub><span 
class="cmsy-7">‚à•</span></sub> is one order smaller than <span 
class="cmmi-10">Œ¥E</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19010r82"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation88x.png" alt="Œ¥E
--‚à•-= O (Œª1).
Œ¥E‚ä•
" class="math-display"  /></center></td><td class="equation-label">(82)</td></tr></table>
<!--l. 990--><p class="nopar" >
Most gyrokinetic simulations approximate the vector potential as <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span><span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>.
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-19011r83"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation89x.png" alt="Œ¥B = ‚àáx √ó (Œ¥A ‚à•e‚à•) ‚âà ‚àáxŒ¥A ‚à• √ó e‚à•.
" class="math-display"  /></center></td><td class="equation-label">(83)</td></tr></table>
<!--l. 997--><p class="nopar" >
We will assume <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">Œ¥Œ¶</span>.
</p><!--l. 1000--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-200003.4"></a>Equation for macroscopic distribution function <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span></sub></h4>
<!--l. 1002--><p class="noindent" >The evolution of the macroscopic quantity <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span></sub> is governed by Eq. (<a 
href="#x1-16002r67">67<!--tex4ht:ref: 16-10-15-1 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-20001r84"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation90x.png" alt="LgFg = 0,
" class="math-display"  /></center></td><td class="equation-label">(84)</td></tr></table>
<!--l. 1006--><p class="nopar" >
where the left-hand side is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation91x.png" alt="       ‚àÇFg   ‚àÇX   ‚àÇFg   ‚àÇV  ‚àÇFg
LgFg = -‚àÇt-+ -‚àÇt ‚ãÖ‚àÇX--+ ‚àÇt-‚ãÖ-‚àÇV-
                    ‚àÇFg                       ‚àÇFg
     + (v‚à•e‚à• + VE0)‚ãÖ ‚àÇX-+ v ‚ãÖ[(ŒªB1 + ŒªB2)Fg]‚àí Œ© ‚àÇŒ±--
       q     (v  ‚àÇF    e  ‚àÇF )
     + --E0 ‚ãÖ -‚ä•----g+ -Œ±---g-
       m      B0  ‚àÇŒº   v‚ä• ‚àÇŒ±
" class="math-display"  /></center>
</div>Expand <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span></sub> as <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span></sub> = <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub> + <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">1</span></sub> + <span 
class="cmmi-10">‚Ä¶</span>., where <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">gi</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmmi-7">i</span></sup>). Then, the balance on order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">0</span></sup>)
gives
   <table 
class="equation"><tr><td><a 
 id="x1-20003r85"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation92x.png" alt="‚àÇF
--g0 = 0
 ‚àÇŒ±
" class="math-display"  /></center></td><td class="equation-label">(85)</td></tr></table>
<!--l. 1025--><p class="nopar" >
i.e., <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub> is independent of the gyro-angle <span 
class="cmmi-10">Œ±</span>. The balance on <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>) gives
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-20004r86"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation93x.png" alt="     ‚àÇF      q    (v  ‚àÇF   )    ‚àÇF
v‚à•e‚à• ‚ãÖ--g0+ --E0 ‚ãÖ --‚ä•---g0  = Œ© ---g1 .
      ‚àÇX    m       B0 ‚àÇŒº        ‚àÇŒ±
" class="math-display"  /></center></td><td class="equation-label">(86)</td></tr></table>
<!--l. 1033--><p class="nopar" >
Performing averaging over <span 
class="cmmi-10">Œ±</span>, <span 
class="cmex-10">‚à´</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmr-7">2</span><span 
class="cmmi-7">œÄ</span></sup>(<span 
class="cmmi-10">‚Ä¶</span>)<span 
class="cmmi-10">dŒ±</span>, on the above equation and noting that <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub> is independent of
<span 
class="cmmi-10">Œ±</span>, we obtain
</p>
                                                                                

                                                                                
   <table 
class="equation"><tr><td><a 
 id="x1-20005r87"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation94x.png" alt="(‚à´ 2œÄ      )  ‚àÇFg0   q-‚àÇFg0‚à´ 2œÄ      ( v‚ä•)   ‚à´ 2œÄ    ‚àÇFg1
  0  dŒ±v‚à•e‚à•  ‚ãÖ‚àÇX   + m  ‚àÇŒº  0  dŒ±E0 ‚ãÖ  B0  =  0  dŒ± Œ© ‚àÇŒ±
" class="math-display"  /></center></td><td class="equation-label">(87)</td></tr></table>
<!--l. 1043--><p class="nopar" >
Note that a quantity <span 
class="cmmi-10">A </span>= <span 
class="cmmi-10">A</span>(<span 
class="cmbx-10">x</span>) that is independent of <span 
class="cmbx-10">v </span>will depend on <span 
class="cmbx-10">v </span>when transformed to
guiding-center coordinates, i.e., <span 
class="cmmi-10">A</span>(<span 
class="cmbx-10">x</span>) = <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>). Therefore <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">g</span></sub> depends on gyro-angle <span 
class="cmmi-10">Œ±</span>. However,
since <span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmmi-10">‚àïL </span><span 
class="cmsy-10">‚â™ </span>1 for equilibrium quantities, the gyro-angle dependence of the equilibrium quantities can
be neglected. SpeciÔ¨Åcally, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>, <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> and <span 
class="cmmi-10">Œ© </span>can be considered to be independent of <span 
class="cmmi-10">Œ±</span>. As to <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>, we have
<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmsy-10">¬±</span><img 
src="nonlinear_gyrokinetic_equation95x.png" alt="‚àò ----------
  2(ùúÄ‚àí B0Œº)"  class="sqrt"  />. Since <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> is considered independent of <span 
class="cmmi-10">Œ±</span>, so does <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>. Using these results, equation
(<a 
href="#x1-20005r87">87<!--tex4ht:ref: 17-5-15-4 --></a>) is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-20006r88"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation96x.png" alt="      ‚àÇF     q ‚àÇF  ‚à´ 2œÄ      ( v )
v‚à•e‚à• ‚ãÖ--g0+ -- --g0    dŒ±E0 ‚ãÖ  -‚ä•- = 0.
      ‚àÇX    m  ‚àÇ Œº  0          B0
" class="math-display"  /></center></td><td class="equation-label">(88)</td></tr></table>
<!--l. 1059--><p class="nopar" >
Using <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmsy-10">‚àí‚àá</span><span 
class="cmmi-10">Œ¶</span><sub><span 
class="cmr-7">0</span></sub>, the above equation is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-20007r89"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation97x.png" alt="                   ‚à´ 2œÄ  (          )
v‚à•e‚à• ‚ãÖ ‚àÇFg0 + q-‚àÇFg0   dŒ±  ‚àí v‚ä•-‚ãÖ‚àá-Œ¶0 = 0,
      ‚àÇX    m  ‚àÇŒº   0         B0
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(89)</td></tr></table>
<!--l. 1066--><p class="nopar" >
Note that
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-20008r90"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation98x.png" alt="‚à´ 2œÄ   -1-
 0  dŒ±B0 v‚ä• ‚ãÖ‚àáX Œ¶0 ‚âà 0,
" class="math-display"  /></center></td><td class="equation-label">(90)</td></tr></table>
<!--l. 1071--><p class="nopar" >
where the error is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>)<span 
class="cmmi-10">Œ¶</span><sub><span 
class="cmr-7">0</span></sub>, and thus, accurate to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>), the last term of equation (<a 
href="#x1-20007r89">89<!--tex4ht:ref: 16-11-16-p1 --></a>) is zero. Then
equation (<a 
href="#x1-20007r89">89<!--tex4ht:ref: 16-11-16-p1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-20009r91"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation99x.png" alt="     ‚àÇFg0
v‚à•e‚à• ‚ãÖ ‚àÇX = 0,
" class="math-display"  /></center></td><td class="equation-label">(91)</td></tr></table>
<!--l. 1078--><p class="nopar" >
which implies that <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub> is constant along a magnetic Ô¨Åeld line.
</p><!--l. 1081--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.5   </span> <a 
 id="x1-210003.5"></a>Equation for <span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">g</span></sub></h4>
<!--l. 1083--><p class="noindent" >Using <span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span></sub> <span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub>, equation (<a 
href="#x1-16003r68">68<!--tex4ht:ref: 16-9-23-p1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-21001r92"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation100x.png" alt="LgŒ¥Fg = Œ¥RFg0 +     Œ¥R Œ¥Fg     ,
               Nonlin‚óüear‚óùT‚óúerm‚óû‚àºO(Œª2)
" class="math-display"  /></center></td><td class="equation-label">(92)</td></tr></table>
<!--l. 1087--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥RŒ¥F</span><sub><span 
class="cmmi-7">g</span></sub> is a nonlinear term which is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) or higher, <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">g</span></sub> and <span 
class="cmmi-10">Œ¥RF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub> are linear terms
which are of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>) or higher. The linear term <span 
class="cmmi-10">Œ¥RF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub> is given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-21002r93"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation101x.png" alt="            (           )   (e  )              (               )
Œ¥RFg0 = ‚àí q- Œ¥E + v-√ó-Œ¥B  √ó  -‚à•  ‚ãÖ ‚àÇFg0 ‚àí q-Œ¥E ‚ãÖ v‚àÇFg0 + v‚ä•-‚àÇFg0 ,
        ‚óü-m----------c‚óù‚óú------Œ©----‚àÇX-‚óû  m‚óü--------‚àÇùúÄ‚óù‚óú--B0--‚àÇŒº--‚óû
                     O(Œª2)                         O(Œª1)
" class="math-display"  /></center></td><td class="equation-label">(93)</td></tr></table>
<!--l. 1101--><p class="nopar" >
In obtaining (<a 
href="#x1-21002r93">93<!--tex4ht:ref: 16-10-15-3 --></a>), use has been made of <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇŒ± </span>= 0. Another linear term <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">g</span></sub> is written as
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation102x.png" alt="L  Œ¥F = ‚àÇ-Œ¥Fg-+ (v e + V   )‚ãÖ ‚àÇŒ¥Fg-+ v‚ãÖ[Œª + Œª   ]Œ¥F  ‚àí Œ©‚àÇ-Œ¥Fg-
  g  g    ‚àÇt     ‚à• ‚à•    E0   ‚àÇX        B1    B2  g   ‚óü-‚àÇ‚óùŒ±‚óú-‚óû
                                                      O(Œª1)
         q    ( v  ‚àÇŒ¥F    e ‚àÇŒ¥F  )
      + --E0 ‚ãÖ  -‚ä•----g+ --Œ±---g- ,                               (94)
        m       B0 ‚àÇ Œº   v‚ä•  ‚àÇŒ±
" class="math-display"  /><a 
 id="x1-21003r94"></a></center>
</div>where <span 
class="cmmi-10">Œ©‚àÇŒ¥F</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï‚àÇŒ±</span> is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>) and all the other terms are of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>).
                                                                                

                                                                                
<!--l. 1118--><p class="indent" >   Next, to reduce the complexity of algebra, we consider the easier case in which <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇŒº </span>= 0.
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-220003.5"></a>Balance on order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>): adiabatic response</h5>
<!--l. 1123--><p class="noindent" >The balance between the leading terms (terms of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>)) in Eq. (<a 
href="#x1-21001r92">92<!--tex4ht:ref: 16-10-15-5 --></a>) requires that
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-22001r95"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation103x.png" alt="              (      )
Œ©‚àÇ-Œ¥Fa-=  q-Œ¥E ‚ãÖ  v‚àÇFg0  ,
  ‚àÇŒ±     m        ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(95)</td></tr></table>
<!--l. 1129--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">a</span></sub> is a unknown distribution function to be solved from the above equation. It is ready to
verify that
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-22002r96"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation104x.png" alt="      q-  ‚àÇFg0
Œ¥Fa = m Œ¥Œ¶ ‚àÇùúÄ  ,
" class="math-display"  /></center></td><td class="equation-label">(96)</td></tr></table>
<!--l. 1135--><p class="nopar" >
is a solution to the above equation, accurate to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>). [Proof: Substitute expression (<a 
href="#x1-22002r96">96<!--tex4ht:ref: 21-8-21-p5 --></a>) into the
left-hand side of Eq. (<a 
href="#x1-22001r95">95<!--tex4ht:ref: 21-8-21-p1 --></a>), we obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation105x.png" alt="             (          )
Œ© ‚àÇŒ¥Fa-= Œ© ‚àÇ-- q-Œ¥Œ¶‚àÇFg0
   ‚àÇŒ±      ‚àÇŒ±  m    ‚àÇùúÄ
         q-‚àÇFg0  -‚àÇ-
       = m  ‚àÇùúÄ Œ© ‚àÇŒ± (Œ¥Œ¶ )
         q-‚àÇFg0          ‚àÇx-
       = m  ‚àÇùúÄ Œ© (‚àáxŒ¥Œ¶) ‚ãÖ‚àÇŒ±                       (97)
" class="math-display"  /><a 
 id="x1-22003r97"></a></center>
</div>Using <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation106x.png" alt="        [           ]
‚àÇx-   ‚àÇ--      e‚à•(X-)-
‚àÇŒ± =  ‚àÇŒ± ‚àí v √ó Œ©(X )
      ‚àÇ       e (X )
   =  --[‚àí v]√ó-‚à•----
      ‚àÇŒ±v       Œ©(X )
   = ‚àí -‚ä•-                                     (98)
       Œ©
" class="math-display"  /></center>
</div>Eq. (<a 
href="#x1-22003r97">97<!--tex4ht:ref: 21-8-21-p7 --></a>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation107x.png" alt="  ‚àÇŒ¥Fa     q ‚àÇFg0         v‚ä•
Œ© -‚àÇŒ±--= ‚àí m--‚àÇùúÄ-Œ©(‚àáx Œ¥Œ¶)‚ãÖ-Œ©-
         q ‚àÇF   (     ‚àÇŒ¥A )
       = -----g0  Œ¥E + ----  ‚ãÖv‚ä•                     (99)
         m  ‚àÇùúÄ         ‚àÇt
       ‚âà q-‚àÇFg0(Œ¥E) ‚ãÖv‚ä•,                           (100)
         m  ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-22005r100"></a></center>
</div>where terms of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) have been dropped. Similarly, dropping the parallel electric Ô¨Åeld term (which is of
<span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>)) on the right-hand side of Eq. (<a 
href="#x1-22001r95">95<!--tex4ht:ref: 21-8-21-p1 --></a>), we Ô¨Ånd it is identical to the right-hand side of Eq.
(<a 
href="#x1-22005r100">100<!--tex4ht:ref: 21-8-21-p3 --></a>)]
                                                                                

                                                                                
   <h5 class="subsubsectionHead"><a 
 id="x1-230003.5"></a>Separate <span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">g</span></sub> into adiabatic and non-adiabatic part</h5>
<!--l. 1178--><p class="noindent" >As is discussed above, the terms of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>) can be eliminated by splitting a so-called adiabatic term form
<span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">g</span></sub>. SpeciÔ¨Åcally, write <span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">g</span></sub> as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-23001r101"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation108x.png" alt="Œ¥F = Œ¥F  + Œ¥G,
  g    a
" class="math-display"  /></center></td><td class="equation-label">(101)</td></tr></table>
<!--l. 1183--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">a</span></sub> is given by (<a 
href="#x1-22002r96">96<!--tex4ht:ref: 21-8-21-p5 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-23002r102"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation109x.png" alt="      q-  ‚àÇFg0
Œ¥Fa = m Œ¥Œ¶ ‚àÇùúÄ  ,
" class="math-display"  /></center></td><td class="equation-label">(102)</td></tr></table>
<!--l. 1188--><p class="nopar" >
which depends on the gyro-angle via <span 
class="cmmi-10">Œ¥Œ¶ </span>and this term is often called adiabatic term. Plugging
expression (<a 
href="#x1-23001r101">101<!--tex4ht:ref: 16-11-20-1 --></a>) into equation (<a 
href="#x1-21001r92">92<!--tex4ht:ref: 16-10-15-5 --></a>), we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-23003r103"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation110x.png" alt="LgŒ¥G = Œ¥‚óüRFg0-‚àí‚óù‚óú-LgŒ¥Fa‚óû+    Œ¥R‚óü ‚óùŒ¥‚óúFg‚óû  .
         LinearTerms    NonlinearTerms
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(103)</td></tr></table>
<!--l. 1196--><p class="nopar" >
Next, let us simplify the linear term on the right-hand side, i.e, <span 
class="cmmi-10">Œ¥RF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">gf</span></sub><span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">a</span></sub>, (which should be of
<span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) or higher because <span 
class="cmmi-10">Œ©‚àÇŒ¥F</span><sub><span 
class="cmmi-7">a</span></sub><span 
class="cmmi-10">‚àï‚àÇŒ± </span>cancels all the <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>) terms in <span 
class="cmmi-10">Œ¥RF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub>).
</p><!--l. 1202--><p class="indent" >   <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">a</span></sub> is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation111x.png" alt="L Œ¥F =  q-‚àÇFg0L Œ¥Œ¶ + q-Œ¥Œ¶L ‚àÇFg0
 g  a   m  ‚àÇùúÄ  g     m    g ‚àÇ ùúÄ
     ‚âà  q-‚àÇFg0L Œ¥Œ¶,                                (104)
        m  ‚àÇùúÄ  g
" class="math-display"  /><a 
 id="x1-23004r104"></a></center>
</div>where the error is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">3</span></sup>). In obtaining the above expression, use has been made of
<span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X </span>= 0, <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X </span>= <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub>, <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇŒ± </span>= 0, <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇŒº </span>= 0, and the deÔ¨Ånition of <span 
class="cmmib-10">Œª</span><sub><span 
class="cmmi-7">B</span><span 
class="cmr-7">1</span></sub> and
<span 
class="cmmib-10">Œª</span><sub><span 
class="cmmi-7">B</span><span 
class="cmr-7">2</span></sub> given in expressions (<a 
href="#x1-10005r39">39<!--tex4ht:ref: 18-9-16-1 --></a>) and (<a 
href="#x1-10006r40">40<!--tex4ht:ref: 18-9-16-2 --></a>). The expression (<a 
href="#x1-23004r104">104<!--tex4ht:ref: 17-5-4-e1 --></a>) involves <span 
class="cmmi-10">Œ¥Œ¶ </span>operated by the Vlasov
propagator <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub>. Since <span 
class="cmmi-10">Œ¥Œ¶ </span>takes the most simple form when expressed in particle coordinates (if in
guiding-center coordinates, <span 
class="cmmi-10">Œ¥Œ¶</span>(<span 
class="cmbx-10">x</span>) = <span 
class="cmmi-10">Œ¥Œ¶</span>(<span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚àí</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó</span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïŒ©</span>), which depends on velocity coordinates and thus
more complicated), it is convenient to use the Vlasov propagator <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub> expressed in particle
coordinates. Transforming <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub> back to the particle coordinates, expression (<a 
href="#x1-23004r104">104<!--tex4ht:ref: 17-5-4-e1 --></a>) is written
<div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation112x.png" alt="              [                                       ]
LgŒ¥Fa = q-‚àÇFg0  ‚àÇŒ¥Œ¶|x,v + v‚ãÖ‚àáx Œ¥Œ¶+ -q(E0 + v√ó B0 )‚ãÖ ‚àÇŒ¶-|x
        m  ‚àÇùúÄ [ ‚àÇt              ] m               ‚àÇv
        q-‚àÇFg0  ‚àÇŒ¥Œ¶-
      = m  ‚àÇùúÄ   ‚àÇt |x,v + v‚ãÖ‚àáx Œ¥Œ¶                               (105)
        q ‚àÇFg0[ ‚àÇŒ¥Œ¶        (       ‚àÇŒ¥A    )]
      = m--‚àÇùúÄ-  ‚àÇt-|x,v + v‚ãÖ ‚àí Œ¥E ‚àí -‚àÇt-|x,v
              [                          ]
      = q-‚àÇFg0  ‚àÇŒ¥Œ¶|x,v ‚àí v‚ãÖŒ¥E ‚àí ‚àÇv-‚ãÖŒ¥A|x,v  .                   (106)
        m  ‚àÇùúÄ [ ‚àÇt                ‚àÇt]
        q-‚àÇFg0  ‚àÇŒ¥Œ¶-         ‚àÇv-‚ãÖŒ¥A-
      = m  ‚àÇùúÄ   ‚àÇt  ‚àí v‚ãÖŒ¥E ‚àí   ‚àÇt    .                         (107)
                                                                                

                                                                                
" class="math-display"  /></center>
</div>Using this and expression (<a 
href="#x1-21002r93">93<!--tex4ht:ref: 16-10-15-3 --></a>), <span 
class="cmmi-10">Œ¥RF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">a</span></sub> is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation113x.png" alt="                                                     (      )
                  q-              (e‚à•)  ‚àÇFg0   q-      ‚àÇFg0
Œ¥RFg0 ‚àí LgŒ¥Fa = ‚àí m(Œ¥E + v √óŒ¥B )√ó   Œ©  ‚ãÖ ‚àÇX  ‚àí m Œ¥E ‚ãÖ v ‚àÇ ùúÄ
                q ‚àÇFg0 [‚àÇŒ¥Œ¶          ‚àÇv ‚ãÖŒ¥A ]
              ‚àí ------  ----‚àí v‚ãÖŒ¥E ‚àí -------
                m  ‚àÇùúÄ    ‚àÇt       (  )  ‚àÇt            [            ]
              = ‚àí q(Œ¥E + v √óŒ¥B )√ó  e‚à•  ‚ãÖ ‚àÇFg0 ‚àí q-‚àÇFg0 ‚àÇŒ¶-‚àí ‚àÇv-‚ãÖŒ¥A- , (108)
                  m                 Œ©    ‚àÇX    m  ‚àÇùúÄ   ‚àÇt     ‚àÇt
" class="math-display"  /><a 
 id="x1-23006r108"></a></center>
</div>where the two terms of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>) (the terms in blue and red) cancel each other, with the remain terms
being all of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>), i.e, the contribution of the adiabatic term cancels the leading order terms of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>)
on the RHS of Eq. (<a 
href="#x1-23003r103">103<!--tex4ht:ref: 16-10-14-1 --></a>).
<!--l. 1273--><p class="indent" >   The consequence of this is that, as we will see in Sec. <a 
href="#x1-260003.6">3.6<!--tex4ht:ref: 17-5-5-p1 --></a>, <span 
class="cmmi-10">Œ¥G </span>is independent of the gyro-angle,
accurate to order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>). Therefore, separating <span 
class="cmmi-10">Œ¥F </span>into adiabatic and non-adiabatic parts
also corresponds to separating <span 
class="cmmi-10">Œ¥F </span>into gyro-angle dependent and gyro-angle independent
parts.
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-240003.5"></a>Linear term expressed in terms of <span 
class="cmmi-10">Œ¥Œ¶ </span>and <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span></h5>
<!--l. 1282--><p class="noindent" >Let us rewrite the linear term (<a 
href="#x1-23006r108">108<!--tex4ht:ref: 16-10-13-e6 --></a>) in terms of <span 
class="cmmi-10">Œ¥Œ¶ </span>and <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span>. The <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E </span>+ <span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">B </span>term in expression (<a 
href="#x1-23006r108">108<!--tex4ht:ref: 16-10-13-e6 --></a>)
is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-24001r109"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation114x.png" alt="                      ‚àÇŒ¥A
Œ¥E +v √ó Œ¥B = ‚àí ‚àáx Œ¥Œ¶ ‚àí----+ v √ó ‚àáx √ó Œ¥A.
                       ‚àÇt
" class="math-display"  /></center></td><td class="equation-label">(109)</td></tr></table>
<!--l. 1289--><p class="nopar" >
Note that this term needs to be accurate to only <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>). Then
                                                                                

                                                                                
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-24002r110"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation115x.png" alt="Œ¥E + v√ó Œ¥B ‚âà ‚àí ‚àáxŒ¥Œ¶ + v√ó ‚àáx √ó Œ¥A,
" class="math-display"  /></center></td><td class="equation-label">(110)</td></tr></table>
<!--l. 1294--><p class="nopar" >
where the error is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>). Using the vector identity <span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó‚àá</span><sub><span 
class="cmmi-7">x</span></sub> <span 
class="cmsy-10">√ó</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span>= (<span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span>) <span 
class="cmsy-10">‚ãÖ</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚àí </span>(<span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ‚àá</span>)<span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span>and noting
<span 
class="cmbx-10">v </span>is constant for <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">x</span></sub> operator, the above equation is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-24003r111"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation116x.png" alt="Œ¥E + v √ó Œ¥B = ‚àí ‚àáx Œ¥Œ¶+ ‚àáx (Œ¥A ‚ãÖv )‚àí (v ‚ãÖ‚àáx )Œ¥A
" class="math-display"  /></center></td><td class="equation-label">(111)</td></tr></table>
<!--l. 1304--><p class="nopar" >
Note that Eq. (<a 
href="#x1-10007r41">41<!--tex4ht:ref: 17-9-2-p1 --></a>) indicates that <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">x</span></sub><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚âà‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">Œ¥Œ¶</span>, where the error is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>), then the above equation
is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-24004r112"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation117x.png" alt="Œ¥E+ v √ó Œ¥B = ‚àí ‚àáX Œ¥Œ¶ + ‚àáX (Œ¥A ‚ãÖv)‚àí (v‚ãÖ‚àáX )Œ¥A
" class="math-display"  /></center></td><td class="equation-label">(112)</td></tr></table>
                                                                                

                                                                                
<!--l. 1312--><p class="nopar" >
Further note that the parallel gradients in the above equation are of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) and thus can be dropped.
Then expression (<a 
href="#x1-24004r112">112<!--tex4ht:ref: 16-10-13-e4 --></a>) is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation118x.png" alt="Œ¥E + v√ó Œ¥B
= ‚àí ‚àáX ‚ä•Œ¥Œ¶+ ‚àáX ‚ä• (Œ¥A ‚ãÖv) ‚àí (v‚ä• ‚ãÖ‚àáX ‚ä•)Œ¥A.
= ‚àí ‚àáX ‚ä•Œ¥L‚àí v ‚ä• ‚ãÖ‚àáX ‚ä•Œ¥A,                              (113)
" class="math-display"  /><a 
 id="x1-24005r113"></a></center>
</div>where <span 
class="cmmi-10">Œ¥L </span>is deÔ¨Åned by
   <table 
class="equation"><tr><td><a 
 id="x1-24006r114"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation119x.png" alt="Œ¥L = Œ¥Œ¶ ‚àí v ‚ãÖŒ¥A.
" class="math-display"  /></center></td><td class="equation-label">(114)</td></tr></table>
<!--l. 1328--><p class="nopar" >
Using expression (<a 
href="#x1-24005r113">113<!--tex4ht:ref: 18-9-14-e1 --></a>), equation (<a 
href="#x1-23006r108">108<!--tex4ht:ref: 16-10-13-e6 --></a>) is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-24007r115"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation120x.png" alt="                 q [                         e ] ‚àÇF      q‚àÇŒ¥L ‚àÇF
Œ¥RF0 ‚àí LgŒ¥Fa = ‚àí -- (‚àí ‚àáX ‚ä•Œ¥L ‚àí v‚ä• ‚ãÖ‚àáX ‚ä•Œ¥A) √ó-‚à• ‚ãÖ---g0‚àí --------g0,
                 m                           Œ©    ‚àÇX    m  ‚àÇt  ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(115)</td></tr></table>
                                                                                

                                                                                
<!--l. 1336--><p class="nopar" >
where all terms are of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>).
</p><!--l. 1339--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.6   </span> <a 
 id="x1-250003.6"></a>Equation for the non-adiabatic part <span 
class="cmmi-10">Œ¥G</span></h4>
<!--l. 1341--><p class="noindent" >Plugging expression (<a 
href="#x1-24007r115">115<!--tex4ht:ref: 16-10-20-1 --></a>) into Eq. (<a 
href="#x1-23003r103">103<!--tex4ht:ref: 16-10-14-1 --></a>), we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-25001r116"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation121x.png" alt="           [                           ]
LgŒ¥G = ‚àí q- (‚àí ‚àáX ‚ä• Œ¥L‚àí v‚ä• ‚ãÖ‚àáX ‚ä•Œ¥A )√ó e‚à• ‚ãÖ ‚àÇFg0‚àí q-‚àÇŒ¥L‚àÇFg0 + Œ¥RŒ¥Fg,
         m                           Œ©    ‚àÇX     m ‚àÇt  ‚àÇ ùúÄ
" class="math-display"  /></center></td><td class="equation-label">(116)</td></tr></table>
<!--l. 1349--><p class="nopar" >
where <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">g</span></sub> is given by Eq. (<a 
href="#x1-21003r94">94<!--tex4ht:ref: 16-11-20-2 --></a>), i.e., </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation122x.png" alt="Lg = -‚àÇ + (v‚à•e‚à• + VE0 )‚ãÖ-‚àÇ + v‚ãÖ[ŒªB1 + ŒªB2 ]‚àí Œ©-‚àÇ
     ‚àÇt    (          ‚àÇX  )                 ‚àÇ Œ±
   + -qE0 ‚ãÖ v-‚ä•-‚àÇ-+ eŒ±--‚àÇ- ,                               (117)
     m      B0 ‚àÇŒº   v‚ä• ‚àÇŒ±
" class="math-display"  /></center>
</div>
   <h5 class="subsubsectionHead"><a 
 id="x1-260003.6"></a>Expansion of <span 
class="cmmi-10">Œ¥G</span></h5>
<!--l. 1363--><p class="noindent" >Expand <span 
class="cmmi-10">Œ¥G </span>as
</p>
   <table 
class="equation-star"><tr><td>
                                                                                

                                                                                
                               <span 
class="cmmi-10">Œ¥G </span>= <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">0</span></sub> + <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">1</span></sub> + <span 
class="cmmi-10">‚Ä¶</span><span 
class="cmmi-10">,</span>
</td></tr></table>
<!--l. 1364--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmmi-7">i</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmmi-7">i</span><span 
class="cmr-7">+1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub>, and note that the right-hand side of Eq. (<a 
href="#x1-25001r116">116<!--tex4ht:ref: 16-10-14-3 --></a>) is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>), then, the balance
on order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>) requires
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-26001r118"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation123x.png" alt="‚àÇ-Œ¥G0-
 ‚àÇ Œ±  = 0,
" class="math-display"  /></center></td><td class="equation-label">(118)</td></tr></table>
<!--l. 1370--><p class="nopar" >
i.e., <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">0</span></sub> is gyro-phase independent.
</p><!--l. 1373--><p class="indent" >   The balance on order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) requires (for the special case of <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> = 0): </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation124x.png" alt="  ‚àÇŒ¥G0-+ v‚à•e‚à• ‚ãÖ ‚àÇŒ¥G0-+ v ‚ãÖ[ŒªB1 + ŒªB2]Œ¥G0
   ‚àÇt [        ‚àÇX               ]
= ‚àí-q  (‚àí ‚àáX ‚ä•Œ¥L ‚àí v‚ä• ‚ãÖ‚àáX Œ¥A )√ó e‚à• ‚ãÖ ‚àÇFg0 ‚àí q-‚àÇŒ¥L-‚àÇFg0+ Œ¥R Œ¥Fg.    (119)
   m                          Œ©     ‚àÇX    m  ‚àÇt  ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-26002r119"></a></center>
</div>
                                                                                

                                                                                
   <h5 class="subsubsectionHead"><a 
 id="x1-270003.6"></a>Gyro-averaging</h5>
<!--l. 1390--><p class="noindent" >DeÔ¨Åne the gyro-average operator <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">‚Ä¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-27001r120"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation125x.png" alt="         ‚àí 1‚à´ 2œÄ
‚ü®h‚ü©Œ± = (2œÄ)      hdŒ±,
             0
" class="math-display"  /></center></td><td class="equation-label">(120)</td></tr></table>
<!--l. 1393--><p class="nopar" >
where <span 
class="cmmi-10">h </span>= <span 
class="cmmi-10">h</span>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œ±,ùúÄ,Œº</span>) is an arbitrary function of guiding-center variables. The gyro-averaging is an
integration in the velocity space. [For a Ô¨Åeld quantity, which is independent of the velocity in particle
coordinates, i.e., <span 
class="cmmi-10">h </span>= <span 
class="cmmi-10">h</span>(<span 
class="cmbx-10">x</span>), it is ready to see that the above averaging is a spatial averaging over a
gyro-ring.]
</p><!--l. 1400--><p class="indent" >   Gyro-averaging Eq. (<a 
href="#x1-26002r119">119<!--tex4ht:ref: 18-9-11-p1 --></a>), we obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation126x.png" alt="‚àÇŒ¥G0   ‚ü®     ‚àÇ Œ¥G0 ‚ü©
-‚àÇt--+  v‚à•e‚à• ‚ãÖ-‚àÇX-  + ‚ü®v‚ãÖ[ŒªB1 + ŒªB2 ]Œ¥G0‚ü©Œ±
     [             e  ]
= ‚àí-q ‚àí ‚àáX ‚ä•‚ü®Œ¥L‚ü©Œ± √ó-‚à•  ‚ãÖ ‚àÇFg0 ‚àí q-‚àÇ‚ü®Œ¥L‚ü©Œ±‚àÇFg0 + ‚ü®Œ¥RŒ¥Fg‚ü©Œ±,      (121)
   m                Œ©    ‚àÇX    m   ‚àÇt   ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-27002r121"></a></center>
</div>where use has been made of <span 
class="cmsy-10">‚ü®</span>(<span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><sub><span 
class="cmmi-7">X</span></sub>)<span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> <span 
class="cmsy-10">‚âà </span>0, where the error is of order higher than
<span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>). Note that <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmsy-10">¬±</span><img 
src="nonlinear_gyrokinetic_equation127x.png" alt="‚àò ----------
  2(ùúÄ‚àí B0Œº )"  class="sqrt"  />. Since <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> is approximately independent of <span 
class="cmmi-10">Œ±</span>, so
does <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>. Using this, the Ô¨Årst gyro-averaging on the left-hand side of the above equation is
written
   <table 
class="equation"><tr><td><a 
 id="x1-27003r122"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation128x.png" alt="‚ü®          ‚ü©
      ‚àÇŒ¥G0-            ‚àÇŒ¥G0-       ‚àÇŒ¥G0-
 v‚à•e‚à• ‚ãÖ ‚àÇX  Œ± = ‚ü®v‚à•e‚à•‚ü©‚ãÖ ‚àÇX   = v‚à•e‚à• ‚ãÖ ‚àÇX
" class="math-display"  /></center></td><td class="equation-label">(122)</td></tr></table>
<!--l. 1426--><p class="nopar" >
The second gyro-averaging on the left-hand side of Eq. (<a 
href="#x1-27002r121">121<!--tex4ht:ref: 18-9-11-p4 --></a>) can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-27004r123"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation129x.png" alt="‚ü®v ‚ãÖ[ŒªB1 + ŒªB2]Œ¥G0‚ü©Œ± = VD ‚ãÖ‚àáX Œ¥G0,
" class="math-display"  /></center></td><td class="equation-label">(123)</td></tr></table>
<!--l. 1433--><p class="nopar" >
where <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is the magnetic curvature and gradient drift (Eq. (<a 
href="#x1-27004r123">123<!--tex4ht:ref: 18-9-11-p3 --></a>) is derived in Appendix xx, to do
later). Then Eq. (<a 
href="#x1-27002r121">121<!--tex4ht:ref: 18-9-11-p4 --></a>) is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation130x.png" alt="[ ‚àÇ                 ]
 ‚àÇt + (v‚à•e‚à• + VD )‚ãÖ‚àáX Œ¥G0
      [               ]
= ‚àí-q  ‚àí ‚àáX ‚ä•‚ü®Œ¥L‚ü©Œ± √ó e‚à• ‚ãÖ ‚àÇFg0 ‚àí q-‚àÇ‚ü®Œ¥L‚ü©Œ± ‚àÇFg0+ ‚ü®Œ¥RŒ¥Fg‚ü©Œ±.     (124)
   m                Œ©    ‚àÇX    m   ‚àÇt    ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-27005r124"></a></center>
</div>
   <h5 class="subsubsectionHead"><a 
 id="x1-280003.6"></a>SimpliÔ¨Åcation of the nonlinear term</h5>
<!--l. 1451--><p class="noindent" >Next, we try to simplify the nonlinear term <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥RŒ¥F</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> appearing in Eq. (<a 
href="#x1-27005r124">124<!--tex4ht:ref: 17-5-5-1 --></a>), which is written as
</p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation131x.png" alt="          ‚ü®    (              ) ‚ü©
‚ü®Œ¥RŒ¥Fg‚ü©Œ± =  Œ¥R  -qŒ¥Œ¶ ‚àÇFg0+ Œ¥G0
          ‚ü®     m(    ‚àÇùúÄ )‚ü©      Œ±
            -q       ‚àÇFg0
        =   m Œ¥R  Œ¥Œ¶  ‚àÇùúÄ    Œ± + ‚ü®Œ¥RŒ¥G0‚ü©Œ±               (125)
" class="math-display"  /></center>
</div>First, let us focus on the Ô¨Årst term, which can be written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation132x.png" alt="   (       )           (            )   (  )               (       ) (       )
Œ¥R  Œ¥Œ¶ ‚àÇFg0  ‚âà ‚àí q-‚àÇFg0  Œ¥E + v√ó-Œ¥B-  √ó  e‚à•  ‚ãÖ ‚àÇŒ¥Œ¶-‚àí q-‚àÇFg0 v-√ó-Œ¥B  ‚ãÖ  eŒ±-‚àÇŒ¥Œ¶-
        ‚àÇùúÄ       m  ‚àÇùúÄ   (      c        Œ©    ‚àÇX )  m  ‚àÇùúÄ      c       v‚ä• ‚àÇŒ±
               -q‚àÇFg0       ‚àÇŒ¥Œ¶-  v‚ä•-‚àÇŒ¥Œ¶-  eŒ±-‚àÇŒ¥Œ¶-   -q        ‚àÇ2Fg0
             ‚àí m  ‚àÇ ùúÄ Œ¥E‚ãÖ  v ‚àÇùúÄ + B0  ‚àÇŒº + v‚ä• ‚àÇ Œ±  + m Œ¥Œ¶Œ¥E ‚ãÖv  ‚àÇùúÄ2
                 q (     v √ó Œ¥B)          q        ‚àÇ2F
             = ‚àí -- Œ¥E + ------  ‚ãÖ‚àáv Œ¥Œ¶+  -Œ¥Œ¶ Œ¥E‚ãÖv ---g20
                 m          c             m         ‚àÇùúÄ
             = -qŒ¥Œ¶Œ¥E ‚ãÖv ‚àÇ2Fg0-                                             (126)
               m         ‚àÇ ùúÄ2
" class="math-display"  /></center>
</div>Using the above results, the nonlinear term <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥RŒ¥F</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> is written as
   <table 
class="equation"><tr><td><a 
 id="x1-28003r127"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation133x.png" alt="          q ‚ü®        ‚àÇ2F  ‚ü©
‚ü®Œ¥RŒ¥F ‚ü©Œ± = --  Œ¥Œ¶Œ¥E ‚ãÖv---g20   + ‚ü®Œ¥RŒ¥G0‚ü©Œ±
          m           ‚àÇùúÄ    Œ±
" class="math-display"  /></center></td><td class="equation-label">(127)</td></tr></table>
                                                                                

                                                                                
<!--l. 1493--><p class="nopar" >
Accurate to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>)<span 
class="cmmi-10">,</span>the Ô¨Årst term on the right-hand side of the above is zero. [Proof: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation134x.png" alt="‚ü®        ‚àÇ2Fg0‚ü©    ‚ü® ‚àÇ2Fg0        ‚ü©
  Œ¥Œ¶ Œ¥E ‚ãÖv -‚àÇùúÄ2-   =   -‚àÇùúÄ2-Œ¥Œ¶‚àá Œ¥Œ¶ ‚ãÖv
               Œ±    2               Œ±
                 = ‚àÇ-Fg0‚ü®v ‚ãÖ‚àá(Œ¥Œ¶)2‚ü©Œ±
                    ‚àÇùúÄ2
                 ‚âà ‚àÇ2Fg0‚ü®v  ‚ãÖ‚àá(Œ¥Œ¶)2‚ü©
                    ‚àÇùúÄ2   ‚ä•         Œ±
                 ‚âà 0,                                 (128)
" class="math-display"  /></center>
</div>where use has been made of <span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> <span 
class="cmsy-10">‚âà </span>0, where the error is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>). Using the above results,
expression (<a 
href="#x1-28003r127">127<!--tex4ht:ref: 16-10-20-3 --></a>) is written as
   <table 
class="equation"><tr><td><a 
 id="x1-28005r129"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation135x.png" alt="‚ü®Œ¥RŒ¥Fg‚ü©Œ± = ‚ü®Œ¥R Œ¥G0‚ü©Œ±.
" class="math-display"  /></center></td><td class="equation-label">(129)</td></tr></table>
<!--l. 1513--><p class="nopar" >
Using the expression of <span 
class="cmmi-10">Œ¥R </span>given by Eq. (<a 
href="#x1-15004r56">56<!--tex4ht:ref: 16-10-6-1 --></a>), the above expression is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation136x.png" alt="               ‚ü®(            )  (   )‚ü©
‚ü®Œ¥RŒ¥G ‚ü©  = ‚àí-q    Œ¥E + v-√ó-Œ¥B  √ó   e‚à•    ‚ãÖ ‚àÇŒ¥G0
      0Œ±    m            c        Œ©   Œ±   ‚àÇX
             q ‚àÇŒ¥G0           q‚àÇ Œ¥G0 ‚ü®     v‚ä•‚ü©
           ‚àím- -‚àÇùúÄ-‚ü®Œ¥E ‚ãÖv‚ü©Œ± ‚àí m-‚àÇ-Œº-  Œ¥E ‚ãÖB0-              (130)
                                              Œ±
" class="math-display"  /><a 
 id="x1-28006r130"></a></center>
</div>where use has been made of <span 
class="cmmi-10">‚àÇŒ¥G</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇŒ± </span>= 0. Using Eq. (<a 
href="#x1-24005r113">113<!--tex4ht:ref: 18-9-14-e1 --></a>), we obtain
   <table 
class="equation"><tr><td><a 
 id="x1-28007r131"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation137x.png" alt="  q ‚ü®              ( e‚à•)‚ü©     q            e‚à•
‚àí m- (Œ¥E +v √ó Œ¥B) √ó  Œ©-  Œ± = m-‚àáX ‚ä•‚ü®Œ¥L‚ü©Œ± √ó Œ©-.
" class="math-display"  /></center></td><td class="equation-label">(131)</td></tr></table>
<!--l. 1535--><p class="nopar" >
The other two terms in Eq. (<a 
href="#x1-28006r130">130<!--tex4ht:ref: 16-10-20-5 --></a>) can be proved to be zero. [Proof: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation138x.png" alt="  q‚àÇŒ¥G0            q‚àÇ Œ¥G0
‚àím---‚àÇùúÄ-‚ü®Œ¥E ‚ãÖv ‚ü©Œ± = m---‚àÇùúÄ-‚ü®v‚ãÖ‚àáx Œ¶‚ü©Œ±
                   q‚àÇ Œ¥G0
                ‚âà m---‚àÇùúÄ-‚ü®v‚ä• ‚ãÖ‚àáxŒ¶‚ü©Œ±
                   q‚àÇ Œ¥G0
                ‚âà m---‚àÇùúÄ-‚ü®v‚ä• ‚ãÖ‚àáX Œ¶‚ü©Œ±
                ‚âà 0                                  (132)
" class="math-display"  /></center>
</div><div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation139x.png" alt="         ‚ü®       ‚ü©            ‚ü®          ‚ü©
‚àí -q‚àÇŒ¥G0-  Œ¥E‚ãÖ v‚ä•-  =  q-‚àÇŒ¥G0- -1-v  ‚ãÖ‚àá Œ¶
  m  ‚àÇŒº        B0  Œ±   m  ‚àÇŒº   B0  ‚ä•   x   Œ±
                       q ‚àÇŒ¥G0 ‚ü® 1         ‚ü©
                    ‚âà  m--‚àÇŒº-- B0-v‚ä• ‚ãÖ‚àáX Œ¶
                                           Œ±
                    ‚âà 0                                   (133)
" class="math-display"  /></center>
</div>] Using the above results, the nonlinear term is Ô¨Ånally written as
   <table 
class="equation"><tr><td><a 
 id="x1-28010r134"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation140x.png" alt="           -q[            e‚à•]
‚ü®Œ¥RŒ¥G0 ‚ü©Œ± = m  ‚àáX ‚ä•‚ü®Œ¥L‚ü©Œ± √ó Œ©  ‚ãÖ‚àáX Œ¥G0.
" class="math-display"  /></center></td><td class="equation-label">(134)</td></tr></table>
<!--l. 1565--><p class="nopar" >
Using this in Eq. (<a 
href="#x1-28005r129">129<!--tex4ht:ref: 16-10-20-7 --></a>), we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-28011r135"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation141x.png" alt="             [              ]
‚ü®Œ¥RŒ¥Fg‚ü©Œ± = q- ‚àáX ‚ä•‚ü®Œ¥L‚ü©Œ± √ó e‚à• ‚ãÖ‚àáX Œ¥G0,
           m              Œ©
" class="math-display"  /></center></td><td class="equation-label">(135)</td></tr></table>
<!--l. 1571--><p class="nopar" >
which is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>).
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-290003.6"></a>Final equation for the non-adiabatic part of perturbed distribution function</h5>
<!--l. 1577--><p class="noindent" >Using the above results, the gyro-averaged kinetic equation for <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">0</span></sub> is Ô¨Ånally written as
</p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation142x.png" alt="       (                         )
 ‚àÇŒ¥G0  |             q        e ‚à•|
 -‚àÇt--+|(v ‚à•e‚à• + VD ‚àí m-‚àá‚ü®Œ¥L‚ü©√ó -Œ© |) ‚ãÖ‚àáX Œ¥G0
                     ‚óü----‚óù‚óú----‚óû
  (             )      nonlinear
=   q-‚àá‚ü®Œ¥L‚ü©√ó e‚à•  ‚ãÖ‚àáXFg0 ‚àí   q-‚àÇ‚ü®Œ¥L‚ü©‚àÇFg0  .              (136)
  ‚óü-m-------‚óù‚óúŒ©--------‚óû    m‚óü---‚àÇt‚óù‚óú-‚àÇùúÄ-‚óû
        spatial‚àí drive        velocit‚àí space‚àí damp
" class="math-display"  /><a 
 id="x1-29001r136"></a></center>
</div>where <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is the equilibrium guiding-center drift velocity, <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">‚Ä¶</span><span 
class="cmsy-10">‚ü© </span>is the gyro-phase averaging operator,
<span 
class="cmmi-10">Œ¥L </span>= <span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span>, and <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,t</span>) is gyro-angle independent and is related to the perturbed
distribution function <span 
class="cmmi-10">Œ¥F</span><sub><span 
class="cmmi-7">g</span></sub> by
   <table 
class="equation"><tr><td><a 
 id="x1-29002r137"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation143x.png" alt="Œ¥Fg = -qŒ¥Œ¶‚àÇFg0 + Œ¥G0,
      m    ‚àÇ ùúÄ
" class="math-display"  /></center></td><td class="equation-label">(137)</td></tr></table>
<!--l. 1600--><p class="nopar" >
where the Ô¨Årst term is called ‚Äúadiabatic term‚Äù, which depends on the gyro-phase <span 
class="cmmi-10">Œ± </span>via <span 
class="cmmi-10">Œ¥Œ¶</span>. Equation
(<a 
href="#x1-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) is the special case (<span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmmi-7">g</span><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇŒº</span><span 
class="cmsy-10">|</span><sub><span 
class="cmmi-7">ùúÄ</span></sub> = 0) of the Frieman-Chen nonlinear gyrokinetic equation given in
Ref. <span class="cite">[<a 
href="#Xfrieman1982">3</a>]</span>. Note that the nonlinear terms only appear on the left-hand side of Eq. (<a 
href="#x1-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) and all the terms
on the right-hand side are linear. The term
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-29003r138"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation144x.png" alt="‚àí q‚àá ‚ü®Œ¥L‚ü©√ó e‚à•
  m        Œ©
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(138)</td></tr></table>
<!--l. 1611--><p class="nopar" >
consists of the <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E </span><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> drift and magnetic Ô¨Çuttering term (refer to ¬†expression (<a 
href="#x1-65007r330">330<!--tex4ht:ref: 21-8-5-p1 --></a>) in Sec. <a 
href="#x1-65000C.3">C.3<!--tex4ht:ref: 16-10-13-1 --></a>). For
notaiton ease, this term is denoted by <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> in the following:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-29004r139"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation145x.png" alt="        -q        e‚à•     q-                e‚à•
Œ¥VD  ‚â° ‚àím ‚àá ‚ü®Œ¥L‚ü©√ó Œ©  = ‚àí m ‚àá‚ü®Œ¥Œ¶‚àí v ‚ãÖŒ¥A‚ü©Œ± √ó Œ©
" class="math-display"  /></center></td><td class="equation-label">(139)</td></tr></table>
<!--l. 1621--><p class="nopar" >
</p><!--l. 1668--><p class="indent" >   Note that <span 
class="cmsy-10">‚àá‚â° </span><span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">X</span>, which is taken in the guiding-center coordinates (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,Œ±</span>) while holding
(<span 
class="cmmi-10">ùúÄ,Œº,Œ±</span>) constant. How do we numerically calculate <span 
class="cmmi-10">‚àÇŒ¶</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X </span>in PIC simulations? The diÔ¨Éculty is that
<span 
class="cmbx-10">X </span>grid is not available, which makes it diÔ¨Écult to use the Ô¨Ånite diÔ¨Äerence method. We note <span 
class="cmbx-10">x </span>grid is
available in PIC simulations. It turns out we can make use of <span 
class="cmbx-10">x </span>grid to approximatly calculate the
derivatives in <span 
class="cmbx-10">X </span>space. Using <span 
class="cmbx-10">x </span>= <span 
class="cmbx-10">X </span>+ <span 
class="cmmi-10">œÅ </span>and the deÔ¨Ånition <span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>) = <span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">p</span></sub>(<span 
class="cmbx-10">x</span>) we obtain
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation146x.png" alt="‚àÇŒ¥Œ¶g(X,Œ±,v‚ä•-)  ‚àÇ-Œ¥Œ¶p-(x-)
     ‚àÇX      =   ‚àÇX
               ‚àÇ Œ¥Œ¶p (x ) ‚àÇx
             = ---‚àÇx-- ‚ãÖ‚àÇX-
               ‚àÇ Œ¥Œ¶p (x ) (    ‚àÇœÅ )
             = ---‚àÇx-- ‚ãÖ 1 + ‚àÇX-

             ‚âà ‚àÇ-Œ¥Œ¶p-(x-),                             (140)
                  ‚àÇx
" class="math-display"  /></center>
</div>which is accurate up to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>) in gyrokinetic ordering. The above relation indicates that the value of
<span 
class="cmmi-10">‚àÇŒ¥Œ¶</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X </span>at a guidng-center location is approximately equal to the value of <span 
class="cmmi-10">‚àÇŒ¥Œ¶</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">x </span>at the
corresponding particle position. Therefore we can use <span 
class="cmmi-10">Œ¥Œ¶ </span>deÔ¨Åned on <span 
class="cmbx-10">x </span>grid to compute
¬†<span 
class="cmmi-10">‚àÇŒ¥Œ¶</span><sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">x</span>, and interpolate it to the particle position and this is a good approximation of
                                                                                

                                                                                
<span 
class="cmmi-10">‚àÇŒ¥Œ¶</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X</span>.
<!--l. 1668--><p class="indent" >   Similarly, we have <span 
class="cmmi-10">‚àÇŒ¥A</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X </span><span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">‚àÇŒ¥A</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">x</span>.
</p><!--l. 1668--><p class="indent" >   Also note that <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmsy-10">‚ü© </span>is not known on <span 
class="cmbx-10">X </span>grid (it is known on random markers). So, to calculate
<span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmsy-10">‚ü©</span><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">X</span>, we need to exchange the operation order:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-29006r141"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation147x.png" alt="Œ¥‚ü®Œ¥Œ¶g‚ü©= ‚ü®‚àÇŒ¥Œ¶g-‚ü© ‚âà ‚ü®‚àÇŒ¥Œ¶p‚ü©.
 ‚àÇX       ‚àÇX       ‚àÇx
" class="math-display"  /></center></td><td class="equation-label">(141)</td></tr></table>
<!--l. 1668--><p class="nopar" >
For notation ease, the subscripts <span 
class="cmmi-10">g </span>and <span 
class="cmmi-10">p </span>are usually dropped. Which one is intended should be obvious
from the context.
</p><!--l. 1670--><p class="indent" >   ¬†
</p><!--l. 1672--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-300004"></a>Gyrokinetic equation suitable for numerical simulation</h3>
<!--l. 1674--><p class="noindent" >The gyrokinetic equation (<a 
href="#x1-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) contains time derivatives on the right-hand side, which is problematic if
treated by using explicit Ô¨Ånite diÔ¨Äerence in PIC simulations. Next, we discuss some methods
that can eliminate these terms, making the gyrokinetic equation more amenable to PIC
simulations.
</p><!--l. 1681--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-310004.1"></a>Eliminate <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥œï</span><span 
class="cmsy-10">‚ü©</span><span 
class="cmmi-10">‚àï‚àÇt </span>term on the right-hand side of Eq. (136)</h4>
<!--l. 1683--><p class="noindent" >Note that the coeÔ¨Écient before <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ</span> in Eq. (<a 
href="#x1-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) involves the time derivative of <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥œï</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub>, which is
problematic if treated by using explicit Ô¨Ånite diÔ¨Äerence (I test the algorithm that treats this term by
implicit scheme, the result roughly agrees with the standard method discussed in Sec. <a 
href="#x1-400006">6<!--tex4ht:ref: 19-1-4-1 --></a>). It turns out
that <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>can be eliminated by deÔ¨Åning another gyro-phase independent function <span 
class="cmmi-10">Œ¥f</span>
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-31001r142"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation148x.png" alt="Œ¥f = -q‚ü®Œ¥Œ¶‚ü©‚àÇF0-+ Œ¥G0.
    m      ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(142)</td></tr></table>
<!--l. 1694--><p class="nopar" >
Substituting this into Eq. (<a 
href="#x1-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>), we obtain the equation for <span 
class="cmmi-10">Œ¥f</span>: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation149x.png" alt="[ ‚àÇ                        ]
  ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX Œ¥f
        [                          ]
‚àí -q‚àÇF0- -‚àÇ + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  ‚ü®Œ¥Œ¶‚ü©
  m  ‚àÇùúÄ [‚àÇt                        ]
‚àí -q‚ü®Œ¥Œ¶‚ü© -‚àÇ + (v e + V   + Œ¥V  )‚ãÖ‚àá   ‚àÇF0-
  m      ‚àÇt    ‚à• ‚à•    D     D    X   ‚àÇùúÄ
                 q ‚àÇ‚ü®Œ¥L‚ü©‚àÇF0
= ‚àí Œ¥VD ‚ãÖ‚àáXF0  ‚àí m---‚àÇt--‚àÇùúÄ-.                          (143)
" class="math-display"  /></center>
</div>Noting that <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span><span 
class="cmsy-10">‚âà‚àí</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">m‚àïT</span>, we Ô¨Ånd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">3</span></sup>) (after both sides being divided by <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">Œ©</span>). Therefore the third line can be
dropped. Moving the second line to the right-hand side and noting that <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥L</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> = <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥œï </span><span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub>, the
above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation150x.png" alt="[                          ]
  ‚àÇ-+ (ve  + V  + Œ¥V  )‚ãÖ‚àá   Œ¥f
  ‚àÇt    ‚à•‚à•    D      D    X
= ‚àí Œ¥VD ‚ãÖ‚àáXF0
  q [  ‚àÇ‚ü®v‚ãÖŒ¥A ‚ü©                           ] ‚àÇF0
‚àí m- ‚àí ---‚àÇt---‚àí (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX ‚ü®Œ¥Œ¶‚ü© ‚àÇùúÄ-,           (144)
" class="math-display"  /><a 
 id="x1-31003r144"></a></center>
</div>where two <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">œï</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>terms cancel each other. Note that the right-hand side of Eq. (<a 
href="#x1-31003r144">144<!--tex4ht:ref: 17-5-13-p2 --></a>) contains a
nonlinear term <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> <span 
class="cmsy-10">‚ãÖ‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span>. This is diÔ¨Äerent from the original Frieman-Chen equation, where all
nonlinear terms appear on the left-hand side. For the electrostatic limit, this term disappears because
<span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is perpendicular to <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub>.
<!--l. 1740--><p class="indent" >   Using
</p>
   <table 
class="equation-star"><tr><td>
                          <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> = <span 
class="cmsy-10">‚àí</span><img 
src="nonlinear_gyrokinetic_equation151x.png" alt="q
--
m"  class="frac" align="middle" /><span 
class="cmsy-10">‚àá‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©√ó</span><img 
src="nonlinear_gyrokinetic_equation152x.png" alt="e
-‚à•
Œ©"  class="frac" align="middle" />
</td></tr></table>
<!--l. 1743--><p class="nopar" >
in the right-hand side of Eq. (<a 
href="#x1-31003r144">144<!--tex4ht:ref: 17-5-13-p2 --></a>) yields </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation153x.png" alt="[                          ]
 ‚àÇ-
 ‚àÇt +(v‚à•e‚à• + VD + Œ¥VD ) ‚ãÖ‚àáX  Œ¥f
= ‚àí Œ¥VD ‚ãÖ‚àáXF0
  q [‚àÇ‚ü®v‚ãÖŒ¥A ‚ü©  (            q             e )        ] ‚àÇF
+ -- --------+  v‚à•e‚à• +VD  + --‚àáX ‚ü®v‚ãÖŒ¥A ‚ü©√ó -‚à•  ‚ãÖ‚àáX ‚ü®Œ¥Œ¶‚ü©  --0.     (145)
  m     ‚àÇt                  m             Œ©            ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-31004r145"></a></center>
</div>[Equation (<a 
href="#x1-31004r145">145<!--tex4ht:ref: 24-12-10-1 --></a>) corresponds to Eqs. (A8-A9) in Yang Chen‚Äôs paper<span class="cite">[<a 
href="#Xychen2009">2</a>]</span>, where the Ô¨Årst minus on the
right-hand side of Eq. (A8) is wrong and should be replaced with <span 
class="cmmi-10">q‚àïm</span>; one <span 
class="cmmi-10">q </span>is missing before
<span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©</span><span 
class="cmmi-10">‚àï‚àÇt </span>in Eq. (A9).]
                                                                                

                                                                                
<!--l. 1766--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-320004.2"></a>Eliminate <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©</span><span 
class="cmmi-10">‚àï‚àÇt </span>term on the right-hand side of GK equation</h4>
<!--l. 1768--><p class="noindent" >Similar to the method of eliminating <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥œï</span><span 
class="cmsy-10">‚ü©</span><span 
class="cmmi-10">‚àï‚àÇt</span>, we deÔ¨Åne another gyro-phase independent function
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-32001r146"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation154x.png" alt="Œ¥h = Œ¥f ‚àí q-‚àÇF0‚ü®v ‚ãÖŒ¥A‚ü©.
         m  ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(146)</td></tr></table>
<!--l. 1774--><p class="nopar" >
Most gyrokinetic simulations approximate the vector potential as <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span><span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>. Let us simplify Eq.
(<a 
href="#x1-31003r144">144<!--tex4ht:ref: 17-5-13-p2 --></a>) for this case. Then <span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-32002r147"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation155x.png" alt="‚ü®v‚ãÖŒ¥A ‚ü©Œ± ‚âà ‚ü®v‚à•Œ¥A‚à•‚ü©.
" class="math-display"  /></center></td><td class="equation-label">(147)</td></tr></table>
<!--l. 1783--><p class="nopar" >
Then expression (<a 
href="#x1-32001r146">146<!--tex4ht:ref: 23-11-15-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-32003r148"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation156x.png" alt="Œ¥h = Œ¥f ‚àí q-‚ü®vŒ¥A ‚ü©‚àÇF0.
         m  ‚à•   ‚à• ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(148)</td></tr></table>
<!--l. 1788--><p class="nopar" >
Then Eq. (<a 
href="#x1-31003r144">144<!--tex4ht:ref: 17-5-13-p2 --></a>) is written in terms of <span 
class="cmmi-10">Œ¥h </span>as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation157x.png" alt="[ ‚àÇ                       ]
 ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX Œ¥h
  q‚àÇF  [ ‚àÇ                        ]
+-----0 -- + (v‚à•e‚à• +VD  + Œ¥VD )‚ãÖ‚àáX  ‚ü®v‚à•Œ¥A‚à•‚ü©
 m  ‚àÇùúÄ  ‚àÇt                (    )
+-q‚ü®v‚à•Œ¥A‚à•‚ü©[(VD + Œ¥VD )‚ãÖ‚àáX ]  ‚àÇF0-
 m                          ‚àÇ ùúÄ
= ‚àí Œ¥VD ‚ãÖ‚àáXF0
  q[  ‚àÇ‚ü®v‚à•Œ¥A‚à•‚ü©                           ] ‚àÇF0
‚àím- ‚àí ---‚àÇt---‚àí (v‚à•e‚à• + VD +Œ¥VD ) ‚ãÖ‚àáX ‚ü®Œ¥Œ¶ ‚ü© ‚àÇ-ùúÄ ,          (149)
" class="math-display"  /></center>
</div>where use has been made of that <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>= 0 and <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0. Further noting that <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">Œ¥Œ¶</span>,
<span 
class="cmmi-10">qŒ¥Œ¶‚àïT </span><span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>), <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span><span 
class="cmsy-10">‚àº‚àí</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">m‚àïT</span>,    <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub><span 
class="cmmi-10">‚àïv</span><sub><span 
class="cmmi-7">t</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>), <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub><span 
class="cmmi-10">‚àïv</span><sub><span 
class="cmmi-7">t</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>), and <span 
class="cmmi-10">œÅ</span><span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we
Ô¨Ånd that the red term of the above equation (after divided by <span 
class="cmmi-10">Œ©F</span><sub><span 
class="cmr-7">0</span></sub>) is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">3</span></sup>), hence can be dropped.
Move the second line to the right-hand side, giving <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation158x.png" alt="[ ‚àÇ                        ]
 -- + (v‚à•e‚à• +VD  + Œ¥VD )‚ãÖ‚àáX  Œ¥h
 ‚àÇt
= ‚àí Œ¥VD ‚ãÖ‚àáXF0
+ q-[(v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX (‚ü®Œ¥Œ¶ ‚àí v‚à•Œ¥A ‚à•‚ü©)]‚àÇF0,             (150)
  m                                   ‚àÇ ùúÄ
" class="math-display"  /><a 
 id="x1-32005r150"></a></center>
</div>where <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ü©</span><span 
class="cmmi-10">‚àï‚àÇt </span>terms cancel each other. Further note that <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> (given by Eq. (<a 
href="#x1-29004r139">139<!--tex4ht:ref: 19-1-3-1 --></a>)) is
                                                                                

                                                                                
perpendicular to <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ü©</span>. Therefore the blue term in Eq. (<a 
href="#x1-32005r150">150<!--tex4ht:ref: 19-1-3-e1 --></a>) is zero, then Eq. (<a 
href="#x1-32005r150">150<!--tex4ht:ref: 19-1-3-e1 --></a>)
simpliÔ¨Åes to <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation159x.png" alt="[                          ]
 ‚àÇ-+ (v e + V   +Œ¥V  ) ‚ãÖ‚àá   Œ¥h
 ‚àÇt    ‚à• ‚à•    D     D    X
= ‚àí Œ¥VD ‚ãÖ‚àáXF0
  q                            ‚àÇF0
+m-[(v‚à•e‚à• + VD )‚ãÖ‚àáX ‚ü®Œ¥Œ¶ ‚àí v‚à•Œ¥A‚à•‚ü©]‚àÇùúÄ-.                 (151)
" class="math-display"  /><a 
 id="x1-32006r151"></a></center>
</div>Note that in terms of (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,Œ±,œÉ</span>) coordinates, <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> is written as
   <table 
class="equation"><tr><td><a 
 id="x1-32007r152"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation160x.png" alt="v‚à• = œÉ‚àò2-ùúÄ‚àí-2ŒºB0,
" class="math-display"  /></center></td><td class="equation-label">(152)</td></tr></table>
<!--l. 1844--><p class="nopar" >
where <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) = <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X </span>+ <span 
class="cmmib-10">œÅ</span>) with <span 
class="cmmib-10">œÅ</span> = <span 
class="cmmib-10">œÅ</span>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ,Œº,Œ±</span>). Since the scale length of <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> is much larger than the
thermal Larmor radius, <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>) <span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X</span>) and hence <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> can be approximated as a constant when
gyro-angle <span 
class="cmmi-10">Œ± </span>changes. Then <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> can be taken out of the gyro-averaging in expression (<a 
href="#x1-32002r147">147<!--tex4ht:ref: 19-3-26-e1 --></a>),
yielding
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-32008r153"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation161x.png" alt="‚ü®v‚à•Œ¥A‚à•‚ü© ‚âà v‚à•‚ü®Œ¥A ‚à•‚ü©.
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(153)</td></tr></table>
<!--l. 1855--><p class="nopar" >
Using this, the term related to <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub> in (<a 
href="#x1-32006r151">151<!--tex4ht:ref: 19-1-4-e1 --></a>) can be further written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation162x.png" alt="(v‚à•e‚à• + VD )‚ãÖ‚àáX ‚ü®v‚à•Œ¥A‚à•‚ü© = (v‚à•e‚à• + VD )‚ãÖ‚àáX (v‚à•‚ü®Œ¥A ‚à•‚ü©)
                      = ‚ü®Œ¥A ‚ü©(ve  + V  )‚ãÖ‚àá  (v)
                           ‚à•   ‚à•‚à•    D    X  ‚à•
                      + v‚à•(v‚à•e‚à• + VD )‚ãÖ‚àáX ‚ü®Œ¥A‚à•‚ü©.            (154)
" class="math-display"  /></center>
</div>Using expression (<a 
href="#x1-32007r152">152<!--tex4ht:ref: 19-3-27-1 --></a>), (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub> + <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub>) <span 
class="cmsy-10">‚ãÖ‚àá</span><sub><span 
class="cmmi-7">X</span></sub>(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation163x.png" alt="‚ü®Œ¥A ‚à•‚ü©(v‚à•e‚à• + VD )‚ãÖ‚àáX (v‚à•) ‚âà ‚ü®Œ¥A‚à•‚ü©(v‚à•e‚à•)‚ãÖ‚àáX (v(‚à•)       )
                        = ‚ü®Œ¥A ‚ü©(v e )‚ãÖ‚àá    œÉ‚àò2-ùúÄ‚àí-2ŒºB--
                             ‚à•  ‚à• ‚à•    X  (‚àò -------0)
                        = ‚ü®Œ¥A‚à•‚ü©œÉ(v‚à•e‚à•)‚ãÖ‚àáX     2ùúÄ‚àí 2ŒºB0

                        = ‚ü®Œ¥A‚à•‚ü©œÉv‚à•‚àí 2‚àöŒºe‚à•-‚ãÖ‚àáXB0-
                                  2  2ùúÄ‚àí 2ŒºB0
                                 ‚àí 2Œºe‚à•-‚ãÖ‚àáXB0-
                        = ‚ü®Œ¥A‚à•‚ü©v‚à•    2v‚à•
                        = ‚àí ‚ü®Œ¥A ‚ü©Œºe ‚ãÖ‚àá  B .                    (155)
                               ‚à•  ‚à•   X  0
" class="math-display"  /></center>
</div>(We can also obtain <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">X</span></sub>(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) = <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">Œº</span>(<span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>)<span 
class="cmmi-10">‚àïv</span><sub><span 
class="cmsy-7">‚à•</span></sub> by using Eq. (<a 
href="#x1-79002r372">372<!--tex4ht:ref: 19-1-2-e1 --></a>)). Using the above results, equation
(<a 
href="#x1-32006r151">151<!--tex4ht:ref: 19-1-4-e1 --></a>) is written as <div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation164x.png" alt="  [                         ]
   ‚àÇ-+ (v e + V  + Œ¥V  )‚ãÖ‚àá    Œ¥h
   ‚àÇt    ‚à• ‚à•    D     D    X
                q-                    ‚àÇF0-
= ‚àí Œ¥VD ‚ãÖ‚àáXF0 + m [(v‚à•e‚à• + VD )‚ãÖ‚àáX ‚ü®Œ¥Œ¶‚ü©]‚àÇ ùúÄ
  q-                                        ‚àÇF0-
‚àí m [v‚à•(v‚à•e‚à• + VD )‚ãÖ‚àáX ‚ü®Œ¥A‚à•‚ü©‚àí ‚ü®Œ¥A‚à•‚ü©(Œºe‚à• ‚ãÖ‚àáXB0 )]‚àÇ ùúÄ ,       (156)
" class="math-display"  /><a 
 id="x1-32011r156"></a></center>
</div>which agrees with the so-called <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚à•</span></sub> formulation given in the <span 
class="cmtt-10">GEM</span> manual (the Ô¨Årst line of Eq. 28). (It is
said that <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚à•</span></sub> formulation uses <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> + <span 
class="cmmi-10">q</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ü©</span><span 
class="cmmi-10">‚àïm </span>as an independent variable, but I can not relate this
explanation to my derivation given above.)
<!--l. 1912--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-330004.3"></a>Mixed-variable pullback method<span class="cite">[<a 
href="#XMISHCHENKO2019194">4</a>]</span></h4>
<!--l. 1914--><p class="noindent" >DeÔ¨Åne <span 
class="cmmi-10">Œ¥f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-33001r157"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation165x.png" alt="Œ¥f(h) = Œ¥f ‚àí-q‚àÇF0-‚ü®v‚à•Œ¥A (h‚à•)‚ü©,
           m  ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(157)</td></tr></table>
<!--l. 1919--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is a part of <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-33002r158"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation166x.png" alt="Œ¥A‚à• = Œ¥A(‚à•s)+ Œ¥A (h‚à•),
" class="math-display"  /></center></td><td class="equation-label">(158)</td></tr></table>
                                                                                

                                                                                
<!--l. 1924--><p class="nopar" >
with <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> determined by an evolution equation:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-33003r159"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation167x.png" alt="‚àÇ Œ¥A (s)
----‚à•- = ‚àí b ‚ãÖ‚àáŒ¥Œ¶.
  ‚àÇt
" class="math-display"  /></center></td><td class="equation-label">(159)</td></tr></table>
<!--l. 1929--><p class="nopar" >
Begining with Eq. (<a 
href="#x1-31003r144">144<!--tex4ht:ref: 17-5-13-p2 --></a>) and following the same procedure in Sec. <a 
href="#x1-320004.2">4.2<!--tex4ht:ref: 24-3-21-p1 --></a>, we obtain the following
evoluation equation for <span 
class="cmmi-10">Œ¥f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation168x.png" alt="[ ‚àÇ                        ]
  ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX Œ¥f (h)

= ‚àí Œ¥VD ‚ãÖ‚àáXF0  + q-‚àÇF0[(VD + Œ¥VD )‚ãÖ‚àáX ‚ü®Œ¥Œ¶‚ü©]
                 m  ‚àÇùúÄ
‚àí -q‚àÇF0-[v‚à•(v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX ‚ü®Œ¥A(‚à•h)‚ü©‚àí ‚ü®Œ¥A (h‚à•)‚ü©(Œºe‚à• ‚ãÖ‚àáXB0 )].     (160)
  m  ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-33004r160"></a></center>
</div>In terms of <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>, the parallel Ampere‚Äôs law is written as
   <table 
class="equation"><tr><td><a 
 id="x1-33005r161"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation169x.png" alt="(            )          (         )
  ‚àë  œâ2                   ‚àë
(    -p2j‚àí ‚àá2‚ä•) Œ¥A(‚à•h)= Œº0(    Œ¥J(|h|j)) + ‚àá2‚ä•Œ¥A (s‚à•),
   j c                     j
" class="math-display"  /></center></td><td class="equation-label">(161)</td></tr></table>
<!--l. 1952--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥J</span><sub><span 
class="cmsy-7">||</span><span 
class="cmmi-7">j</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is the parallel current carried by the distrbution funciton <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">j</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>, where the subscript <span 
class="cmmi-10">j </span>is
species index. Here <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> has been moved to the right-hand side since its value is already known when
we solve the Ampere‚Äôs law for <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>.
</p><!--l. 1959--><p class="indent" >   Compared with the <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚à•</span></sub> formulation, the improvement of the above procedure is that a part of <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub> is
solved from an evolution equation (which is chosen by some physical consideration) and the remainder
is solved from the Ampere‚Äôs law. We hope that <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> is the dominant part of <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub> so that the remainder
solved from the Ampere‚Äôs law is small and hence the cancellation problem (of the Ampere‚Äôs law)
become less signiÔ¨Åcant. While a clever choice of the evolution equation for <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> may help ensure that
<span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> remain dominant over the entire simulation duration, we have another simple way to make
<span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> remain dominant: collect both <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> and <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> into <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">s</span><span 
class="cmr-7">)</span></sup> at the end of each time
step:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-33006r162"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation170x.png" alt="Œ¥A (s)  = Œ¥A(s) + Œ¥A(h).
   ‚à•new     ‚à•old    ‚à•old
" class="math-display"  /></center></td><td class="equation-label">(162)</td></tr></table>
<!--l. 1974--><p class="nopar" >
Then, to make <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub> untouched (so that electromagnetic Ô¨Åeld remain unchanged), we set <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> to
zero:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-33007r163"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation171x.png" alt="Œ¥A (h‚à•)new = 0.
" class="math-display"  /></center></td><td class="equation-label">(163)</td></tr></table>
                                                                                

                                                                                
<!--l. 1979--><p class="nopar" >
Here ‚Äúold‚Äù and ‚Äúnew‚Äù refers to before and after the re-spliting, respectively. Note that this re-spliting is
made at the end of each time step and does not correspond to any time evolution. This
re-splitting keeps the value of <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub> untouched and hence does not inÔ¨Çuence the electromagnetic
Ô¨Åeld. Meanwhile, the deÔ¨Ånition of Eq. (<a 
href="#x1-33001r157">157<!--tex4ht:ref: 23-11-16-p1 --></a>) indicates that, for a given <span 
class="cmmi-10">Œ¥f</span>, the re-splitting
will make the value of <span 
class="cmmi-10">Œ¥f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> increase by <span 
class="cmmi-10">Œî </span>= <img 
src="nonlinear_gyrokinetic_equation172x.png" alt="q-
m"  class="frac" align="middle" /><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmr-7">old</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmsy-10">‚ü©</span><sub>
<span 
class="cmmi-7">Œ±</span></sub><img 
src="nonlinear_gyrokinetic_equation173x.png" alt="‚àÇF0
 ‚àÇùúÄ"  class="frac" align="middle" /> since <span 
class="cmmi-10">Œ¥A</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup> is reduced
by <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmr-7">old</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>. To keep <span 
class="cmmi-10">Œ¥f </span>unchanged, which is what we need to ensure, we must add <span 
class="cmmi-10">Œî </span>to
<span 
class="cmmi-10">Œ¥f</span><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-33008r164"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation174x.png" alt="  (h)     (h)  -q     (h) ‚àÇF0-
Œ¥fnew = Œ¥fold + m ‚ü®v‚à•Œ¥A‚à•old‚ü© ‚àÇùúÄ .
" class="math-display"  /></center></td><td class="equation-label">(164)</td></tr></table>
<!--l. 1995--><p class="nopar" >
After the operations in (<a 
href="#x1-33006r162">162<!--tex4ht:ref: 23-11-16-p3 --></a>) (<a 
href="#x1-33007r163">163<!--tex4ht:ref: 23-11-16-p4 --></a>) and (<a 
href="#x1-33008r164">164<!--tex4ht:ref: 23-11-16-p5 --></a>), both the electromagnetic Ô¨Åeld and the distribution
function <span 
class="cmmi-10">Œ¥f </span>remain unchanged. Therefore we do not change any physical state of the system. Hence the
above operations can only have eÔ¨Äects on numerical round-oÔ¨Ä errors. As mentioned above, we hope the
numerical eÔ¨Äects will reduce the cancellation errors.
</p><!--l. 2003--><p class="indent" >   ¬†
</p><!--l. 2005--><p class="indent" >   Next, consider the special case that <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is a local Maxwellian given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-33009r165"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation175x.png" alt="               (   m    )3‚àï2   [   m ùúÄ ]
F0(X,ùúÄ) = n0(X ) 2œÄT-(X-)-   exp ‚àí T-(X)- ,
                    0              0
" class="math-display"  /></center></td><td class="equation-label">(165)</td></tr></table>
<!--l. 2010--><p class="nopar" >
Then <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span>and <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> are written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-33010r166"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation176x.png" alt="      (    )
‚àÇF0-=  ‚àí m-  F0,
 ‚àÇùúÄ      T
" class="math-display"  /></center></td><td class="equation-label">(166)</td></tr></table>
<!--l. 2015--><p class="nopar" >
and </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation177x.png" alt="‚àáF0 = ‚àÇF0-‚àán0 + ‚àÇF0‚àáT0
      ‚àÇn0       ‚àÇT(        )
    = F ‚àán0-+ F   mv2- ‚àí 3  ‚àáT0-
       0 n0     0  2T0   2   T0
          [    ( mv2   3 )   ]
    = ‚àí F0 Œ∫n +  2T0-‚àí 2  Œ∫T  ,                    (167)
" class="math-display"  /><a 
 id="x1-33011r167"></a></center>
</div>where <span 
class="cmmib-10">Œ∫</span><sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmsy-10">‚àí</span><img 
src="nonlinear_gyrokinetic_equation178x.png" alt="‚àán0
 n0"  class="frac" align="middle" />, and <span 
class="cmmib-10">Œ∫</span><sub><span 
class="cmmi-7">T</span></sub> = <span 
class="cmsy-10">‚àí</span><img 
src="nonlinear_gyrokinetic_equation179x.png" alt="‚àáT0
 T0"  class="frac" align="middle" />. Consider the case that <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,ùúÄ</span>) is independent of <span 
class="cmmi-10">ùúÉ </span>and <span 
class="cmmi-10">Œ±</span>, then
<span 
class="cmmib-10">Œ∫</span><sub><span 
class="cmmi-7">n</span></sub> and <span 
class="cmmib-10">Œ∫</span><sub><span 
class="cmmi-7">T</span></sub>are written as <span 
class="cmmib-10">Œ∫</span><sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmmi-10">Œ∫</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">r </span>and <span 
class="cmmib-10">Œ∫</span><sub><span 
class="cmmi-7">T</span></sub> = <span 
class="cmmi-10">Œ∫</span><sub><span 
class="cmmi-7">T</span></sub><span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">r</span>, where <span 
class="cmmi-10">Œ∫</span><sub><span 
class="cmmi-7">n</span></sub> <span 
class="cmsy-10">‚â°‚àí</span><img 
src="nonlinear_gyrokinetic_equation180x.png" alt="-1
n0"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation181x.png" alt="dn0
 dr"  class="frac" align="middle" />, <span 
class="cmmi-10">Œ∫</span><sub><span 
class="cmmi-7">T</span></sub> <span 
class="cmsy-10">‚â°‚àí</span><img 
src="nonlinear_gyrokinetic_equation182x.png" alt="1-
T0"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation183x.png" alt="dT0-
dr"  class="frac" align="middle" />, and <span 
class="cmmi-10">r </span>is
chosen to be the minor radius one the low Ô¨Åeld side.
<!--l. 2034--><p class="indent" >   Using the above results, Eq. (<a 
href="#x1-33004r160">160<!--tex4ht:ref: 17-6-21-3 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation184x.png" alt="   (h)              [    (    2    )   ]
dŒ¥f---= Œ¥VD ‚ãÖ‚àá œàdr- Œ∫n +  mv--‚àí 3  Œ∫T  F0 ‚àí q[(VD  + Œ¥VD )‚ãÖ‚àá‚ü®Œ¥Œ¶‚ü©]F0
 dt             dœà        2T0   2           T
      + q-[v‚à•(v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àá ‚ü®Œ¥A (h)‚ü©‚àí ‚ü®Œ¥A(h)‚ü©(Œºe‚à• ‚ãÖ‚àáB0 )]F0.        (168)
        T                          ‚à•       ‚à•
" class="math-display"  /><a 
 id="x1-33012r168"></a></center>
</div>
                                                                                

                                                                                
   <h5 class="subsubsectionHead"><a 
 id="x1-340004.3"></a>Weight evolution equation</h5>
<!--l. 2049--><p class="noindent" >The weight of the <span 
class="cmmi-10">j</span> th marker is deÔ¨Åned by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-34001r169"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation185x.png" alt="       (h)
wj = Œ¥f  (Xj,vj,t)Vpj0,
" class="math-display"  /></center></td><td class="equation-label">(169)</td></tr></table>
<!--l. 2052--><p class="nopar" >
where <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span><span 
class="cmr-7">0</span></sub> is the phase space volume occupied by the <span 
class="cmmi-10">j</span>th marker. Multiplying both sides of Eq. (<a 
href="#x1-33012r168">168<!--tex4ht:ref: 21-8-8-a1 --></a>)
by <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span><span 
class="cmr-7">0</span></sub>, and noting that <span 
class="cmmi-10">d</span>(<span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span><span 
class="cmr-7">0</span></sub>)<span 
class="cmmi-10">‚àïdt </span>= 0, we obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation186x.png" alt="dwj            dr[     (mv2    3)   ]         q
-dt-= Œ¥VD ‚ãÖ‚àá œàdœà- Œ∫n +  -2T- ‚àí 2  Œ∫T Vpj0F0 ‚àí T-[(VD + Œ¥VD ) ‚ãÖ‚ü®‚àá Œ¥Œ¶‚ü©]Vpj0F0.
      q                    0     (h)      (h)
    + T-[v‚à•(v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚ü®‚àá Œ¥A‚à• ‚ü©‚àí ‚ü®Œ¥A‚à• ‚ü©(Œºe‚à• ‚ãÖ‚àáB0 )]Vpj0F0,        (170)
" class="math-display"  /><a 
 id="x1-34002r170"></a></center>
</div>where use has been made of <span 
class="cmsy-10">‚àá‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü© </span>= <span 
class="cmsy-10">‚ü®‚àá</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü© </span>and <span 
class="cmsy-10">‚àá‚ü®</span><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmsy-10">‚ü© </span>= <span 
class="cmsy-10">‚ü®‚àá</span><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmsy-10">‚ü©</span>.
   <h5 class="subsubsectionHead"><a 
 id="x1-350004.3"></a>In Ô¨Åeld-aligned coordinates</h5>
<!--l. 2074--><p class="noindent" >In Ô¨Åeld-aligned coordinates (<span 
class="cmmi-10">x,y,z</span>), ¬†<img 
src="nonlinear_gyrokinetic_equation187x.png" alt="‚àÇŒ¥Œ¶
 ‚àÇx"  class="frac" align="middle" /> can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35001r171"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation188x.png" alt="‚àÇŒ¥Œ¶-  ‚àÇŒ¥Œ¶-     ‚àÇŒ¥Œ¶-    ‚àÇŒ¥Œ¶-
‚àÇx  = ‚àÇx ‚àáx +  ‚àÇy ‚àáy +  ‚àÇz ‚àáz.
" class="math-display"  /></center></td><td class="equation-label">(171)</td></tr></table>
<!--l. 2081--><p class="nopar" >
Note that the direction of <span 
class="cmmi-10">‚àÇ</span><span 
class="cmbx-10">r</span><span 
class="cmmi-10">‚àï‚àÇx </span>at <span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ </span>is diÔ¨Äerent from that of <span 
class="cmmi-10">‚àÇ</span><span 
class="cmbx-10">r</span><span 
class="cmmi-10">‚àï‚àÇx </span>at <span 
class="cmmi-10">ùúÉ </span>= +<span 
class="cmmi-10">œÄ</span>. This implies that
<span 
class="cmmi-10">‚àÇŒ¥Œ¶‚àï‚àÇx </span>is a non-periodic function of <span 
class="cmmi-10">ùúÉ</span>. Similarly, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y </span>is also a non-perioidic functon of <span 
class="cmmi-10">ùúÉ</span>. Then both
<span 
class="cmmi-10">‚àÇŒ¥Œ¶‚àï‚àÇx </span>and <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y </span>are discontinuous across the <span 
class="cmmi-10">ùúÉ </span>cut (<span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">¬±</span><span 
class="cmmi-10">œÄ</span>).
</p><!--l. 2090--><p class="indent" >   The gyro-average of expression (<a 
href="#x1-35001r171">171<!--tex4ht:ref: 23-11-29-p1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35002r172"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation189x.png" alt=" ‚àÇŒ¥Œ¶     ‚àÇŒ¥Œ¶       ‚àÇŒ¥Œ¶        ‚àÇŒ¥Œ¶
‚ü®-‚àÇx-‚ü© ‚âà ‚ü®-‚àÇx-‚ü©‚àáx + ‚ü®-‚àÇy-‚ü©‚àáy + ‚ü®‚àÇz-‚ü©‚àáz,
" class="math-display"  /></center></td><td class="equation-label">(172)</td></tr></table>
<!--l. 2096--><p class="nopar" >
where we approximate <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">x</span>, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y</span>, and <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">z </span>as constants when performing the gyro-averge since they
are determined by the equilibrim magnetic Ô¨Åeld, which is nearly constant on the Larmor
radius scale. As is mentioned above, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y </span>is not continuous at the <span 
class="cmmi-10">ùúÉ </span>cut. Do we need to worry
about this? We do not. This is because we must stick to the same branch when we perform
gryo-average on it, and hence <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y </span>is always continous. Then, do we need to worry about
the disconunity of <span 
class="cmmi-10">‚àÇŒ¥Œ¶‚àï‚àÇx </span>across the <span 
class="cmmi-10">ùúÉ </span>cut when performing the gyro-averge on it? We
do not either. The reason is the same: we must stick to a single branch. The disconunity
is just irrelevant here. The discontinuity only manifest itself when we need to infer value
on <span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ </span>from that on <span 
class="cmmi-10">ùúÉ </span>= +<span 
class="cmmi-10">œÄ </span>(vice versa), i.e., when across branch communication is
explicitly needed. In TEK, the Ô¨Åeld equations are not solved at <span 
class="cmmi-10">ùúÉ </span>= +<span 
class="cmmi-10">œÄ </span>and hence the Ô¨Åeld
values are not directly obtained. Instead, the Ô¨Åeld values at <span 
class="cmmi-10">ùúÉ </span>= +<span 
class="cmmi-10">œÄ </span>are infered from the
Ô¨Åeld values at <span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ </span>using the coninuity of <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">Œ¥Œ¶</span>. At the <span 
class="cmmi-10">ùúÉ </span>cut, the continuity of <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">Œ¥Œ¶</span>
requires
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35003r173"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation190x.png" alt="‚ü®‚àÇ-Œ¥Œ¶-‚ü©+‚àáx + ‚ü®‚àÇŒ¥Œ¶‚ü©‚àáy+  = ‚ü®‚àÇŒ¥Œ¶‚ü©‚àí ‚àáx + ‚ü®‚àÇŒ¥Œ¶-‚ü©‚àáy ‚àí ,
  ‚àÇx          ‚àÇy         ‚àÇx          ‚àÇy
" class="math-display"  /></center></td><td class="equation-label">(173)</td></tr></table>
<!--l. 2119--><p class="nopar" >
where the superscript ‚Äú+‚Äù and ‚Äú<span 
class="cmsy-10">‚àí</span>‚Äù refer to the location <span 
class="cmmi-10">ùúÉ </span>= +<span 
class="cmmi-10">œÄ </span>and <span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ</span>, respectively. Dotting the
above by <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">x</span>, we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35004r174"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation191x.png" alt=" ‚àÇ Œ¥Œ¶      ‚àÇ Œ¥Œ¶     ‚àÇŒ¥Œ¶  ‚àáy‚àí ‚ãÖ‚àáx ‚àí ‚àáy+ ‚ãÖ‚àáx
‚ü®-‚àÇx-‚ü©+ = ‚ü®‚àÇx-‚ü©‚àí + ‚ü®-‚àÇy-‚ü©------|‚àáx-|2-------,
" class="math-display"  /></center></td><td class="equation-label">(174)</td></tr></table>
<!--l. 2129--><p class="nopar" >
which is used in TEK to infer the value of <span 
class="cmsy-10">‚ü®</span><img 
src="nonlinear_gyrokinetic_equation192x.png" alt="‚àÇŒ¥Œ¶
‚àÇx"  class="frac" align="middle" /><span 
class="cmsy-10">‚ü©</span><sup><span 
class="cmr-7">+</span></sup> from that of <span 
class="cmsy-10">‚ü®</span><img 
src="nonlinear_gyrokinetic_equation193x.png" alt="‚àÇŒ¥Œ¶
 ‚àÇx"  class="frac" align="middle" /><span 
class="cmsy-10">‚ü©</span><sup><span 
class="cmsy-7">‚àí</span></sup>.
</p><!--l. 2134--><p class="indent" >   Similarly, for <span 
class="cmmi-10">‚àÇŒ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">(</span><span 
class="cmmi-7">h</span><span 
class="cmr-7">)</span></sup><span 
class="cmmi-10">‚àï‚àÇ</span><span 
class="cmbx-10">x</span>, we obtain:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35005r175"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation194x.png" alt="‚àÇŒ¥A(‚à•h)   ‚àÇŒ¥A(‚à•h)      ‚àÇŒ¥A(‚à•h)     ‚àÇŒ¥A(‚à•h)
------=  -----‚àáx +  -----‚àáy +  -----‚àáz.
  ‚àÇx      ‚àÇx         ‚àÇy         ‚àÇz
" class="math-display"  /></center></td><td class="equation-label">(175)</td></tr></table>
<!--l. 2143--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35006r176"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation195x.png" alt="    (h)       (h)          (h)          (h)
 ‚àÇŒ¥A‚à•--    ‚àÇŒ¥A‚à•--       ‚àÇŒ¥A‚à•--      ‚àÇŒ¥A-‚à•-
‚ü®  ‚àÇx  ‚ü© ‚âà ‚ü® ‚àÇx  ‚ü©‚àáx + ‚ü® ‚àÇy  ‚ü©‚àáy + ‚ü®  ‚àÇz  ‚ü©‚àáz
" class="math-display"  /></center></td><td class="equation-label">(176)</td></tr></table>
<!--l. 2151--><p class="nopar" >
Using these, Eq. (<a 
href="#x1-34002r170">170<!--tex4ht:ref: 17-7-25-1m --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation196x.png" alt="dwj           dr [     (mv2    3)   ]
-dt-= Œ¥VD ‚ãÖ‚àá œàdœà- Œ∫n +  2T0-‚àí  2 Œ∫T  Vpj0F0
        [        ‚Ä≤              ‚Ä≤               ‚Ä≤   ]
    ‚àí q- ‚ü®‚àÇŒ¥Œ¶‚ü©dX--‚ãÖ‚àáx + ‚ü®‚àÇŒ¥Œ¶-‚ü©dX--‚ãÖ‚àáy + ‚ü®‚àÇŒ¥Œ¶-‚ü©dX--‚ãÖ‚àáz  Vpj0F0
      T   ‚àÇ(x   dt         ‚àÇy  dt         ‚àÇz   dt            )
      q     ‚àÇŒ¥A (h‚à•) dX        ‚àÇ Œ¥A (‚à•h) dX        ‚àÇ Œ¥A (h‚à•) dX
    + --v‚à•(‚ü®------‚ü©--- ‚ãÖ‚àáx  +‚ü®------‚ü©--- ‚ãÖ‚àáy +‚ü®------‚ü©--- ‚ãÖ‚àáz) Vpj0F0
      T       ‚àÇx    dt         ‚àÇy    dt         ‚àÇz    dt
      q-   (h)
    ‚àí T ‚ü®Œ¥A ‚à• ‚ü©(Œºb ‚ãÖ‚àáB0 )Vpj0F0,                                        (177)
" class="math-display"  /></center>
</div>where <img 
src="nonlinear_gyrokinetic_equation197x.png" alt="ddXt-"  class="frac" align="middle" /> <span 
class="cmsy-10">‚â° </span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">b </span>+ <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> + <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> and <img 
src="nonlinear_gyrokinetic_equation198x.png" alt="  ‚Ä≤
dXdt"  class="frac" align="middle" /> <span 
class="cmsy-10">‚â° </span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> + <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub>. DeÔ¨Åne
   <table 
class="equation"><tr><td><a 
 id="x1-35008r178"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation199x.png" alt=" --  q Œ¥Œ¶  --(h)   quvuŒ¥A (h)
Œ¥Œ¶ = -u---,Œ¥A ‚à•  = ------‚à•-,
      Tu             Tu
" class="math-display"  /></center></td><td class="equation-label">(178)</td></tr></table>
<!--l. 2178--><p class="nopar" >
Then, a typical term of the above is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation200x.png" alt="                                    --
q    ‚àÇŒ¥A(‚à•h)dX          q  Tu   - ‚àÇ Œ¥A(‚à•h) dX-  --
T-v‚à•‚ü®-‚àÇx--‚ü©-dt ‚ãÖ‚àáxtn = T-q-v-vnv‚à•‚ü®-‚àÇx--‚ü©-dt ‚ãÖ‚àáx
                          uu       -(h)  --
                       q‚àïqu-vn-  ‚àÇŒ¥A‚à•-- dX- --
                     = T‚àïTu vuv‚à•‚ü® ‚àÇx   ‚ü©dt ‚ãÖ‚àáx,
" class="math-display"  /></center>
</div>where <img 
src="nonlinear_gyrokinetic_equation201x.png" alt="q‚àïqu-
T‚àïTu"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation202x.png" alt="vn
vu"  class="frac" align="middle" /> is the normlizing factor needed when coding. The mirror force term: <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation203x.png" alt="q‚ü®Œ¥A(h)‚ü©(Œºb ‚ãÖ‚àáB0)tn = q-Tu--BnŒºn-‚ü®Œ¥A-(h‚à•)‚ü©(Œºb ‚ãÖ‚àáB0-)tn           (179)
T   ‚à•                T quvu  Ln
                     q‚àïqu-1-Bnv2n  -(h) -- ----
                  =  T‚àïTu vuLnBn ‚ü®Œ¥A‚à• ‚ü©(Œºb ‚ãÖ‚àá B0)tn
                     q‚àïqu vn --(h)  -- ----
                  =  T‚àïT--v-‚ü®Œ¥A ‚à• ‚ü©(Œºb‚ãÖ‚àá B0)
                        u  u
" class="math-display"  /></center>
</div>where <img 
src="nonlinear_gyrokinetic_equation204x.png" alt="q‚àïqu-
T‚àïTu"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation205x.png" alt="vn
vu"  class="frac" align="middle" /> is the normlizing factor needed when coding.
<!--l. 2209--><p class="indent" >   The pullback: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation206x.png" alt="                            (   )
q‚ü®v‚à•Œ¥A(h)‚ü©‚àÇF0-Vp = q-‚ü®v‚à•Œ¥A(h)‚ü© ‚àí m- F0Vp
m     ‚à•   ‚àÇùúÄ      m     ‚à•      T
               ‚âà ‚àí q-v‚à•‚ü®Œ¥A (h‚à•)‚ü©F0Vp
                   T
               = ‚àí q‚àïqu-v‚à•‚ü®Œ¥A(‚à•h)‚ü©F0Vp
                   T‚àïTu vu
" class="math-display"  /></center>
</div>The <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E </span><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> drift term is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation207x.png" alt="   ‚àÇŒ¥Œ¶             (                            )
‚àí ‚ü®‚àÇx-‚ü©√ó-B0-= ‚àí 1-- ‚ü®‚àÇŒ¥Œ¶-‚ü©‚àáx + ‚ü®‚àÇŒ¥Œ¶-‚ü©‚àáy +‚ü®‚àÇ-Œ¥Œ¶-‚ü©‚àáz  √ó B0
     B20        B20    ‚àÇx        ‚àÇy        ‚àÇz
                ‚àÇ-Œ¥Œ¶ -1-          ‚àÇŒ¥Œ¶- -1-          ‚àÇŒ¥Œ¶- 1--
            = ‚àí ‚ü®‚àÇx ‚ü©B20 ‚àáx √ó B0 ‚àí ‚ü® ‚àÇy ‚ü©B20‚àáy √ó B0 ‚àí ‚ü® ‚àÇz ‚ü©B20‚àáz √ó B0.
" class="math-display"  /></center>
</div>The <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">x</span>, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y</span>, and <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">z </span>components of the above expression are written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation208x.png" alt="  ‚ü®‚àÇ‚àÇŒ¥Œ¶x-‚ü©√ó-B0-        ‚àÇŒ¥Œ¶- -1-              ‚àÇŒ¥Œ¶- 1--
‚àí    B20    ‚ãÖ‚àáx = ‚àí ‚ü® ‚àÇy ‚ü©B20‚àáy √óB0 ‚ãÖ‚àáx ‚àí ‚ü® ‚àÇz ‚ü©B20‚àáz √ó B0 ‚ãÖ‚àáx
                    ‚àÇŒ¥Œ¶   1               ‚àÇŒ¥Œ¶  1
                = ‚àí ‚ü®-‚àÇy-‚ü©B2‚àáx √ó ‚àáy ‚ãÖB0 ‚àí ‚ü®-‚àÇz-‚ü©B2‚àáx √ó ‚àáz ‚ãÖB0.     (180)
                          0                     0
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation209x.png" alt="   ‚àÇŒ¥Œ¶
‚àí ‚ü®-‚àÇx-‚ü©√ó2-B0-‚ãÖ‚àáy = ‚àí ‚ü®‚àÇŒ¥Œ¶‚ü©-12‚àáx √ó B0 ‚ãÖ‚àáy ‚àí ‚ü®‚àÇ-Œ¥Œ¶-‚ü©-12-‚àáz √óB0 ‚ãÖ‚àáy
      B0             ‚àÇx  B 0               ‚àÇz  B0
                = ‚ü®‚àÇŒ¥Œ¶-‚ü© 1-‚àáx √ó ‚àáy ‚ãÖB ‚àí ‚ü®‚àÇŒ¥Œ¶‚ü©-1-‚àáy √ó ‚àáz ‚ãÖB        (181)
                    ‚àÇx  B20           0    ‚àÇz B20          0
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation210x.png" alt="  ‚ü®‚àÇŒ¥‚àÇxŒ¶‚ü©√ó-B0-         ‚àÇŒ¥Œ¶--1-              ‚àÇ-Œ¥Œ¶- -1-
‚àí     B20    ‚ãÖ‚àáz = ‚àí ‚ü®‚àÇx ‚ü©B20‚àáx √ó B0 ‚ãÖ‚àáz ‚àí ‚ü® ‚àÇy ‚ü©B20 ‚àáy √óB0 ‚ãÖ‚àáz
                   ‚àÇŒ¥Œ¶  1                ‚àÇŒ¥Œ¶  1
                = ‚ü®-‚àÇx-‚ü©B2‚àáx √ó ‚àáz ‚ãÖB0 + ‚ü®-‚àÇy ‚ü©B2-‚àáy √ó ‚àáz ‚ãÖB0      (182)
                         0                     0
" class="math-display"  /></center>
</div>
<!--l. 2276--><p class="indent" >   Using
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35016r183"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation211x.png" alt="dx
--= VG  ‚ãÖ‚àáx,
dt
" class="math-display"  /></center></td><td class="equation-label">(183)</td></tr></table>
<!--l. 2279--><p class="nopar" >
i.e.,
</p>
                                                                                

                                                                                
   <table 
class="equation"><tr><td><a 
 id="x1-35017r184"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation212x.png" alt="dx-= tnVG  ‚ãÖ‚àáx
dt
" class="math-display"  /></center></td><td class="equation-label">(184)</td></tr></table>
<!--l. 2283--><p class="nopar" >
To get the normalizing factor, consider only the contribution from <span 
class="cmmi-10">E </span><span 
class="cmsy-10">√ó</span><span 
class="cmmi-10">B </span>drift. Then a typical term is
written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation213x.png" alt="dx       ‚àÇŒ¥Œ¶  1
dt = ‚àí tn‚ü®‚àÇy-‚ü©B2-‚àáx √ó ‚àáy ‚ãÖB0
               0 --
  =  ‚àí Tu-tn--‚ü®‚àÇŒ¥Œ¶‚ü©-1-‚àáx √ó ‚àáy ‚ãÖB0
      qu BnL2n ‚àÇy  B20
      T     1    ‚àÇŒ¥Œ¶- 1 --   --  --
  =  ‚àí-u--------‚ü®---‚ü©--2‚àáx √ó ‚àáy ‚ãÖB0,                 (185)
      qu BnvnLn  ‚àÇy  B 0
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">T</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub>) is the normlizing factor we need when coding.
<!--l. 2301--><p class="indent" >   The magnetic Ô¨Çuttering term is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation214x.png" alt="                        ‚ü®    (                           )‚ü©
‚àí v‚à•‚ü®b √ó ‚àá (Œ¥A )‚ü© = ‚àí v‚à• b √ó  ‚àÇŒ¥A-‚à•‚àáx + ‚àÇŒ¥A-‚à•‚àáy + ‚àÇŒ¥A‚à•‚àáz
  B0      x   ‚à•      B0        ‚àÇx        ‚àÇy        ‚àÇz
                     v‚à•-   ( ‚àÇŒ¥A-‚à•       ‚àÇŒ¥A‚à•-      ‚àÇŒ¥A‚à•-   )
                 ‚âà ‚àí B0b √ó  ‚ü® ‚àÇx  ‚ü©‚àáx + ‚ü® ‚àÇy ‚ü©‚àáy + ‚ü® ‚àÇz ‚ü©‚àáz
" class="math-display"  /></center>
</div>The <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">x</span>, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y</span>, and <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">z </span>components of the above expression are written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation215x.png" alt="  v‚à•                     v‚à•    ( ‚àÇ Œ¥A ‚à•       ‚àÇŒ¥A‚à•    )
‚àí B-‚ü®b √ó ‚àáx(Œ¥A‚à•)‚ü©‚ãÖ‚àáx = ‚àí B--b√ó  ‚ü®--‚àÇy-‚ü©‚àáy + ‚ü®-‚àÇz-‚ü©‚àáz  ‚ãÖ‚àáx
   0                      0(                               )
                     =  v‚à•2- ‚ü®‚àÇŒ¥A‚à•‚ü©‚àáx √ó ‚àáy + ‚ü®‚àÇŒ¥A‚à•-‚ü©‚àáx √ó ‚àáz   ‚ãÖB0    (186)
                        B0    ‚àÇy              ‚àÇz
" class="math-display"  /></center>
</div><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation216x.png" alt="                               (                     )
‚àí v‚à•‚ü®b √ó ‚àáx(Œ¥A )‚ü©‚ãÖ‚àáy = ‚àí v‚à•-b√ó  ‚ü®‚àÇ-Œ¥A-‚à•‚ü©‚àáx + ‚ü®‚àÇŒ¥A‚à•‚ü©‚àáz  ‚ãÖ‚àáy
  B0          ‚à•          B0        ‚àÇx         ‚àÇz
                        v‚à•(  ‚àÇŒ¥A‚à•-           ‚àÇŒ¥A‚à•-        )
                     =  B20  ‚ü® ‚àÇx ‚ü©‚àáy √ó ‚àáx + ‚ü® ‚àÇz  ‚ü©‚àáy √ó ‚àáz   ‚ãÖB0    (187)
" class="math-display"  /></center>
</div><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation217x.png" alt="                               (                     )
‚àí v‚à•‚ü®b √ó ‚àá (Œ¥A )‚ü©‚ãÖ‚àáz = ‚àí v‚à•-b√ó  ‚ü®‚àÇ-Œ¥A-‚à•‚ü©‚àáx + ‚ü®‚àÇŒ¥A‚à•‚ü©‚àáy  ‚ãÖ‚àáz
  B0      x   ‚à•          B0        ‚àÇx         ‚àÇy
                        v‚à•(  ‚àÇŒ¥A‚à•-           ‚àÇŒ¥A‚à•-        )
                     =  B2  ‚ü® ‚àÇx ‚ü©‚àáz √ó ‚àáx + ‚ü® ‚àÇy  ‚ü©‚àáz √ó ‚àáy   ‚ãÖB0    (188)
                         0
" class="math-display"  /></center>
</div>
<!--l. 2354--><p class="indent" >   Also to get the normalizing factor needed in the code, consider a typical term: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation218x.png" alt="dx      v  ‚àÇŒ¥A
---= tn-‚à•2‚ü®---‚à•‚ü©‚àáx √ó ‚àáy ‚ãÖB0
 dt    B 0  ‚àÇy   -    --
   =  Tu--t--vn- v‚à•‚ü®‚àÇŒ¥A-‚à•‚ü©‚àáx √ó ‚àáy ‚ãÖB-
      quvu nL2nBn B2  ‚àÇy             0
               -  0  --          --
   =  Tu----1--v‚à•2‚ü®‚àÇŒ¥A‚à•‚ü©‚àáx √ó ‚àáy ‚ãÖB0                   (189)
      quvu LnBn B 0  ‚àÇy
" class="math-display"  /></center>
</div>
<!--l. 2371--><p class="indent" >   where <span 
class="cmmi-10">T</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub>) is the normlizing factor I need when coding.
</p><!--l. 2373--><p class="indent" >   The basic terms involved in the above expressions can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35024r190"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation219x.png" alt="                B2
(‚àáx √ó ‚àáy )‚ãÖB0 = -0‚Ä≤ ,
                Œ®
" class="math-display"  /></center></td><td class="equation-label">(190)</td></tr></table>
<!--l. 2376--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35025r191"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation220x.png" alt="               (               )
(‚àáx  √ó‚àáz )‚ãÖB0 =   ‚àÇx-‚àÇz-‚àí ‚àÇx-‚àÇz-  Bœï ‚â° W 14
                 ‚àÇZ ‚àÇR   ‚àÇR ‚àÇZ
" class="math-display"  /></center></td><td class="equation-label">(191)</td></tr></table>
<!--l. 2382--><p class="nopar" >
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation221x.png" alt="               -- (         )  -- (               )   -- (         )
(‚àáy √ó ‚àáz)‚ãÖB0 = BR   1-‚àÇŒ±-‚àÇùúÉ- + B œï  ‚àÇŒ±-‚àÇùúÉ-‚àí ‚àÇŒ±-‚àÇ-ùúÉ  + BZ  ‚àí 1-‚àÇŒ±-‚àÇùúÉ-
                    R ‚àÇœï ‚àÇZ         ‚àÇZ ‚àÇR   ‚àÇR ‚àÇZ           R ‚àÇœï ‚àÇR
             ‚â° W 15                                                   (192)
" class="math-display"  /></center>
</div>
<!--l. 2396--><p class="indent" >   DeÔ¨Åne
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35027r193"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation222x.png" alt=" --  q Œ¥Œ¶  -(h)  quvuŒ¥A(h) --(s)   quvuŒ¥A (s)  -(h)   Œ¥J(h)
Œ¥Œ¶ = -u--,Œ¥A‚à•  = ------‚à•--,Œ¥A ‚à• =  ------‚à•-,Œ¥J||s = ---‚à•s--,
      Tu            Tu               Tu           nuquvns
" class="math-display"  /></center></td><td class="equation-label">(193)</td></tr></table>
<!--l. 2403--><p class="nopar" >
where <span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,n</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,T</span><sub><span 
class="cmmi-7">u</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">u</span></sub> are chosen units, <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">ns</span></sub> is a velocity unit for a species, whose value is diÔ¨Äerent among
diÔ¨Äerent species [<span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">ns</span></sub> = <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">‚àï</span>(2<span 
class="cmmi-10">œÄ‚àï</span>(<span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmsy-10">|</span><span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">s</span></sub><span 
class="cmsy-10">|</span><span 
class="cmmi-10">‚àïm</span><sub><span 
class="cmmi-7">s</span></sub>))]. In <span 
class="cmtt-10">TEK</span>, <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">u</span></sub> is chosen as <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">ns</span></sub> of the Ô¨Årst ion
species.
</p><!--l. 2409--><p class="indent" >   Then the Ampere‚Äôs law (<a 
href="#x1-33005r161">161<!--tex4ht:ref: 23-12-4-1 --></a>) is written as
                                                                                

                                                                                
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35028r194"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation223x.png" alt="(            )
 ‚àë   œâ2ps    2   -(h)   nuq2uv2u ‚àë  vns -(h)   2 --(s)
     c2-‚àí ‚àá ‚ä•  Œ¥A‚à•  = ùúÄ-T-c2    -v-Œ¥J||s + ‚àá‚ä• Œ¥A ‚à• ,
  s                    0 u    s  u
" class="math-display"  /></center></td><td class="equation-label">(194)</td></tr></table>
<!--l. 2415--><p class="nopar" >
where use has been made of <span 
class="cmmi-10">Œº</span><sub><span 
class="cmr-7">0</span></sub> = 1<span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">c</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmr-7">0</span></sub>).
</p><!--l. 2418--><p class="indent" >   <span 
class="cmmi-10">Œ¥f </span>pullback in Eq. (<a 
href="#x1-33008r164">164<!--tex4ht:ref: 23-11-16-p5 --></a>) is now written as (for the case of <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> being Maxwellian): </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation224x.png" alt="  (h)     (h)   q-    (h)  (  m-)
Œ¥fnew = Œ¥fold + m‚ü®v‚à•Œ¥A‚à•old‚ü©Œ± ‚àí T   F0
     = f(h)‚àí  q‚ü®v‚à•Œ¥A(h)‚ü©Œ±F0
        old   T     ‚à•old
     = f(h)‚àí  qv‚à•vn‚ü®Œ¥A-(h)‚ü©Œ±F0                        (195)
        old   T  vu    ‚à•old
" class="math-display"  /></center>
</div>In terms of units used in <span 
class="cmtt-10">TEK</span>, Eq. (<a 
href="#x1-33003r159">159<!--tex4ht:ref: 23-11-16-2 --></a>) is written as
   <table 
class="equation-star"><tr><td>
                          <img 
src="nonlinear_gyrokinetic_equation225x.png" alt="  --(s)
‚àÇ-Œ¥A-‚à•-
  ‚àÇt"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation226x.png" alt="-Tu-
quvu"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation227x.png" alt="1-
tu"  class="frac" align="middle" /> = <span 
class="cmsy-10">‚àí</span><img 
src="nonlinear_gyrokinetic_equation228x.png" alt="-Tu--
quLn"  class="frac" align="middle" /><span 
class="cmbx-10">b </span><span 
class="cmsy-10">‚ãÖ</span><span class="overline"><span 
class="cmsy-10">‚àá</span></span><span 
class="cmmi-10">Œ¥</span><span class="overline"><span 
class="cmmi-10">Œ¶</span></span><span 
class="cmmi-10">,</span>
</td></tr></table>
                                                                                

                                                                                
<!--l. 2435--><p class="nopar" >
where <span class="overline"><span 
class="cmmi-10">t</span></span> = <span 
class="cmmi-10">t‚àït</span><sub><span 
class="cmmi-7">u</span></sub>, <span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">u</span></sub> = <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">‚àïv</span><sub><span 
class="cmmi-7">u</span></sub>. Then the above equation is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35030r196"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation229x.png" alt="‚àÇ Œ¥A-(s)       ----
----‚à•- = ‚àí b ‚ãÖ‚àáŒ¥Œ¶,
  ‚àÇt
" class="math-display"  /></center></td><td class="equation-label">(196)</td></tr></table>
<!--l. 2441--><p class="nopar" >
i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-35031r197"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation230x.png" alt="  --(s)             --
‚àÇ-Œ¥A-‚à•- = ‚àí (b ‚ãÖ‚àáz )‚àÇŒ¥Œ¶-.
  ‚àÇt              ‚àÇz
" class="math-display"  /></center></td><td class="equation-label">(197)</td></tr></table>
<!--l. 2447--><p class="nopar" >
</p><!--l. 2450--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.4   </span> <a 
 id="x1-360004.4"></a>Summary of distribution function split</h4>
<!--l. 2452--><p class="noindent" >In simulations, the seemingly trivial thing on how to split the distribution function is often a big deal.
Separating the perturbation from the total distribution function gives rise to the the famous ‚Äú<span 
class="cmmi-10">Œ¥f</span>
particle method‚Äù, in contrast to the conventional particle method which is now called full-f particle
method.
</p><!--l. 2458--><p class="indent" >   In the above, the perturbed part of the distribution function, <span 
class="cmmi-10">Œ¥F</span>, is split at least three times in
order to (1) simplify the gyrokinetic equation by splitting out the adiabatic response; (2)
eliminate the time derivatives, <span 
class="cmmi-10">‚àÇŒ¥œï‚àï‚àÇt </span>and <span 
class="cmmi-10">‚àÇŒ¥</span><span 
class="cmbx-10">A</span><span 
class="cmmi-10">‚àï‚àÇt</span>, on the right-hand. To avoid confusion, I
summarize the split of the distribution function here. The total distribution function <span 
class="cmmi-10">F </span>is split
as
                                                                                

                                                                                
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-36001r198"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation231x.png" alt="F = F0 +Œ¥F,
" class="math-display"  /></center></td><td class="equation-label">(198)</td></tr></table>
<!--l. 2466--><p class="nopar" >
where <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is the equilibrium distribution function and <span 
class="cmmi-10">Œ¥F </span>is the perturbed part of the total distribution
function. <span 
class="cmmi-10">Œ¥F </span>is further split as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-36002r199"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation232x.png" alt="Œ¥F = Œ¥h + -q(Œ¥Œ¶‚àí ‚ü®Œ¥Œ¶‚ü©)‚àÇF0-+ q-‚ü®v‚ãÖŒ¥A ‚ü©‚àÇF0,
         m            ‚àÇùúÄ   m        ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(199)</td></tr></table>
<!--l. 2475--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥h </span>satisÔ¨Åes the gyrokinetic equation (<a 
href="#x1-32006r151">151<!--tex4ht:ref: 19-1-4-e1 --></a>) or (<a 
href="#x1-32011r156">156<!--tex4ht:ref: 19-1-4-5 --></a>). In PIC simulations, <span 
class="cmmi-10">Œ¥h </span>is evolved by using
markers and its moment in the phase-space is evaluated via Monte-Carlo integration. The blue and red
terms explicitly depends on the unknown perturbed Ô¨Åeld. After being integrated in the velocity space,
these two terms give ¬†the polarization density and the skin current, respectively. The polarization
density is discussed in Sec. <a 
href="#x1-400006">6<!--tex4ht:ref: 19-1-4-1 --></a>. The skin current is discussed in Sec. (<a 
href="#x1-370004.5">4.5<!--tex4ht:ref: 24-12-10-e1 --></a>) and the so-called ‚Äúcancellation
problem‚Äù is discussed in Sec. <a 
href="#x1-380005">5<!--tex4ht:ref: 24-12-10-e2 --></a>.
</p><!--l. 2486--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.5   </span> <a 
 id="x1-370004.5"></a>Skin current</h4>
<!--l. 2488--><p class="noindent" >Let us calculate the velocity space moment of <img 
src="nonlinear_gyrokinetic_equation233x.png" alt="q-
m"  class="frac" align="middle" /><span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©</span><img 
src="nonlinear_gyrokinetic_equation234x.png" alt="‚àÇF0
 ‚àÇùúÄ"  class="frac" align="middle" />. Consider the approximation <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span><span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>,
then the blue term in Eq. (<a 
href="#x1-36002r199">199<!--tex4ht:ref: 19-1-3-e2 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37001r200"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation235x.png" alt=" q       ‚àÇF0
m-‚ü®v‚à•Œ¥A‚à•‚ü©-‚àÇùúÄ .
" class="math-display"  /></center></td><td class="equation-label">(200)</td></tr></table>
<!--l. 2496--><p class="nopar" >
Notice that <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> can be taken out of the gyro-averaging. Then the above equation is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37002r201"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation236x.png" alt="-qv‚à•‚ü®Œ¥A‚à•‚ü©‚àÇF0.
m         ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(201)</td></tr></table>
<!--l. 2502--><p class="nopar" >
If we neglect the FLR eÔ¨Äect, then the above expression is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37003r202"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation237x.png" alt=" q     ‚àÇF0
m-v‚à•Œ¥A‚à•-‚àÇùúÄ-.
" class="math-display"  /></center></td><td class="equation-label">(202)</td></tr></table>
<!--l. 2507--><p class="nopar" >
The zeroth order moment (number density) is then written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37004r203"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation238x.png" alt="           ‚à´
     q-        ‚àÇF0-
Œ¥n = m Œ¥A‚à•   v‚à•‚àÇ ùúÄ dv,
" class="math-display"  /></center></td><td class="equation-label">(203)</td></tr></table>
<!--l. 2512--><p class="nopar" >
which is zero if <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is Maxwellian. Next, consider the parallel current carried by distribution (<a 
href="#x1-37003r202">202<!--tex4ht:ref: 19-2-20-5 --></a>),
which is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37005r204"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation239x.png" alt="     q2    ‚à´  2‚àÇF0
Œ¥j‚à• = m-Œ¥A ‚à• v‚à•-‚àÇùúÄ-dv.
" class="math-display"  /></center></td><td class="equation-label">(204)</td></tr></table>
<!--l. 2518--><p class="nopar" >
If <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is a Maxwellian distribution given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37006r205"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation240x.png" alt="      (  m  )3‚àï2    (  mv2)
F0 = n0 2œÄT-   exp  ‚àí 2T-- .
" class="math-display"  /></center></td><td class="equation-label">(205)</td></tr></table>
<!--l. 2523--><p class="nopar" >
then
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37007r206"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation241x.png" alt="‚àÇF0-   m-
‚àÇùúÄ  = ‚àíT F0.
" class="math-display"  /></center></td><td class="equation-label">(206)</td></tr></table>
<!--l. 2527--><p class="nopar" >
Then expression (<a 
href="#x1-37005r204">204<!--tex4ht:ref: 19-2-20-1 --></a>) is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37008r207"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation242x.png" alt="       q2   ( m  )3‚àï2    ‚à´       (  mv2)
Œ¥j‚à• = ‚àí T-n0 2œÄT-   Œ¥A ‚à•  v2‚à•exp  ‚àí 2T-- dv.
" class="math-display"  /></center></td><td class="equation-label">(207)</td></tr></table>
<!--l. 2533--><p class="nopar" >
Working in the spherical coordinates, then <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmmi-10">v</span> cos<span 
class="cmmi-10">ùúÉ </span>and <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= <span 
class="cmmi-10">v</span><sup><span 
class="cmr-7">2</span></sup> sin<span 
class="cmmi-10">ùúÉdvdùúÉdœï</span>. Then expression (<a 
href="#x1-37008r207">207<!--tex4ht:ref: 19-2-20-4 --></a>)
is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation243x.png" alt="           (     )      ‚à´            (     )
Œ¥j = ‚àí q2n   -m-- 3‚àï2Œ¥A    v2cos2ùúÉexp  ‚àí mv2- v2sinùúÉdvdùúÉdœï
  ‚à•    T  0  2œÄT       ‚à•                2T
       q2  (  m  )3‚àï2    4œÄ‚à´   4   (  mv2 )
   = ‚àí T-n0  2œÄT-   Œ¥A ‚à•3--  v exp  ‚àí-2T-  dv
        2  (  )3 ‚àï2         ‚à´
   = ‚àí q-n0  1-    2TŒ¥A  4œÄ-  x4exp(‚àí x2)dx
       T     œÄ     m    ‚à•3
       q2  ( 1)3 ‚àï2 2T    4œÄ3‚àö œÄ-
   = ‚àí T-n0  œÄ-    m-Œ¥A ‚à•3---8-
        2
   = ‚àí q-n0Œ¥A‚à•.                                                 (208)
       m
" class="math-display"  /></center>
</div>Using <span 
class="cmmi-10">c </span>= 1<span 
class="cmmi-10">‚àï</span><img 
src="nonlinear_gyrokinetic_equation244x.png" alt="‚àö----
 Œº0ùúÄ0"  class="sqrt"  /> and <span 
class="cmmi-10">œâ</span><sub><span 
class="cmmi-7">p</span></sub><sup><span 
class="cmr-7">2</span></sup> = <span 
class="cmmi-10">n</span><sub>
<span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">q</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">mùúÄ</span><sub>
<span 
class="cmr-7">0</span></sub>), the above expression can be written as
   <table 
class="equation"><tr><td><a 
 id="x1-37010r209"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation245x.png" alt="         œâ2p-
Œº0Œ¥j‚à• = ‚àí c2 Œ¥A ‚à•,
" class="math-display"  /></center></td><td class="equation-label">(209)</td></tr></table>
<!--l. 2556--><p class="nopar" >
where the <span 
class="cmmi-10">c‚àïœâ</span><sub><span 
class="cmmi-7">ps</span></sub> is often called the skin depth of species ‚Äús‚Äù. This current <span 
class="cmmi-10">Œ¥j</span><sub><span 
class="cmsy-7">‚à•</span></sub> is often called ‚Äúskin
current‚Äù, which can also be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-37011r210"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation246x.png" alt="         Œ≤
Œº0Œ¥j‚à• = ‚àí-2Œ¥A ‚à•,
         œÅ
" class="math-display"  /></center></td><td class="equation-label">(210)</td></tr></table>
<!--l. 2562--><p class="nopar" >
where <span 
class="cmmi-10">œÅ </span>= <img 
src="nonlinear_gyrokinetic_equation247x.png" alt="‚àò -----
  2T‚àïm"  class="sqrt"  /><span 
class="cmmi-10">‚àïŒ© </span>is the thermal Larmor radius.
                                                                                

                                                                                
</p><!--l. 2565--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-380005"></a>Parallel Ampere‚Äôs Law</h3>
   <table 
class="equation"><tr><td><a 
 id="x1-38001r211"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation248x.png" alt="   2   (n+1)       (n+1)    (n+1)
‚àí ‚àá‚ä• Œ¥A‚à•    = Œº0(Œ¥J ||i   + Œ¥J||e   ),
" class="math-display"  /></center></td><td class="equation-label">(211)</td></tr></table>
<!--l. 2569--><p class="nopar" >
where the parallel currents are given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-38002r212"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation249x.png" alt="                         ‚à´
Œ¥J(n+1)= Œ¥J ‚Ä≤(Œ¥œï(n),Œ¥A(n)) +  (v(n+1))2 q2i-‚ü®Œ¥A (n+1)‚ü© ‚àÇFi0dv,
  ||i       ||i        ‚à•        ‚à•     mi    ‚à•    Œ± ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(212)</td></tr></table>
<!--l. 2577--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-38003r213"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation250x.png" alt="                       ‚à´         q2          ‚àÇF
Œ¥J||e = Œ¥J‚Ä≤||e(Œ¥œï(n),Œ¥A (n‚à•))+  (v(n‚à•+1))2-e‚ü®Œ¥A (n‚à•+1)‚ü©Œ± --e0dv,
                                 me           ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(213)</td></tr></table>
                                                                                

                                                                                
<!--l. 2583--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥J</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">i</span></sub><span 
class="cmsy-10">‚Ä≤ </span>and <span 
class="cmmi-10">Œ¥J</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">e</span></sub><span 
class="cmsy-10">‚Ä≤ </span>is the parallel current carried by the distribution function <span 
class="cmmi-10">Œ¥h </span>in Eq. (<a 
href="#x1-36002r199">199<!--tex4ht:ref: 19-1-3-e2 --></a>), which
are updated from the value at the <span 
class="cmmi-10">n</span>th time step using an explicit scheme and therefore does not
depends on the Ô¨Åeld at the (<span 
class="cmmi-10">n </span>+ 1)th step. The blue terms ¬†in Eqs. (<a 
href="#x1-38002r212">212<!--tex4ht:ref: 19-3-21-4 --></a>) and (<a 
href="#x1-38003r213">213<!--tex4ht:ref: 19-3-21-5 --></a>) are called ‚Äúskin
current‚Äù, which depend on the unknown Ô¨Åeld at the (<span 
class="cmmi-10">n </span>+ 1)th step and thus need to be moved to the
left-hand side of Ampere‚Äôs law (<a 
href="#x1-38001r211">211<!--tex4ht:ref: 19-3-21-6 --></a>) if we want to solve this equation by direct methods. In this case,
equation (<a 
href="#x1-38001r211">211<!--tex4ht:ref: 19-3-21-6 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation251x.png" alt="               ‚à´
‚àí ‚àá2 Œ¥A(n+1)‚àí Œº  (v(n+1))2 q2i‚ü®Œ¥A(n+1)‚ü© ‚àÇFi0-dv
   ‚ä•  ‚à•       0    ‚à•     mi   ‚à•    Œ± ‚àÇ ùúÄ
   ‚à´   (n+1) 2 q2e   (n+1)  ‚àÇFe0
‚àí Œº0 (v‚à•   ) me‚ü®Œ¥A ‚à•   ‚ü©Œ±  ‚àÇùúÄ dv.
= Œº (Œ¥J ‚Ä≤+ Œ¥J‚Ä≤ )                                         (214)
   0  ‚à•i    ||e
" class="math-display"  /></center>
</div>Then we need to put the blue terms into matrix form. If we put the bule terms into martrix form by
using numerical spatial grid integration (as we do for the polarization density), then there arises the
cancellation propblem (i.e., the two parts of the distribution are evaluated by diÔ¨Äerent methods,one
is grid-based and the other is MC marker based, there is a risk that the sum of the two
terms will be inaccurate when the two terms are of opposite signs and large amplitudes, and
the Ô¨Ånal result amplitude is expected to be much smaller than the amplituded of the two
terms). If we get the matrix form by evaluating it numerically using MC markers (which
can avoid the cancellation problem), the corresponding matrix will depends on markers
and thus needs to be re-constructed and inverted each time-step, which is computationally
expensive.
<!--l. 2617--><p class="noindent" >Therefore we go back to Eq. (<a 
href="#x1-38001r211">211<!--tex4ht:ref: 19-3-21-6 --></a>) and try to solve it using iterative methods. However, it is found
numerically that directly using Eq. (<a 
href="#x1-38001r211">211<!--tex4ht:ref: 19-3-21-6 --></a>) as an iterative scheme is usually divergent. To obtain a
convergent iterative scheme, we need to have an approximate form for the blue terms, which is
independent of markers and so that it is easy to construct its matrix, and then subtract this
approximate form from both sides. After doing this, the iterative scheme has better chance to be
convergent (partially due to that the right-hand side becomes smaller). An approximate form is that
derived by neglecting the FLR eÔ¨Äect given in Sec. <a 
href="#x1-370004.5">4.5<!--tex4ht:ref: 19-3-21-8 --></a>. Using this, the iterative scheme for solving Eq.
(<a 
href="#x1-38001r211">211<!--tex4ht:ref: 19-3-21-6 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation252x.png" alt="              (                       )
    2  (n+1)     œâ2pi  (n+1)  œâ2pe  (n+1)
‚àí ‚àá ‚ä•Œ¥A‚à•    ‚àí  ‚àí c2 Œ¥A‚à•    ‚àí c2 Œ¥A‚à•
       ‚Ä≤     ‚Ä≤
= Œº0(‚à´Œ¥J‚à•i + Œ¥J||e)
        (n+1) 2 q2i  (n+1) ‚àÇFi0
+ Œº0  (v‚à•   ) mi‚ü®Œ¥A‚à•   ‚ü©Œ± ‚àÇùúÄ dv
    ‚à´   (n+1)  q2   (n+1)  ‚àÇFe0
+ Œº0  (v‚à•   )2me‚ü®Œ¥A‚à•    ‚ü©Œ± -‚àÇùúÄ-dv
  (   2        e  2        )
‚àí  ‚àí œâpiŒ¥A(n+1)‚àí œâpeŒ¥A(n+1) .                          (215)
      c2   ‚à•       c2   ‚à•
" class="math-display"  /><a 
 id="x1-38005r215"></a></center>
</div>In the drift-kinetic limit (i.e., neglecting the FLR eÔ¨Äect), the blue and red terms on the
right-hand side of the above equation cancel each other exactly. Even in this case, it is
found numerically that these terms need to be retained and the blue terms are evaluated
using markers. Otherwise, numerical inaccuracy can give numerical instabilities, which is
the so-called cancellation problem. The explanation for this is as follows. The blue terms
are part of the current. The remained part of the current carried by <span 
class="cmmi-10">Œ¥h </span>is computed by
using Monte-Carlo integration over markers. If the blue terms are evaluated analytically,
rather than using Monte-Carlo integration over markers, then the cancellation between this
analytical part and Monte-Carlo part can have large error (assume that there are two large
contribution that have opposite signs in the two parts) because the two parts are evaluated
using diÔ¨Äerent methods and thus have diÔ¨Äerent accuracy, which makes the cancellation less
accurate.
<!--l. 2658--><p class="indent" >   Because the ion skin current is less than its electron counterpart by a factor of <span 
class="cmmi-10">m</span><sub><span 
class="cmmi-7">e</span></sub><span 
class="cmmi-10">‚àïm</span><sub><span 
class="cmmi-7">i</span></sub>, its accuracy
is not important. The cancellation error is not a problem and hence can be neglected. In this case,
equation (<a 
href="#x1-38005r215">215<!--tex4ht:ref: 19-3-21-p1 --></a>) is simpliÔ¨Åed as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation253x.png" alt="              (   2           2       )
‚àí ‚àá2‚ä•Œ¥A(n+1)‚àí  ‚àí œâpiŒ¥A(n+1)‚àí œâpeŒ¥A(n+1)
       ‚à•         c2   ‚à•      c2   ‚à•
= Œº0(Œ¥J‚Ä≤ + Œ¥J‚Ä≤ )
    ‚à´  ‚à•i    ||e2
+ Œº0  (v(n+1))2 qe-‚ü®Œ¥A (n+1)‚ü©Œ±‚àÇFe0dv
  (     ‚à•     me)    ‚à•      ‚àÇùúÄ
     œâ2pe   (n+1)
‚àí  ‚àí -c2 Œ¥A ‚à•   .                                      (216)
" class="math-display"  /><a 
 id="x1-38006r216"></a></center>
                                                                                

                                                                                
</div>Note that the blue term will be evaluated using Monte-Carlo markers.
<!--l. 2676--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-390005.1"></a>Discretizing Laplacian operator </h4>
<!--l. 2678--><p class="noindent" >In <span 
class="cmtt-10">TEK</span>, the Laplacian operator is approximated as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-39001r217"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation254x.png" alt="          2           2            2
‚àá2‚ä• Œ¥A‚à• ‚âà ‚àÇ-Œ¥2A‚à•|‚àáx|2 + ‚àÇ-Œ¥A2-‚à•|‚àáy |2 + ‚àÇ-Œ¥A‚à•2‚àáx ‚ãÖ‚àáy.
          ‚àÇ x         ‚àÇ y         ‚àÇx‚àÇy
" class="math-display"  /></center></td><td class="equation-label">(217)</td></tr></table>
<!--l. 2685--><p class="nopar" >
To approximate <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub> of zero boundary condition <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmmi-10">x </span>= 0) = <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmmi-10">x </span>= <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">x</span></sub>) = 0, the sine expansion can
be adopted. In the <span 
class="cmmi-10">y </span>direction, full Fourier expansion is needed. Then, at each value of <span 
class="cmmi-10">z</span>, <span 
class="cmmi-10">A</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmmi-10">x,y,z</span>) is
approximated by the following two-dimensional expansion:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-39002r218"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation255x.png" alt="              N ‚àï2     (      )              (           )
              ‚àëy          2œÄ-  Nx‚àë‚àí1            m-œÄ
Œ¥A ‚à•(x,y,z) ‚âà       exp  inLyy       Am,n(z)sin  Lx (x‚àí x0) ,
            n=‚àí Ny‚àï2             m=1
" class="math-display"  /></center></td><td class="equation-label">(218)</td></tr></table>
<!--l. 2695--><p class="nopar" >
Using this expression, Eq. (<a 
href="#x1-39001r217">217<!--tex4ht:ref: 23-12-16-3 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation256x.png" alt="   2        N‚àëy‚àï2     (   2œÄ ) Nx‚àë‚àí1
‚àí ‚àá ‚ä•Œ¥A‚à• =       exp  in L-y      Œ¥Am,n(z)
          n{=[‚àíNy‚àï2        y   m=1       ]                                                     }
             (m œÄ)2        (  2œÄ)2         ( mœÄ        )    2œÄ ( mœÄ )           ( m œÄ       )
        √ó     L--   |‚àáx |2 + n L--  |‚àáy |2 sin  L--(x‚àí x0) ‚àí inL--  L--  2‚àáx ‚ãÖ‚àáycos  L--(x‚àí x0)
                x              y              x               y   x                 x
" class="math-display"  /></center>
</div>At <span 
class="cmmi-10">x </span>= <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub>, with <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub> <span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">x</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmmi-10">jŒî </span>and <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">x</span></sub><span 
class="cmmi-10">‚àïŒî </span>= <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">x</span></sub>, the above expression is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation257x.png" alt="            N‚àëy‚àï2     (      ) Nx‚àë‚àí1
‚àí ‚àá2‚ä•Œ¥A‚à• =       exp  in 2œÄy      Œ¥Am,n(z)
          n=‚àíNy‚àï2       Ly   m=1
          {[ (   )2        (    )2     ]   (     )       (    )           (     )}
        √ó     m-œÄ   |‚àáx |2 + n 2œÄ-  |‚àáy |2 sin  jmœÄ-  ‚àí in2œÄ  m-œÄ  2‚àáx ‚ãÖ‚àáy cos  jm-œÄ(219,)
              Lx              Ly             Nx       Ly   Lx                Nx
" class="math-display"  /><a 
 id="x1-39004r219"></a></center>
</div>where <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">x </span>and <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y </span>are evaluated at <span 
class="cmmi-10">x</span><sub><span 
class="cmmi-7">j</span></sub>. Plugging the DST coeÔ¨Écients
   <table 
class="equation"><tr><td><a 
 id="x1-39005r220"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation258x.png" alt="                             (     )
          -2-Nx‚àë‚àí 1             j‚Ä≤m-œÄ-
Œ¥Am,n(z) = Nx  ‚Ä≤  An(xj‚Ä≤,z)sin  Nx    ,
              j=1
" class="math-display"  /></center></td><td class="equation-label">(220)</td></tr></table>
<!--l. 2724--><p class="nopar" >
into expression (<a 
href="#x1-39004r219">219<!--tex4ht:ref: 23-12-16-1 --></a>) gives </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation259x.png" alt="            Ny‚àï2     (      ) N ‚àí1    N ‚àí1           (     )
‚àí ‚àá2 Œ¥A =   ‚àë    exp  in 2œÄy   x‚àë  -2- ‚àëx  A (x ‚Ä≤,z)sin  j‚Ä≤m-œÄ-
   ‚ä•  ‚à•                 Ly   m=1 Nx  j‚Ä≤=1  n  j        Nx
          n{=[‚àíN(y‚àï2)         (    )      ]   (     )       (    )           (     )}
              m-œÄ  2    2     2œÄ-2    2      jmœÄ-     2œÄ-  m-œÄ              jm-œÄ
        √ó     Lx    |‚àáx | +  n Ly   |‚àáy | sin  Nx    ‚àí inLy  Lx   2‚àáx ‚ãÖ‚àáy cos   Nx
" class="math-display"  /></center>
</div>For a single toroidal harmonic, the above expression reduces to <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation260x.png" alt="  Nx‚àë‚àí1    N‚àëx‚àí1           (  ‚Ä≤  )
       -2-    An (xj‚Ä≤,z)sin  jm-œÄ-
   m=1 Nx j‚Ä≤=1               Nx
  { [(    )2       (    )2     ]   (     )        (   )            (    ) }
√ó      mœÄ-  |‚àáx|2 + n 2œÄ-  |‚àáy |2  sin  jm-œÄ  ‚àí in 2œÄ- m-œÄ  2‚àáx ‚ãÖ‚àáy cos jm-œÄ (221)
       Lx             Ly              Nx       Ly  Lx                Nx
" class="math-display"  /><a 
 id="x1-39007r221"></a></center>
</div>DeÔ¨Åne <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation261x.png" alt="        N‚àëx‚àí1 2    (j‚Ä≤m œÄ)
Mjj‚Ä≤,n ‚â°     N--sin  -N---
        m{=[1   x       x              ]                                         }
          ( m œÄ)2    2  (  2œÄ )2    2    (jm œÄ)     2œÄ ( mœÄ )           ( jmœÄ )
      √ó     Lx-  |‚àáx | +  nLy-  |‚àáy|  sin  -Nx-  ‚àí inLy-  Lx- 2‚àáx ‚ãÖ‚àáy cos  Nx--
" class="math-display"  /></center>
                                                                                

                                                                                
</div>then expression (<a 
href="#x1-39007r221">221<!--tex4ht:ref: 23-12-27-e1 --></a>) is written as
   <table 
class="equation"><tr><td><a 
 id="x1-39009r222"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation262x.png" alt="Nx‚àë ‚àí1
     Mjj‚Ä≤,nAn (xj‚Ä≤,z).
 j‚Ä≤=1
" class="math-display"  /></center></td><td class="equation-label">(222)</td></tr></table>
<!--l. 2760--><p class="nopar" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-400006"></a>Poisson‚Äôs equation and polarization density</h3>
<!--l. 2763--><p class="noindent" >Poisson‚Äôs equation is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-40001r223"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation263x.png" alt="‚àí ùúÄ0‚àá2Œ¥Œ¶ = qiŒ¥ni + qeŒ¥ne,
" class="math-display"  /></center></td><td class="equation-label">(223)</td></tr></table>
<!--l. 2767--><p class="nopar" >
where <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmsy-10">‚àá</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span>is called the space-charge term. Since we consider modes with <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚â™ </span><span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, the
space-charge term is approximated as <span 
class="cmsy-10">‚àá</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚â°‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span>+ <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚âà‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶</span>. Then Eq. (<a 
href="#x1-40001r223">223<!--tex4ht:ref: 18-10-5-p4 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-40002r224"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation264x.png" alt="‚àí ùúÄ0‚àá2‚ä• Œ¥Œ¶ = qiŒ¥ni + qeŒ¥ne.
" class="math-display"  /></center></td><td class="equation-label">(224)</td></tr></table>
<!--l. 2776--><p class="nopar" >
This approximation eliminates the parallel plasma oscillation from the system. The perpendicular
plasma oscillations seem to be only partially eliminated in the system consisting of gyrokinetic ions and
drift-kinetic electrons. There are the so-called <span 
class="cmmi-10">Œ©</span><sub><span 
class="cmmi-7">H</span></sub> modes (also called electrostatic shear Alfven wave)
that appear in the gyrokinetic system which have some similarity with the plasma oscillations but with
a much smaller frequency, <span 
class="cmmi-10">Œ©</span><sub><span 
class="cmmi-7">H</span></sub> <span 
class="cmsy-10">‚àº </span>(<span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïk</span><sub><span 
class="cmsy-7">‚ä•</span></sub>)(<span 
class="cmmi-10">Œª</span><sub><span 
class="cmmi-7">D</span></sub><span 
class="cmmi-10">‚àïœÅ</span><sub><span 
class="cmmi-7">s</span></sub>)<span 
class="cmmi-10">œâ</span><sub><span 
class="cmmi-7">pe</span></sub>.
</p><!--l. 2785--><p class="indent" >   Using expression (<a 
href="#x1-36002r199">199<!--tex4ht:ref: 19-1-3-e2 --></a>), the perturbed number density <span 
class="cmmi-10">Œ¥n </span>is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation265x.png" alt="    ‚à´
Œ¥n =  Œ¥F dv
               [                 ]       [             ]
    ‚à´        ‚à´  -q           ‚àÇF0-      ‚à´  q-        ‚àÇF0-
  =   Œ¥hdv +    m (Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶ ‚ü©Œ±) ‚àÇùúÄ  dv +    m ‚ü®v‚ãÖŒ¥A ‚ü©Œ±‚àÇ ùúÄ  dv,     (225)
" class="math-display"  /><a 
 id="x1-40003r225"></a></center>
</div>where the blue term is approximately zero for isotropic <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> and this term is usually dropped in
simulations that assume isotropic <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> and approximate <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span>as <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>. The red term in expression (<a 
href="#x1-40003r225">225<!--tex4ht:ref: 19-1-12-e1 --></a>)
is the so-called the polarization density <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">p</span></sub>, i.e.,
   <table 
class="equation"><tr><td><a 
 id="x1-40004r226"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation266x.png" alt="        ‚à´  q           ‚àÇF
Œ¥np(x) =  --(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)---0dv,
          m             ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(226)</td></tr></table>
<!--l. 2805--><p class="nopar" >
which has an explicit dependence on <span 
class="cmmi-10">Œ¥Œ¶ </span>and is usually moved to the left hand of Poisson‚Äôs equation
when constructing the numerical solver of the Poisson equation, i.e., equation (<a 
href="#x1-40002r224">224<!--tex4ht:ref: 19-1-12-e2 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-40005r227"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation267x.png" alt="             ‚à´  q            ‚àÇF
‚àí ùúÄ0‚àá2‚ä•Œ¥Œ¶ ‚àí qi  -i-(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)--i0dv = qiŒ¥n‚Ä≤i + qeŒ¥ne,
               mi             ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(227)</td></tr></table>
<!--l. 2814--><p class="nopar" >
where <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmsy-10">‚Ä≤ </span>= <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">i</span></sub> <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">pi</span></sub> = <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">Œ¥h</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span>, which is evaluated by using Monte-Carlo markers. Since some parts
depending on <span 
class="cmmi-10">Œ¥Œ¶ </span>are moved from the right-hand side to the left-hand side of the Ô¨Åeld equation,
numerical solvers (for <span 
class="cmmi-10">Œ¥Œ¶</span>) based on the left-hand side of Eq. (<a 
href="#x1-40005r227">227<!--tex4ht:ref: 19-1-12-e4 --></a>) probably behaves better than the
one that is based on the left-hand side of Eq. (<a 
href="#x1-40002r224">224<!--tex4ht:ref: 19-1-12-e2 --></a>), i.e., <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶</span>.
</p><!--l. 2823--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-410006.1"></a>Discussion on cancellation scheme</h4>
<!--l. 2825--><p class="noindent" >The polarization density is part of the perturbed density that is extracted from the source term and
moved to the left-hand side of the Poisson equation. The polarization density will be evaluated without
using Monte-Carlo markers, whereas the remained density on the right-hand side will be
evaluated using Mote-Carlo markers. The two diÔ¨Äerent methods of evaluating two parts of
the total perturbed density can possibly introduce signiÔ¨Åcant errors if the two terms are
expected to cancel each other and give a small quantity that is much smaller than either of
the two terms. This is one pitfall for PIC simulations that extract some parts from the
source term and move them to the left-hand side. To remedy this, rather than directly
moving a part of the distribution function to the left-hand side, we subtract an (approximate)
analytic expression from both sides of Eq. (<a 
href="#x1-40002r224">224<!--tex4ht:ref: 19-1-12-e2 --></a>). The analytical expressions on both sides are
evaluated based on grid values of perturbed electromagnetic Ô¨Åelds and are independent of
makers. All the original parts of the distribution functions are kept on the right-hand side
and are still evaluated by using markers, which hopefully avoids the possible cancellation
problem. This strategy is often called a cancellation scheme. Since unknown perturbed
electromagnetic Ô¨Åelds appear on the right-hand side, iteration is needed to solve the Ô¨Åeld
equation.
</p><!--l. 2845--><p class="indent" >   Note that two things appear here: What motivates us to move parts of the distribution function to
the left? It is the goal of hopefully making the left-hand side matrix more well-behaved (such as good
condition number, etc.) Why do we need the cancellation scheme? Because we want to avoid the
numerical inaccuracy that appears when large terms cancels each other. Note that iteration is needed
when the cancellation scheme is used because the right-hand side explicitly contains unknown
electromagnetic Ô¨Åelds.
</p><!--l. 2853--><p class="indent" >   It turns out that the cancellation scheme is not necessary for Eq. (<a 
href="#x1-40005r227">227<!--tex4ht:ref: 19-1-12-e4 --></a>), but for the Ô¨Åeld solver for
Ampere‚Äôs equation (discussed later), this cancellation scheme is necessary in order to obtain stable
results.
</p><!--l. 2859--><p class="noindent" >
</p>
                                                                                

                                                                                
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-420007"></a>Polarization density expressed as local Fourier expansion</h3>
<!--l. 2861--><p class="noindent" >Since <span 
class="cmmi-10">Œ¥Œ¶ </span>is independent of the velocity in the particle coaordinates, the Ô¨Årst term (adiabatic term) in
expression (<a 
href="#x1-40004r226">226<!--tex4ht:ref: 18-9-13-p9 --></a>) is trivial and the velocity integration can be readily performed (assume <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is
Maxwellian), giving </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation268x.png" alt="      ‚à´
        -q    ‚àÇF0-
Œ¥nad =   m (Œ¥Œ¶) ‚àÇùúÄ dv.
      q     ‚à´ (  m    )
    = m-(Œ¥Œ¶)   ‚àí T-fM  dv.
        qŒ¥Œ¶
    = ‚àí ---n0,                                  (228)
        T
" class="math-display"  /><a 
 id="x1-42001r228"></a></center>
</div>which is called adiabatic response. Next, let us perform the gyro-averaging and the velocity integration
of the second term in expression (<a 
href="#x1-40004r226">226<!--tex4ht:ref: 18-9-13-p9 --></a>), i.e.,
   <table 
class="equation"><tr><td><a 
 id="x1-42002r229"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation269x.png" alt="  ‚à´  q     ‚àÇF
‚àí   --‚ü®Œ¥Œ¶‚ü©Œ±--0-dv.
    m       ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(229)</td></tr></table>
<!--l. 2878--><p class="nopar" >
</p><!--l. 2880--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-430007.1"></a>Gyro-averaging of <span 
class="cmmi-10">Œ¥Œ¶ </span>in guiding-center coordinates</h4>
<!--l. 2882--><p class="noindent" >In order to perform the gyro-averaging of <span 
class="cmmi-10">Œ¥Œ¶</span>, we Fourier expand <span 
class="cmmi-10">Œ¥Œ¶ </span>in space as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-43001r230"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation270x.png" alt="       ‚à´               dk
Œ¥Œ¶(x) =   Œ¥Œ¶kexp(ik ‚ãÖx)----3,
                      (2œÄ)
" class="math-display"  /></center></td><td class="equation-label">(230)</td></tr></table>
<!--l. 2887--><p class="nopar" >
and then express <span 
class="cmbx-10">x </span>in terms of the guiding center variables (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) since the gyro-averaging is taken by
holding <span 
class="cmbx-10">X </span>rather than <span 
class="cmbx-10">x </span>constant. The guiding-center transformation gives
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-43002r231"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation271x.png" alt="x = X + œÅ(x,v ) ‚âà X ‚àí v√ó e‚à•(X-).
                        Œ©(X )
" class="math-display"  /></center></td><td class="equation-label">(231)</td></tr></table>
<!--l. 2896--><p class="nopar" >
Using expressions (<a 
href="#x1-43001r230">230<!--tex4ht:ref: 19-6-13-1 --></a>) and (<a 
href="#x1-43002r231">231<!--tex4ht:ref: 19-6-13-2 --></a>), the gyro-average of <span 
class="cmmi-10">Œ¥Œ¶ </span>is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation272x.png" alt="       ‚ü®‚à´                   ‚ü©
‚ü®Œ¥Œ¶ ‚ü©Œ± =     Œ¥Œ¶kexp(ik ‚ãÖx)-dk-3
       ‚ü®‚à´        (    ((2œÄ)  Œ±      ) )     ‚ü©
                               e‚à•(X)-   -dk--
     =     Œ¥Œ¶kexp  ik ‚ãÖ X ‚àí v √ó Œ© (X )    (2œÄ)3  Œ±
       ‚à´              ‚ü®    (         e (X ))‚ü©    dk
     =   Œ¥Œ¶k exp (ik ‚ãÖX )  exp  ‚àí ik ‚ãÖv √ó -‚à•----   ----3.         (232)
                                     Œ©(X )   Œ±(2œÄ)
" class="math-display"  /><a 
 id="x1-43003r232"></a></center>
</div>When doing the gyro-averaging, <span 
class="cmbx-10">X </span>is hold constant and thus <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">X</span>) is also constant. Then it is
straightforward to deÔ¨Åne the gyro-angle <span 
class="cmmi-10">Œ±</span>. Let <span 
class="cmbx-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub> deÔ¨Åne one of the perpendicular direction <img 
src="nonlinear_gyrokinetic_equation273x.png" alt="ÀÜe"  class="circ"  /><sub><span 
class="cmr-7">1</span></sub>, i.e.,
<span 
class="cmbx-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub><img 
src="nonlinear_gyrokinetic_equation274x.png" alt="ÀÜe"  class="circ"  /><sub><span 
class="cmr-7">1</span></sub>. Then another perpendicular basis vector is deÔ¨Åned by <img 
src="nonlinear_gyrokinetic_equation275x.png" alt="ÀÜe"  class="circ"  /><sub><span 
class="cmr-7">2</span></sub> = <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">√ó</span><img 
src="nonlinear_gyrokinetic_equation276x.png" alt="ÀÜe"  class="circ"  /><sub><span 
class="cmr-7">1</span></sub>. Then <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> is written as
                                                                                

                                                                                
<span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>(<img 
src="nonlinear_gyrokinetic_equation277x.png" alt="ÀÜe"  class="circ"  /><sub><span 
class="cmr-7">1</span></sub> cos<span 
class="cmmi-10">Œ± </span>+ <img 
src="nonlinear_gyrokinetic_equation278x.png" alt="ÀÜe"  class="circ"  /><sub><span 
class="cmr-7">2</span></sub> sin<span 
class="cmmi-10">Œ±</span>), which deÔ¨Ånes the gyro-angle <span 
class="cmmi-10">Œ±</span>. Then the blue expression in Eq. (<a 
href="#x1-43003r232">232<!--tex4ht:ref: 18-9-13-a1 --></a>) is
written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation279x.png" alt="         e‚à•(X-)-                           e‚à•(X-)-
‚àí ik ‚ãÖv√ó  Œ©(X ) = ‚àí ik ‚ãÖv‚ä•(ÀÜe1cosŒ± + ÀÜe2sinŒ± )√ó Œ© (X )
                      v‚ä•
              = ‚àí ik ‚ãÖŒ©-(X)(‚àí ÀÜe2 cosŒ± + ÀÜe1sin Œ±)
                   k v
              = ‚àí i-‚ä•-‚ä•-sinŒ±.                               (233)
                    Œ©
" class="math-display"  /><a 
 id="x1-43004r233"></a></center>
</div>Then the gyro-averaging in expression (<a 
href="#x1-43003r232">232<!--tex4ht:ref: 18-9-13-a1 --></a>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation280x.png" alt="‚ü®    (         e‚à•(X ))‚ü©    ‚ü®    (   k‚ä•v‚ä•     )‚ü©
  exp  ‚àí ik ‚ãÖv√ó  Œ©(X-)-   =   exp ‚àí i-Œ©---sinŒ±
                       Œ±     ‚à´ 2œÄ   (          Œ± )
                        =  1--   exp  ‚àí ik‚ä•v‚ä•-sinŒ± dŒ±
                           2œÄ 0           Œ©
                             (k‚ä•v‚ä•-)
                        = J0    Œ©    .                        (234)
" class="math-display"  /></center>
</div>where use has been made of the deÔ¨Ånition of the zeroth Bessel function of the Ô¨Årst kind. Then <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> in
expression (<a 
href="#x1-43003r232">232<!--tex4ht:ref: 18-9-13-a1 --></a>) is written as
   <table 
class="equation"><tr><td><a 
 id="x1-43006r235"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation281x.png" alt="       ‚à´                (     )
                          k‚ä•v‚ä•- --dk-
‚ü®Œ¥Œ¶ ‚ü©Œ± =   Œ¥Œ¶k exp (ik ‚ãÖX )J0   Œ©    (2œÄ)3.
" class="math-display"  /></center></td><td class="equation-label">(235)</td></tr></table>
<!--l. 2951--><p class="nopar" >
</p><!--l. 2953--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-440007.2"></a>Gryo-angle integration in particle coordinates</h4>
<!--l. 2955--><p class="noindent" >Next, we need to perform the integration in velocity space, which is done by holding <span 
class="cmbx-10">x </span>(rather than <span 
class="cmbx-10">X</span>)
constant. Therefore, it is convenient to transform back to particle coordinates. Using <span 
class="cmbx-10">X </span>= <span 
class="cmbx-10">x </span>+ <span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó</span><img 
src="nonlinear_gyrokinetic_equation282x.png" alt="e‚à•(x)
Œ© (x)"  class="frac" align="middle" />,
expression (<a 
href="#x1-43006r235">235<!--tex4ht:ref: 18-9-12-e1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-44001r236"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation283x.png" alt="        ‚à´               (      )    (         )
‚ü®Œ¥Œ¶‚ü©Œ± =   Œ¥Œ¶kexp(ik‚ãÖx)J0  k‚ä•v‚ä•- exp  ik ‚ãÖv √ó e‚à•  -dk-.
                           Œ©                Œ©   (2œÄ)3
" class="math-display"  /></center></td><td class="equation-label">(236)</td></tr></table>
<!--l. 2967--><p class="nopar" >
Then the velocity integration is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation284x.png" alt="‚à´      ‚àÇF0
  ‚ü®Œ¥Œ¶‚ü©Œ±-‚àÇùúÄ-dv
  ‚à´              [‚à´   ( k v  )    (       e ) ‚àÇF   ]  dk
=    Œ¥Œ¶k exp(ik ‚ãÖx)   J0  -‚ä•-‚ä•-  exp  ik‚ãÖv √ó -‚à•  --0dv  ---3.      (237)
                          Œ©               Œ©   ‚àÇùúÄ     (2œÄ )
" class="math-display"  /><a 
 id="x1-44002r237"></a></center>
</div>Similar to Eq. (<a 
href="#x1-43004r233">233<!--tex4ht:ref: 18-9-12-e6 --></a>), except for now at <span 
class="cmbx-10">x </span>rather than <span 
class="cmbx-10">X</span>, <span 
class="cmmi-10">i</span><span 
class="cmbx-10">k </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó</span><img 
src="nonlinear_gyrokinetic_equation285x.png" alt="e‚à•
Œ©"  class="frac" align="middle" /> is written as
   <table 
class="equation"><tr><td><a 
 id="x1-44003r238"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation286x.png" alt="       e‚à•   k‚ä•v‚ä•
ik ‚ãÖv√ó  Œ©-= i--Œ©--sin Œ±.
" class="math-display"  /></center></td><td class="equation-label">(238)</td></tr></table>
<!--l. 2985--><p class="nopar" >
Since this is at <span 
class="cmbx-10">x </span>rather than <span 
class="cmbx-10">X</span>, <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, and <span 
class="cmmi-10">Œ© </span>are diÔ¨Äerent from those appearing in expression (<a 
href="#x1-43004r233">233<!--tex4ht:ref: 18-9-12-e6 --></a>).
However, since this diÔ¨Äerence is due to the variation of the equilibrium quantity <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïŒ© </span>in a Larmor
radius, and thus is small and is ignored in the following.
</p><!--l. 2992--><p class="indent" >   Plugging expression (<a 
href="#x1-44003r238">238<!--tex4ht:ref: 18-9-13-p4 --></a>) into expression (<a 
href="#x1-44002r237">237<!--tex4ht:ref: 18-9-12-e5 --></a>) and using <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">dŒ±</span>, we get
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation287x.png" alt="‚à´
 ‚ü®Œ¥Œ¶‚ü©Œ±‚àÇF0-dv
  ‚à´    ‚àÇùúÄ       [‚à´    (     )    (          )               ]
=   Œ¥Œ¶ exp(ik‚ãÖx)   J   k‚ä•v-‚ä•  exp ik‚ä•v-‚ä•sinŒ±  ‚àÇF0-v dv dv dŒ±  -dk-. (239)
      k              0   Œ©           Œ©         ‚àÇùúÄ  ‚ä•  ‚ä•  ‚à•    (2œÄ)3
" class="math-display"  /><a 
 id="x1-44004r239"></a></center>
</div>Note that <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span>is independent of the gyro-angle <span 
class="cmmi-10">Œ± </span>in terms of guiding-center variables. When
transformed back to particle coordinates, <span 
class="cmbx-10">X </span>contained in <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span>will introduce <span 
class="cmmi-10">Œ± </span>dependence via
<span 
class="cmbx-10">X </span>= <span 
class="cmbx-10">x </span>+ <span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó</span><img 
src="nonlinear_gyrokinetic_equation288x.png" alt="e‚à•Œ©-"  class="frac" align="middle" />. This dependence on <span 
class="cmmi-10">Œ± </span>is weak since the equilibrium quantities can be considered
constant over a Larmor radius distance evaluated at the thermal velocity. Therefore this dependence
can be ignored when performing the integration over <span 
class="cmmi-10">Œ±</span>, i.e., in terms of particle coordinates, <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span>is
approximately independent of the gyro-angle <span 
class="cmmi-10">Œ±</span>. Then the integration over <span 
class="cmmi-10">Œ± </span>in Eq. (<a 
href="#x1-44004r239">239<!--tex4ht:ref: 19-1-7-1 --></a>) can be
performed, yielding <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation289x.png" alt="  ‚à´
    ‚ü®Œ¥Œ¶‚ü©Œ±‚àÇF0-dv
          ‚àÇùúÄ
  ‚à´              ‚à´ ‚à´    (k‚ä•v-‚ä•) [‚à´ 2œÄ   ( k‚ä•v-‚ä•    )   ] ‚àÇF0-        -dk--
=    Œ¥Œ¶kexp(ik ‚ãÖx)     J0   Œ©      0  exp  i Œ©  sinŒ±  dŒ±  ‚àÇ ùúÄ v‚ä•dv‚ä•dv ‚à•(2œÄ )3
  ‚à´              [‚à´ ‚à´    (k  v )     ( k v  )‚àÇF          ]  dk
=    Œ¥Œ¶kexp(ik ‚ãÖx)      J0 -‚ä•--‚ä•  2œÄJ0  -‚ä•-‚ä•- ---0v‚ä•dv‚ä•dv‚à• ----3,        (240)
                            Œ©           Œ©     ‚àÇùúÄ          (2œÄ)
" class="math-display"  /><a 
 id="x1-44005r240"></a></center>
</div>where again use has been made of the deÔ¨Ånition of the Bessel function.
   <h5 class="subsubsectionHead"><a 
 id="x1-450007.2"></a>The remaining velocity integration can be performed analytically if <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is Maxwellian</h5>
<!--l. 3035--><p class="noindent" >In order to perform the remaining velocity integration in expression (<a 
href="#x1-44005r240">240<!--tex4ht:ref: 18-9-13-a4 --></a>), we assume that <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is a
Maxwellian distribution given by </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation290x.png" alt="                           (      )
          ----n0(X-)-----    ‚àí-mv2-
F0 = fM = (2œÄT (X)‚àïm )3‚àï2 exp 2T (X )                   (241)
       n0       ( ‚àí v2)
  = ----3‚àï23 exp  2v2- ,                             (242)
    (2œÄ)  vt        t
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub> = <img 
src="nonlinear_gyrokinetic_equation291x.png" alt="‚àò ----
  T‚àïm"  class="sqrt"  />, then
   <table 
class="equation"><tr><td><a 
 id="x1-45002r243"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation292x.png" alt="‚àÇF      m
---0= ‚àí --fM .
 ‚àÇùúÄ     T
" class="math-display"  /></center></td><td class="equation-label">(243)</td></tr></table>
<!--l. 3047--><p class="nopar" >
Again we will ignore the weak dependence of <span 
class="cmmi-10">n</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X</span>) and <span 
class="cmmi-10">T</span>(<span 
class="cmbx-10">X</span>) on <span 
class="cmbx-10">v </span>introduced by <span 
class="cmbx-10">X </span>= <span 
class="cmbx-10">x </span>+ <span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïŒ©</span>
when transformed back to particle coordinates. (For suÔ¨Éciently large velocity, the corresponding
Larmor radius will be large enough to make the equilibrium undergo substantial variation. Since the
                                                                                

                                                                                
velocity integration limit is to inÔ¨Ånite, this will deÔ¨Ånitely occur. However, <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is exponentially
decreasing with velocity, making those particles with velocity much larger than the thermal velocity
negligibly few and thus can be neglected.)
</p>
<!--l. 3058--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-460007.2"></a><span 
class="cmbx-10">Parallel integration</span></span>
   Using Eq. (<a 
href="#x1-45002r243">243<!--tex4ht:ref: 18-9-13-p6 --></a>), the expression in the square brackets of Eq. (<a 
href="#x1-44005r240">240<!--tex4ht:ref: 18-9-13-a4 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation293x.png" alt="  ‚à´ ‚à´    ( k v ) ‚àÇF
2œÄ     J20  -‚ä•-‚ä•- ---0v‚ä•dv‚ä•dv‚à•
            Œ©‚à´ ‚à´   ‚àÇùúÄ(     )       (         )
   m---n0--       2  k‚ä•v‚ä•- -1       v2‚à• +-v2‚ä•
= ‚àí T(2œÄ)1‚àï2    J 0   Œ©    v3t exp  ‚àí   2v2t   v‚ä•dv ‚ä•dv‚à•        (244)
            ‚à´ ‚à´    (     )    (  -2   -2)
= ‚àí m--n0--     J2   k‚ä•v‚ä•- exp  ‚àív‚à•-+-v‚ä•  v dv dv ,          (245)
    T(2œÄ)1‚àï2      0   Œ©             2      ‚ä•  ‚ä•  ‚à•
" class="math-display"  /><a 
 id="x1-46001r245"></a></center>
</div>where <span class="overline"><span 
class="cmmi-10">v</span></span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïv</span><sub><span 
class="cmmi-7">t</span></sub>, <span class="overline"><span 
class="cmmi-10">v</span></span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">‚àïv</span><sub><span 
class="cmmi-7">t</span></sub>. Using
   <table 
class="equation"><tr><td><a 
 id="x1-46002r246"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation294x.png" alt="‚à´ ‚àû    (   x2)     ‚àö ---
    exp  ‚àí 2- dx =   2œÄ,
 ‚àí‚àû
" class="math-display"  /></center></td><td class="equation-label">(246)</td></tr></table>
<!--l. 3081--><p class="nopar" >
the integration over <span class="overline"><span 
class="cmmi-10">v</span></span><sub><span 
class="cmsy-7">‚à•</span></sub> in expression (<a 
href="#x1-46001r245">245<!--tex4ht:ref: 21-8-16-p1 --></a>) can be performed, yielding
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-46003r247"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation295x.png" alt="      ‚à´ ‚àû    (     )    (  -2 )
‚àí m-n0    J20  k‚ä•v‚ä•-  exp ‚àí v‚ä•- v‚ä•dv ‚ä•
  T    0        Œ©           2
" class="math-display"  /></center></td><td class="equation-label">(247)</td></tr></table>
<!--l. 3089--><p class="nopar" >
</p>
<!--l. 3091--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-470007.2"></a><span 
class="cmbx-10">Perpendicular integration</span></span>
   Using (I veriÔ¨Åed this by using Sympy)
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-47001r248"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation296x.png" alt="‚à´ ‚àû          (   2)
    J20(ax)exp  ‚àí x  xdx = exp(‚àí a2)I0(a2),
 0               2
" class="math-display"  /></center></td><td class="equation-label">(248)</td></tr></table>
<!--l. 3097--><p class="nopar" >
where <span 
class="cmmi-10">I</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmmi-10">a</span>) is the zeroth modiÔ¨Åed Bessel function of the Ô¨Årst kind, expression (<a 
href="#x1-46003r247">247<!--tex4ht:ref: 21-8-16-p2 --></a>) is
written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-47002r249"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation297x.png" alt="  m
‚àí --n0exp(‚àí b)I0(b)
  T
" class="math-display"  /></center></td><td class="equation-label">(249)</td></tr></table>
<!--l. 3102--><p class="nopar" >
where <span 
class="cmmi-10">b </span>= <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">‚àïŒ©</span><sup><span 
class="cmr-7">2</span></sup> = <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">t</span></sub><sup><span 
class="cmr-7">2</span></sup>. Then the corresponding density (<a 
href="#x1-42002r229">229<!--tex4ht:ref: 21-9-18-a1 --></a>) is written as
                                                                                

                                                                                
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-47003r250"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation298x.png" alt="    ‚à´                  ‚à´
‚àí q-  ‚ü®Œ¥Œ¶ ‚ü© ‚àÇF0dv = qn0   Œ¥Œ¶ exp(ik ‚ãÖx)exp(‚àí b)I (b)-dk-.
  m      Œ± ‚àÇùúÄ       T      k                 0  (2œÄ)3
" class="math-display"  /></center></td><td class="equation-label">(250)</td></tr></table>
<!--l. 3110--><p class="nopar" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-480007.2"></a>Final form of polarization density</h5>
<!--l. 3114--><p class="noindent" >In Fourier space, the adiabatic term in expression (<a 
href="#x1-42001r228">228<!--tex4ht:ref: 18-11-27-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-48001r251"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation299x.png" alt="‚à´                              ‚à´
   q(Œ¥Œ¶)‚àÇF0-dv = ‚àí qn0Œ¥Œ¶ = ‚àí qn0 Œ¥Œ¶k exp(ik ‚ãÖx)-dk3-.
   m     ‚àÇùúÄ        T         T                (2œÄ)
" class="math-display"  /></center></td><td class="equation-label">(251)</td></tr></table>
<!--l. 3121--><p class="nopar" >
Plugging expression (<a 
href="#x1-47003r250">250<!--tex4ht:ref: 18-9-13-p7 --></a>) and (<a 
href="#x1-48001r251">251<!--tex4ht:ref: 18-9-13-p8 --></a>) into expression (<a 
href="#x1-40004r226">226<!--tex4ht:ref: 18-9-13-p9 --></a>), the polarization density <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">p</span></sub> is written as
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation300x.png" alt="          ‚à´
np = ‚àí qn0  Œ¥Œ¶k exp(ik ‚ãÖx)[1‚àí exp(‚àí b)I0(b)]-dk-.            (252)
       T                                (2œÄ )3
" class="math-display"  /><a 
 id="x1-48002r252"></a></center>
</div>DeÔ¨Åne
   <table 
class="equation"><tr><td><a 
 id="x1-48003r253"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation301x.png" alt="Œì = exp(‚àí b)I (b),
 0          0
" class="math-display"  /></center></td><td class="equation-label">(253)</td></tr></table>
<!--l. 3132--><p class="nopar" >
then Eq. (<a 
href="#x1-48002r252">252<!--tex4ht:ref: 21-8-17-a1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-48004r254"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation302x.png" alt="      qn0‚à´                      dk
np = ‚àí-T-   Œ¥Œ¶kexp(ik ‚ãÖx)[1 ‚àí Œì 0](2œÄ)3,
" class="math-display"  /></center></td><td class="equation-label">(254)</td></tr></table>
<!--l. 3137--><p class="nopar" >
Expression (<a 
href="#x1-48004r254">254<!--tex4ht:ref: 18-9-23-p1 --></a>) agrees with the result given in Yang Chen‚Äôs notes. Note that the dependence on
species mass enters the formula through the Larmor radius <span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">t</span></sub> in <span 
class="cmmi-10">Œì</span><sub><span 
class="cmr-7">0</span></sub>.
</p><!--l. 3142--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.3   </span> <a 
 id="x1-490007.3"></a>Pade approximation</h4>
<!--l. 3144--><p class="noindent" ><span 
class="cmmi-10">Œì</span><sub><span 
class="cmr-7">0</span></sub> deÔ¨Åned in Eq. (<a 
href="#x1-48003r253">253<!--tex4ht:ref: 18-9-23-p4 --></a>) can be approximated by the Pade approximation as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-49001r255"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation303x.png" alt="      1
Œì 0 ‚âà----.
     1+ b
" class="math-display"  /></center></td><td class="equation-label">(255)</td></tr></table>
<!--l. 3148--><p class="nopar" >
The comparison between the exact value of <span 
class="cmmi-10">Œì</span><sub><span 
class="cmr-7">0</span></sub> and the above Pade approximation is shown in Fig.
<a 
href="#x1-490021">1<!--tex4ht:ref: 18-9-23-e1 --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x1-490021"></a>
                                                                                

                                                                                
<!--l. 3153--><p class="noindent" > <img 
src="my_figure/home/yj/theory/figures/pade/p.png" alt="pict"  
 width="254.95248pt" />
<br /> </p><div class="caption" 
><span class="id">Fig. 1:  </span><span  
class="content">Comparison  between  the  exact  value  of  <span 
class="cmmi-10">Œì</span><sub><span 
class="cmr-7">0</span></sub>   =  exp(<span 
class="cmsy-10">‚àí</span>(<span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">œÅ</span>)<sup><span 
class="cmr-7">2</span></sup>)<span 
class="cmmi-10">I</span><sub><span 
class="cmr-7">0</span></sub>((<span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">œÅ</span>)<sup><span 
class="cmr-7">2</span></sup>)  and  the
corresponding Pade approximation 1<span 
class="cmmi-10">‚àï</span>(1 + (<span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">œÅ</span>)<sup><span 
class="cmr-7">2</span></sup>).</span></div><!--tex4ht:label?: x1-490021 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 3159--><p class="indent" >   Using the Pade approximation (<a 
href="#x1-49001r255">255<!--tex4ht:ref: 18-10-23-p1 --></a>), the polarization density <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">p</span></sub> in expression (<a 
href="#x1-48004r254">254<!--tex4ht:ref: 18-9-23-p1 --></a>) can be written
as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation304x.png" alt="          ‚à´                2 2
np ‚âà ‚àí qn0  Œ¥Œ¶kexp(ik‚ãÖx)--k‚ä•œÅ2---dk--.                (256)
       T                1 + k‚ä•œÅ2(2œÄ)3
" class="math-display"  /><a 
 id="x1-49003r256"></a></center>
</div>(Pade approximate is the ‚Äúbest‚Äù approximation of a function by a rational function of given order ‚Äì
under this technique, the approximant‚Äôs power series agrees with the power series of the function it is
approximating.)
   <h5 class="subsubsectionHead"><a 
 id="x1-500007.3"></a>Long wavelength approximation of the polarization density</h5>
<!--l. 3172--><p class="noindent" >In the long wavelength limit, <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">œÅ </span><span 
class="cmsy-10">‚â™ </span>1, expression (<a 
href="#x1-49003r256">256<!--tex4ht:ref: 19-1-23-p6 --></a>) can be further approximated as
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation305x.png" alt="         ‚à´
n ‚âà ‚àí qn0   Œ¥Œ¶  exp(ik ‚ãÖx)k2œÅ2-dk--,
 p     T      k          ‚ä•  (2œÄ)3
  = qn0 œÅ2‚àá2 Œ¥Œ¶.                                     (257)
     T     ‚ä•
" class="math-display"  /><a 
 id="x1-50001r257"></a></center>
</div>Then the corresponding term in the Poisson equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation306x.png" alt="q-n =  q2n0-œÅ2‚àá2Œ¥Œ¶
ùúÄ0 p   ùúÄ0T    ‚ä•
       œÅ2- 2
    =  Œª2‚àá ‚ä•Œ¥Œ¶,                             (258)
        D
" class="math-display"  /><a 
 id="x1-50002r258"></a></center>
</div>where <span 
class="cmmi-10">Œª</span><sub><span 
class="cmmi-7">D</span></sub> is the Debye length deÔ¨Åned by <span 
class="cmmi-10">Œª</span><sub><span 
class="cmmi-7">D</span></sub><sup><span 
class="cmr-7">2</span></sup> = <span 
class="cmmi-10">TùúÄ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">n</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">q</span><sup><span 
class="cmr-7">2</span></sup>). For typical tokamak plasmas, the
thermal ion gyroradius <span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">i</span></sub> is much larger than <span 
class="cmmi-10">Œª</span><sub><span 
class="cmmi-7">D</span></sub>. Therefore the term in expression (<a 
href="#x1-50002r258">258<!--tex4ht:ref: 18-9-23-p5 --></a>) for
ions is much larger than the space charge term <span 
class="cmsy-10">‚àá</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚â°‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span>+ <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚âà‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥Œ¶ </span>in the
Poisson equation. Therefore the space charge term can be neglected in the long wavelength
limit.
<!--l. 3196--><p class="indent" >   Equation (<a 
href="#x1-50002r258">258<!--tex4ht:ref: 18-9-23-p5 --></a>) also shows that electron polarization density is smaller than the ion polarization
density by a factor of <span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">e</span></sub><span 
class="cmmi-10">‚àïœÅ</span><sub><span 
class="cmmi-7">i</span></sub> <span 
class="cmsy-10">‚âà </span>1<span 
class="cmmi-10">‚àï</span>60. Note that this conclusion is drawn in the long wavelength limit. For
short wavelength, the electron polarization and ion polarization density can be of similar magnitude (to
be discussed later).
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-510007.3"></a>Polarization density expressed in terms of Laplacian operator</h5>
<!--l. 3204--><p class="noindent" >The polarization density expression (<a 
href="#x1-50001r257">257<!--tex4ht:ref: 19-1-23-p5 --></a>) is for the long wavelength limit, which partially neglects
FLR eÔ¨Äect. Let us go back to the more general expression (<a 
href="#x1-49003r256">256<!--tex4ht:ref: 19-1-23-p6 --></a>). The Poisson equation is
written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-51001r259"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation307x.png" alt="‚àí ùúÄ0‚àá2‚ä• Œ¥Œ¶ = qiŒ¥ni + qeŒ¥ne.
" class="math-display"  /></center></td><td class="equation-label">(259)</td></tr></table>
<!--l. 3210--><p class="nopar" >
Write <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">i</span></sub> = <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">pi</span></sub> + <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmsy-10">‚Ä≤</span>, where <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">pi</span></sub> is the ion polarization density, then the above expression is
written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-51002r260"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation308x.png" alt="‚àí ùúÄ0‚àá2‚ä•Œ¥Œ¶ ‚àí qinpi = qiŒ¥n‚Ä≤i + qeŒ¥ne.
" class="math-display"  /></center></td><td class="equation-label">(260)</td></tr></table>
<!--l. 3216--><p class="nopar" >
Fourier transforming in space, the above equation is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-51003r261"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation309x.png" alt="‚àí ùúÄ0k2‚ä•Œ¥ÀÜŒ¶ ‚àí qiÀÜnpi = qiŒ¥ÀÜn‚Ä≤i + qeŒ¥ÀÜne,
" class="math-display"  /></center></td><td class="equation-label">(261)</td></tr></table>
<!--l. 3221--><p class="nopar" >
where <img 
src="nonlinear_gyrokinetic_equation310x.png" alt="ÀÜn"  class="circ"  /><sub><span 
class="cmmi-7">pi</span></sub> is the Fourier transformation (in space) of the polarization density <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">pi</span></sub> and similar meanings
for <span 
class="cmmi-10">Œ¥</span><img 
src="nonlinear_gyrokinetic_equation311x.png" alt="ÀÜŒ¶"  class="circ"  /> , <span 
class="cmmi-10">Œ¥</span><img 
src="nonlinear_gyrokinetic_equation312x.png" alt="nÀÜ"  class="circ"  /><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmsy-10">‚Ä≤</span>, and <span 
class="cmmi-10">Œ¥</span><img 
src="nonlinear_gyrokinetic_equation313x.png" alt="ÀÜn"  class="circ"  /><sub><span 
class="cmmi-7">e</span></sub>. Expression (<a 
href="#x1-49003r256">256<!--tex4ht:ref: 19-1-23-p6 --></a>) implies that <img 
src="nonlinear_gyrokinetic_equation314x.png" alt="ÀÜn"  class="circ"  /><sub><span 
class="cmmi-7">pi</span></sub> is given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-51004r262"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation315x.png" alt="       qini0- --k2‚ä•œÅ2i--
ÀÜnpi = ‚àí Ti Œ¥ÀÜŒ¶1 + k2œÅ2.
                  ‚ä• i
" class="math-display"  /></center></td><td class="equation-label">(262)</td></tr></table>
<!--l. 3229--><p class="nopar" >
Using this, equation (<a 
href="#x1-51003r261">261<!--tex4ht:ref: 19-1-23-p8 --></a>) is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-51005r263"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation316x.png" alt="            (                )
     2 ÀÜ       qini0--k2‚ä•-œÅ2i-- ÀÜ       ‚Ä≤
‚àí ùúÄ0k‚ä• Œ¥Œ¶‚àí qi ‚àí  Ti  1+ k2‚ä•œÅ2i Œ¥Œ¶ = qiŒ¥ÀÜni + qeŒ¥nÀÜe,
" class="math-display"  /></center></td><td class="equation-label">(263)</td></tr></table>
<!--l. 3235--><p class="nopar" >
Multiplying both sides by (1 + <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">œÅ</span><sub><span 
class="cmmi-7">i</span></sub><sup><span 
class="cmr-7">2</span></sup>)<span 
class="cmmi-10">‚àïùúÄ</span><sub><span 
class="cmr-7">0</span></sub>, the above equation is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-51006r264"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation317x.png" alt="       2 2  2     qi(  qini0  2 2   )    1     2 2     ‚Ä≤
‚àí (1 + k‚ä•œÅi)k‚ä•Œ¥ÀÜŒ¶‚àí  ùúÄ0- ‚àí -Ti-(k‚ä•œÅi)Œ¥ÀÜŒ¶  = ùúÄ0(1+ k‚ä•œÅi)(qiŒ¥ÀÜni + qeŒ¥ÀÜne).
" class="math-display"  /></center></td><td class="equation-label">(264)</td></tr></table>
<!--l. 3243--><p class="nopar" >
Next, transforming the above equation back to the real space, we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-51007r265"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation318x.png" alt="                   qi( qini0       )    1
‚àí (1‚àí œÅ2i‚àá2‚ä• )‚àá2‚ä•Œ¥Œ¶ ‚àí ùúÄ-  -T--œÅ2i‚àá2‚ä•Œ¥Œ¶  = ùúÄ-(1‚àí œÅ2i‚àá2‚ä•)(qiŒ¥n‚Ä≤i + qeŒ¥ne).
                    0    i             0
" class="math-display"  /></center></td><td class="equation-label">(265)</td></tr></table>
<!--l. 3250--><p class="nopar" >
Neglecting the Debye shielding term, the above equation is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-51008r266"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation319x.png" alt="  (         )
    œÅ2i-- 2      -1     2  2     ‚Ä≤
‚àí   Œª2Di‚àá ‚ä•Œ¥Œ¶  = ùúÄ0(1‚àí œÅi‚àá ‚ä•)(qiŒ¥ni + qeŒ¥ne),
" class="math-display"  /></center></td><td class="equation-label">(266)</td></tr></table>
<!--l. 3256--><p class="nopar" >
which is the equation actually solved in many gyrokinetic codes, where <span 
class="cmmi-10">Œª</span><sub><span 
class="cmmi-7">Di</span></sub><sup><span 
class="cmr-7">2</span></sup> = <span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">T</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">q</span><sub><span 
class="cmmi-7">i</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">i</span><span 
class="cmr-7">0</span></sub>).
</p><!--l. 3260--><p class="indent" >   ¬†
</p><!--l. 3263--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-520008"></a>Polarization density matrix obtained by numerically integrating in phase space using
grid</h3>
<!--l. 3265--><p class="noindent" >In Sec. <a 
href="#x1-420007">7<!--tex4ht:ref: 21-8-22-a3 --></a>, to evaluate the polarization density, the potential <span 
class="cmmi-10">Œ¥Œ¶ </span>is Fourier expanded in space using
local Cartesian coordinates, and then the double gyro-angle integration of each harmonic is
expressed as the Bessel function. (It seems that the original motivation of using the Fourier
expansion here is to facilitate analytical treatment and is not designed for numerical use.
GEM code does make use of the local Fourier expansion in its numerical implementation,
where the local perpendicular wave number needs to be estimated numerically, which seems
awkward.)
</p><!--l. 3274--><p class="indent" >   In this section, we avoid using the local Fourier expansion, and directly express the double
gyro-angle integral as linear combination of values of <span 
class="cmmi-10">Œ¥Œ¶ </span>at spatial grid-points. The polarization density
is given by Eq. (<a 
href="#x1-40004r226">226<!--tex4ht:ref: 18-9-13-p9 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-52001r267"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation320x.png" alt="        q-‚à´    (           ‚àÇF0-)
np(x) = m   dv  (Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©Œ±) ‚àÇùúÄ .
" class="math-display"  /></center></td><td class="equation-label">(267)</td></tr></table>
<!--l. 3282--><p class="nopar" >
Our goal is to write <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">p</span></sub> in the following real-space discrete from:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-52002r268"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation321x.png" alt="        ‚àë
np(xk ) =   cijŒ¥Œ¶i,j.
        i,j
" class="math-display"  /></center></td><td class="equation-label">(268)</td></tr></table>
<!--l. 3286--><p class="nopar" >
</p><!--l. 3289--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.1   </span> <a 
 id="x1-530008.1"></a>Direct evaluation of the double gyrophase integration</h4>
<!--l. 3291--><p class="noindent" >DeÔ¨Åne
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-53001r269"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation322x.png" alt="         q‚à´    (      ‚àÇF0)
A(x) = ‚àím-   dv  ‚ü®Œ¥Œ¶ ‚ü©Œ± ‚àÇùúÄ-- .
" class="math-display"  /></center></td><td class="equation-label">(269)</td></tr></table>
<!--l. 3295--><p class="nopar" >
Using <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">dŒ±</span>, the above integration is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-53002r270"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation323x.png" alt="         q ‚à´ ‚àû    ‚à´ ‚àû       ‚àÇF ‚à´ 2œÄ
A (x) = ‚àí--    dv‚à•    v‚ä•dv‚ä• --0-   dŒ± ‚ü®Œ¥Œ¶ ‚ü©Œ±,
         m  ‚àí‚àû     0        ‚àÇùúÄ  0
" class="math-display"  /></center></td><td class="equation-label">(270)</td></tr></table>
<!--l. 3302--><p class="nopar" >
where use has been made of the assumption that <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span>is uniform in <span 
class="cmmi-10">Œ± </span>in (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>)
coordinates, and thus is moved outside of the <span 
class="cmmi-10">Œ± </span>integration. Using the deÔ¨Ånition of gyro-averaging
(2<span 
class="cmmi-10">œÄ</span>)<sup><span 
class="cmsy-7">‚àí</span><span 
class="cmr-7">1</span></sup> <span 
class="cmex-10">‚à´</span>
   <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmr-7">2</span><span 
class="cmmi-7">œÄ</span></sup>(<span 
class="cmmi-10">‚Ä¶</span>)<span 
class="cmmi-10">dŒ±</span><span 
class="cmsy-10">‚Ä≤</span>, the above integration is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-53003r271"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation324x.png" alt="         q ‚à´ ‚àû    ‚à´ ‚àû    ‚àÇFi0  ‚à´ 2œÄ   ( 1 ‚à´ 2œÄ     )
A (x) = ‚àí--     dv‚à•    dv‚ä•----v‚ä•    dŒ±   ---   Œ¥Œ¶dŒ± ‚Ä≤ .
        m   ‚àí‚àû     0      ‚àÇùúÄ    0       2œÄ 0
" class="math-display"  /></center></td><td class="equation-label">(271)</td></tr></table>
<!--l. 3313--><p class="nopar" >
Note that the gyro-averaging is performed in the guiding-center space, i.e., performed by varying the
gyroangle <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤ </span>while keeping guiding-center position <span 
class="cmbx-10">X</span>, <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, and <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> constant. Using the deÔ¨Ånition of <span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">g</span></sub>
(i.e., its relation with <span 
class="cmmi-10">Œ¥Œ¶</span>):
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-53004r272"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation325x.png" alt="Œ¥Œ¶g(X,Œ±‚Ä≤,v‚ä•) = Œ¥Œ¶(x),
" class="math-display"  /></center></td><td class="equation-label">(272)</td></tr></table>
<!--l. 3320--><p class="nopar" >
where the particle location <span 
class="cmbx-10">x </span>is computed from the guiding-center location by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-53005r273"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation326x.png" alt="                        e‚à•(X )
x = X + œÅ(x,v ) ‚âà X ‚àí v√ó -----,
                        Œ©(X )
" class="math-display"  /></center></td><td class="equation-label">(273)</td></tr></table>
<!--l. 3327--><p class="nopar" >
then <span 
class="cmmi-10">A</span>(<span 
class="cmbx-10">x</span>) is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation327x.png" alt="A(x)
    q ‚à´ ‚àû    ‚à´ ‚àû    ‚àÇFi0  ‚à´ 2œÄ   [ 1 ‚à´ 2œÄ   (            ‚Ä≤   e‚à•(X))   ‚Ä≤]
= ‚àím-     dv‚à•    dv‚ä•-‚àÇùúÄ-v‚ä•    dŒ±  2œÄ-    Œ¥Œ¶  X ‚àí v‚ä•(v‚ä•,Œ± )√ó Œ©-(X-)- dŒ±
      ‚à´‚àí‚àû    ‚à´0           ‚à´0     ‚åä    0    (                     )‚åã
   -q  ‚àû       ‚àû    ‚àÇFi0    2œÄ   ‚åà-1-‚àëN2                ‚Ä≤   e‚à•(X-)-‚åâ
‚âà ‚àím   ‚àí‚àû dv‚à• 0  dv‚ä• ‚àÇùúÄ v‚ä• 0  dŒ±  N2    Œ¥Œ¶  X ‚àí v‚ä• (v‚ä•,Œ± j) √ó Œ© (X )
                                     j=1
" class="math-display"  /></center>
</div>where <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmbx-10">v</span>(<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤</span>) denotes a perpendicular velocity corresponding to a discrete gyro-angle
<span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤</span>.
<!--l. 3347--><p class="indent" >   Next, in order to perform the remaining velocity space integration, transform back to the particle
coordinates (because the velocity integration is performed in the particle coordinates, i.e., it is
performed by keeping the particle coordinate <span 
class="cmbx-10">x </span>constant): </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation328x.png" alt="          ‚à´       ‚à´
        q-  ‚àû       ‚àû    ‚àÇFi0
A(x) = ‚àí m ‚àí ‚àûdv‚à•  0 dv‚ä•  ‚àÇùúÄ v‚ä•
 ‚à´      ‚åä    N2   (                                       )‚åã
√ó  2œÄdŒ± ‚åà-1-‚àë  Œ¥Œ¶  x + v (v ,Œ±)√ó e‚à•(X-)‚àí v (v ,Œ± ‚Ä≤)√ó  e‚à•(X-)-‚åâ
  0      N2 j=1         ‚ä•  ‚ä•      Œ©(X )   ‚ä•  ‚ä•  j    Œ©(X )
      ‚à´ ‚àû    ‚à´ ‚àû
‚âà ‚àí q-    dv‚à•    dv‚ä•‚àÇFi0v‚ä•
    m  ‚àí‚àû‚åä     0      ‚àÇùúÄ                                   ‚åã
 ‚à´ 2œÄ       ‚àëN2   (                                      )
√ó    dŒ± ‚åà-1-   Œ¥Œ¶  x + v‚ä•(v‚ä•,Œ±)√ó e‚à•(x) ‚àí v‚ä•(v‚ä•,Œ±‚Ä≤j)√ó e‚à•(x) ‚åâ
  0      N2 j=1                   Œ©(x)              Œ© (x)
    q ‚à´ ‚àû    ‚à´ ‚àû    ‚àÇFi0
‚âà ‚àí --    dv‚à•    dv‚ä•----v‚ä•
    m  ‚àí‚àû     0 (    ‚àÇùúÄ                                 )
 -2œÄ‚àëN1 1--N‚àë2                   e-‚à•(x)          ‚Ä≤   e‚à•(x)
√óN1     N2    Œ¥Œ¶  x+ v‚ä• (v‚ä•,Œ±i)√ó  Œ©(x) ‚àí v‚ä•(v‚ä•,Œ±j)√ó Œ© (x)  .      (274)
     i=1    j=1
" class="math-display"  /><a 
 id="x1-53007r274"></a></center>
</div>For notation ease, deÔ¨Åne
                                                                                

                                                                                
   <table 
class="equation"><tr><td><a 
 id="x1-53008r275"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation329x.png" alt="                  e‚à•(x)-         ‚Ä≤   e‚à•(x)
ŒîœÅij = v‚ä• (v‚ä•,Œ±i)√ó Œ©(x) ‚àí v‚ä•(v‚ä•,Œ±j)√ó Œ© (x),
" class="math-display"  /></center></td><td class="equation-label">(275)</td></tr></table>
<!--l. 3387--><p class="nopar" >
where <span 
class="cmmi-10">ŒîœÅ</span><sub><span 
class="cmmi-7">ij</span></sub> is a function of (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">i</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤</span>). Then Eq. (<a 
href="#x1-53007r274">274<!--tex4ht:ref: 21-9-16-a4 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation330x.png" alt="         q‚à´ ‚àû     ‚à´ ‚àû    ‚àÇFi0   2œÄ‚àëN1 1  N‚àë2
A(x) = ‚àí--     dv‚à•    dv‚ä•----v‚ä•---    ---   Œ¥Œ¶(x+ Œî œÅij).       (276)
        m   ‚àí‚àû     0      ‚àÇùúÄ   N1  i=1 N2 j=1
" class="math-display"  /><a 
 id="x1-53009r276"></a></center>
</div>The guiding-center transform and its inverse involved in the above are illustrated in Fig. <a 
href="#x1-530112">2<!--tex4ht:ref: 21-8-22-a1 --></a>.
Then the double gyro-angle integral appearing in the polarization density is approximated
as
   <table 
class="equation"><tr><td><a 
 id="x1-53010r277"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation331x.png" alt="‚à´ 2œÄ   ( ‚à´ 2œÄ        ‚Ä≤)    (2œÄ)2 N‚àë1 N‚àë2
    dŒ±      Œ¥Œ¶(x)dŒ±   ‚âà N1N2-       Œ¥Œ¶(xij),
 0       0                   i=1 j=1
" class="math-display"  /></center></td><td class="equation-label">(277)</td></tr></table>
<!--l. 3406--><p class="nopar" >
where <span 
class="cmmi-10">N</span><sub><span 
class="cmr-7">1</span></sub> = 4<span 
class="cmmi-10">,N</span><sub><span 
class="cmr-7">2</span></sub> = 4 for the case shown in Fig. <a 
href="#x1-530112">2<!--tex4ht:ref: 21-8-22-a1 --></a>. This gives how to approximate the double
gyro-angle integration using the discrete values of <span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">ij</span></sub>. The spatial points <span 
class="cmbx-10">x</span><sub><span 
class="cmmi-7">ij</span></sub> appearing in Eq. (<a 
href="#x1-53010r277">277<!--tex4ht:ref: 21-9-2-a1 --></a>)
are not necessarily grid points. Linear interpolations are used to express <span 
class="cmmi-10">Œ¥Œ¶</span>(<span 
class="cmbx-10">x</span><sub><span 
class="cmmi-7">ij</span></sub>) as linear combination
                                                                                

                                                                                
of values of <span 
class="cmmi-10">Œ¥Œ¶ </span>at grid-points.
</p><!--l. 3414--><p class="indent" >   ¬†
</p><!--l. 3416--><p class="indent" >   ¬†
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x1-530112"></a>
                                                                                

                                                                                
<!--l. 3419--><p class="noindent" > <img 
src="../figures/double_gyro/p-1-.png" alt="PIC"  
 />
<br /> </p><div class="caption" 
><span class="id">Fig. 2: </span><span  
class="content">Given a <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, then the double gyro-angle integration in Eq. (<a 
href="#x1-53003r271">271<!--tex4ht:ref: 21-8-22-e1 --></a>) at a particle location <span 
class="cmbx-10">x </span>is
evaluated by the following steps: Use the guiding center transform to get guiding-center locations
(four locations are shown in this case, namely <span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">i</span></sub> with <span 
class="cmmi-10">i </span>= 1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span>3<span 
class="cmmi-10">,</span>4, corresponding gyro-angle <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">i</span></sub>
with <span 
class="cmmi-10">i </span>= 1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span>3<span 
class="cmmi-10">,</span>4; 2.) For each guiding-center location, use the inverse guiding-center transform
to calculate points on the corresponding gyro-ring (four points are shown for each guiding-center
<span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">i</span></sub> in this case, namely <span 
class="cmbx-10">x</span><sub><span 
class="cmmi-7">ij</span></sub> with <span 
class="cmmi-10">j </span>= 1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span>3<span 
class="cmmi-10">,</span>4, corresponding gyro angle <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤ </span>with <span 
class="cmmi-10">j </span>= 1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span>3<span 
class="cmmi-10">,</span>4.)</span></div><!--tex4ht:label?: x1-530112 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 3432--><p class="indent" >   ¬†
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.2   </span> <a 
 id="x1-540008.2"></a>Performing the parallel velocity integration</h4>
<!--l. 3436--><p class="noindent" >Assume that <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is Maxwellian, then
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-54001r278"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation332x.png" alt="‚àÇF      m       m     n         ( ‚àí mv2‚à•)   ( ‚àí mv2 )
--0-= ‚àí -fM  = ‚àí--------0-3‚àï2 exp  ------ exp  ----‚ä•- .
‚àÇ ùúÄ     T       T (2œÄT ‚àïm)         2T          2T
" class="math-display"  /></center></td><td class="equation-label">(278)</td></tr></table>
<!--l. 3442--><p class="nopar" >
Note that <span 
class="cmmi-10">ŒîœÅ</span><sub><span 
class="cmmi-7">ij</span></sub> is independent of <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>. Then the integration over <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> in Eq. (<a 
href="#x1-53009r276">276<!--tex4ht:ref: 22-11-8-1 --></a>) can be analytically
performed, yielding
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation333x.png" alt="                   (   - )                    (     )
       q-‚à´ ‚àû  -      ‚àí-v2‚à•  ‚à´ ‚àû -  - --n0--      ‚àí v2‚ä•
A (x) = T  ‚àí‚àû dv‚à•exp   2     0 dv‚ä• v‚ä•(2œÄ)3‚àï2 exp   2

       2œÄ-N‚àë1 -1-N‚àë2
     √ó N1    N2    Œ¥Œ¶(x + ŒîœÅij)
         ‚à´i=1   j=1   (     )
           ‚àû  - -       ‚àí v2‚ä• -1-‚àëN1 1--N‚àë2 q-
     = n0 0  dv‚ä•v‚ä• exp   2   N1     N2    T Œ¥Œ¶ (x + Œî œÅij).       (279)
                                 i=1    j=1
" class="math-display"  /><a 
 id="x1-54002r279"></a></center>
</div>where <span class="overline"><span 
class="cmmi-10">v</span></span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïv</span><sub><span 
class="cmmi-7">t</span></sub>, <span class="overline"><span 
class="cmmi-10">v</span></span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">‚àïv</span><sub><span 
class="cmmi-7">t</span></sub>, ¬†<span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub> = <img 
src="nonlinear_gyrokinetic_equation334x.png" alt="‚àò ----
  T‚àïm"  class="sqrt"  />, and use has been made of
   <table 
class="equation"><tr><td><a 
 id="x1-54003r280"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation335x.png" alt="‚à´ ‚àû    (    2)     ‚àö ---
    exp  ‚àí x- dx =   2œÄ.
 ‚àí‚àû        2
" class="math-display"  /></center></td><td class="equation-label">(280)</td></tr></table>
<!--l. 3466--><p class="nopar" >
</p><!--l. 3468--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.3   </span> <a 
 id="x1-550008.3"></a>Toroidal DFT of polarization density in Ô¨Åeld-aligned coordinates</h4>
<!--l. 3470--><p class="noindent" >In Ô¨Åeld-aligned coordinates (<span 
class="cmmi-10">x,y,z</span>), Fourier expansion of <span 
class="cmmi-10">Œ¥Œ¶ </span>along <span 
class="cmmi-10">y </span>is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-55001r281"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation336x.png" alt="         Ny‚àï2     (      )
Œ¥Œ¶ (x) ‚âà   ‚àë    exp  Œπn 2œÄy  Œ¥Œ¶n(x,z),
        n=‚àíNy‚àï2       Ly
" class="math-display"  /></center></td><td class="equation-label">(281)</td></tr></table>
<!--l. 3475--><p class="nopar" >
where <span 
class="cmmi-10">Œπ </span>= <img 
src="nonlinear_gyrokinetic_equation337x.png" alt="‚àö ---
  ‚àí 1"  class="sqrt"  />. Use this in Eq. (<a 
href="#x1-54002r279">279<!--tex4ht:ref: 21-9-16-a5 --></a>), yielding </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation338x.png" alt="         ‚à´            (  - )
A(x) = n   ‚àû dv v  exp  ‚àí-v2‚ä•
        0 0    ‚ä• ‚ä•       2
          N‚àë1    N‚àë2 ‚åä    N‚àëy‚àï2     (              )                       ‚åã
     √ó 1--   -1-   ‚åà-q        exp  Œπn2œÄ-(y + ŒîœÅijy) Œ¥Œ¶n(x+ Œî œÅijx,z + Œî œÅijz)‚åâ
       N1 i=1 N2 j=1 T n= ‚àíNy‚àï2      Ly
        Nt‚àï2     (      )   ‚à´           (   - )
         ‚àë          2œÄ-      ‚àû  -  -      ‚àí-v2‚ä•
     =        exp ŒπnLy y n0  0 dv‚ä• v‚ä•exp    2
       n= ‚àíNy‚àï2
       1--N‚àë1 -1-N‚àë2 [   (   2œÄ-    ) q-                     ]
     √ó N1    N2     exp  Œπn LyŒî œÅijy  TŒ¥Œ¶n (x + ŒîœÅijx,z + ŒîœÅijz) .           (282)
          i=1    j=1
" class="math-display"  /><a 
 id="x1-55002r282"></a></center>
</div>From Eq. (<a 
href="#x1-55002r282">282<!--tex4ht:ref: 21-9-16-a1 --></a>), the Fourier expansion coeÔ¨Écient of <span 
class="cmmi-10">A</span>(<span 
class="cmbx-10">x</span>) can be identiÔ¨Åed: <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation339x.png" alt="           ‚à´            (     )
             ‚àû  -  -      ‚àí v2‚ä•
An(x,z) = n0 0 dv‚ä• v‚ä• exp   2
            ‚àëN1   ‚àëN2 [   (         )                         ]
       √ó -1-    1--    exp  Œπn2œÄ-ŒîœÅijy  -qŒ¥Œ¶n(x+ Œî œÅijx,z + Œî œÅijz) .  (283)
         N1 i=1 N2 j=1        Ly       T
" class="math-display"  /><a 
 id="x1-55003r283"></a></center>
</div>Let us make the following approximation
   <table 
class="equation"><tr><td><a 
 id="x1-55004r284"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation340x.png" alt="Œ¥Œ¶n(x+ Œî œÅijx,z + Œî œÅijz) ‚âà Œ¥Œ¶n(x + ŒîœÅijx,z),
" class="math-display"  /></center></td><td class="equation-label">(284)</td></tr></table>
<!--l. 3509--><p class="nopar" >
which should be a good approximation since the variation of <span 
class="cmmi-10">Œ¥Œ¶ </span>along a Ô¨Åeld line over a distance of a
Larmor radius is small. Then expression (<a 
href="#x1-55003r283">283<!--tex4ht:ref: 22-12-21-1 --></a>) is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation341x.png" alt="           ‚à´ ‚àû  - -     ( ‚àí v2 )
An(x,z) ‚âà n0   dv‚ä•v‚ä• exp  --‚ä•-
            0 [   (        2)                  ]
 -1-‚àëN1 1--N‚àë2        2œÄ-      -q
√óN1     N2     exp  ŒπnLy ŒîœÅijy T Œ¥Œ¶n(x +Œî œÅijx,z) .          (285)
    i=1    j=1
" class="math-display"  /></center>
</div>The approximation (<a 
href="#x1-55004r284">284<!--tex4ht:ref: 22-12-21-3 --></a>) makes the operator <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">n</span></sub> on <span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">n</span></sub> become local in <span 
class="cmmi-10">z </span>direction, i.e., it involves
<span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">n</span></sub> at locations with a Ô¨Åxed value of <span 
class="cmmi-10">z</span>. This makes <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">n</span></sub>(<span 
class="cmmi-10">x,z</span>) reduce to a 1D operator on <span 
class="cmmi-10">Œ¥Œ¶</span><sub><span 
class="cmmi-7">n</span></sub> in the <span 
class="cmmi-10">x</span>
direction.
<!--l. 3526--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.4   </span> <a 
 id="x1-560008.4"></a>Using MC integration, to be continued, not necessary</h4>
<!--l. 3528--><p class="noindent" >The integration we try to express is given by </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation342x.png" alt="          ‚à´
Aijk ‚âà -1--    dxnp(x)
      Vijk  Vijk
       1  ‚à´      ‚à´   ( q            ‚àÇF0)
    = V---    dx   dv  m-(Œ¥Œ¶‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)‚àÇ-ùúÄ- ,              (286)
       ijk  Vijk
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">ijk</span></sub> is the value of <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">p</span></sub>(<span 
class="cmbx-10">x</span>) at a grid-point, which is approximated by the spatial averaging of
<span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">p</span></sub>(<span 
class="cmbx-10">x</span>) over the cell whose center is the grid-point, <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">ijk</span></sub> is the volume of the cell. We will use
Monte-Carlo guiding-center markers to compute the above cell average. <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation343x.png" alt="                    (          )
A (1)= ‚àí q--1--‚àë  ‚àë    ‚ü®Œ¥Œ¶‚ü©  ‚àÇF01
  ijk    m Vijk  p  Œ±      Œ± ‚àÇùúÄ g
              ‚àë       ‚àë  (     )
    = ‚àí q--1--   ‚ü®Œ¥Œ¶ ‚ü©Œ±      ‚àÇF01
        m Vijk  p       Œ±   ‚àÇùúÄ g
" class="math-display"  /></center>
</div>Nearest neighbour interpolation
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation344x.png" alt="              ‚àë  ‚àë  (        )
A (2) = ‚àí-q--1-        Œ¥Œ¶‚àÇF0-1
  ijk    m Vijk p  Œ±      ‚àÇùúÄ g
         qŒ¥Œ¶   ‚àë  ‚àë  ( ‚àÇF  1)
     = ‚àí-----ijk        --0--
        m  Vijk  p  Œ±    ‚àÇùúÄ g
" class="math-display"  /></center>
</div>Later, I found that evaluating the polarization density using grid works well. Therefore there is no need
to evaluate it using MC markers, which is more complicated.
<!--l. 3563--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">A   </span> <a 
 id="x1-57000A"></a>Adiabatic electron response</h3>
<!--l. 3565--><p class="noindent" >Assume that the total electron density satisÔ¨Åes the Boltzmann distribution on each magnetic surface,
i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-57001r287"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation345x.png" alt="              (  qŒ¥Œ¶ )     (    q Œ¥Œ¶)
ne = Ne(œà)exp  ‚àí -e--  ‚âà Ne  1‚àí -e--  ,
                  Te             Te
" class="math-display"  /></center></td><td class="equation-label">(287)</td></tr></table>
                                                                                

                                                                                
<!--l. 3570--><p class="nopar" >
where <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">e</span></sub> is a radial function. Note that this does not imply that the equilibrium density is <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">e</span></sub> (it just
implies that the total density is <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">e</span></sub> at the location where <span 
class="cmmi-10">Œ¥Œ¶ </span>= 0, which can still be diÔ¨Äerent from the
equilibrium density).
</p><!--l. 3576--><p class="indent" >   Further assume that the magnetic surface average of <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">e</span></sub> = <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span></sub> <span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span><span 
class="cmr-7">0</span></sub> is zero, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-57002r288"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation346x.png" alt="‚ü®ne ‚àí ne0‚ü©f = 0,
" class="math-display"  /></center></td><td class="equation-label">(288)</td></tr></table>
<!--l. 3580--><p class="nopar" >
where <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span><span 
class="cmr-7">0</span></sub> is the equilibrium electron density, <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">‚Ä¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">f</span></sub> is the magntic surface averaging operator. Using Eq.
(<a 
href="#x1-57001r287">287<!--tex4ht:ref: 23-2-13-1 --></a>) in the above condition, we get
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-57003r289"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation347x.png" alt="                       (           )
Ne = ne0----1-----‚âà ne0 1 + qe‚ü®Œ¥Œ¶-‚ü©f- .
        1 ‚àí qe‚ü®Œ¥TeŒ¶‚ü©f-            Te
" class="math-display"  /></center></td><td class="equation-label">(289)</td></tr></table>
<!--l. 3588--><p class="nopar" >
Then expression (<a 
href="#x1-57001r287">287<!--tex4ht:ref: 23-2-13-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-57004r290"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation348x.png" alt="        (          ) (        )      (                 )
             qe‚ü®Œ¥Œ¶‚ü©f-      qeŒ¥Œ¶-            qe‚ü®Œ¥Œ¶‚ü©f-  qeŒ¥Œ¶-
ne = ne0  1+    Te     1 ‚àí  Te   ‚âà ne0 1 +   Te   ‚àí  Te   .
" class="math-display"  /></center></td><td class="equation-label">(290)</td></tr></table>
<!--l. 3595--><p class="nopar" >
Then the perturbation <span 
class="cmmi-10">Œ¥n</span><sub><span 
class="cmmi-7">e</span></sub> = <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span></sub> <span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span><span 
class="cmr-7">0</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-57005r291"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation349x.png" alt="          qe(Œ¥Œ¶-‚àí-‚ü®Œ¥Œ¶‚ü©f)
Œ¥ne = ‚àí n0e    Te      .
" class="math-display"  /></center></td><td class="equation-label">(291)</td></tr></table>
<!--l. 3600--><p class="nopar" >
This model of electron response is often called adiabatic electron.
</p><!--l. 3603--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">A.1   </span> <a 
 id="x1-58000A.1"></a>Poisson‚Äôs equation with adiabatic electron response</h4>
<!--l. 3605--><p class="noindent" >Pluging expression (<a 
href="#x1-57005r291">291<!--tex4ht:ref: 23-3-10-1 --></a>) into the Poisson equation (<a 
href="#x1-40005r227">227<!--tex4ht:ref: 19-1-12-e4 --></a>), we get
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-58001r292"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation350x.png" alt="            ‚à´  q            ‚àÇF          q2(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶ ‚ü©)
‚àí ùúÄ0‚àá2‚ä•Œ¥Œ¶‚àí qi  -i(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)-i0dv + n0ee---------f--= qiŒ¥n‚Ä≤i.
               mi            ‚àÇùúÄ              Te
" class="math-display"  /></center></td><td class="equation-label">(292)</td></tr></table>
<!--l. 3615--><p class="nopar" >
When solving the Poisson equation, the equation is Fourier expanded in toroidal harmonics and each
harmonic is independent of each other, so that they can be solved independently. For <span 
class="cmmi-10">n</span><span 
class="cmmi-10">‚â†</span>0 harmonics,
the <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">f</span></sub> terms is zero and thus it is trivial to treat the electron term. For the <span 
class="cmmi-10">n </span>= 0 harmonic, the
<span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">f</span></sub> term is nonzero and needs special treatment. I use the following method to obtain <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">f</span></sub>. First
slove the <span 
class="cmmi-10">n </span>= 0 harmonic of the following equation:
</p>
                                                                                

                                                                                
   <table 
class="equation"><tr><td><a 
 id="x1-58002r293"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation351x.png" alt="     2  ‚Ä≤    ‚à´  qi   ‚Ä≤     ‚Ä≤  ‚àÇFi0        ‚Ä≤
‚àí ùúÄ0‚àá ‚ä•Œ¥Œ¶ ‚àí qi mi-(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶ ‚ü©Œ±)-‚àÇùúÄ-dv = qiŒ¥ni,
" class="math-display"  /></center></td><td class="equation-label">(293)</td></tr></table>
<!--l. 3628--><p class="nopar" >
(i.e., Eq. (<a 
href="#x1-58001r292">292<!--tex4ht:ref: 23-2-13-3 --></a>) with electron term dropped), and then take the magnetic surface average of the solution
<span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚Ä≤ </span>to get <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚Ä≤‚ü©</span><sub><span 
class="cmmi-7">f</span></sub>. It can be proved that <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚Ä≤‚ü©</span><sub><span 
class="cmmi-7">f</span></sub> is equal to <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">f</span></sub>. Then solving Eq. (<a 
href="#x1-58001r292">292<!--tex4ht:ref: 23-2-13-3 --></a>)
becomes easier since <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">f</span></sub> term is known and can be moved to the right-hand side as a source
term.
</p><!--l. 3636--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">B   </span> <a 
 id="x1-59000B"></a>Characteristic curves of Frieman-Chen nonlinear gyrokinetic equation</h3>
<!--l. 3638--><p class="noindent" >Examining the left-hand side of Eq. (), it is ready to Ô¨Ånd that the characteristic curves of this equation
are given by the following equations:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-59001r294"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation352x.png" alt="dX
-dt = v‚à•e‚à• + VD + Œ¥VD,
" class="math-display"  /></center></td><td class="equation-label">(294)</td></tr></table>
<!--l. 3643--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-59002r295"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation353x.png" alt="dùúÄ
--= 0,
dt
" class="math-display"  /></center></td><td class="equation-label">(295)</td></tr></table>
<!--l. 3646--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-59003r296"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation354x.png" alt="dŒº
--= 0.
dt
" class="math-display"  /></center></td><td class="equation-label">(296)</td></tr></table>
<!--l. 3649--><p class="nopar" >
(It is instructive to notice that the kinetic energy <span 
class="cmmi-10">ùúÄ </span>is conserved along the characteristic
curves while the real kinetic energy of a particle is usually not conserved in a perturbed
electromagnetic Ô¨Åeld. This may be an indication that Frieman-Chen equation neglects the velocity
space nonlinearity.) For notation ease, we denote the total guiding-center velocity by <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub>,
i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-59004r297"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation355x.png" alt="     dX    dX    dX
VG = --- = ---0+ ---1 = v‚à•e‚à• + VD + Œ¥VD,
      dt    dt    dt
" class="math-display"  /></center></td><td class="equation-label">(297)</td></tr></table>
<!--l. 3660--><p class="nopar" >
where
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-59005r298"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation356x.png" alt="dX0-= v e + V  .
 dt    ‚à• ‚à•    D
" class="math-display"  /></center></td><td class="equation-label">(298)</td></tr></table>
<!--l. 3665--><p class="nopar" >
In the above, <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> can be obtained by using <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmmi-10">œÉ</span><img 
src="nonlinear_gyrokinetic_equation357x.png" alt="‚àò ---------
  2(ùúÄ‚àí BŒº )"  class="sqrt"  />. However <span 
class="cmmi-10">œÉ </span>is not easy to determine since
it changes with time for trapped particles. In practice, we get <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> from an evolution equation. This
evolution equation for <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> can be obtained by combining the equations for <span 
class="cmmi-10">ùúÄ </span>and <span 
class="cmmi-10">Œº</span>. Next, we derive this
equation.
</p><!--l. 3673--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">B.1   </span> <a 
 id="x1-60000B.1"></a>Time evolution equation for <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub></h4>
<!--l. 3675--><p class="noindent" >Using the deÔ¨Ånition <span 
class="cmmi-10">Œº </span>= <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">‚àï</span>(2<span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>), equation (<a 
href="#x1-59003r296">296<!--tex4ht:ref: 16-10-12-2 --></a>), i.e., <span 
class="cmmi-10">dŒº‚àïdt </span>= 0, is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60001r299"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation358x.png" alt="   (  2 )
-d  -v‚ä•-  = 0,
dt  2B0
" class="math-display"  /></center></td><td class="equation-label">(299)</td></tr></table>
<!--l. 3679--><p class="nopar" >
which is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60002r300"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation359x.png" alt="-1-d(v2)+ v2 d-( 1-) = 0,
B dt  ‚ä•    ‚ä• dt B0
" class="math-display"  /></center></td><td class="equation-label">(300)</td></tr></table>
<!--l. 3684--><p class="nopar" >
which can be further written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60003r301"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation360x.png" alt="-d  2      d-
dt(v‚ä•) = 2Œº dt(B0).
" class="math-display"  /></center></td><td class="equation-label">(301)</td></tr></table>
<!--l. 3688--><p class="nopar" >
Using the deÔ¨Ånition of the characteristics, the right-hand side of the above equation can be expanded,
giving
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60004r302"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation361x.png" alt="d   2      (‚àÇB0   dX          dùúÄ ‚àÇB0   dŒº ‚àÇB0)
dt(v‚ä•) = 2Œº -‚àÇt-+ -dt ‚ãÖ‚àáXB0 + -dt-‚àÇùúÄ-+ dt-‚àÇŒº-- ,
" class="math-display"  /></center></td><td class="equation-label">(302)</td></tr></table>
<!--l. 3696--><p class="nopar" >
where <span 
class="cmmi-10">d</span><span 
class="cmbx-10">X</span><span 
class="cmmi-10">‚àïdt</span>, <span 
class="cmmi-10">dùúÄ‚àïdt</span>, and <span 
class="cmmi-10">dŒº‚àïdt </span>are given by Eq. (<a 
href="#x1-59001r294">294<!--tex4ht:ref: 16-10-11-3 --></a>), (<a 
href="#x1-59002r295">295<!--tex4ht:ref: 16-10-12-1 --></a>), and (<a 
href="#x1-59003r296">296<!--tex4ht:ref: 16-10-12-2 --></a>), respectively. Using Eqs.
(<a 
href="#x1-59001r294">294<!--tex4ht:ref: 16-10-11-3 --></a>)-(<a 
href="#x1-59003r296">296<!--tex4ht:ref: 16-10-12-2 --></a>) and <span 
class="cmmi-10">‚àÇB</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>= 0, equation (<a 
href="#x1-60004r302">302<!--tex4ht:ref: 16-10-12-p5 --></a>) is reduced to
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60005r303"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation362x.png" alt="          (          )
d- 2        dX-
dt(v‚ä• ) = 2Œº dt ‚ãÖ‚àáXB0   .
" class="math-display"  /></center></td><td class="equation-label">(303)</td></tr></table>
<!--l. 3704--><p class="nopar" >
On the other hand, equation (<a 
href="#x1-59002r295">295<!--tex4ht:ref: 16-10-12-1 --></a>), i.e., <span 
class="cmmi-10">dùúÄ‚àïdt </span>= 0, is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60006r304"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation363x.png" alt="d-  2
dt(v ) = 0,
" class="math-display"  /></center></td><td class="equation-label">(304)</td></tr></table>
<!--l. 3709--><p class="nopar" >
which can be further written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60007r305"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation364x.png" alt="d   2     d  2
dt(v‚à•) = ‚àídt(v‚ä•).
" class="math-display"  /></center></td><td class="equation-label">(305)</td></tr></table>
<!--l. 3713--><p class="nopar" >
Using Eq. (<a 
href="#x1-60005r303">303<!--tex4ht:ref: 16-10-12-5 --></a>), the above equation is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60008r306"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation365x.png" alt="            (          )
d-        Œº-  dX-
dt(v‚à•) = ‚àí v‚à•  dt ‚ãÖ‚àáXB0   ,
" class="math-display"  /></center></td><td class="equation-label">(306)</td></tr></table>
<!--l. 3719--><p class="nopar" >
which is the equation for the time evolution of <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>. This equation involves <span 
class="cmmi-10">d</span><span 
class="cmbx-10">X</span><span 
class="cmmi-10">‚àïdt</span>, i,e., the guiding-center
drift, which is given by Eq. (<a 
href="#x1-59001r294">294<!--tex4ht:ref: 16-10-11-3 --></a>). Equation (<a 
href="#x1-60008r306">306<!--tex4ht:ref: 16-10-12-p1 --></a>) for <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> can be simpliÔ¨Åed by noting that the
Frieman-Chen equation is correct only to the second order, <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>), and thus the characteristics need to
be correct only to the Ô¨Årst order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>) and higher order terms can be dropped. Note that, in the
guiding-center drift <span 
class="cmmi-10">d</span><span 
class="cmbx-10">X</span><span 
class="cmmi-10">‚àïdt </span>given by Eq. (<a 
href="#x1-59001r294">294<!--tex4ht:ref: 16-10-11-3 --></a>), only the <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub> term in ¬†is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">0</span></sup>), all the
other terms are of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>). Using this, accurate to order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>), equation (<a 
href="#x1-60008r306">306<!--tex4ht:ref: 16-10-12-p1 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-60009r307"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation366x.png" alt="d-
dt(v‚à•) = ‚àí Œºe‚à• ‚ãÖ‚àáXB0,
" class="math-display"  /></center></td><td class="equation-label">(307)</td></tr></table>
<!--l. 3734--><p class="nopar" >
which is the time evolution equation ready to be used for numerically advancing <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>. Note that only the
mirror force <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">Œº</span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">B </span>appears in Eq. (<a 
href="#x1-60009r307">307<!--tex4ht:ref: 16-10-11-p24 --></a>) and there is no parallel acceleration term <span 
class="cmmi-10">qv</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">Œ¥E</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïm </span>in
Eq. (<a 
href="#x1-60009r307">307<!--tex4ht:ref: 16-10-11-p24 --></a>). This is because <span 
class="cmmi-10">Œ¥E</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmsy-10">‚àí</span><span 
class="cmbx-10">b </span><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">‚àÇŒ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) and (**check** the terms
involving <span 
class="cmmi-10">E</span><sub><span 
class="cmsy-7">‚à•</span></sub> are of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">3</span></sup>) or higher and thus have been dropped in deriving Frieman-Chen
equation.)
</p><!--l. 3746--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">C   </span> <a 
 id="x1-61000C"></a>From (<span 
class="cmmi-10">Œ¥Œ¶,Œ¥</span><span 
class="cmbx-10">A</span>) to (<span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span><span 
class="cmmi-10">,Œ¥</span><span 
class="cmbx-10">B</span>)</h3>
<!--l. 3748--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">C.1   </span> <a 
 id="x1-62000C.1"></a>Expression of <span 
class="cmmi-10">Œ¥B</span><sub><span 
class="cmsy-7">‚ä•</span></sub> in terms of <span 
class="cmmi-10">Œ¥A</span></h4>
<!--l. 3750--><p class="noindent" >Note that </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation367x.png" alt="Œ¥B ‚ä• = ‚àá √ó Œ¥A ‚àí (e‚à• ‚ãÖ‚àá √ó Œ¥A )e‚à•
    = ‚àá √ó (Œ¥A ‚ä• + Œ¥A‚à•e‚à•)‚àí [e‚à• ‚ãÖ‚àá √ó (Œ¥A ‚ä• +Œ¥A ‚à•e‚à•)]e‚à•           (308)
" class="math-display"  /></center>
</div>Correct to order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>), <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">B</span><sub><span 
class="cmsy-7">‚ä•</span></sub> in the above equation is written as (<span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub> vector can be considered as
constant because its spatial gradient combined with <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span>will give terms of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>), which are neglected)
<div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation368x.png" alt="Œ¥B‚ä• ‚âà ‚àá √ó Œ¥A ‚ä• + ‚àá Œ¥A‚à• √ó e‚à• ‚àí [e‚à• ‚ãÖ‚àá √ó Œ¥A ‚ä• + e‚à• ‚ãÖ(‚àá Œ¥A‚à• √óe‚à•)]e‚à• (309)
    = ‚àá √ó Œ¥A ‚ä• + ‚àá Œ¥A‚à• √ó e‚à• ‚àí (e‚à• ‚ãÖ‚àá √ó Œ¥A ‚ä•)e‚à•                   (310)
" class="math-display"  /><a 
 id="x1-62002r310"></a></center>
</div>Using local cylindrical coordinates (<span 
class="cmmi-10">r,œï,z</span>) with <span 
class="cmmi-10">z </span>being along the local direction of <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub>, and two
components of <span 
class="cmbx-10">A</span><sub><span 
class="cmsy-7">‚ä•</span></sub> being <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">r</span></sub> and <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">œï</span></sub>, then <span 
class="cmsy-10">‚àá√ó </span><span 
class="cmbx-10">A</span><sub><span 
class="cmsy-7">‚ä•</span></sub> is written as
   <table 
class="equation"><tr><td><a 
 id="x1-62003r311"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation369x.png" alt="          (  ‚àÇŒ¥A  )     (‚àÇŒ¥A  )     1 [ ‚àÇ        ‚àÇŒ¥A  ]
‚àá √ó Œ¥A ‚ä• =  ‚àí ---œï- er +  ----r  eœï +-  --(rŒ¥Aœï)‚àí ----r e‚à•.
              ‚àÇz          ‚àÇz        r  ‚àÇr         ‚àÇ œï
" class="math-display"  /></center></td><td class="equation-label">(311)</td></tr></table>
<!--l. 3784--><p class="nopar" >
Note that the parallel gradient operator <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚â° </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá </span>= <span 
class="cmmi-10">‚àÇ‚àï‚àÇz </span>acting on the the perturbed quantities will
result in quantities of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>). Retaining terms of order up to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>), equation (<a 
href="#x1-62003r311">311<!--tex4ht:ref: 16-10-11-p4 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-62004r312"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation370x.png" alt="          1 [ ‚àÇ        ‚àÇ Œ¥A  ]
‚àá √óŒ¥A ‚ä• ‚âà -  --(rŒ¥Aœï)‚àí ----r e‚à•,
          r  ‚àÇr         ‚àÇ œï
" class="math-display"  /></center></td><td class="equation-label">(312)</td></tr></table>
<!--l. 3794--><p class="nopar" >
i.e., only the parallel component survive, which exactly cancels the last term in Eq. (<a 
href="#x1-62002r310">310<!--tex4ht:ref: 16-10-11-p3 --></a>), i.e., equation
(<a 
href="#x1-62002r310">310<!--tex4ht:ref: 16-10-11-p3 --></a>) is reduced to
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-62005r313"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation371x.png" alt="Œ¥B‚ä• = ‚àá Œ¥A ‚à• √ó e‚à•.
" class="math-display"  /></center></td><td class="equation-label">(313)</td></tr></table>
<!--l. 3800--><p class="nopar" >
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-63000C.1"></a>Using basis vectors in Ô¨Åeld-aligned coordinates</h5>
<!--l. 3805--><p class="noindent" >In terms of <span 
class="cmmi-10">Œ¥B</span><sub><span 
class="cmmi-7">xL</span></sub> and <span 
class="cmmi-10">Œ¥B</span><sub><span 
class="cmmi-7">yL</span></sub>, ¬†<span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">B</span><sub><span 
class="cmsy-7">‚ä•</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-63001r314"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation372x.png" alt="Œ¥B ‚ä• = Œ¥BxL‚àáx + Œ¥ByL ‚àáy = ‚àáŒ¥A ‚à• √ó e‚à•
" class="math-display"  /></center></td><td class="equation-label">(314)</td></tr></table>
<!--l. 3810--><p class="nopar" >
Dotting the above equation by <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">x </span>and <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">y</span>, respectively, we obtain
                                                                                

                                                                                
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-63002r315"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation373x.png" alt="Œ¥BxL|‚àáx|2 + Œ¥ByL‚àáx ‚ãÖ‚àáy = ‚àáx ‚ãÖ(‚àá Œ¥A‚à• √ó e‚à•),
" class="math-display"  /></center></td><td class="equation-label">(315)</td></tr></table>
<!--l. 3819--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-63003r316"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation374x.png" alt="Œ¥BxL‚àáx ‚ãÖ‚àáy + Œ¥ByL|‚àáy |2 = ‚àáy ‚ãÖ(‚àá Œ¥A‚à• √ó e‚à•).
" class="math-display"  /></center></td><td class="equation-label">(316)</td></tr></table>
<!--l. 3824--><p class="nopar" >
Equations (<a 
href="#x1-63002r315">315<!--tex4ht:ref: 18-6-9-a1 --></a>) and (<a 
href="#x1-63003r316">316<!--tex4ht:ref: 18-6-9-a2 --></a>) can be further written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-63004r317"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation375x.png" alt="                              ( ‚àÇŒ¥A           ‚àÇŒ¥A        )
Œ¥BxL|‚àáx|2 + Œ¥ByL‚àáx ‚ãÖ‚àáy = ‚àí ‚àáx ‚ãÖ ---‚à•‚àáy √ó e‚à• + ---‚à•‚àáz √ó e‚à•  ,
                                 ‚àÇy            ‚àÇz
" class="math-display"  /></center></td><td class="equation-label">(317)</td></tr></table>
<!--l. 3833--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-63005r318"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation376x.png" alt="                              (                          )
                     2          ‚àÇŒ¥A‚à•-         ‚àÇŒ¥A‚à•-
Œ¥BxL‚àáx ‚ãÖ‚àáy + Œ¥ByL |‚àáy | = ‚àí ‚àáy ‚ãÖ  ‚àÇx ‚àáx √ó e‚à• +  ‚àÇz ‚àáz √ó e‚à•  ,
" class="math-display"  /></center></td><td class="equation-label">(318)</td></tr></table>
<!--l. 3840--><p class="nopar" >
</p><!--l. 3843--><p class="indent" >   The solution of this 2 <span 
class="cmsy-10">√ó </span>2 system is expressed by Cramer‚Äôs rule in the code.
</p><!--l. 3846--><p class="indent" >   ¬†
</p><!--l. 3848--><p class="indent" >   Use <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> = <span 
class="cmmi-10">Œ®</span><span 
class="cmsy-10">‚Ä≤‚àá</span><span 
class="cmmi-10">x </span><span 
class="cmsy-10">√ó‚àá</span><span 
class="cmmi-10">y</span>
</p><!--l. 3850--><p class="indent" >   <span 
class="cmbx-10">b </span>= <span 
class="cmmi-10">Œ®</span><span 
class="cmsy-10">‚Ä≤‚àá</span><span 
class="cmmi-10">x </span><span 
class="cmsy-10">√ó‚àá</span><span 
class="cmmi-10">y‚àïB</span><sub><span 
class="cmr-7">0</span></sub>
</p><!--l. 3852--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">C.2   </span> <a 
 id="x1-64000C.2"></a>Expression of <span 
class="cmmi-10">Œ¥B</span><sub><span 
class="cmsy-7">‚à•</span></sub> in terms of <span 
class="cmmi-10">Œ¥A</span></h4>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation377x.png" alt="Œ¥B‚à• = e‚à• ‚ãÖ‚àá √ó Œ¥A

    = e‚à• ‚ãÖ‚àá √ó (Œ¥A ‚ä• + Œ¥A‚à•e‚à•)                     (319)
" class="math-display"  /></center>
</div>Accurate to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>), <span 
class="cmmi-10">Œ¥B</span><sub><span 
class="cmsy-7">‚à•</span></sub> in the above equation is written as (<span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub> vector can be considered as constant
because its spatial gradient combined with <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A </span>will give <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) terms, which are neglected)
<div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation378x.png" alt="Œ¥B ‚à• ‚âà e‚à• ‚ãÖ‚àá √ó Œ¥A ‚ä• + e‚à• ‚ãÖ(‚àá Œ¥A‚à• √óe‚à•)
    = e‚à• ‚ãÖ‚àá √ó Œ¥A ‚ä•                                  (320)
" class="math-display"  /><a 
 id="x1-64002r320"></a></center>
</div>[Using local cylindrical coordinates (<span 
class="cmmi-10">r,œï,z</span>) with <span 
class="cmmi-10">z </span>being along the local direction of <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub>, and two
components of <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><sub><span 
class="cmsy-7">‚ä•</span></sub> being <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmmi-7">r</span></sub> and <span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmmi-7">œï</span></sub>, then <span 
class="cmsy-10">‚àá√ó </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><sub><span 
class="cmsy-7">‚ä•</span></sub> is written as
   <table 
class="equation"><tr><td><a 
 id="x1-64003r321"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation379x.png" alt="          (  ‚àÇŒ¥A œï)     ( ‚àÇŒ¥Ar)     1 [ ‚àÇ         ‚àÇŒ¥Ar]
‚àá √ó Œ¥A‚ä• =   ‚àí--‚àÇz-  er +  -‚àÇz-- er + r ‚àÇr(rŒ¥Aœï)‚àí  -‚àÇœï--e‚à•
" class="math-display"  /></center></td><td class="equation-label">(321)</td></tr></table>
<!--l. 3881--><p class="nopar" >
Note that the parallel gradient operator <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚â° </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá </span>= <span 
class="cmmi-10">‚àÇ‚àï‚àÇz </span>acting on the the perturbed quantities will
result in quantities of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>). Retaining terms of order up to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>), equation (<a 
href="#x1-62003r311">311<!--tex4ht:ref: 16-10-11-p4 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-64004r322"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation380x.png" alt="          1 [ ‚àÇ        ‚àÇ Œ¥A  ]
‚àá √óŒ¥A ‚ä• ‚âà -  --(rŒ¥Aœï)‚àí ----r e‚à•,
          r  ‚àÇr         ‚àÇ œï
" class="math-display"  /></center></td><td class="equation-label">(322)</td></tr></table>
<!--l. 3891--><p class="nopar" >
Using this, equation (<a 
href="#x1-64002r320">320<!--tex4ht:ref: 16-10-18-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-64005r323"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation381x.png" alt="       [                ]
      1  ‚àÇ--       ‚àÇŒ¥Ar-
Œ¥B‚à• = r  ‚àÇr(rŒ¥A œï)‚àí  ‚àÇœï   .
" class="math-display"  /></center></td><td class="equation-label">(323)</td></tr></table>
<!--l. 3896--><p class="nopar" >
However, this expression is not useful for GEM because GEM does not use the local coordinates
(<span 
class="cmmi-10">r,œï,z</span>).]
</p><!--l. 3900--><p class="noindent" >¬†
</p><!--l. 3903--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">C.3   </span> <a 
 id="x1-65000C.3"></a>Expressing the perturbed drift in terms of <span 
class="cmmi-10">Œ¥E </span>and <span 
class="cmmi-10">Œ¥B</span></h4>
<!--l. 3905--><p class="noindent" >The perturbed drift <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is given by Eq. (<a 
href="#x1-29004r139">139<!--tex4ht:ref: 19-1-3-1 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-65001r324"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation382x.png" alt="Œ¥V   = ‚àí-q‚àá  ‚ü®Œ¥L‚ü© √ó  e‚à•.
   D    m   X    Œ±   Œ©
" class="math-display"  /></center></td><td class="equation-label">(324)</td></tr></table>
<!--l. 3910--><p class="nopar" >
Using <span 
class="cmmi-10">Œ¥L </span>= <span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span>, the above expression can be further written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation383x.png" alt="Œ¥V   = ‚àí-q‚àá  ‚ü®Œ¥Œ¶ ‚àí v‚ãÖŒ¥A ‚ü© √ó e‚à•
   D    m   X           Œ±   Œ©
     = q-e‚à• √ó‚àáX  ‚ü®Œ¥Œ¶‚ü©Œ± ‚àí q-e‚à• √ó‚àáX ‚ü®v‚à•Œ¥A‚à•‚ü©Œ±
       m Œ©              m Œ©
       ‚àí-q e‚à•√ó ‚àáX ‚ü®v‚ä• ‚ãÖŒ¥A ‚ä•‚ü©Œ±.                           (325)
        m  Œ©
" class="math-display"  /><a 
 id="x1-65002r325"></a></center>
</div>Accurate to order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>), the term involving <span 
class="cmmi-10">Œ¥Œ¶ </span>is <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation384x.png" alt=" q e‚à•             e‚à•
m- Œ©-√ó ‚àáX ‚ü®Œ¥Œ¶‚ü©Œ± = B--√ó‚ü®‚àáX Œ¥Œ¶‚ü©Œ±
                  e0‚à•
               ‚âà  B--√ó‚ü®‚àáx Œ¥Œ¶‚ü©Œ±
                   0  ‚ü®           ‚ü©
               ‚âà  e‚à•-√ó  ‚àí Œ¥E ‚àí ‚àÇŒ¥A
                  B0           ‚àÇt   Œ±
               ‚âà  e‚à•-√ó‚ü®‚àí Œ¥E‚ü©Œ±
                  B0
               ‚â° Œ¥VE,                                 (326)
" class="math-display"  /><a 
 id="x1-65003r326"></a></center>
</div>which is the <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span><span 
class="cmsy-10">√ó</span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> drift. Accurate to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>), the <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> term on the right-hand side of Eq. (<a 
href="#x1-65002r325">325<!--tex4ht:ref: 18-9-14-p1 --></a>) is
written <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation385x.png" alt=" -q e‚à•                 q-v‚à•
‚àím  Œ© √ó ‚àáX ‚ü®v‚à•Œ¥A ‚à•‚ü©Œ± ‚âà ‚àí m Œ© ‚ü®e‚à• √ó ‚àáX (Œ¥A‚à•)‚ü©Œ±
                   ‚âà ‚àí q-v‚à•‚ü®e √ó ‚àá  (Œ¥A  )‚ü©                (327)
                       m Œ©   ‚à•    x   ‚à• Œ±
                   = v ‚ü®Œ¥B‚ä•-‚ü©Œ±-,                         (328)
                      ‚à•  B0
" class="math-display"  /><a 
 id="x1-65004r328"></a></center>
</div>which is called ‚Äúmagnetic Ô¨Çuttering‚Äù (this is actually not a real drift). In obtaining the last equality, use
has been made of Eq. (<a 
href="#x1-62005r313">313<!--tex4ht:ref: 16-10-11-p7 --></a>), i.e., <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">B</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmbx-7">x</span></sub><span 
class="cmmi-10">Œ¥A</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>.
<!--l. 3959--><p class="indent" >   Accurate to <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>), the last term on the right-hand side of expression (<a 
href="#x1-65002r325">325<!--tex4ht:ref: 18-9-14-p1 --></a>) is written
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation386x.png" alt="‚àí q-e‚à•√ó ‚àáX ‚ü®v‚ä• ‚ãÖŒ¥A‚ä• ‚ü©Œ± ‚âà ‚àí 1-‚ü®e‚à• √ó ‚àáX (v‚ä• ‚ãÖŒ¥A‚ä• )‚ü©Œ±
  m Œ©                     B0
                      ‚âà ‚àí 1-‚ü®e √ó ‚àá  (v  ‚ãÖŒ¥A  )‚ü©
                          B0  ‚à•    x  ‚ä•    ‚ä•  Œ±
                          1--
                      = ‚àí B0‚ü®e‚à• √ó (v‚ä• √ó ‚àáx √óŒ¥A ‚ä• + v‚ä• ‚ãÖ‚àáxŒ¥A ‚ä•)‚ü©Œ±
                          1--
                      = ‚àí B0‚ü®(e‚à• ‚ãÖ‚àáx √ó Œ¥A‚ä• )v ‚ä• + e‚à• √ó v ‚ä• ‚ãÖ‚àáx Œ¥A‚ä• ‚ü©Œ±
" class="math-display"  /></center>
</div>Using equation (<a 
href="#x1-64002r320">320<!--tex4ht:ref: 16-10-18-1 --></a>), i.e., <span 
class="cmmi-10">Œ¥B</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá√ó </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, the above expression is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation387x.png" alt="‚àí-q e‚à•√ó ‚àá  ‚ü®v  ‚ãÖŒ¥A ‚ü©  = ‚àí 1-‚ü®Œ¥B v  + e √ó v  ‚ãÖ‚àá Œ¥A  ‚ü©
 m  Œ©     X  ‚ä•    ‚ä• Œ±     B0   ‚à• ‚ä•    ‚à•   ‚ä•   x   ‚ä• Œ±
                          1--
                      ‚âà ‚àí B0‚ü®Œ¥B‚à•v‚ä• + e‚à• √ó v‚ä• ‚ãÖ‚àáX Œ¥A‚ä• ‚ü©Œ±
                          1             1
                      ‚âà ‚àí B0‚ü®Œ¥B‚à•v‚ä• ‚ü©Œ± ‚àí B0e‚à• √ó ‚ü®v ‚ä• ‚ãÖ‚àáX Œ¥A ‚ä•‚ü©Œ±.
                          1
                      ‚âà ‚àí B-‚ü®Œ¥B‚à•v‚ä• ‚ü©Œ±.                            (329)
                           0
" class="math-display"  /><a 
 id="x1-65006r329"></a></center>
</div>where use has been made of <span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> <span 
class="cmsy-10">‚âà </span>0 (**seems wrong**), where the error is of
<span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>)<span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><sub><span 
class="cmsy-7">‚ä•</span></sub>. The term <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥B</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><span 
class="cmmi-10">‚àïB</span><sub><span 
class="cmr-7">0</span></sub> is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) and thus can be neglected (I need to verify
this).
<!--l. 4001--><p class="indent" >   Using Eqs. (<a 
href="#x1-65003r326">326<!--tex4ht:ref: 17-5-7-1 --></a>), (<a 
href="#x1-65004r328">328<!--tex4ht:ref: 16-10-11-p10 --></a>), and (<a 
href="#x1-65006r329">329<!--tex4ht:ref: 16-10-18-p5 --></a>), expression (<a 
href="#x1-65002r325">325<!--tex4ht:ref: 18-9-14-p1 --></a>) is Ô¨Ånally written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-65007r330"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation388x.png" alt="        q           e    ‚ü®Œ¥E‚ü© √ó e      ‚ü®Œ¥B  ‚ü©
Œ¥VD  ‚â° ‚àí --‚àáX ‚ü®Œ¥L ‚ü©Œ± √ó -‚à• = ----Œ±---‚à•-+ v‚à•---‚ä•-Œ±.
        m           Œ©       B0           B0
" class="math-display"  /></center></td><td class="equation-label">(330)</td></tr></table>
                                                                                

                                                                                
<!--l. 4009--><p class="nopar" >
Using this, the Ô¨Årst equation of the characteristics, equation (<a 
href="#x1-59001r294">294<!--tex4ht:ref: 16-10-11-3 --></a>), is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation389x.png" alt="dX-
 dt = v‚à•e‚à• + VD + Œ¥VD                                  (331)
                 ‚ü®Œ¥E‚ü©Œ± √ó e‚à•    ‚ü®Œ¥B ‚ä•‚ü©Œ±
   =  v‚à•e‚à• + VD + ----B-----+ v‚à•--B----
                      0           0
   ‚â°  VG                                              (332)
" class="math-display"  /><a 
 id="x1-65008r331"></a></center>
</div>
<!--l. 4023--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">C.4   </span> <a 
 id="x1-66000C.4"></a>Expressing the coeÔ¨Écient before <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span>in terms of <span 
class="cmmi-10">Œ¥E </span>and <span 
class="cmmi-10">Œ¥B</span></h4>
<!--l. 4025--><p class="noindent" >[Note that
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-66001r333"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation390x.png" alt="‚àÇŒ¥A‚ä•
-‚àÇt--= ‚àí (Œ¥E ‚ä• + ‚àá‚ä•Œ¥Œ¶ ),
" class="math-display"  /></center></td><td class="equation-label">(333)</td></tr></table>
<!--l. 4029--><p class="nopar" >
where <span 
class="cmmi-10">‚àÇŒ¥</span><span 
class="cmbx-10">A</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>). This means that <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span><sub><span 
class="cmsy-7">‚ä•</span></sub> + <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">Œ¥œï </span>is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) although both <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span><sub><span 
class="cmsy-7">‚ä•</span></sub> and <span 
class="cmmi-10">Œ¥œï </span>are
of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span>).]
</p><!--l. 4035--><p class="indent" >   Note that </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation391x.png" alt="‚àÇ‚ü®v-‚ãÖŒ¥A‚ü©Œ± = v ‚àÇ‚ü®Œ¥A‚à•‚ü©Œ±+ v ‚ä• ‚ãÖ ‚àÇ-‚ü®Œ¥A-‚ü©Œ±
    ‚àÇt       ‚à•  ‚àÇt            ‚àÇt
              ‚àÇ‚ü®Œ¥A‚à•‚ü©Œ±
          = v‚à•  ‚àÇt   + ‚ü®v‚ä• ‚ãÖ(‚àí Œ¥E ‚àí ‚àáŒ¥Œ¶ )‚ü©Œ±
              ‚àÇ‚ü®Œ¥A‚à•‚ü©Œ±
          ‚âà v‚à•  ‚àÇt   ‚àí ‚ü®v‚ä• ‚ãÖŒ¥E‚ü©Œ±                        (334)
" class="math-display"  /><a 
 id="x1-66002r334"></a></center>
</div>where use has been made of <span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">Œ¥œï</span><span 
class="cmsy-10">‚ü©‚âà </span>0, This indicates that <span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> is of <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span>. Using Eq.
(<a 
href="#x1-66002r334">334<!--tex4ht:ref: 17-5-13-p1 --></a>), the coeÔ¨Écient before <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇùúÄ </span>in Eq. (<a 
href="#x1-31003r144">144<!--tex4ht:ref: 17-5-13-p2 --></a>) can be further written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation392x.png" alt="    [             (              e              )         ]
‚àí q- ‚àí ‚àÇ-‚ü®v-‚ãÖŒ¥A‚ü©Œ± ‚àí v‚à•e‚à• + VD ‚àí q--‚à•√ó ‚àáX ‚ü®v ‚ãÖŒ¥A ‚ü©Œ± ‚ãÖ‚àáX ‚ü®Œ¥Œ¶‚ü©Œ±
  m   [   ‚àÇt                   m Œ©                             ‚ü®           ‚ü©  ]
= ‚àí q- ‚àí v ‚àÇ‚ü®Œ¥A-‚à•‚ü©Œ± + ‚ü®v ‚ãÖŒ¥E ‚ü© ‚àí (v e + V ‚àí  q-e‚à•√ó ‚àá  ‚ü®v ‚ãÖŒ¥A ‚ü© )‚ãÖ  ‚àí Œ¥E ‚àí ‚àÇŒ¥A
    m    ‚à•   ‚àÇt       ‚ä•    Œ±     ‚à• ‚à•    D   m Œ©     X       Œ±           ‚àÇt   Œ±
    q [   ‚àÇ‚ü®Œ¥A ‚à•‚ü©Œ±              (            q e‚à•             )            ‚ü® ‚àÇA‚à• ‚ü© ]
‚âà ‚àí m- ‚àí v‚à•--‚àÇt-- + ‚ü®v‚ä• ‚ãÖŒ¥E ‚ü©Œ± ‚àí v‚à•e‚à• + VD ‚àí m-Œ©-√ó ‚àáX ‚ü®v ‚ãÖŒ¥A ‚ü©Œ± ‚ãÖ‚ü®‚àí Œ¥E‚ü©Œ± + v‚à• -‚àÇt-
    q [           (            q e              )      ]                         Œ±
= ‚àí -- ‚ü®v ‚ä• ‚ãÖŒ¥E ‚ü©Œ± + v‚à•e‚à• + VD ‚àí-- -‚à•√ó ‚àáX ‚ü®v‚ãÖŒ¥A ‚ü©Œ± ‚ãÖ‚ü®Œ¥E‚ü©Œ±
    m [           (           m  Œ©    )       ]
‚âà ‚àí q- ‚ü®v‚ä• ‚ãÖŒ¥E ‚ü©Œ± + v‚à•e‚à• + VD + v‚à•‚ü®Œ¥B-‚ä•‚ü©- ‚ãÖ‚ü®Œ¥E‚ü©Œ± .                               (335)
    m                             B0
" class="math-display"  /><a 
 id="x1-66003r335"></a></center>
</div>Using Eq. (<a 
href="#x1-66003r335">335<!--tex4ht:ref: 18-8-26-3 --></a>) and (), gyrokinetic equation (<a 
href="#x1-31003r144">144<!--tex4ht:ref: 17-5-13-p2 --></a>) is Ô¨Ånally written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation393x.png" alt="[    (                                 )     ]
 ‚àÇ- +  v e + V  + ‚ü®Œ¥E-‚ü©Œ±-√ó-e‚à•+ v ‚ü®Œ¥B‚ä•-‚ü©Œ±-  ‚ãÖ‚àá   Œ¥f
 ‚àÇt     ‚à• ‚à•    D      B0       ‚à•  B0       X
    (‚ü®Œ¥E‚ü©Œ± √ó e‚à•    ‚ü®Œ¥B‚ä• ‚ü©Œ± )
= ‚àí  ----B0----+ v‚à•--B0--- ‚ãÖ‚àáXF0
    [           (                    )       ]
‚àí q- ‚ü®v‚ä• ‚ãÖŒ¥E ‚ü©Œ± + v‚à•e‚à• + VD + v‚à•‚ü®Œ¥B-‚ä•‚ü©Œ±- ‚ãÖ‚ü®Œ¥E‚ü©Œ± ‚àÇF0-.         (336)
  m                              B0            ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-66004r336"></a></center>
</div>
<!--l. 4109--><p class="indent" >   ¬†
</p><!--l. 4111--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">D   </span> <a 
 id="x1-67000D"></a>Split-weight scheme for electrons in GEM code</h3>
<!--l. 4113--><p class="noindent" >The perturbed distribution function is decomposed as given by Eq. (<a 
href="#x1-36002r199">199<!--tex4ht:ref: 19-1-3-e2 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-67001r337"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation394x.png" alt="         q            ‚àÇF0   q         ‚àÇF0
Œ¥F = Œ¥h + m-(Œ¥Œ¶‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)-‚àÇùúÄ-+ m-‚ü®v‚ãÖŒ¥A ‚ü©Œ± ‚àÇùúÄ-,
" class="math-display"  /></center></td><td class="equation-label">(337)</td></tr></table>
<!--l. 4121--><p class="nopar" >
where the term in blue is the so-called adiabatic response, which depends on the gyro-angle in
guiding-center coordinates. Recall that the red term <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub>, which is independent of the gyro-angle, is
introduced in order to eliminate the time derivative <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>term on the right-hand side of the
original Frieman-Chen gyrokinetic equation.
</p><!--l. 4129--><p class="indent" >   The so-called generalized split-weight scheme corresponds to going back to the original
Frieman-Chen gyrokinetic equation by introducing another <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> term with a free small parameter <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub>.
SpeciÔ¨Åcally, <span 
class="cmmi-10">Œ¥h </span>in the above is split as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-67002r338"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation395x.png" alt="Œ¥h = Œ¥h + ùúñ q-‚ü®Œ¥Œ¶‚ü© ‚àÇF0.
       s   gm     Œ±‚àÇ ùúÄ
" class="math-display"  /></center></td><td class="equation-label">(338)</td></tr></table>
<!--l. 4136--><p class="nopar" >
(If <span 
class="cmmi-10">ùúÄ</span><sub><span 
class="cmmi-7">g</span></sub> = 1, then the two <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> terms in Eq. (<a 
href="#x1-67001r337">337<!--tex4ht:ref: 22-11-13-e2 --></a>) and (<a 
href="#x1-67002r338">338<!--tex4ht:ref: 22-11-13-e1 --></a>) cancel each other.) Substituting this
expression into Eq. (), we obtain the following equation for <span 
class="cmmi-10">Œ¥h</span><sub><span 
class="cmmi-7">s</span></sub>: </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation396x.png" alt="[-‚àÇ                        ]
 ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  Œ¥hs
    q ‚àÇF  [ ‚àÇ                       ]
+ ùúñg----0- --+ (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  ‚ü®Œ¥Œ¶ ‚ü©Œ±
    m ‚àÇùúÄ   ‚àÇ[t                        ]
+ ùúñg q-‚ü®Œ¥Œ¶‚ü©Œ± ‚àÇ-+ (v e + VD + Œ¥VD )‚ãÖ‚àáX   ‚àÇF0-
    m       ‚àÇt    ‚à• ‚à•                   ‚àÇùúÄ
= ‚àí Œ¥VD ‚ãÖ‚àáXF0
  q-                                    ‚àÇF0-
‚àí m [(v‚à•e‚à• + VD + Œ¥VD ) ‚ãÖ‚àáX (‚ü®v ‚ãÖŒ¥A ‚àí Œ¥Œ¶ ‚ü©Œ± )] ‚àÇùúÄ .            (339)
" class="math-display"  /><a 
 id="x1-67003r339"></a></center>
</div>Noting that <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we Ô¨Ånd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">3</span></sup>) and thus can be dropped. Moving the second line to the right-hand side, the
above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation397x.png" alt="[                          ]
  ‚àÇ-
  ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX Œ¥hs
= ‚àí Œ¥VD ‚ãÖ‚àáXF0
   q{                                          [‚àÇ ‚ü®Œ¥Œ¶‚ü©                ]} ‚àÇF
‚àí --  (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX [‚ü®v ‚ãÖŒ¥A‚ü©Œ± ‚àí ‚ü®Œ¥Œ¶ ‚ü©Œ±]+ ùúñg -----Œ± + VG ‚ãÖ‚àáX ‚ü®Œ¥Œ¶‚ü©Œ±   -(03.40)
  m                                               ‚àÇt                     ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-67004r340"></a></center>
</div>
                                                                                

                                                                                
   <h5 class="subsubsectionHead"><a 
 id="x1-68000D"></a>special case of <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub> = 1</h5>
<!--l. 4181--><p class="noindent" >For the special case of <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub> = 1 (the default and most used case in <span 
class="cmtt-10">GEM</span> code, Yang Chen said <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub> <span 
class="cmmi-10">&#x003C; </span>1 cases
are sometimes not accurate, so he gave up using it since 2009), equation (<a 
href="#x1-67004r340">340<!--tex4ht:ref: 19-1-10-7 --></a>) can be simpliÔ¨Åed as:
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation398x.png" alt="[ ‚àÇ                        ]
 -- + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  Œ¥hs
 ‚àÇt
= ‚àí Œ¥V[D ‚ãÖ‚àáXF0                ]
‚àí q- VG ‚ãÖ‚àáX ‚ü®v ‚ãÖŒ¥A ‚ü©Œ± + ‚àÇ-‚ü®Œ¥Œ¶-‚ü©Œ± ‚àÇF0-,                 (341)
  m                     ‚àÇt     ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-68001r341"></a></center>
</div>where two <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub> <span 
class="cmsy-10">‚ãÖ‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> terms cancel each other. Because the <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">E</span><sub><span 
class="cmsy-7">‚à•</span></sub> term is one of the factors that make
kinetic electron simulations diÔ¨Écult, eliminating <span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">G</span></sub> <span 
class="cmsy-10">‚ãÖ‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> term may be beneÔ¨Åcial for obtaining stable
algorithms.
<!--l. 4201--><p class="indent" >   For <span 
class="cmmi-10">ùúñ</span><sub><span 
class="cmmi-7">g</span></sub> = 1, <span 
class="cmmi-10">Œ¥F </span>is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation399x.png" alt="Œ¥F = Œ¥hs + ùúÄg q-‚ü®Œ¥Œ¶ ‚ü©Œ± ‚àÇFg0+-q(Œ¥Œ¶ ‚àí ‚ü®Œ¥Œ¶ ‚ü©Œ±)‚àÇF0-+-q‚ü®v ‚ãÖŒ¥A ‚ü©Œ±‚àÇF0-
            m       ‚àÇùúÄ   m             ‚àÇùúÄ   m          ‚àÇùúÄ
   = Œ¥hs + q-Œ¥Œ¶‚àÇFg0 + q-‚ü®v‚ãÖŒ¥A ‚ü©Œ±‚àÇF0,                            (342)
          m    ‚àÇùúÄ    m          ‚àÇùúÄ
" class="math-display"  /></center>
</div>where the adiabatic term will be moved to the left-hand side of the Poisson‚Äôs equation. The
descretization of this term is much easier than the polarization density. This term is already in
<span 
class="cmtt-10">GEM</span>.
<!--l. 4217--><p class="indent" >   Equation (<a 
href="#x1-68001r341">341<!--tex4ht:ref: 19-1-10-7m2 --></a>) actually goes back to the original Frieman-Chen equation. The only diÔ¨Äerence is
that <img 
src="nonlinear_gyrokinetic_equation400x.png" alt="q-
m"  class="frac" align="middle" /><span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><img 
src="nonlinear_gyrokinetic_equation401x.png" alt="‚àÇF0
‚àÇùúÄ"  class="frac" align="middle" /> is further split from the perturbed distribution function. Considering this, equation
(<a 
href="#x1-68001r341">341<!--tex4ht:ref: 19-1-10-7m2 --></a>) can also be obtained from the original Frieman-Chen equation (<a 
href="#x1-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) by writing <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">0</span></sub>
as
</p>
                                                                                

                                                                                
   <table 
class="equation"><tr><td><a 
 id="x1-68003r343"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation402x.png" alt="           -q        ‚àÇF0-
Œ¥G0 = Œ¥hs + m ‚ü®v ‚ãÖŒ¥A ‚ü©Œ± ‚àÇùúÄ ,
" class="math-display"  /></center></td><td class="equation-label">(343)</td></tr></table>
<!--l. 4227--><p class="nopar" >
In this case, <span 
class="cmmi-10">Œ¥F </span>is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-68004r344"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation403x.png" alt="           q   ‚àÇFg0   q        ‚àÇF0
Œ¥F = Œ¥hs + m-Œ¥Œ¶-‚àÇùúÄ-+ m-‚ü®v ‚ãÖŒ¥A‚ü©Œ±-‚àÇùúÄ-,
" class="math-display"  /></center></td><td class="equation-label">(344)</td></tr></table>
<!--l. 4233--><p class="nopar" >
Substituting expression (<a 
href="#x1-68003r343">343<!--tex4ht:ref: 19-1-11-1 --></a>) into equation (<a 
href="#x1-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>), we obtain the following equation for <span 
class="cmmi-10">Œ¥h</span><sub><span 
class="cmmi-7">s</span></sub>:
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation404x.png" alt="[                          ]
  ‚àÇ-+ (v e + V  + Œ¥V  )‚ãÖ‚àá    Œ¥h
  ‚àÇt    ‚à• ‚à•   D      D    X    s
  -q‚àÇF0-[-‚àÇ                        ]
+ m  ‚àÇùúÄ  ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  ‚ü®v ‚ãÖŒ¥A ‚ü©Œ±
   q        [ ‚àÇ                        ] ‚àÇF
+ --‚ü®v‚ãÖŒ¥A ‚ü©Œ± -- + (v‚à•e‚à• +VD  + Œ¥VD )‚ãÖ‚àáX  ---0
  m          ‚àÇt                          ‚àÇùúÄ
= ‚àí Œ¥VD ‚ãÖ‚àáXF0 ‚àí q-‚àÇ‚ü®Œ¥Œ¶-‚àí-v‚ãÖŒ¥A-‚ü©Œ±-‚àÇF0,                     (345)
                m       ‚àÇt       ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-68005r345"></a></center>
</div>Noting that <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>= 0, <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> = 0, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">‚àº </span><span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">1</span></sup>)<span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>, we Ô¨Ånd that the third line of the above
equation is of order <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">3</span></sup>) and thus can be dropped. Moving the second line to the right-hand side, the
above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation405x.png" alt="[ ‚àÇ                        ]
 -- + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àáX  Œ¥hs
 ‚àÇt
= ‚àí Œ¥V[D ‚ãÖ‚àáXF0                             ]
‚àí q- ‚àÇ‚ü®Œ¥Œ¶‚ü©Œ± + (v e + VD  + Œ¥VD )‚ãÖ‚àáX ‚ü®v‚ãÖŒ¥A ‚ü©Œ±  ‚àÇF0,           (346)
  m    ‚àÇt      ‚à• ‚à•                           ‚àÇùúÄ
" class="math-display"  /><a 
 id="x1-68006r346"></a></center>
</div>which agrees with Eq. (<a 
href="#x1-68001r341">341<!--tex4ht:ref: 19-1-10-7m2 --></a>).
<!--l. 4271--><p class="indent" >   In GEM, the split weight method is used only for electrons, and <span 
class="cmmi-10">‚àÇ</span><span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥Œ¶</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub><span 
class="cmmi-10">‚àï‚àÇt </span>is approximated by
<span 
class="cmmi-10">‚àÇŒ¥Œ¶‚àï‚àÇt</span>, which is obtained from the vorticity equation (rather than from time-diÔ¨Äerence
scheme).
</p><!--l. 4276--><p class="indent" >   When using the split weight scheme, a <span 
class="cmmi-10">‚àÇŒ¥œï‚àï‚àÇt </span>terms appear in the right-hand-side of the weight
evolution equation. GEM makes use of the vorticity equation (time derivative of the Poissson equation)
to evaluate <span 
class="cmmi-10">‚àÇŒ¥œï‚àï‚àÇt</span>.
</p><!--l. 4281--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">E   </span> <a 
 id="x1-69000E"></a>Coordinate system and grid in <span 
class="cmtt-10">TEK</span> code</h3>
<!--l. 4283--><p class="noindent" >In (<span 
class="cmmi-10">œà,ùúÉ,œï</span>) coordinates: </p>
   <ul class="itemize1">
   <li class="itemize"><span 
class="cmmi-10">œà </span>is the normalized poloidal magnetic Ô¨Çux, <span 
class="cmmi-10">œà </span>= (<span 
class="cmmi-10">Œ® </span><span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">Œ®</span><sub><span 
class="cmr-7">axis</span></sub>)<span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">Œ®</span><sub><span 
class="cmr-7">lcfs</span></sub> <span 
class="cmsy-10">‚àí </span><span 
class="cmmi-10">Œ®</span><sub><span 
class="cmr-7">axis</span></sub>).
   </li>
   <li class="itemize"><span 
class="cmmi-10">ùúÉ </span><span 
class="cmsy-10">‚àà </span>[<span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ,œÄ</span>) is increasing along the anti-clockwise direction when viewed along <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">œï </span>direction
   with <span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ </span>at the high-Ô¨Åeld-side midplane.
                                                                                

                                                                                
   </li>
   <li class="itemize"><span 
class="cmmi-10">œï </span>is the toroidal angle of the right-handed cylindrical coordinates (<span 
class="cmmi-10">R,œï,Z</span>).</li></ul>
<!--l. 4295--><p class="noindent" >In this convention, the Jacobian of the (<span 
class="cmmi-10">œà,ùúÉ,œï</span>) coordinate system, <span 
class="cmsy-10">ùí• </span>= (<span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">œà </span><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">ùúÉ </span><span 
class="cmsy-10">√ó‚àá</span><span 
class="cmmi-10">œï</span>) is negative,
i.e., (<span 
class="cmmi-10">œà,ùúÉ,œï</span>) is a left-handed system. The Ô¨Åeld-line-following coordinate system (<span 
class="cmmi-10">œà,ùúÉ,Œ±</span>) is
also a left-handed system. The coordinate system (<span 
class="cmmi-10">x </span>= <span 
class="cmmi-10">œà,y </span>= <span 
class="cmmi-10">Œ±,z </span>= <span 
class="cmmi-10">ùúÉ</span>) is a right-handed
system.
</p><!--l. 4302--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">E.1   </span> <a 
 id="x1-70000E.1"></a>Poloidal grid</h4>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x1-700013"></a>
                                                                                

                                                                                
<!--l. 4305--><p class="noindent" > <img 
src="/home/yj/theory/figures/my_grids_and_gem_grids/poloidal_grids/a-1-.png" alt="PIC"  
 />
<br /> </p><div class="caption" 
><span class="id">Fig. 3: </span><span  
class="content">Poloidal grid for equilibrium quantities used in <span 
class="cmtt-10">TEK</span> and <span 
class="cmtt-10">GEM</span> code. The array starts at
<span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ </span>and ends at <span 
class="cmmi-10">ùúÉ </span>= +<span 
class="cmmi-10">œÄ </span>(<span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">¬±</span><span 
class="cmmi-10">œÄ </span>is chosen to be at the high-Ô¨Åeld side midplane in both the
codes). <span 
class="cmtt-10">TEK</span> array index starts from 1 whereas GEM array index starts from 0. Hence <span 
class="cmtt-10">mpol=nth+1</span>.
<span 
class="cmtt-10">nth</span> is denoted by <span 
class="cmtt-10">ntheta</span> in GEM. In TEK, <span 
class="cmtt-10">mpol</span> must be an odd number, so that the array has
a midpoint, whose index is given by <span 
class="cmtt-10">(mpol+1)/2</span>, which corresponds to <span 
class="cmmi-10">ùúÉ </span>= 0.</span></div><!--tex4ht:label?: x1-700013 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 4317--><p class="indent" >   I do not need to make connection with GEM‚Äôs equilibrium poloidal array because there is no
coupling of equilibrium quantities between the code written by me and the original code in
GEM. The coupling happens for the perturbed quanties, whose poloidal grids need to be
consistent.
</p>
   <ul class="itemize1">
   <li class="itemize">The gridpoint number along <span 
class="cmmi-10">ùúÉ </span>for perturbations is denoted by <span 
class="cmtt-10">mpol2</span>. Its value is not chosen
   by users. Instead, it is equal to <span 
class="cmtt-10">numproc/ntube</span>, i.e., <span 
class="cmtt-10">mpol2</span> is the total number of cells
   along <span 
class="cmmi-10">ùúÉ </span>for MPI parallelation. (<span 
class="cmtt-10">numproc</span> and <span 
class="cmtt-10">ntube</span> must be chosen in a way that makes
   ¬†<span 
class="cmtt-10">numproc/ntube</span> an integer.)
   </li>
   <li class="itemize">Poloidal grid-points for perturbations are indexed as <span 
class="cmtt-10">0:mpol2-1</span>, with <span 
class="cmtt-10">0</span> corresponding to
   <span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ </span>and <span 
class="cmtt-10">mpol2</span> corresponding to <span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmmi-10">œÄ</span>. Field equations are solved at 0 : mpol2 <span 
class="cmsy-10">‚àí </span>1. (The
   Ô¨Åeld at <span 
class="cmtt-10">mpol2</span>, i.e., <span 
class="cmmi-10">ùúÉ </span>= +<span 
class="cmmi-10">œÄ</span>, is not identical to that at <span 
class="cmmi-10">ùúÉ </span>= <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ </span>due to toroidal shift of a
   magnetic Ô¨Åeld line when it Ô¨Ånish one poloidal loop, and is obtained by toroidally inerpolating
   the Ô¨Åelds at <span 
class="cmmi-10">ùúÉ </span>=  <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">œÄ</span>.) No array for this is actually used in the code. The indexes just
   correspond to <span 
class="cmtt-10">gclr</span> of MPI processors.
   </li>
   <li class="itemize">The equilibrium poloidal gridpoint number, <span 
class="cmtt-10">mpol</span>, must be chosen in a way that makes
   <span 
class="cmtt-10">(mpol-1)/mpol2</span> an integer, which can be larger than 1, i.e., one simulation cell can span
   several equilibrium cells.</li></ul>
   <h4 class="subsectionHead"><span class="titlemark">E.2   </span> <a 
 id="x1-71000E.2"></a>Toroidal grid</h4>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x1-710014"></a>
                                                                                

                                                                                
<!--l. 4351--><p class="noindent" > <img 
src="my_figure/home/yj/theory/figures/my_grids_and_gem_grids/toroidal_grids/a-1.png" alt="pict"  
 width="247.92624pt" />
<br />  </p><div class="caption" 
><span class="id">Fig. 4:   </span><span  
class="content">Toroidal   grid   used   in   <span 
class="cmtt-10">TEK</span>  and   GEM.   In   TEK,   the   toroidal   array   is
<span 
class="cmtt-10">tor</span><span 
class="cmtt-10">_1d</span><span 
class="cmtt-10">_array(1:mtor+1)</span>. Source terms, <span 
class="cmmi-10">Œ¥n </span>and <span 
class="cmmi-10">Œ¥j</span><sub><span 
class="cmsy-7">‚à•</span></sub>, and EM Ô¨Åelds are deÔ¨Åned at <span 
class="cmtt-10">1:mtor</span>. GEM
array index starts from 0 and ends at <span 
class="cmtt-10">jm</span>. It follows that <span 
class="cmtt-10">mtor=jm</span>.</span></div><!--tex4ht:label?: x1-710014 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 4359--><p class="indent" >   ¬†
</p>
   <h4 class="subsectionHead"><span class="titlemark">E.3   </span> <a 
 id="x1-72000E.3"></a>Radial grid</h4>
<!--l. 4363--><p class="noindent" >¬†
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x1-720015"></a>
                                                                                

                                                                                
<!--l. 4366--><p class="noindent" > <img 
src="my_figure/home/yj/theory/figures/my_grids_and_gem_grids/radial_grids/a-1.png" alt="pict"  
 width="366.36874pt" />
<br /> </p><div class="caption" 
><span class="id">Fig. 5: </span><span  
class="content">Radial grid used in <span 
class="cmtt-10">TEK</span>. Two radial arrays are used in the code, <span 
class="cmtt-10">radcor</span><span 
class="cmtt-10">_1d</span><span 
class="cmtt-10">_array(1:nt)</span>
and <span 
class="cmtt-10">radcor</span><span 
class="cmtt-10">_1d</span><span 
class="cmtt-10">_array2(1:n)</span>, equilibrium is deÔ¨Åned on the former grid, and perturbations are
deÔ¨Åned on the latter grid. Here nt = <span 
class="cmmi-10">n </span>+ 2<span 
class="cmmi-10">m</span>, <span 
class="cmmi-10">m </span>is the number of grid points in one of the two
buÔ¨Äer regions (regions in blue color). In the code <span 
class="cmmi-10">n </span>is denoted by <span 
class="cmtt-10">nflux2</span> and nt is denoted by
<span 
class="cmtt-10">nflux</span>, <span 
class="cmmi-10">m </span>is denoted by <span 
class="cmtt-10">points</span><span 
class="cmtt-10">_in</span><span 
class="cmtt-10">_buffer</span>. In <span 
class="cmtt-10">GEM</span> the radial array does no include the buÔ¨Äer
regions and the index starts at <span 
class="cmtt-10">0</span> and ends at <span 
class="cmtt-10">imx</span>. Hence <span 
class="cmtt-10">n=imx+1</span>.</span></div><!--tex4ht:label?: x1-720015 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 4379--><p class="indent" >   GEM array index system is better than TEK‚Äôs because my system is not consistent: sometimes I
use 0-based index and sometimes I use 1-based index, sometimes the index ends at n and
sometimes ends at n+1. It is important to know accurately the transformation between the two
systems.
</p><!--l. 4384--><p class="indent" >   ¬†
</p>
   <h3 class="sectionHead"><span class="titlemark">F   </span> <a 
 id="x1-73000F"></a>Implementation of gyrokinetics in particle-in-cell (PIC) codes</h3>
<!--l. 4389--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">F.1   </span> <a 
 id="x1-74000F.1"></a>Monte-Carlo evaluation of distribution function moment at grid-points</h4>
<!--l. 4391--><p class="noindent" >Suppose that the 6D guiding-center phase-space (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) is described by (<span 
class="cmmi-10">œà,ùúÉ,œï,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>)
coordinates, where <span 
class="cmmi-10">Œ± </span>is the gyro-angle. Denote the Jacobian of the coordinate system by
<span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">rv</span></sub>.
</p><!--l. 4396--><p class="indent" >   Suppose that we sample the 6D phase-space by using a probability function <span 
class="cmmi-10">P</span>(<span 
class="cmmi-10">œà,ùúÉ,œï,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>).
(Then the eÔ¨Äecitive probability function used in rejection method is <span 
class="cmmi-10">P</span><span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">r</span></sub><span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">v</span></sub>.) Note that we will
sample a distribution function <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>) that happens to be independent of the
gyro-angle <span 
class="cmmi-10">Œ±</span>. Since <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub> is uniform in <span 
class="cmmi-10">Œ±</span>, it is natural to smaple <span 
class="cmmi-10">Œ± </span>using a uniform probability
function, i.e., <span 
class="cmmi-10">P</span>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) can be chosen to be independent of <span 
class="cmmi-10">Œ±</span>. Then the weight is also
independent of <span 
class="cmmi-10">Œ±</span>. In terms of sampling <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub>, there is no need to specify <span 
class="cmmi-10">Œ± </span>because both <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub> and
marker distribution <span 
class="cmmi-10">g </span>= <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">P </span>are indepedent of <span 
class="cmmi-10">Œ±</span>. However, sampling <span 
class="cmmi-10">Œ± </span>is still necessary in
simulations. From the perspective of programming, it is ready to understand why <span 
class="cmmi-10">Œ± </span>needs to be
speciÔ¨Åed: when computing density at grid-points, we need to compute particle locations
from the guiding-center locations which requires us to specify the gyro-angle <span 
class="cmmi-10">Œ± </span>for each
marker. SpeciÔ¨Åcally, markers in guiding-center space (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) with Ô¨Åxed (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) but
diÔ¨Äerent values of <span 
class="cmmi-10">Œ± </span>correspond to markers in particle space with diÔ¨Äerent locations (and
diÔ¨Äerent <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤</span>). In the PIC method of computing <span 
class="cmmi-10">Œ¥n </span>or <span 
class="cmmi-10">Œ¥j</span><sub><span 
class="cmsy-7">‚à•</span></sub> at Ô¨Åxed <span 
class="cmbx-10">x</span>, the contribution of each
particle marker to the density is aÔ¨Äected by the distance of the particle marker to the Ô¨Åxed <span 
class="cmbx-10">x</span>.
Therefore diÔ¨Äerent values of <span 
class="cmmi-10">Œ± </span>contributes diÔ¨Äerently to <span 
class="cmmi-10">Œ¥n </span>or <span 
class="cmmi-10">Œ¥j</span><sub><span 
class="cmsy-7">‚à•</span></sub>, and thus the resolution of <span 
class="cmmi-10">Œ±</span>
matters.
</p><!--l. 4422--><p class="indent" >   For a marker with coordinators (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>), the corresponding particle position can be calculated
by using the inverse guiding-center transformation (<a 
href="#x1-6003r29">29<!--tex4ht:ref: 19-1-19-p2 --></a>). Then we can deposit the marker weight to
grid-points in the same way that we do in conventional PIC simulations. Looping over all markers, we
build the particle density at grids.
</p><!--l. 4429--><p class="indent" >   Compared with conventional PIC methods, where particle positions are directly sampled, what is
the beneÔ¨Åt of sampling guiding-center positions and then transform them back to the particle
positions? More computations are involved since we need to numerically perform the inverse
guiding-center transformation. The answer lies in the important fact that the distribution function
<span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>) that needs to be numerically evaluated in gyrokinetic simulation is actually
independent of the gyro-angle <span 
class="cmmi-10">Œ±</span>. Furthermore, we use a probability density function <span 
class="cmmi-10">P</span>
that is independent of <span 
class="cmmi-10">Œ± </span>to sample the 6D phase space (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>). Then the marker
weight <span 
class="cmmi-10">w </span><span 
class="cmsy-10">‚â° </span><span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">P</span>) is independent of <span 
class="cmmi-10">Œ±</span>, where <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">p</span></sub> is number of markers loaded. This fact
enable resolution in particle coordinates can be increased in a trivial way, as described
below.
                                                                                

                                                                                
</p><!--l. 4443--><p class="indent" >   Suppose we have a concrete sampling of <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub> in the 6D phase-space (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>), i.e.,
(<span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,w</span><sub><span 
class="cmmi-7">j</span></sub>) with <span 
class="cmmi-10">j </span>= 1<span 
class="cmmi-10">,</span><span 
class="cmmi-10">‚Ä¶</span><span 
class="cmmi-10">,N</span><sub><span 
class="cmmi-7">p</span></sub>, then we can do the inverse guiding-center transform and then
deposit particles to the grids to obtain a moment (e.g. density).
</p><!--l. 4449--><p class="indent" >   Since <span 
class="cmmi-10">P</span><span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">rv</span></sub> is independent of <span 
class="cmmi-10">Œ±</span>, the sampling <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub> with <span 
class="cmmi-10">j </span>= 0<span 
class="cmmi-10">,</span>1<span 
class="cmmi-10">,</span><span 
class="cmmi-10">‚Ä¶</span><span 
class="cmmi-10">,N</span><sub><span 
class="cmmi-7">p</span></sub> are uniform distributed
random numbers. Therefore we can generate another sampling of <span 
class="cmmi-10">Œ± </span>(denoted by <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤ </span>with <span 
class="cmmi-10">j </span>= 1<span 
class="cmmi-10">,</span><span 
class="cmmi-10">‚Ä¶</span><span 
class="cmmi-10">,N</span><sub><span 
class="cmmi-7">p</span></sub>)
using random number generators and combine <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤ </span>with the old sampling (<span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">j</span></sub>) to obtain a new
sampling (<span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,w</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤</span>). ¬†The values of <span 
class="cmmi-10">w </span>at the new sampling points are equal to the original
values, i.e., <span 
class="cmmi-10">w</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmsy-10">‚Ä≤ </span>= <span 
class="cmmi-10">w</span><sub><span 
class="cmmi-7">j</span></sub> since the particle weight <span 
class="cmmi-10">w </span>= <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">P</span>) is independent of <span 
class="cmmi-10">Œ±</span>. ¬†Using the new
sampling and following the same procedures given above, we can estimate values of the moment at
grid-points again, which will diÔ¨Äer from the estimation obtained using the old sampling
because the resulting sampling of <span 
class="cmbx-10">x </span>and <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤ </span>for <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">p</span></sub> is diÔ¨Äerent. Taking the average of the two
estimations will give a more accurate estimation because the resolution in <span 
class="cmbxti-10">x </span>and <span 
class="cmmi-10">Œ±</span><span 
class="cmsy-10">‚Ä≤ </span>for <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">p</span></sub> is
increased.
</p><!--l. 4465--><p class="indent" >   [Note that even if <span 
class="cmmi-10">P</span><span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">rv</span></sub> is dependent on <span 
class="cmmi-10">Œ± </span>due to the possible dependence of <span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">rv</span></sub> on <span 
class="cmmi-10">Œ±</span>, we still can
easily generate a new set of sampling which diÔ¨Äers from the old sampling only in <span 
class="cmmi-10">Œ±</span>. SpeciÔ¨Åcally, in the
rejection method, we use the old sampling (<span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">j</span></sub>) for each reject step and only adjust <span 
class="cmmi-10">Œ± </span>to
satisfy the acceptance criteria.]
</p><!--l. 4472--><p class="indent" >   We can also construct a new sampling by replacing <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub> with <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub> + <span 
class="cmmi-10">Œî</span>, where <span 
class="cmmi-10">Œî </span>is a constant. Then
the new set of sampling (<span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,Œ±</span><sub><span 
class="cmmi-7">j</span></sub> + <span 
class="cmmi-10">Œî,w</span><sub><span 
class="cmmi-7">j</span></sub>) with <span 
class="cmmi-10">j </span>= 1<span 
class="cmmi-10">,</span><span 
class="cmmi-10">‚Ä¶</span><span 
class="cmmi-10">,N</span><sub><span 
class="cmmi-7">p</span></sub> is still a consistent set of
sampling.
</p><!--l. 4477--><p class="indent" >   In doing the deposition, each marker has a single gyro-angle. Due to the independence of the weight
(<span 
class="cmmi-10">w </span>= <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">‚àï</span>(<span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">P</span>)) of the gyro-angle, the particle phase space resolution can be increased in a way that
there can be several gyro-angles for a single (<span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">j</span></sub>). This gives the wrong impression that the
gyro-angle of a guiding-center marker is arbitrary. The correct understanding is that given
above, i.e., we do several (say 4) separate sampling of the phase space and then average the
results.
</p><!--l. 4486--><p class="indent" >   In the code, the gyro-angle is deÔ¨Åned relative to the direction <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">œà‚àï</span><span 
class="cmsy-10">|‚àá</span><span 
class="cmmi-10">œà</span><span 
class="cmsy-10">| </span>at the guiding-center
position. SpeciÔ¨Åcally, the gyro-angle is deÔ¨Åned as the included angle between <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">œà‚àï</span><span 
class="cmsy-10">|‚àá</span><span 
class="cmmi-10">œà</span><span 
class="cmsy-10">| </span>and
<span 
class="cmsy-10">‚àí</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">x</span>)<span 
class="cmmi-10">‚àïŒ©</span>(<span 
class="cmbx-10">x</span>), where <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">x</span>)<span 
class="cmmi-10">‚àïŒ©</span>(<span 
class="cmbx-10">x</span>) is approximated by the value at the guiding-center
location.
</p><!--l. 4493--><p class="indent" >   ¬†
</p><!--l. 4495--><p class="indent" >   Then (<span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmmi-7">j</span></sub>) can be evolved by using the guiding-center motion equation. (It is
obvious how to evalute the gyro-averaging of the electromagnetic Ô¨Åelds needed in pusing
markers.)
</p><!--l. 4500--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">F.2   </span> <a 
 id="x1-75000F.2"></a>Monte-Carlo sampling of 6D guiding-center phase-space </h4>
<!--l. 4502--><p class="noindent" >Suppose that the 6D guiding-center phase-space (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) is described by (<span 
class="cmmi-10">œà,ùúÉ,œï,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span>) coordinates.
The Jacobian of the coordinate system is given by <span 
class="cmsy-10">ùí• </span>= <span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">r</span></sub><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>, where <span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">r</span></sub> = <span 
class="cmsy-10">ùí• </span>(<span 
class="cmmi-10">œà,ùúÉ</span>) is the Jacobian of
the coordinates (<span 
class="cmmi-10">œà,ùúÉ,œï</span>). Suppose that we sample the 6D phase-space by using the following probability
density function:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-75001r347"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation406x.png" alt="                                 [            ]
                   1 ( m  )3‚àï2      m(v2‚à• + v2‚ä• )
P(œà,ùúÉ,œï,v‚à•,v‚ä•, Œ±) = Vr 2œÄT-    exp ‚àí ---2T----- ,
" class="math-display"  /></center></td><td class="equation-label">(347)</td></tr></table>
<!--l. 4513--><p class="nopar" >
where <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">r</span></sub> is the volume of the spatial simulation box, <span 
class="cmmi-10">T </span>is a constant temperature. <span 
class="cmmi-10">P </span>given above is
independent of <span 
class="cmmi-10">œà,ùúÉ,œï </span>and <span 
class="cmmi-10">Œ±</span>. It is ready to verify that the above <span 
class="cmmi-10">P </span>satisÔ¨Åes the following normalization
condition:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-75002r348"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation407x.png" alt="‚à´  ‚à´           ‚à´  ‚à´ +‚àû ‚à´ ‚àû‚à´ 2œÄ
      PdvdX =                  Pv‚ä•dŒ±dv‚ä•dv ‚à•ùí•rd œàdùúÉdœï = 1.
 Vr             Vr  ‚àí‚àû   0   0
" class="math-display"  /></center></td><td class="equation-label">(348)</td></tr></table>
<!--l. 4522--><p class="nopar" >
I use the rejection method to numerically generate <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">p</span></sub> markers that satisfy the above probability
density function. [The eÔ¨Äective probability density function actually used in the rejection method is <span 
class="cmmi-10">P</span><span 
class="cmsy-10">‚Ä≤</span>,
which is related to <span 
class="cmmi-10">P </span>by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-75003r349"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation408x.png" alt="P‚Ä≤ = |ùí•rùí•v|P = |ùí•r (œà,ùúÉ)|v‚ä•P
" class="math-display"  /></center></td><td class="equation-label">(349)</td></tr></table>
<!--l. 4530--><p class="nopar" >
Note that <span 
class="cmmi-10">P</span><span 
class="cmsy-10">‚Ä≤ </span>does not depend on the gyro-angle <span 
class="cmmi-10">Œ±</span>.]
</p><!--l. 4533--><p class="indent" >   Then the weight of a marker sampling <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-75004r350"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation409x.png" alt="w = Œ¥fg(œà,ùúÉ,œï,v‚à•,v‚ä•).
         NpP
" class="math-display"  /></center></td><td class="equation-label">(350)</td></tr></table>
<!--l. 4537--><p class="nopar" >
Since both <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub> and <span 
class="cmmi-10">P </span>are independent of the gyro-angle <span 
class="cmmi-10">Œ±</span>, <span 
class="cmmi-10">w </span>is also independent of <span 
class="cmmi-10">Œ±</span>.
</p><!--l. 4541--><p class="indent" >   The numerical representation of <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub> is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-75005r351"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation410x.png" alt="  Àú   --1--N‚àëp
Œ¥fg = ùí•rv‚ä•    wjŒ¥(œà‚àí œàj)Œ¥(ùúÉ‚àí ùúÉj)Œ¥(œï ‚àí œïj)Œ¥(v‚à• ‚àí v‚à•j)Œ¥(v‚ä• ‚àí v‚ä•j)Œ¥(Œ± ‚àí Œ±j).
            j
" class="math-display"  /></center></td><td class="equation-label">(351)</td></tr></table>
<!--l. 4547--><p class="nopar" >
Although the distribution function <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub> to be sampled is independent of the gyro-angle <span 
class="cmmi-10">Œ±</span>,
we still need to specify the gyro-angle because we need to use the inverse guiding-center
transformation, which needs the gyro-angle. Each marker needs to have a speciÔ¨Åc gyro-angle value <span 
class="cmmi-10">Œ±</span><sub><span 
class="cmmi-7">j</span></sub>
so that we know how to transform its <span 
class="cmbx-10">X</span><sub><span 
class="cmmi-7">j</span></sub> to <span 
class="cmbx-10">x</span><sub><span 
class="cmmi-7">j</span></sub> and then do the charge deposition in <span 
class="cmbx-10">x</span>
space.
</p><!--l. 4555--><p class="indent" >   To increase the resolution over the gyro-angle (the quantity of intest to us, e.g., density, is the
integration of the particle distribution function at Ô¨Åxed spatial location, and the distribution at the
Ô¨Åxed location is not uniform in the gyro-angle. So the resolution over <span 
class="cmmi-10">Œ± </span>matters), we need to load more
markers. However, thanks to the fact that both sampling probability density function <span 
class="cmmi-10">P </span>and
<span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub> are independent of <span 
class="cmmi-10">Œ±</span>, the resolution over the gyro-angle can be increased in a simple
way.
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-75006r352"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation411x.png" alt="       n1(x-)+-n2(x-)+-n3(x-)+-n4(x-)
n(x) =             4             .
" class="math-display"  /></center></td><td class="equation-label">(352)</td></tr></table>
<!--l. 4565--><p class="nopar" >
This corresponds to sampling the 6D phase-space 4 separate times (each time with identical
sampling points in (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>) but diÔ¨Äerent sampling points in <span 
class="cmmi-10">Œ±</span>) and then using the averaging
of the 4 Monte-Carlo integrals to estimate the exact value. This estimation can also be
(roughly) considered as a Monte-Carlo estimation using 4 times larger number of markers
as that is originally used (the Monte-Carlo estimation using truly 4 time larger number
of markers is more accurate than the result we obtained above because the former also
increase the resolution of (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>) while the latter keeps the resolution of (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub>)
unchanged.)
</p><!--l. 4577--><p class="indent" >   In numerical implementation, we choose <span 
class="cmmi-10">N </span>sampling points that are evenly distributed on the
gyro-ring (<span 
class="cmmi-10">N </span>is usually 4 as a compromise between eÔ¨Éciency and accuracy). And the weight is evenly
split by the <span 
class="cmmi-10">N </span>sub-markers on the gyro-ring. Therefore each sub-marker have a Monte-Carlo weight
<span 
class="cmmi-10">w</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">‚àïN</span>, where <span 
class="cmmi-10">w</span><sub><span 
class="cmmi-7">j</span></sub> is the weight of the <span 
class="cmmi-10">j</span> th marker. Then calculating the integration (<a 
href="#x1-77003r358">358<!--tex4ht:ref: 19-1-19-p1 --></a>) at a grid
corresponds to depositing all the <span 
class="cmmi-10">N </span>sub-markers associated with each guiding-center marker to the grid,
as is illustrated in Fig. <a 
href="#x1-750076">6<!--tex4ht:ref: 19-1-19-p4 --></a>. However, interpreting in this way is confusing to me because: why can you
split a single sampling into <span 
class="cmmi-10">N </span>diÔ¨Äerent samplings? I prefer the above interpretation that the 6D
phase space is sampled 4 separate times and thus we get 4 estimations and Ô¨Ånally we take
the averaging of these 4 estimations. It took a long time for me to Ô¨Ånally Ô¨Ånd this way of
understanding.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x1-750076"></a>
                                                                                

                                                                                
<!--l. 4592--><p class="noindent" > <img 
src="my_figure/home/yj/theory/figures/grids_cells/grids-3.png" alt="pict"  
 width="182.6825pt" />
<br /> </p><div class="caption" 
><span class="id">Fig. 6:  </span><span  
class="content">The  spatial  grid  in  the  plane  perpendicular  to  the  equilibrium  magnetic  Ô¨Åeld,  a
guiding-center marker <span 
class="cmmi-10">C</span>, and its gyro-ring with 4 sampling points (sub-markers) on it. The 4
sub-markers are calculated by using the transformation (<a 
href="#x1-6003r29">29<!--tex4ht:ref: 19-1-19-p2 --></a>) (inverse guiding-center transform).
Assume that Monte-Carlo weight of the guiding-center marker <span 
class="cmmi-10">C</span> is <span 
class="cmmi-10">w</span><sub><span 
class="cmmi-7">j</span></sub>. Then The Monte-Carlo
weight of each sub-marker is <span 
class="cmmi-10">w</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">‚àï</span>4. The value of integration (<a 
href="#x1-77003r358">358<!--tex4ht:ref: 19-1-19-p1 --></a>) at a grid point is approximated
by  <span 
class="cmmi-10">I‚àïŒîV </span>,  where  <span 
class="cmmi-10">I  </span>is  the  Monte-Carlo  integration  of  all  sub-markers  (associated  with  all
guiding-center markers) in the cell, <span 
class="cmmi-10">ŒîV </span>is the cell volume. The cell associated with a grid-point
(e.g., <span 
class="cmmi-10">A</span>) is indicated by the dashed rectangle (this is for the 2D projection, the cell is 3D and
it is a cube). If the Dirac delta function is used as the shape function of the sub-markers,
then calculating the contribution of a sub-marker to a grid corresponds to the nearest-point
interpolation (for example, the 4 sub-markers will contribute nothing to grid point <span 
class="cmmi-10">B </span>since no-sub
marker is located within the cell). In practice, the Ô¨Çat-top shape function with its support equal
to the cell size is often used, then the depositing corresponds to linearly interpolating the weight
of each sub-marker to the nearby grids.</span></div><!--tex4ht:label?: x1-750076 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 4615--><p class="indent" >   ¬†
</p><!--l. 4617--><p class="indent" >   In summary, the phase-space to be sampled in gyrokinetic simulations are still 6D rather than
5D. In this sense, the statement that gyrokinetic simulation works in a 5D phase space is
misleading. We are still working in the 6D phase-space. The only subtle thing is that the sixth
dimension, i.e., gyro-angle, can be sampled in an easy way that is independent of the other 5
variables.
</p><!--l. 4624--><p class="indent" >   In numerical implementation, the gyro-angle may not be explicitly used. We just try to Ô¨Ånd 4
arbitrary points on the gyro-ring that are easy to calculate. Some codes (e.g. ORB5) introduces a
random variable to rotate these 4 points for diÔ¨Äerent markers so that the gyro-angle can be sampled
less biased.
</p><!--l. 4630--><p class="indent" >   From the view of particle simulations, the gyrokinetic model can be considered as a noise reduction
method, where the averaging over the gyro-angle is equivalent to a time averaging over a gyro-period,
which reduces the Ô¨Çuctuation level (in both time and space) associated with evaluating the
Monte-Carlo phase integration. Here the averaging in gyrokinetic particle simulation refers to taking
several points on a gyro-ring when depositing markers to spatial grids to obtain the density and current
on the grids. (Another gyro-averaging appears in evaluating the guiding-center drift.) In gyrokinetic
particle simulation, even a step size smaller than a gyro-period is taken, the quantities used
in the model is still the ones averaged over one gyro-period. In this sense, a gyrokinetic
simulation is only meaningful when the time step size is larger than one gyro-period. [**Some
authors may disagree with that the gyro-averaging is a time-averaging. They may consider the
gyro-averaging as the phase-space integration over the gyro-angle coordinate. This view
seems to be right in Euler simulations but seems to be wrong in particle simulations. The
reason is as follows. For each marker, choose a random gyro-phase and then do the inverse
transformation to obtain particle position, and sum over all markers (this corresponds to phase-space
Monte-Carlo integration, which include the gyro-angle integration, so no further gyro-angle
integration is needed); choose another random gyro-phase and repeat the above procedure
(this can be interpreted as do the phase-space Monte-Carlo integration at another time),
choose further random gyro-phase for each marker and repeat. Finally averaging all the
above values to obtain the Ô¨Ånal estimation of the phase-space integration. This amounts to
a time-averaging over a gyro-motion. In summary, sampling several times with diÔ¨Äerent
gyro-phases for each marker and taking the average amounts to the time averaging over
gyro-motion**]
</p><!--l. 4658--><p class="indent" >   When doing the time-average over the ion cyclotron motion, the time variation of the low-frequency
mode is negligible and only the spatial variation of the modes is important. For the gyro-motion, only
the gyro-angle is changing and all the other variables, (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>), ¬†are approximately constant. As a
result, this time averaging Ô¨Ånally reduces to a gyro-averaging.
</p><!--l. 4665--><p class="indent" >   ¬†
</p><!--l. 4667--><p class="indent" >   I prefer to reason in terms of particle position and velocity, and consider the guiding-center location
as an image of the particle position. When working in the guiding-center coordinates, I prefer to reason
by transforming back to the particle position. This reasoning is clear and help me avoid some
confusions I used to have.
</p><!--l. 4673--><p class="indent" >   ¬†
</p><!--l. 4675--><p class="indent" >   In coding, the initial sampling of the phase space is performed for particles ((<span 
class="cmbx-10">v</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">x</span>) of particles) and
then is transformed to guiding-center coordinates.
</p><!--l. 4679--><p class="indent" >   ¬†
</p><!--l. 4681--><p class="indent" >   ¬†
                                                                                

                                                                                
</p>
   <h4 class="subsectionHead"><span class="titlemark">F.3   </span> <a 
 id="x1-76000F.3"></a>Distribution function transform**check</h4>
<!--l. 4685--><p class="noindent" >In the above, we assume that <span 
class="cmbx-10">X </span>and <span 
class="cmbx-10">x </span>are related to each other by the guiding-center transformation
(<a 
href="#x1-6001r27">27<!--tex4ht:ref: 16-9-21-1 --></a>) or (<a 
href="#x1-6003r29">29<!--tex4ht:ref: 19-1-19-p2 --></a>) , i.e., <span 
class="cmbx-10">x </span>and <span 
class="cmbx-10">X </span>are not independent. For some cases, it may be convenient to treat <span 
class="cmbx-10">x </span>and <span 
class="cmbx-10">X</span>
as independent variables and express the guiding-center transformation via an integral of the Dirac
delta function. For example,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-76001r353"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation412x.png" alt="         ‚à´
fp(x,v) =  fg(X,v)Œ¥3(X ‚àí x+ œÅ)dX,
" class="math-display"  /></center></td><td class="equation-label">(353)</td></tr></table>
<!--l. 4694--><p class="nopar" >
where <span 
class="cmbx-10">x </span>and <span 
class="cmbx-10">X </span>are considered as independent variables, <span 
class="cmmib-10">œÅ</span> is the gyroradius evaluated at <span 
class="cmbx-10">x</span>,
<span 
class="cmmi-10">Œ¥</span><sup><span 
class="cmr-7">3</span></sup>(<span 
class="cmbx-10">x </span><span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">X </span><span 
class="cmsy-10">‚àí</span> <span 
class="cmmib-10">œÅ</span>) is the three-dimensional Dirac delta function. [In terms of general coordinates
(<span 
class="cmmi-10">x</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,x</span><sub><span 
class="cmr-7">2</span></sub><span 
class="cmmi-10">,x</span><sub><span 
class="cmr-7">3</span></sub>), the three-dimensional Dirac delta function is deÔ¨Åned via the 1D Dirac delta function as
follows:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-76002r354"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation413x.png" alt=" 3      1
Œ¥ (x) = |ùí•-|Œ¥(x1)Œ¥(x2)Œ¥(x3),
" class="math-display"  /></center></td><td class="equation-label">(354)</td></tr></table>
<!--l. 4704--><p class="nopar" >
where <span 
class="cmsy-10">ùí• </span>is the the Jacobian of the general coordinate system. The Jacobian is included in order to
make <span 
class="cmmi-10">Œ¥</span><sup><span 
class="cmr-7">3</span></sup>(<span 
class="cmbx-10">x</span>) satisfy the normalization condition <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">Œ¥</span><sup><span 
class="cmr-7">3</span></sup>(<span 
class="cmbx-10">x</span>)<span 
class="cmmi-10">d</span><span 
class="cmbx-10">x </span>= <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">Œ¥</span><sup><span 
class="cmr-7">3</span></sup>(<span 
class="cmbx-10">x</span>)<span 
class="cmsy-10">|ùí•|</span><span 
class="cmmi-10">dx</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">dx</span><sub><span 
class="cmr-7">2</span></sub><span 
class="cmmi-10">dx</span><sub><span 
class="cmr-7">3</span></sub> = 1.]
</p><!--l. 4710--><p class="indent" >   Expression (<a 
href="#x1-76001r353">353<!--tex4ht:ref: 19-1-20-e1 --></a>) can be considered as a transformation that transforms an arbitrary function from
the guiding-center coordinates to the particle coordinates. Similarly,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-76003r355"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation414x.png" alt="          ‚à´
fg(X,v) =   fp(x,v)Œ¥3(x ‚àí X ‚àí œÅ )dx,
" class="math-display"  /></center></td><td class="equation-label">(355)</td></tr></table>
<!--l. 4716--><p class="nopar" >
is a transformation that transforms an arbitrary function from the the particle coordinates to the
guiding-center coordinates.
</p><!--l. 4721--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">F.4   </span> <a 
 id="x1-77000F.4"></a>Moments of distribution function expressed as integration over guiding-center
variables</h4>
<!--l. 4723--><p class="noindent" >In terms of particle variables (<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), it is straightforward to calculate the moment of the distribution
function. For example, the number density <span 
class="cmmi-10">n</span>(<span 
class="cmbx-10">x</span>) is given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-77001r356"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation415x.png" alt="      ‚à´
n(x) =  fp(x,v)dv.
" class="math-display"  /></center></td><td class="equation-label">(356)</td></tr></table>
<!--l. 4729--><p class="nopar" >
However, it is a little diÔ¨Écult to calculate <span 
class="cmmi-10">n</span>(<span 
class="cmbx-10">x</span>) at real space location <span 
class="cmbx-10">x </span>by using the guiding-center
variables (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>). This is because holding <span 
class="cmbx-10">x </span>constant and changing <span 
class="cmbx-10">v</span>, which is required by the
integration in Eq. (<a 
href="#x1-77001r356">356<!--tex4ht:ref: 18-12-26-p1 --></a>), means the guiding-center variable <span 
class="cmbx-10">X </span>is changing according to Eq. (<a 
href="#x1-6001r27">27<!--tex4ht:ref: 16-9-21-1 --></a>). Using
Eq. (<a 
href="#x1-9001r34">34<!--tex4ht:ref: 17-8-19-p1 --></a>), expression (<a 
href="#x1-77001r356">356<!--tex4ht:ref: 18-12-26-p1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-77002r357"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="nonlinear_gyrokinetic_equation416x.png" alt="      ‚à´
n(x) =   f (X (x,v),v )dv,
          g
" class="math-display"  /></center></td><td class="equation-label">(357)</td></tr></table>
<!--l. 4740--><p class="nopar" >
As is mentioned above, the <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>integration in Eq. (<a 
href="#x1-77002r357">357<!--tex4ht:ref: 18-12-26-p2 --></a>) should be performed by holding <span 
class="cmbx-10">x </span>constant and
changing <span 
class="cmbx-10">v</span>, which means the guiding-center variable <span 
class="cmbx-10">X </span>= <span 
class="cmbx-10">X</span>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) is changing. This means that, in
(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) space, the above integration is a (generalized) curve integral along the the curve
¬†<span 
class="cmbx-10">X</span>(<span 
class="cmbx-10">v</span>) = <span 
class="cmbx-10">x </span><span 
class="cmsy-10">‚àí</span><span 
class="cmmib-10">œÅ</span>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) with <span 
class="cmbx-10">x </span>being constant. Treating <span 
class="cmbx-10">X </span>and <span 
class="cmbx-10">x </span>as independent variables and using the
Dirac delta function <span 
class="cmmi-10">Œ¥</span>, this curve integral can be written as the following double integration over the
independent variables <span 
class="cmbx-10">X </span>and <span 
class="cmbx-10">v</span>:
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-77003r358"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation417x.png" alt="      ‚à´  ‚à´         3
n(x) =     fg(X, v)Œ¥ (X ‚àí x + œÅ)dvdX.
" class="math-display"  /></center></td><td class="equation-label">(358)</td></tr></table>
<!--l. 4755--><p class="nopar" >
Another perspective of interpreting Eq. (<a 
href="#x1-77003r358">358<!--tex4ht:ref: 19-1-19-p1 --></a>) is that we are Ô¨Årst using the transformation (<a 
href="#x1-76001r353">353<!--tex4ht:ref: 19-1-20-e1 --></a>) to
transform <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub> to <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">p</span></sub> and then integrating <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">p</span></sub> in the velocity space.
</p><!--l. 4760--><p class="indent" >   ¬†
</p><!--l. 4762--><p class="indent" >   ¬†
</p><!--l. 4764--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">G   </span> <a 
 id="x1-78000G"></a>Diamagnetic Ô¨Çow **check**</h3>
<!--l. 4766--><p class="noindent" >The perturbed distribution function <span 
class="cmmi-10">Œ¥F </span>given in Eq. () contains two terms. The Ô¨Årst term is gyro-phase
dependent while the second term is gyro-phase independent. The perpendicular velocity moment of the
second term will give rise to the so-called diamagnetic Ô¨Çow. For this case, it is crucial to distinguish
between the distribution function in terms of the guiding-center variables, <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), and that in terms
of the particle variables, <span 
class="cmmi-10">f</span><sub><span 
class="cmmi-7">p</span></sub>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>). In terms of these denotations, ¬†equation () is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-78001r359"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation418x.png" alt="Œ¥Fg = -q(Œ¥Œ¶‚àí ‚ü®Œ¥Œ¶‚ü©Œ±)‚àÇF0g + Œ¥fg.
      m             ‚àÇùúÄ
" class="math-display"  /></center></td><td class="equation-label">(359)</td></tr></table>
<!--l. 4778--><p class="nopar" >
Next, consider the perpendicular Ô¨Çow <span 
class="cmbx-10">U</span><sub><span 
class="cmsy-7">‚ä•</span></sub> carried by <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub>. This Ô¨Çow is deÔ¨Åned by the corresponding
distribution function in terms of the particle variables, <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">p</span></sub>, via,
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-78002r360"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation419x.png" alt="       ‚à´

nU ‚ä• =   v‚ä•Œ¥fp(x,v)dv,
" class="math-display"  /></center></td><td class="equation-label">(360)</td></tr></table>
<!--l. 4785--><p class="nopar" >
where <span 
class="cmmi-10">n </span>is the number density deÔ¨Åned by <span 
class="cmmi-10">n </span>= <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">p</span></sub><span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span>. Using the relation between the particle
distribution function and guiding-center distribution function, equation (<a 
href="#x1-78002r360">360<!--tex4ht:ref: 17-8-19-p4 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-78003r361"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation420x.png" alt="       ‚à´
nU ‚ä• =   v‚ä•Œ¥fg(x ‚àí œÅ,v )dv.
" class="math-display"  /></center></td><td class="equation-label">(361)</td></tr></table>
<!--l. 4793--><p class="nopar" >
Using the Taylor expansion near <span 
class="cmbx-10">x</span>, <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">x </span><span 
class="cmsy-10">‚àí</span><span 
class="cmmib-10">œÅ</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) can be approximated as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-78004r362"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation421x.png" alt="Œ¥fg(x ‚àí œÅ,v) ‚âà Œ¥fg(x,v)‚àí œÅ ‚ãÖ‚àáŒ¥fg(x,v).
" class="math-display"  /></center></td><td class="equation-label">(362)</td></tr></table>
<!--l. 4800--><p class="nopar" >
Plugging this expression into Eq. (<a 
href="#x1-78003r361">361<!--tex4ht:ref: 17-8-19-1 --></a>), we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-78005r363"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation422x.png" alt="      ‚à´                ‚à´
nU ‚ä• ‚âà   v‚ä•Œ¥fg(x,v)dv‚àí   v‚ä• œÅ‚ãÖ‚àá Œ¥fg(x,v)dv
" class="math-display"  /></center></td><td class="equation-label">(363)</td></tr></table>
<!--l. 4806--><p class="nopar" >
As mentioned above, <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) is independent of the gyro-angle <span 
class="cmmi-10">Œ±</span>. It is obvious that the Ô¨Årst
integration is zero and thus Eq. (<a 
href="#x1-78005r363">363<!--tex4ht:ref: 17-8-19-3 --></a>) is reduced to
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-78006r364"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation423x.png" alt="         ‚à´
nU ‚ä• = ‚àí   v‚ä•œÅ ‚ãÖ‚àáŒ¥fg(x,v)dv
" class="math-display"  /></center></td><td class="equation-label">(364)</td></tr></table>
<!--l. 4813--><p class="nopar" >
Using the deÔ¨Ånition <span 
class="cmmib-10">œÅ</span> = <span 
class="cmsy-10">‚àí</span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïŒ©</span>, the above equation is written </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation424x.png" alt="      ‚à´    v √ó e‚à•
nU‚ä• =   v ‚ä•--Œ©---‚ãÖ‚àá Œ¥fg(x,v)dv
      ‚à´    ( e            )
    =   v ‚ä•  -‚à•√ó ‚àá Œ¥fg(x,v)  ‚ãÖv‚ä•dv.
      ‚à´      Œ©
    =   v ‚ä•H ‚ãÖv‚ä•dv,                                 (365)
" class="math-display"  /><a 
 id="x1-78007r365"></a></center>
</div>where <span 
class="cmbx-10">H </span>= <img 
src="nonlinear_gyrokinetic_equation425x.png" alt="e
Œ©‚à•"  class="frac" align="middle" /> <span 
class="cmsy-10">√ó‚àá</span><span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>), which is independent of the gyro-angle <span 
class="cmmi-10">Œ± </span>because both <span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub>(<span 
class="cmbx-10">x</span>)<span 
class="cmmi-10">‚àïŒ©</span>(<span 
class="cmbx-10">x</span>) and
<span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) are independent of <span 
class="cmmi-10">Œ±</span>. Next, we try to perform the integration over <span 
class="cmmi-10">Œ± </span>in Eq. (<a 
href="#x1-78007r365">365<!--tex4ht:ref: 17-8-19-p6 --></a>). In terms of
velocity space cylindrical coordinates (<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">,Œ±</span>), <span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub> is written as
   <table 
class="equation"><tr><td><a 
 id="x1-78008r366"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation426x.png" alt="v ‚ä• = v‚ä• (ÀÜx cosŒ±+ ÀÜy sinŒ± ),
" class="math-display"  /></center></td><td class="equation-label">(366)</td></tr></table>
<!--l. 4836--><p class="nopar" >
where <img 
src="nonlinear_gyrokinetic_equation427x.png" alt="ÀÜx"  class="circ"  /> and <img 
src="nonlinear_gyrokinetic_equation428x.png" alt="ÀÜy"  class="circ"  /> are two arbitrary unit vectors perpendicular each other and both perpendicular to
<span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">x</span>). <span 
class="cmbx-10">H </span>can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-78009r367"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation429x.png" alt="H  = HxÀÜx + HyÀÜy,
" class="math-display"  /></center></td><td class="equation-label">(367)</td></tr></table>
<!--l. 4842--><p class="nopar" >
where <span 
class="cmmi-10">H</span><sub><span 
class="cmmi-7">x</span></sub> and <span 
class="cmmi-10">H</span><sub><span 
class="cmmi-7">y</span></sub> are independent of <span 
class="cmmi-10">Œ±</span>. Using these in Eq. (<a 
href="#x1-78007r365">365<!--tex4ht:ref: 17-8-19-p6 --></a>), we obtain </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation430x.png" alt="       ‚à´
nU ‚ä• =   v‚ä•(ÀÜx cosŒ± + ÀÜysinŒ±)v‚ä•(Hx cosŒ±+ Hy sin Œ±)dv
       ‚à´
     =   v2‚ä•[ÀÜx(Hx cos2Œ± + Hy sinŒ± cosŒ±)+ ÀÜy(Hx cosŒ±sinŒ± +Hy sin2Œ±)]dv.   (368)
" class="math-display"  /></center>
</div>Using <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">dŒ±</span>, the above equation is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation431x.png" alt="      ‚à´ ‚àû     ‚à´ ‚àû      ‚à´ 2œÄ
nU ‚ä• =     dv‚à•    v‚ä•dv ‚ä•    v2‚ä• [ÀÜx(Hx cos2 Œ±+ Hy sin Œ±cosŒ±)+ ÀÜy(Hx cosŒ±sinŒ± + Hysin2Œ±)]dŒ±
      ‚à´‚àí ‚àû    ‚à´0       ‚à´0
        ‚àû       ‚àû        2œÄ 2        2          2
    =  ‚àí ‚àû dv‚à• 0  v‚ä•dv ‚ä• 0  v‚ä• (ÀÜxHx cos Œ± + ÀÜyHy sin Œ±)dŒ±
      ‚à´ ‚àû     ‚à´ ‚àû
    =      dv‚à•    v‚ä•dv ‚ä•[v2‚ä• (xÀÜHx œÄ + ÀÜyHyœÄ)]
      ‚à´‚àí‚àû‚àû    ‚à´0‚àû
    =      dv‚à•    v‚ä•dv ‚ä•[v2‚ä•H œÄ ]
      ‚à´‚àí ‚àû    ‚à´0
        ‚àû       ‚àû       2 e‚à•
    =  ‚àí ‚àû dv‚à• 0  v‚ä•dv ‚ä•[v‚ä• Œ© √ó ‚àá Œ¥fg(x,v )œÄ ]
       e‚à•    ‚à´ ‚àû    ‚à´ ‚àû              v2
    =  --√ó ‚àá     dv‚à•    v‚ä•dv‚ä• Œ¥fg(x,v)-‚ä•-2œÄ
       Œ©e      ‚àí‚àû     0                2
    =  -‚à•--√ó‚àá Œ¥p‚ä•,                                                            (369)
       mŒ©
" class="math-display"  /><a 
 id="x1-78011r369"></a></center>
</div>where <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation432x.png" alt="     ‚à´ ‚àû     ‚à´ ‚àû
Œ¥p  ‚â°     dv     v  dv Œ¥f (x,v)mv2‚ä• 2œÄ
 ‚ä•    ‚àí ‚àû  ‚à•  0  ‚ä•   ‚ä•  g      2
     ‚à´         mv2‚ä•
   =   Œ¥fg(x,v)--2-dv,                               (370)
" class="math-display"  /></center>
</div>is the perpendicular pressure carried by <span 
class="cmmi-10">Œ¥f</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>). The Ô¨Çow given by Eq. (<a 
href="#x1-78011r369">369<!--tex4ht:ref: 17-8-19-p9 --></a>) is called the diamagnetic
Ô¨Çow.
<!--l. 4890--><p class="indent" >   ¬†
</p><!--l. 4892--><p class="indent" >   ¬†
</p><!--l. 4895--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">H   </span> <a 
 id="x1-79000H"></a>Transform gyrokinetic equation from (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,ùúÄ,Œ±</span>) to (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span>) coordinates</h3>
<!--l. 4897--><p class="noindent" >The gyrokinetic equation given above is written in terms of variables (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,ùúÄ,Œ±</span>). Next, we transform it
into coordinates (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,Œº</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span><span 
class="cmsy-10">‚Ä≤</span>) which are deÔ¨Åned by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-79001r371"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation433x.png" alt="(   ‚Ä≤
||{ X‚Ä≤(X,Œº,ùúÄ,Œ±) = X
  Œº‚Ä≤(X, Œº,ùúÄ,Œ±) = Œº
||( Œ± (X, Œº,ùúÄ,Œ±) = Œ± ‚àò-------------
  v‚à•(X, Œº,ùúÄ,Œ±) = ¬±  2(ùúÄ ‚àí ŒºB0 (X))
" class="math-display"  /></center></td><td class="equation-label">(371)</td></tr></table>
<!--l. 4908--><p class="nopar" >
Use this deÔ¨Ånition and the chain rule, we obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation434x.png" alt="   |
-‚àÇ-||    = ‚àÇX-‚Ä≤‚ãÖ-‚àÇ--+ ‚àÇŒº-‚Ä≤‚àÇ--+ ‚àÇv‚à• ‚àÇ--+ ‚àÇŒ±-‚Ä≤‚àÇ--
‚àÇX |Œº,ùúÄ,Œ±   ‚àÇX   ‚àÇX ‚Ä≤  ‚àÇX  ‚àÇŒº‚Ä≤  ‚àÇX  ‚àÇv‚à•  ‚àÇX  ‚àÇŒ±‚Ä≤
           ‚àÇ    Œº ‚àÇB0  ‚àÇ
        = ‚àÇX-‚Ä≤ ‚àí v-‚àÇX-‚àÇv-,                                (372)
                 ‚à•      ‚à•
" class="math-display"  /><a 
 id="x1-79002r372"></a></center>
</div>and <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation435x.png" alt="‚àÇ ||       ‚àÇX‚Ä≤  ‚àÇ    ‚àÇŒº‚Ä≤ ‚àÇ   ‚àÇv‚à•  ‚àÇ   ‚àÇ Œ±‚Ä≤ ‚àÇ
‚àÇùúÄ||    =  ‚àÇùúÄ-‚àÇX-‚Ä≤ + ‚àÇùúÄ-‚àÇŒº‚Ä≤ +-‚àÇùúÄ ‚àÇv-+ -‚àÇùúÄ ‚àÇŒ±‚Ä≤
   X,Œº,Œ±                           ‚à•
       =  1--‚àÇ-.                                         (373)
          v‚à•‚àÇv‚à•
" class="math-display"  /></center>
</div>Then, in terms of (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,Œº</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span><span 
class="cmsy-10">‚Ä≤</span>), equation (<a 
href="#x1-29001r136">136<!--tex4ht:ref: 16-10-16-2 --></a>) is written <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation436x.png" alt="[                           ]
  ‚àÇ-+ (ve  + VD + Œ¥VD )‚ãÖ-‚àÇ-- Œ¥G0 ‚àí (ve  + VD + Œ¥VD )‚ãÖ-Œº‚àÇB0-‚àÇŒ¥G0-
  ‚àÇt    ‚à•‚à•              ‚àÇX ‚Ä≤        ‚à• ‚à•              v‚à• ‚àÇX  ‚àÇv‚à•
         ( ‚àÇF0   Œº ‚àÇB0 ‚àÇF0)    q ‚àÇ‚ü®Œ¥L ‚ü©Œ± ‚àÇF0 1
= ‚àí Œ¥VD ‚ãÖ  ‚àÇX-‚Ä≤ ‚àí v-‚àÇX-‚àÇv-- ‚àí m- --‚àÇt--‚àÇv--v-,                     (374)
                  ‚à•      ‚à•               ‚à• ‚à•
" class="math-display"  /><a 
 id="x1-79004r374"></a></center>
</div>Dropping terms of order higher than <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>), equation (<a 
href="#x1-79004r374">374<!--tex4ht:ref: 18-12-17-3 --></a>) is written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation437x.png" alt="[                          ]
 ‚àÇ- + (v e + V   + Œ¥V  )‚ãÖ-‚àÇ-- Œ¥G ‚àí e  ‚ãÖŒº‚àÇB0-‚àÇŒ¥G0-
 ‚àÇt    ‚à• ‚à•    D     D   ‚àÇX ‚Ä≤   0   ‚à•   ‚àÇX   ‚àÇv‚à•
         (‚àÇF0 )   (       ‚àÇB0   q ‚àÇ‚ü®Œ¥L‚ü©Œ±) ‚àÇF0 1
= ‚àí Œ¥VD ‚ãÖ ‚àÇX-‚Ä≤  +  Œ¥VD ‚ãÖŒº ‚àÇX--‚àí m---‚àÇt--  ‚àÇv--v-,          (375)
                                            ‚à•  ‚à•
" class="math-display"  /></center>
</div>The above equation drops all terms higher than <span 
class="cmmi-10">O</span>(<span 
class="cmmi-10">Œª</span><sup><span 
class="cmr-7">2</span></sup>) and as a result the coeÔ¨Écient before <span 
class="cmmi-10">‚àÇŒ¥f‚àï‚àÇv</span><sub><span 
class="cmsy-7">‚à•</span></sub>
contains only the mirror force, i.e., <span 
class="cmsy-10">‚àí</span><span 
class="cmbx-10">e</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œº</span><span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>, which is independent of any perturbations.
<!--l. 4968--><p class="indent" >   Note that the gyro-averaging operator in (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,Œº</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span><span 
class="cmsy-10">‚Ä≤</span>) coordinates is identical to that
in the old coordinates since the perpendicular velocity variable <span 
class="cmmi-10">Œº </span>is identical between the
two coordinate systems. Also note that the perturbed guiding-center velocity <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is given
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-79006r376"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation438x.png" alt="Œ¥V   = e‚à•-√ó‚àáX-‚ü®Œ¥œï‚ü©Œ± + v ‚ü®Œ¥B-‚ä•‚ü©Œ±,
   D        B0         ‚à•  B0
" class="math-display"  /></center></td><td class="equation-label">(376)</td></tr></table>
<!--l. 4977--><p class="nopar" >
where <span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">X </span>(rather than <span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤</span>) is used. Since <span 
class="cmmi-10">Œ¥œï</span>(<span 
class="cmbx-10">x</span>) = <span 
class="cmmi-10">Œ¥œï</span><sub><span 
class="cmmi-7">g</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,Œ±</span><span 
class="cmsy-10">‚Ä≤</span>), which is independent of <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>,
then Eq. (<a 
href="#x1-79002r372">372<!--tex4ht:ref: 19-1-2-e1 --></a>) indicates that <span 
class="cmmi-10">‚àÇŒ¥œï‚àï‚àÇ</span><span 
class="cmbx-10">X </span>= <span 
class="cmmi-10">‚àÇŒ¥œï‚àï‚àÇ</span><span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤</span>.
</p><!--l. 4984--><p class="indent" >   Following the same procedures, equation (<a 
href="#x1-31003r144">144<!--tex4ht:ref: 17-5-13-p2 --></a>) in terms of (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,Œº</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,Œ±</span><span 
class="cmsy-10">‚Ä≤</span>) is written as
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation439x.png" alt="[                           ]
  ‚àÇ-+ (ve  + V  + Œ¥V  )‚ãÖ-‚àÇ-- Œ¥f ‚àí e ‚ãÖŒº‚àáB  ‚àÇŒ¥f-
  ‚àÇt    ‚à•‚à•    D      D  ‚àÇX ‚Ä≤       ‚à•     0‚àÇv‚à•
         ( ‚àÇF0)              ‚àÇF0 1
= ‚àí Œ¥VD ‚ãÖ  ‚àÇX-‚Ä≤ + Œ¥VD ‚ãÖŒº ‚àáB0 ‚àÇv-v-
    [             (            ‚à• ‚à•      )         ]
‚àí q- ‚àí ‚àÇ‚ü®v‚ãÖŒ¥A-‚ü©Œ±‚àí   v‚à•e‚à• + VD + v‚à•‚ü®Œ¥B‚ä•-‚ü©Œ±  ‚ãÖ‚àáX ‚ü®Œ¥œï‚ü©Œ±  ‚àÇF0-1.      (377)
  m        ‚àÇt                      B0               ‚àÇv‚à•v‚à•
" class="math-display"  /><a 
 id="x1-79007r377"></a></center>
</div>next, try to recover the equation in Mishchenk‚Äôs paper: <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation440x.png" alt="[ ‚àÇ                      ‚àÇ  ]             ‚àÇŒ¥f
 ‚àÇt + (v‚à•e‚à• + VD + Œ¥VD )‚ãÖ‚àÇX-‚Ä≤ Œ¥f ‚àí e‚à• ‚ãÖŒº‚àáB0 ‚àÇv‚à•
         (    )
= ‚àí Œ¥VD  ‚ãÖ -‚àÇF0  + Œ¥VD ‚ãÖŒº‚àáB0 ‚àÇF0-1-
    [     ‚àÇX ‚Ä≤  (           ‚àÇv ‚à•v‚à•)          ]
  q-   ‚àÇ‚ü®Œ¥A-‚à•‚ü©Œ±-        VD--  ‚ü®Œ¥B-‚ä•‚ü©Œ±-           ‚àÇF0-
‚àí m  ‚àí   ‚àÇt   ‚àí   e‚à• + v‚à• +   B0    ‚ãÖ‚àáX ‚ü®Œ¥œï‚ü©Œ± ‚àÇv ‚à•.
" class="math-display"  /></center>
</div><span 
class="cmmi-10">Œ¥L </span>= <span 
class="cmmi-10">Œ¥Œ¶ </span><span 
class="cmsy-10">‚àí </span><span 
class="cmbx-10">v </span><span 
class="cmsy-10">‚ãÖ </span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">A</span>,
   <table 
class="equation"><tr><td><a 
 id="x1-79009r378"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation441x.png" alt="Œ¥V        q                  e‚à•
---D = ‚àí----‚àáX ‚ü®Œ¥Œ¶‚àí v‚à•A ‚à•‚ü©Œ± √ó --.
 v‚à•     mv ‚à•                 Œ©
" class="math-display"  /></center></td><td class="equation-label">(378)</td></tr></table>
<!--l. 5028--><p class="nopar" >
</p>
   <table 
class="equation-star"><tr><td>
                                                                                

                                                                                
           <span 
class="cmsy-10">‚àí</span><img 
src="nonlinear_gyrokinetic_equation442x.png" alt="q
m-"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation443x.png" alt="[  ‚àÇ‚ü®Œ¥A ‚à•‚ü©Œ±   (     VD    q           e‚à•)          ]
 ‚àí --‚àÇt---‚àí   e‚à• +-v--+ m-‚àáX ‚ü®A ‚à•‚ü©Œ± √ó Œ©-  ‚ãÖ‚àáX ‚ü®Œ¥œï‚ü©Œ±
                   ‚à•"  class="left" align="middle" /><img 
src="nonlinear_gyrokinetic_equation444x.png" alt=" ‚àÇF0
‚àÇv--
  ‚à•"  class="frac" align="middle" /><span 
class="cmmi-10">.</span>
</td></tr></table>
<!--l. 5035--><p class="nopar" >
</p>
   <table 
class="equation-star"><tr><td>
            <span 
class="cmsy-10">‚àí</span><img 
src="nonlinear_gyrokinetic_equation445x.png" alt="q
--
m"  class="frac" align="middle" /><img 
src="nonlinear_gyrokinetic_equation446x.png" alt="[  ‚àÇ‚ü®Œ¥A  (h)‚ü©   ( V     q           e )          ]
 ‚àí ----‚à•---Œ±‚àí   --D-+ --‚àáX ‚ü®A ‚à•‚ü©Œ± √ó -‚à•  ‚ãÖ‚àáX ‚ü®Œ¥œï‚ü©Œ±
      ‚àÇt         v‚à•    m           Œ©"  class="left" align="middle" /><img 
src="nonlinear_gyrokinetic_equation447x.png" alt=" ‚àÇF
---0
‚àÇv‚à•"  class="frac" align="middle" /><span 
class="cmmi-10">.</span>
</td></tr></table>
<!--l. 5042--><p class="nopar" >
</p><!--l. 5045--><p class="indent" >   ¬†
</p><!--l. 5047--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">H.1   </span> <a 
 id="x1-80000H.1"></a>Recover equation in W. Deng‚Äôs 2011 NF paper</h4>
<!--l. 5049--><p class="noindent" >The guiding-center velocity in the equilibrium Ô¨Åeld is given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-80001r379"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation448x.png" alt="ve  + V  = -B‚ãÜ0-v + --Œº--B  √ó ‚àáB  + --1---E √ó B
‚à• ‚à•    D   B ‚ãÜ‚à•0 ‚à•  Œ©B ‚ãÜ‚à•0 0      0  B0B ‚ãÜ‚à•0 0    0
" class="math-display"  /></center></td><td class="equation-label">(379)</td></tr></table>
<!--l. 5055--><p class="nopar" >
where
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-80002r380"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation449x.png" alt="            v‚à•
B‚ãÜ0 = B0 + B0--‚àá √ó b,
            Œ©
" class="math-display"  /></center></td><td class="equation-label">(380)</td></tr></table>
<!--l. 5060--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-80003r381"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation450x.png" alt="               (             )
B ‚ãÜ‚â° b ‚ãÖB‚ãÜ = B  1+ v‚à•b ‚ãÖ‚àá √ó b ,
  ‚à•                Œ©
" class="math-display"  /></center></td><td class="equation-label">(381)</td></tr></table>
<!--l. 5065--><p class="nopar" >
Using <span 
class="cmmi-10">B</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">‚ãÜ</span></sup> <span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>, then expression (<a 
href="#x1-80001r379">379<!--tex4ht:ref: 18-12-17-1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-80004r382"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation451x.png" alt="                  v2‚à•          Œº             1
v‚à•e‚à• + VD = v‚à•b +  Œ©-‚àá √ó b + Œ©B0-B0 √ó ‚àáB0 + B2-E0 √ó B0,
                 cu‚óürva‚óùt‚óúured‚óûrift  ‚óü-----‚óù‚óú----‚óû  ‚óü-0-‚óù‚óú---‚óû
                                ‚àáB drift       E√óB drift
" class="math-display"  /></center></td><td class="equation-label">(382)</td></tr></table>
<!--l. 5075--><p class="nopar" >
where the curvature drift, <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">B </span>drift, and <span 
class="cmbx-10">E</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="cmsy-10">√ó </span><span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub> drift can be identiÔ¨Åed. Note that the perturbed
guiding-center velocity <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">D</span></sub> is given by (refer to Sec. <a 
href="#x1-65000C.3">C.3<!--tex4ht:ref: 19-3-28-e1 --></a>)
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-80005r383"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation452x.png" alt="Œ¥V   = e‚à•-√ó‚àáX-‚ü®Œ¥œï‚ü©Œ± + v ‚ü®Œ¥B-‚ä•‚ü©Œ±.
   D        B0         ‚à•  B0
" class="math-display"  /></center></td><td class="equation-label">(383)</td></tr></table>
<!--l. 5083--><p class="nopar" >
Using the above results, equation (<a 
href="#x1-79007r377">377<!--tex4ht:ref: 17-5-13-p2m --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation453x.png" alt="[                          ]
 ‚àÇ-                     -‚àÇ--              ‚àÇŒ¥f-
 ‚àÇt +(v‚à•e‚à• + VD + Œ¥VD  )‚ãÖ‚àÇX ‚Ä≤ Œ¥f ‚àí e‚à• ‚ãÖŒº ‚àáB0 ‚àÇv‚à•
         (    )   (e  √ó‚àá  ‚ü®Œ¥œï‚ü©            )  (          )
= ‚àí Œ¥VD ‚ãÖ ‚àÇF0‚Ä≤  +  -‚à•----X----Œ± + v‚à•‚ü®Œ¥B-‚ä•‚ü©Œ±- ‚ãÖ  Œº-‚àáB0 ‚àÇF0-
    [     ‚àÇX      (     B0            B0       v‚à•    ‚àÇv‚à•               )         ]
  q    ‚àÇ‚ü®v ‚ãÖŒ¥A ‚ü©Œ±           v2‚à•         Œº             1             ‚ü®Œ¥B ‚ä•‚ü©Œ±            ‚àÇF0 1
‚àí m- ‚àí ---‚àÇt----‚àí  v‚à•e‚à• + Œ©-‚àá √ó b+ Œ©B0- B0 √ó ‚àáB0 + B2E0 √ó B0 + v‚à•--B0--- ‚ãÖ‚àáX ‚ü®Œ¥œï ‚ü©Œ±  ‚àÇv‚à•(3v8‚à•4),
                                                    0
" class="math-display"  /></center>
</div>Collecting coeÔ¨Écients before <span 
class="cmmi-10">‚àÇF</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï‚àÇv</span><sub><span 
class="cmsy-7">‚à•</span></sub>, we Ô¨Ånd that the two terms involving <span 
class="cmsy-10">‚àá</span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub> (terms in blue and
red) cancel each other, yielding <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation454x.png" alt="[                          ]
 ‚àÇ- +(v‚à•e‚à• + VD + Œ¥VD  )‚ãÖ-‚àÇ-- Œ¥f ‚àí e‚à• ‚ãÖŒº ‚àáB0 ‚àÇŒ¥f
 ‚àÇt      (    )         ‚àÇX ‚Ä≤              ‚àÇv‚à•
          ‚àÇF0-
= ‚àí Œ¥VD ‚ãÖ  ‚àÇX
    [                                (       v2                             )         ]
+ q- m-v‚à•‚ü®Œ¥B‚ä•-‚ü©Œ±-‚ãÖ(Œº‚àáB0 )+ ‚àÇ‚ü®v-‚ãÖŒ¥A-‚ü©Œ± +  v‚à•b+  ‚à•-‚àá √ób + -12E0 √ó B0 + v‚à•‚ü®Œ¥B-‚ä•‚ü©Œ± ‚ãÖ‚àáX ‚ü®Œ¥œï ‚ü©Œ±  ‚àÇF0(3185,)
  m  q     B0                 ‚àÇt             Œ©        B 0             B0               ‚àÇv‚à• v‚à•
" class="math-display"  /><a 
 id="x1-80007r385"></a></center>
</div>This equation agrees with Eq. (8) in I. Holod‚Äôs 2009 pop paper (gyro-averaging is wrongly omitted in
that paper) and W. Deng‚Äôs 2011 NF paper.
<!--l. 5130--><p class="indent" >   ¬†
</p><!--l. 5132--><p class="indent" >   ¬†
</p><!--l. 5134--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">I   </span> <a 
 id="x1-81000I"></a>Drift-kinetic limit</h3>
<!--l. 5136--><p class="noindent" >In the drift-kinetic limit, <span 
class="cmsy-10">‚ü®</span><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ãÖ</span><span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> = 0, <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥B</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">v</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> = 0, and <span 
class="cmsy-10">‚ü®</span><span 
class="cmmi-10">Œ¥h</span><span 
class="cmsy-10">‚ü©</span><sub><span 
class="cmmi-7">Œ±</span></sub> = <span 
class="cmmi-10">Œ¥h</span>, where <span 
class="cmmi-10">Œ¥h </span>is an arbitrary Ô¨Åeld
quantity. Using these, gyrokinetic equation (<a 
href="#x1-66004r336">336<!--tex4ht:ref: 18-8-26-2 --></a>) is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation455x.png" alt="[    (                       )    ]
 ‚àÇ-                      Œ¥B-‚ä•-
 ‚àÇt +  v‚à•e‚à• + vD + vE +v‚à• B0  ‚ãÖ‚àáX   Œ¥f
    (       Œ¥B‚ä• )          q [(             Œ¥B‚ä• )    ] ‚àÇF0
= ‚àí  vE + v‚à•-B--  ‚ãÖ‚àáXF0 ‚àí m-   v‚à•e‚à• + vD + v‚à•-B-  ‚ãÖŒ¥E -‚àÇùúÄ-.     (386)
              0                               0
" class="math-display"  /><a 
 id="x1-81001r386"></a></center>
</div>
                                                                                

                                                                                
<!--l. 5153--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">I.1   </span> <a 
 id="x1-82000I.1"></a>Linear case</h4>
<!--l. 5155--><p class="noindent" >Neglecting the nonlinear terms, drift-kinetic equation (<a 
href="#x1-81001r386">386<!--tex4ht:ref: 17-5-14-e1 --></a>) is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation456x.png" alt="[                    ]
  ‚àÇ-
  ‚àÇt + (v‚à•e‚à• + vD) ‚ãÖ‚àáX Œ¥f
    (       Œ¥B ‚ä•)          q                ‚àÇF0
= ‚àí   vE +v‚à•-B--  ‚ãÖ‚àáXF0  ‚àí m-[(v‚à•e‚à• + vD )‚ãÖŒ¥E]‚àÇ-ùúÄ .         (387)
               0
" class="math-display"  /><a 
 id="x1-82001r387"></a></center>
</div>Next let us derive the parallel momentum equation from the linear drift kinetic equation (this is needed
in my simulation). Multiplying the linear drift kinetic equation (<a 
href="#x1-82001r387">387<!--tex4ht:ref: 17-5-17-p1 --></a>) by <span 
class="cmmi-10">qv</span><sub><span 
class="cmsy-7">‚à•</span></sub> and then integrating over
velocity space, we obtain <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation457x.png" alt="‚àÇŒ¥j‚à•     ‚à´
 ‚àÇt  = ‚àí q  dvv‚à•(v‚à•e‚à• + vD )‚ãÖ‚àáX Œ¥f
        ‚à´     (        Œ¥B ‚ä• )         q  ‚à´                    ‚àÇF0
     ‚àí q  dvv‚à•  vE + v‚à• B--- ‚ãÖ‚àáXF0  ‚àí m-q  dvv‚à•[(v‚à•e‚à• + vD)‚ãÖŒ¥E ]‚àÇùúÄ-.  (388)
                         0
" class="math-display"  /><a 
 id="x1-82002r388"></a></center>
</div>Equation (<a 
href="#x1-82002r388">388<!--tex4ht:ref: 17-7-20-1 --></a>) involve <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">Œ¥f </span>and this should be avoided in particle methods whose goal is to avoid
directly evaluating the derivatives of <span 
class="cmmi-10">Œ¥f </span>over phase-space coordinates. On the other hand, the partial
derivatives of velocity moment of <span 
class="cmmi-10">Œ¥f </span>are allowed. Therefore, we would like to make the velocity
integration of <span 
class="cmmi-10">Œ¥f </span>appear. Note that <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">Œ¥f </span>here is taken by holding (<span 
class="cmmi-10">ùúÄ,Œº</span>) constant and thus <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>
is not a constant and thus can not be moved inside <span 
class="cmsy-10">‚àá</span><sub><span 
class="cmmi-7">X</span></sub>. Next, to facilitate performing
the integration over <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>, we transform the linear drift kinetic equation (<a 
href="#x1-82001r387">387<!--tex4ht:ref: 17-5-17-p1 --></a>) into variable
(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>).
                                                                                

                                                                                
<!--l. 5192--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">I.2   </span> <a 
 id="x1-83000I.2"></a>Transform from (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,ùúÄ</span>) to (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) coordinates</h4>
<!--l. 5194--><p class="noindent" >The kinetic equation given above is written in terms of variable (<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,ùúÄ</span>). Next, we transform it into
coordinates (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,Œº</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) which is deÔ¨Åned by
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-83001r389"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation458x.png" alt="X‚Ä≤(X,Œº,ùúÄ) = X,
" class="math-display"  /></center></td><td class="equation-label">(389)</td></tr></table>
<!--l. 5199--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-83002r390"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation459x.png" alt="Œº‚Ä≤(X,Œº,ùúÄ) = Œº,
" class="math-display"  /></center></td><td class="equation-label">(390)</td></tr></table>
<!--l. 5202--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-83003r391"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation460x.png" alt="           ‚àò -------------
v‚à•(X, Œº,ùúÄ) =  2(ùúÄ ‚àí ŒºB0(X )).
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(391)</td></tr></table>
<!--l. 5207--><p class="nopar" >
Use this, we have </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation461x.png" alt="‚àÇŒ¥G0-     ‚àÇX‚Ä≤‚àÇ-Œ¥G0   ‚àÇŒº‚Ä≤‚àÇŒ¥G0-  ‚àÇv‚à•‚àÇ-Œ¥G0-
‚àÇX  |Œº,ùúÄ = ‚àÇX  ‚àÇX ‚Ä≤ + ‚àÇX  ‚àÇŒº‚Ä≤ + ‚àÇX  ‚àÇv‚à•
          ‚àÇŒ¥G        ‚àÇ Œ¥G     Œº ‚àÇB  ‚àÇŒ¥G
       =  ---0‚Ä≤ |Œº,v‚à• + 0-‚Ä≤0‚àí  ----0----0,               (392)
          ‚àÇX          ‚àÇŒº     v‚à•dX  ‚àÇv‚à•
" class="math-display"  /></center>
</div>and <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation462x.png" alt="‚àÇF    ‚àÇF ‚àÇ Œº‚Ä≤  ‚àÇF  ‚àÇv
--0-= --0‚Ä≤--- + --0---‚à•
‚àÇùúÄ    ‚àÇŒº  ‚àÇùúÄ   ‚àÇv‚à• ‚àÇùúÄ
    = 0‚àÇF0-+ ‚àÇF0‚àÇv‚à•
       ‚àÇŒº‚Ä≤   ‚àÇv‚à• ‚àÇùúÄ
      ‚àÇF0 1
    = ‚àÇv‚à•v‚à•                                   (393)
" class="math-display"  /></center>
</div>Then, in terms of variable (<span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤</span><span 
class="cmmi-10">,Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>), equation (<a 
href="#x1-82001r387">387<!--tex4ht:ref: 17-5-17-p1 --></a>) is written <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation463x.png" alt=" ‚àÇŒ¥f+ (v‚à•e‚à• + vD )‚ãÖ‚àáŒ¥f ‚àí e‚à• ‚ãÖŒº‚àáB ‚àÇ-Œ¥f
 ‚àÇt                             ‚àÇv‚à•
    (       Œ¥B ‚ä•)        ( vE   Œ¥B‚ä• )      ‚àÇF0    q[(     vD )    ] ‚àÇF0
= ‚àí   vE + v‚à•-B0  ‚ãÖ‚àáF0 +   v‚à•-+ -B0-  ‚ãÖŒº‚àáB ‚àÇv‚à•-‚àí m-   e‚à• +-v‚à•  ‚ãÖŒ¥E  ‚àÇv‚à•,(394)
" class="math-display"  /><a 
 id="x1-83006r394"></a></center>
</div>where <span 
class="cmsy-10">‚àá‚â° </span><span 
class="cmmi-10">‚àÇ‚àï‚àÇ</span><span 
class="cmbx-10">X</span><span 
class="cmsy-10">‚Ä≤|</span><sub><span 
class="cmmi-7">Œº,v</span><sub><span 
class="cmsy-5">‚à•</span></sub></sub>.
<!--l. 5250--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">I.3   </span> <a 
 id="x1-84000I.3"></a>Parallel momentum equation</h4>
<!--l. 5252--><p class="noindent" >Multiplying the linear drift kinetic equation (<a 
href="#x1-83006r394">394<!--tex4ht:ref: 17-5-14-e3 --></a>) by <span 
class="cmmi-10">qv</span><sub><span 
class="cmsy-7">‚à•</span></sub> and then integrating over velocity space, we
obtain </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation464x.png" alt="       ‚à´                          ‚à´
‚àÇŒ¥j‚à•+ q   dvv‚à•(v‚à•e‚à• + vD )‚ãÖ‚àáX Œ¥f ‚àí q dvv‚à•e‚à• ‚ãÖŒº‚àáB ‚àÇŒ¥f-
 ‚àÇt ‚à´      (           )           ‚à´     (      ‚àÇv‚à• )
                   Œ¥B-‚ä•                    vE-  Œ¥B‚ä•-       ‚àÇF0-
= ‚àí q  dvv‚à• vE + v‚à• B0   ‚ãÖ‚àáXF0 + q   dvv‚à•  v‚à• +  B0   ‚ãÖŒº‚àáB ‚àÇv‚à•
  q  ‚à´     [(     v  )    ] ‚àÇF
‚àí--q   dvv‚à•  e‚à• + -D- ‚ãÖŒ¥E  ---0.                                  (395)
 m                v‚à•       ‚àÇv ‚à•
" class="math-display"  /><a 
 id="x1-84001r395"></a></center>
</div>Consider the simple case that <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> does not carry current, i.e., <span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub>(<span 
class="cmbx-10">X</span><span 
class="cmmi-10">,Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) is an even function about <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>.
Then it is obvious that the integration of the terms in red in Eq. (<a 
href="#x1-84001r395">395<!--tex4ht:ref: 17-5-18-1 --></a>) are all zero. Among the rest
terms, only the following term
   <table 
class="equation"><tr><td><a 
 id="x1-84002r396"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation465x.png" alt="  q  ‚à´               ‚àÇF  1
‚àí --q  dvv‚à•[(v‚à•e‚à•)‚ãÖŒ¥E ]--0--
  m                   ‚àÇv‚à•v‚à•
" class="math-display"  /></center></td><td class="equation-label">(396)</td></tr></table>
                                                                                

                                                                                
<!--l. 5280--><p class="nopar" >
explicitly depends on <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span>. Using <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= 2<span 
class="cmmi-10">œÄBdv</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">dŒº</span>, the integration in the above expression can be
analytically performed, giving </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation466x.png" alt=" -q ‚à´                ‚àÇF0-1
‚àím q   dvv‚à•[(v‚à•e‚à•)‚ãÖŒ¥E]‚àÇv‚à•v‚à•
    2 ‚à´
= ‚àí q   2œÄBdv‚à•dŒºv‚à•Œ¥E ‚à•‚àÇF0-
   m  ‚à´          ‚à´    ‚àÇv‚à•
   q2                ‚àÇF0-
= ‚àím    2œÄBd ŒºŒ¥E‚à•  v‚à• ‚àÇv‚à•dv‚à•
   q2 ‚à´          (    ‚à´      )
= ‚àí--   2œÄBd ŒºŒ¥E‚à•  0‚àí   F0dv‚à•
   m
= q2Œ¥E n .                                        (397)
  m   ‚à• 0
" class="math-display"  /></center>
</div>Using these results, the parallel momentum equation (<a 
href="#x1-84001r395">395<!--tex4ht:ref: 17-5-18-1 --></a>) is written <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation467x.png" alt="                  ‚à´                         ‚à´
‚àÇŒ¥j‚à• = q2Œ¥E n  ‚àí q  dvv (ve  + v )‚ãÖ‚àá  Œ¥f + q  dvv e ‚ãÖŒº ‚àáB ‚àÇŒ¥f-
 ‚àÇt    m   ‚à• 0         ‚à•  ‚à•‚à•    D    X           ‚à• ‚à•      ‚àÇv‚à•
         ‚à´      (  Œ¥B ‚ä•)         ‚à´      (Œ¥B ‚ä•)       ‚àÇF0
       ‚àí q  dvv‚à• v‚à•-B--  ‚ãÖ‚àáF0 + q   dvv‚à• -B--  ‚ãÖŒº‚àáB  ‚àÇv-,         (398)
                     0                      0          ‚à•
" class="math-display"  /><a 
 id="x1-84004r398"></a></center>
</div>where the explicit dependence on <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E </span>is via the Ô¨Årst term <span 
class="cmmi-10">q</span><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">n</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">Œ¥E</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">‚àïm</span>, with all the the other terms
being explicitly independent of <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E </span>(<span 
class="cmmi-10">Œ¥f </span>and <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">B </span>implicitly depend on <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E</span>).
<!--l. 5317--><p class="indent" >   Equation (<a 
href="#x1-84004r398">398<!--tex4ht:ref: 17-5-18-p3 --></a>) involve derivatives of <span 
class="cmmi-10">Œ¥f </span>with respect to space and <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> and these should be avoided in
the particle method whose goal is to avoid directly evaluating these derivatives. Using integration by
parts, the terms involving <span 
class="cmmi-10">‚àÇ‚àï‚àÇv</span><sub><span 
class="cmsy-7">‚à•</span></sub> can be simpliÔ¨Åed, yielding </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation468x.png" alt="‚àÇŒ¥j‚à•  q2         ‚à´                                  ‚à´
----= --Œ¥E ‚à•n0 ‚àí q dvv ‚à•(v‚à•e‚à• + vD )‚ãÖ‚àáX Œ¥f ‚àí q(e‚à• ‚ãÖ‚àáB0 ) ŒºŒ¥f dv
 ‚àÇt    m ‚à´     (       )         (     )       ‚à´
      ‚àí q  dvv‚à•  v‚à•Œ¥B‚ä•-  ‚ãÖ‚àáF0 ‚àí q  Œ¥B-‚ä•- ‚ãÖ(‚àáB0 )  ŒºF0dv,          (399)
                    B0             B0
" class="math-display"  /></center>
</div>DeÔ¨Åne <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmr-7">0</span></sub> = <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">mv</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àï</span>2<span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>and <span 
class="cmmi-10">Œ¥p</span><sub><span 
class="cmsy-7">‚ä•</span></sub> = <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">mv</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥f‚àï</span>2<span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span>, then the above equation is written
<div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation469x.png" alt="‚àÇ Œ¥j‚à•   q2         ‚à´                                  Œ¥p‚ä•
-‚àÇt- = m-Œ¥E ‚à•n0 ‚àí q  dvv‚à•(v‚à•e‚à• + vD) ‚ãÖ‚àáX Œ¥f ‚àí q(e‚à• ‚ãÖ‚àáB0 )mB
          ‚à´     (       )         (    )                0
       ‚àí q  dvv‚à•  v‚à•Œ¥B‚ä•- ‚ãÖ‚àáF0 ‚àí q  Œ¥B-‚ä•  ‚ãÖ(‚àáB0 ) p‚ä•0-,          (400)
                    B0              B0          mB0
" class="math-display"  /><a 
 id="x1-84006r400"></a></center>
</div>Next, we try to eliminate the spatial gradient of <span 
class="cmmi-10">Œ¥f </span>by changing the order of integration. The second
term on the right-hand side of Eq. (<a 
href="#x1-84006r400">400<!--tex4ht:ref: 17-5-18-p8 --></a>) is written <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation470x.png" alt="  ‚à´
‚àí q  dvv ‚à•(v‚à•e‚à•)‚ãÖ‚àáX Œ¥f,
    ‚à´
= ‚àí q  2œÄB  dv dŒºv2e ‚ãÖ‚àá  Œ¥f
          0  ‚à•   ‚à• ‚à•   X
               ‚à´  2
= ‚àí q2œÄB0e‚à• ‚ãÖ‚àáX  v‚à•Œ¥fdv‚à•dŒº
             (  1  ‚à´         )
= ‚àí qB0e‚à• ‚ãÖ‚àáX  ----  mv2‚à•Œ¥fdv
             ( mB0 )
= ‚àí qB0e‚à• ‚ãÖ‚àáX  Œ¥p‚à•- ,                             (401)
               mB0
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">Œ¥p</span><sub><span 
class="cmsy-7">‚à•</span></sub> = <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">mv</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">Œ¥fd</span><span 
class="cmbx-10">v</span>. Similarly, the term <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">q</span> <span 
class="cmex-10">‚à´</span>
 <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><img 
src="nonlinear_gyrokinetic_equation471x.png" alt="(     )
 v‚à•Œ¥BB‚ä•0-"  class="left" align="middle" /><span 
class="cmsy-10">‚ãÖ‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub> is written as
<div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation472x.png" alt="   ‚à´     (       )
‚àí q  dvv  v  Œ¥B-‚ä•- ‚ãÖ‚àá  F
        ‚à•  ‚à• B0      X  0
     ‚à´          (  2Œ¥B‚ä•-)
= ‚àí q  2œÄB0dv‚à•dŒº  v‚à• B0   ‚ãÖ‚àáXF0
     (Œ¥B  )        ‚à´
= ‚àí q ---‚ä•  ‚ãÖB0‚àáX    (v2‚à•F02œÄdv‚à•dŒº)
     ( B0 )        [  ‚à´          ]
= ‚àí q Œ¥B-‚ä•  ‚ãÖB ‚àá    1-  (mv2F dv)
       B0     0  X  B      ‚à• 0
             (-p‚à•0 )
= ‚àí qŒ¥B ‚ä• ‚ãÖ‚àáX mB0                                   (402)
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmr-7">0</span></sub> = <span 
class="cmex-10">‚à´</span>
  <span 
class="cmmi-10">mv</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">F</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span>. Similarly, the term <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">q</span> <span 
class="cmex-10">‚à´</span>
 <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">v</span><sub><span 
class="cmmi-7">D</span></sub> <span 
class="cmsy-10">‚ãÖ‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">Œ¥f </span>can be written as the gradient of
moments of <span 
class="cmmi-10">Œ¥f</span>. Let us work on this. The drift <span 
class="cmbx-10">v</span><sub><span 
class="cmmi-7">D</span></sub> is given by
   <table 
class="equation"><tr><td><a 
 id="x1-84009r403"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation473x.png" alt="      B0vŒ©‚à•‚àá-√ó-b-    -Œº--
vD =     B ‚ãÜ   v‚à• + Œ©B ‚ãÜB0 √ó ‚àáB0.
           ‚à•           ‚à•
" class="math-display"  /></center></td><td class="equation-label">(403)</td></tr></table>
<!--l. 5387--><p class="nopar" >
where <span 
class="cmmi-10">B</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmmi-7">‚ãÜ</span></sup> = <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub><img 
src="nonlinear_gyrokinetic_equation474x.png" alt="(    v‚à•-       )
 1 + Œ©b ‚ãÖ‚àá √ó b"  class="left" align="middle" /> (refer to my another notes). ¬†Using <span 
class="cmbx-10">b </span><span 
class="cmsy-10">‚ãÖ‚àá√ó </span><span 
class="cmbx-10">b </span><span 
class="cmsy-10">‚âà </span>0, we obtain
<span 
class="cmmi-10">B</span><sub><span 
class="cmsy-7">‚à•</span></sub><sup><span 
class="cmmi-7">‚ãÜ</span></sup> <span 
class="cmsy-10">‚âà </span><span 
class="cmmi-10">B</span>. Then <span 
class="cmbx-10">v</span><sub><span 
class="cmmi-7">D</span></sub> is written
</p>
   <table 
class="equation-star"><tr><td>
                           <span 
class="cmbx-10">v</span><sub><span 
class="cmmi-7">D</span></sub> = <img 
src="nonlinear_gyrokinetic_equation475x.png" alt="v2‚à•
Œ©-"  class="frac" align="middle" /><span 
class="cmsy-10">‚àá√ó </span><span 
class="cmbx-10">b </span>+ <img 
src="nonlinear_gyrokinetic_equation476x.png" alt="Œº
Œ©-"  class="frac" align="middle" /><span 
class="cmbx-10">b </span><span 
class="cmsy-10">√ó‚àá</span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">.</span>
</td></tr></table>
<!--l. 5393--><p class="nopar" >
Using this and <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= 2<span 
class="cmmi-10">œÄB</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">dŒº</span>, the term <span 
class="cmsy-10">‚àí</span><span 
class="cmmi-10">q</span> <span 
class="cmex-10">‚à´</span>
 <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v</span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">v</span><sub><span 
class="cmmi-7">D</span></sub> <span 
class="cmsy-10">‚ãÖ‚àá</span><sub><span 
class="cmmi-7">X</span></sub><span 
class="cmmi-10">Œ¥f </span>is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation477x.png" alt="                                     (                   )
  ‚à´                    ‚à´              v2‚à•        Œº
‚àí q  dvv‚à•vD ‚ãÖ‚àáX Œ¥f = ‚àí q 2œÄB0dv ‚à•dŒºv‚à•  -Œ©‚àá √ó b + Œ©-b √ó‚àáB0   ‚ãÖ‚àáX Œ¥f
                                        ‚à´                                  ‚à´
                  = ‚àí q2œÄB -1(‚àá √ó b)‚ãÖ‚àá     v3Œ¥f dvdŒº ‚àí q2œÄB -1(b √ó‚àáB  )‚ãÖ‚àá     v ŒºŒ¥fdv dŒº
                          0Œ©           X    ‚à•   ‚à•         0Œ©        0    X    ‚à•     ‚à•
                         1-           ( -1-‚à´  3    )      -1              (-1-‚à´         )
                  = ‚àí qB0Œ© (‚àá √ó b)‚ãÖ‚àáX   B0   v‚à•Œ¥fdv  ‚àí qB0Œ© (b√ó ‚àáB0 )‚ãÖ‚àáX   B0   v‚à•ŒºŒ¥fdv  ,
                                   ( 1 ‚à´        )                  ( 1 ‚à´        )
                  = ‚àí m(‚àá √ó b)‚ãÖ‚àáX   ---  v3‚à•Œ¥fdv  ‚àí m (b√ó ‚àáB0 )‚ãÖ‚àáX   ---  v‚à•ŒºŒ¥fdv  ,   (404)
                                    B0                              B0
" class="math-display"  /></center>
</div>which are the third order moments of <span 
class="cmmi-10">Œ¥f </span>and may be neglect-able (a guess, not veriÔ¨Åed). Using the
above results, the linear parallel momentum equation is Ô¨Ånally written <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation478x.png" alt="                          (    )
‚àÇŒ¥j‚à•-= e2ne0Œ¥E  +eB  b‚ãÖ‚àá    -Œ¥p‚à•  + e(b‚ãÖ‚àáB  )-Œ¥p‚ä•
‚àÇt      m    ‚à•     0    X  mB0            0 mB0
                 ( p‚à•0 )    (Œ¥B ‚ä•)        p‚ä•0
      +eŒ¥B ‚ä• ‚ãÖ‚àáX  mB0-   +e  -B0-  ‚ãÖ(‚àáB0 )mB0-.
                     (   ‚à´       )                  (    ‚à´        )
      ‚àí m (‚àá √ó b)‚ãÖ‚àáX  -1-  v3‚à•Œ¥fdv  ‚àí m (b √ó ‚àáB0 )‚ãÖ‚àáX   -1-  v‚à•ŒºŒ¥fdv   (405)
                      B0                              B0
" class="math-display"  /><a 
 id="x1-84011r405"></a></center>
</div>DeÔ¨Åne
   <table 
class="equation"><tr><td><a 
 id="x1-84012r406"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation479x.png" alt="       ( p   )  ‚àáB   p
D0 = ‚àá  --‚à•0  + ---0 -‚ä•0-,
        mB0      B0  mB0
" class="math-display"  /></center></td><td class="equation-label">(406)</td></tr></table>
<!--l. 5436--><p class="nopar" >
which, for the isotropic case (<span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmr-7">0</span></sub> = <span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚ä•</span><span 
class="cmr-7">0</span></sub> = <span 
class="cmmi-10">p</span><sub><span 
class="cmr-7">0</span></sub>), is simpliÔ¨Åed to
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-84013r407"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation480x.png" alt="     ‚àáp
D0 = ---0.
     mB0
" class="math-display"  /></center></td><td class="equation-label">(407)</td></tr></table>
<!--l. 5441--><p class="nopar" >
then Eq. (<a 
href="#x1-84011r405">405<!--tex4ht:ref: 17-5-19-2 --></a>) is written as </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation481x.png" alt="‚àÇŒ¥j    e2n
---‚à•=  ---0Œ¥E‚à• + eŒ¥B ‚ä• ‚ãÖD0
 ‚àÇt     m       (    )
    + eB0b ‚ãÖ‚àáX   -Œ¥p‚à•  + e(b‚ãÖ‚àáB0 )-Œ¥p‚ä•
                 mB0(    ‚à´       ) mB0              (    ‚à´        )
                     -1-   3                         -1-
    ‚àí m (‚àá √ó b)‚ãÖ‚àáX   B0   v‚à•Œ¥fdv  ‚àí m (b √ó ‚àáB0 )‚ãÖ‚àáX   B0   v‚à•ŒºŒ¥fdv  . (408)
" class="math-display"  /></center>
</div>
<!--l. 5457--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">I.4   </span> <a 
 id="x1-85000I.4"></a>Special case in uniform magnetic Ô¨Åeld</h4>
<!--l. 5459--><p class="noindent" >In the case of uniform magnetic Ô¨Åeld, the parallel momentum equation (<a 
href="#x1-84011r405">405<!--tex4ht:ref: 17-5-19-2 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-85001r409"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation482x.png" alt="‚àÇŒ¥j‚à• = q-qE n  ‚àí qe ‚ãÖ‚àá  (Œ¥p )‚àí qŒ¥B‚ä•-‚ãÖ‚àá  p  .
 ‚àÇt    m   ‚à• e0    ‚à•   X   ‚à•     B0    X ‚à•0
" class="math-display"  /></center></td><td class="equation-label">(409)</td></tr></table>
<!--l. 5466--><p class="nopar" >
</p><!--l. 5468--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">I.5   </span> <a 
 id="x1-86000I.5"></a>Electron perpendicular Ô¨Çow</h4>
<!--l. 5470--><p class="noindent" >Using the gyrokinetic theory and taking the drift-kinetic limit, the perturbed perpendicular electron
Ô¨Çow, <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">V</span><sub><span 
class="cmmi-7">e</span><span 
class="cmsy-7">‚ä•</span></sub>, is written (see Sec. <a 
href="#x1-78000G">G<!--tex4ht:ref: 17-9-26-1 --></a> or Appendix in Yang Chen‚Äôs paper<span class="cite">[<a 
href="#Xychen2009">2</a>]</span>)
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-86001r410"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation483x.png" alt="ne0Œ¥Ve ‚ä• = ne0Œ¥E √ób ‚àí -1-b √ó ‚àá Œ¥p‚ä•e
          B‚óü0-‚óù‚óú---‚óû  e‚óüB0--‚óù‚óú-----‚óû
           E√óB Ô¨Çow     diamagneticÔ¨Çow
" class="math-display"  /></center></td><td class="equation-label">(410)</td></tr></table>
<!--l. 5478--><p class="nopar" >
where <span 
class="cmmi-10">n</span><sub><span 
class="cmmi-7">e</span><span 
class="cmr-7">0</span></sub> is the equilibrium electron number density, <span 
class="cmmi-10">Œ¥p</span><sub><span 
class="cmmi-7">e</span><span 
class="cmsy-7">‚ä•</span></sub> is the perturbed perpendicular pressure of
electrons.
</p><!--l. 5482--><p class="indent" >   ¬†
</p><!--l. 5484--><p class="indent" >   ¬†
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-87000I.5"></a>Drift kinetic equation</h5>
<!--l. 5488--><p class="noindent" >Drift kinetic equation is written
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-87001r411"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation484x.png" alt="     (                 )       (                )
‚àÇf-+   vbÀú+ vD + Œ¥E-√ó-b  ‚ãÖ‚àáf +  ‚àí e-Œ¥E ‚àí ŒºbÀú‚ãÖ‚àáB   ‚àÇf- = 0,
 ‚àÇt     ‚à•          B0             m   ‚à•           ‚àÇv‚à•
" class="math-display"  /></center></td><td class="equation-label">(411)</td></tr></table>
<!--l. 5495--><p class="nopar" >
where <span 
class="cmmi-10">f </span>= <span 
class="cmmi-10">f</span>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">,t</span>), <span 
class="cmmi-10">Œº </span>= <span 
class="cmmi-10">mv</span><sub><span 
class="cmsy-7">‚ä•</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">‚àïB</span><sub><span 
class="cmr-7">0</span></sub> is the magnetic moment, <img 
src="nonlinear_gyrokinetic_equation485x.png" alt="Àúb"  class="tilde"  /> = <span 
class="cmbx-10">b </span>+ <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">B</span><sub><span 
class="cmsy-7">‚ä•</span></sub><span 
class="cmmi-10">‚àïB</span><sub><span 
class="cmr-7">0</span></sub>, <span 
class="cmbx-10">b </span>= <span 
class="cmbx-10">B</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">‚àïB</span><sub><span 
class="cmr-7">0</span></sub> is the
unit vector along the equilibrium magnetic Ô¨Åeld, <span 
class="cmbx-10">v</span><sub><span 
class="cmmi-7">D</span></sub> = <span 
class="cmbx-10">v</span><sub><span 
class="cmmi-7">D</span></sub>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,Œº,v</span><sub><span 
class="cmsy-7">‚à•</span></sub>) is the guiding-center drift in the
equilibrium magnetic Ô¨Åeld. <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">E </span>and <span 
class="cmmi-10">Œ¥</span><span 
class="cmbx-10">B </span>are the perturbed electric Ô¨Åeld and magnetic Ô¨Åeld,
respectively.
</p>
   <h5 class="subsubsectionHead"><a 
 id="x1-88000I.5"></a>Parallel momentum equation</h5>
<!--l. 5506--><p class="noindent" >Multiplying the drift kinetic equation () by <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub> and then integrating over velocity space, we
obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-88001r412"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation486x.png" alt="‚à´ ‚àÇf v      ‚à´   (                 )          ‚à´   (                )
  --e-‚à•dv +   v‚à•  v‚à•Àúb + vD + Œ¥E-√ó-b  ‚ãÖ‚àáfedv +   v‚à• ‚àí e-Œ¥E‚à• ‚àí Œº Àúb‚ãÖ‚àáB  ‚àÇfedv = 0,
    ‚àÇt                        B0                    m               ‚àÇv‚à•
" class="math-display"  /></center></td><td class="equation-label">(412)</td></tr></table>
<!--l. 5515--><p class="nopar" >
which can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-88002r413"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation487x.png" alt="      ‚à´   (                  )         ‚à´
‚àÇJ‚à•e-          Àú       Œ¥E-√ó-e‚à•               (  e-      Àú     ) ‚àÇfe
‚àÇt  +   v‚à•  v‚à•b + vD +   B0     ‚ãÖ‚àáfedv +   v‚à• ‚àí m Œ¥E ‚à• ‚àí Œºb ‚ãÖ‚àáB  ‚àÇv‚à•dv = 0,
" class="math-display"  /></center></td><td class="equation-label">(413)</td></tr></table>
<!--l. 5524--><p class="nopar" >
Using <span 
class="cmmi-10">d</span><span 
class="cmbx-10">v </span>= <span 
class="cmmi-10">B</span><sup><span 
class="cmsy-7">‚àí</span><span 
class="cmr-7">1</span></sup>2<span 
class="cmmi-10">œÄmdv</span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmmi-10">dŒº</span>, the last term on the RHS of the above equation is written
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation488x.png" alt="‚à´ ‚à´    (                )
     v‚à• ‚àí e-Œ¥E ‚à• ‚àí ŒºÀúb ‚ãÖ‚àáB  ‚àÇfedv
          m               ‚àÇv‚à•
  ‚à´ ‚à´    (  e-      Àú     ) ‚àÇfe  B-
=      v‚à• ‚àí m Œ¥E ‚à• ‚àí Œºb ‚ãÖ‚àáB  ‚àÇv‚à•2œÄm dv‚à•dŒº
    e      B  ‚à´ ‚à´   ‚àÇf                  B ‚à´   ‚à´   ‚àÇf
= ‚àí --Œ¥E‚à•2œÄ--     v‚à•--edv‚à•dŒº ‚àí (Àúb ‚ãÖ‚àáB )2œÄ-  Œº   v‚à•--edv‚à•dŒº
    m      m  ‚à´ (   ‚àÇv‚à•   ‚à´      )      m         ‚àÇv‚à´‚à•  (         ‚à´      )
= ‚àí e-Œ¥E 2œÄB-    v f |+‚àû  ‚àí   fdv   dŒº‚àí (Àúb ‚ãÖ‚àáB )2œÄB-  Œº  v f |+‚àû  ‚àí   fdv   dŒº
    m   ‚à•  m      ‚à• e‚àí‚àû       e ‚à•                m       ‚à• e‚àí ‚àû      e ‚à•
  -e      B-‚à´ ‚à´           Àú        B-‚à´   ‚à´
= m Œ¥E ‚à•2œÄm      fedv‚à•dŒº + (b ‚ãÖ‚àáB )2œÄm    Œº  fedv‚à•dŒº
   e        ‚à´ ‚à´
= m-Œ¥E ‚à•ne +    Œº(Àúb ‚ãÖ‚àáB )fedv                                             (414)
   e
‚âà m-Œ¥E ‚à•ne
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation489x.png" alt="‚à´ ‚à´
    v‚à•(v‚à•Àúb)‚ãÖ‚àáfedv
  ‚à´ ‚à´
=     Àúb ‚ãÖ‚àá(v2f )dv
            ‚à• e
  ‚à´ ‚à´ Àú     2     B-
=     b ‚ãÖ‚àá(v‚à•fe)2œÄ m dv‚à•dŒº
      ( ‚à´ ‚à´       1      )
= Àúb‚ãÖ‚àá       v2‚à•fe2œÄ--dv‚à•dŒº  B0
      (   )       m
= Àúb‚ãÖ‚àá   p‚à•- B0
      ( B0      )
  Àú     p‚à•0 +-Œ¥p‚à•
= b‚ãÖ‚àá      B0     B0
      ( p‚à•0)          (Œ¥p‚à•)
= Àúb‚ãÖ‚àá   --- B0 + Àúb ‚ãÖ‚àá  ---  B0
      ( B0 )           B0(   )          (   )
‚âà b‚ãÖ‚àá   p‚à•0 B0 + Œ¥B-‚ä• ‚ãÖ‚àá  p‚à•0  B0 + b ‚ãÖ‚àá  Œ¥p‚à•- B0
        B0        B0      B0              B0
             Œ¥B‚ä•-
‚âà b‚ãÖ‚àá (p‚à•0)+  B0  ‚ãÖ‚àá (p‚à•0)+ b ‚ãÖ‚àá(Œ¥p‚à•)                        (415)
  Œ¥B‚ä•-
=  B0 ‚ãÖ‚àá (p‚à•0)+ b ‚ãÖ‚àá (Œ¥p‚à•)
" class="math-display"  /></center>
</div>where use has been made of <span 
class="cmbx-10">b </span><span 
class="cmsy-10">‚ãÖ‚àá</span><span 
class="cmmi-10">p</span><sub><span 
class="cmsy-7">‚à•</span><span 
class="cmr-7">0</span></sub> = 0.
   <table 
class="equation"><tr><td><a 
 id="x1-88005r416"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation490x.png" alt="‚àÇ-Œ¥Je‚à• = ‚àí e-Œ¥E  n ‚àí Œ¥B-‚ä• ‚ãÖ‚àá(p  )‚àí b‚ãÖ‚àá (Œ¥p )
  ‚àÇt      m   ‚à• e   B0      ‚à•0         ‚à•
" class="math-display"  /></center></td><td class="equation-label">(416)</td></tr></table>
<!--l. 5585--><p class="nopar" >
Using Eq. () in Eq. (), we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-88006r417"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation491x.png" alt="                                [                        ]
   e-                            Œ¥B-‚ä•
Œº0em Œ¥E‚à•ne + b ‚ãÖ‚àá √ó ‚àá √ó Œ¥E = ‚àí Œº0e B0  ‚ãÖ‚àá(pe‚à•0) +b ‚ãÖ‚àá (Œ¥pe‚à•)
" class="math-display"  /></center></td><td class="equation-label">(417)</td></tr></table>
<!--l. 5592--><p class="nopar" >
</p><!--l. 5595--><p class="indent" >   ¬†
</p><!--l. 5597--><p class="indent" >   ‚Äî‚Äî‚Äî‚Äî‚Äì
</p><!--l. 5599--><p class="indent" >   ¬†
</p><!--l. 5601--><p class="indent" >   ¬†
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-88007r418"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation492x.png" alt="                      (                                      )
                          Œ¥B‚ä•-         -q
‚àí b‚ãÖ‚àá √ó ‚àá √ó Œ¥E = ‚àí Œº0e ‚àí qB0  ‚ãÖ‚àáXp ‚à•0 + m qE‚à•ne0 ‚àí qe‚à• ‚ãÖ‚àáX (Œ¥p‚à•) .
" class="math-display"  /></center></td><td class="equation-label">(418)</td></tr></table>
<!--l. 5609--><p class="nopar" >
</p><!--l. 5612--><p class="indent" >   ¬†
</p><!--l. 5614--><p class="indent" >   ddddd </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation493x.png" alt="‚à´ ‚à´   (                 )
    v   v Àúb+ v  + Œ¥E-√ó-b  ‚ãÖ‚àáf dv
     ‚à•   ‚à•    D     B0        e
  ‚à´ ‚à´ (   Àú       Œ¥E-√ó-b)
=       v‚à•b+ vD +   B0    ‚ãÖ‚àá (v‚à•fe)dv
  ‚à´ ‚à´                 ‚à´ ‚à´                ‚à´  ‚à´ Œ¥E √ó b
=     v‚à•Àúb ‚ãÖ‚àá(v‚à•fe)dv +     vD ‚ãÖ‚àá (v‚à•fe)dv+      ------ ‚ãÖ‚àá (v‚à•fe)dv
  ‚à´ ‚à´               ‚à´ ‚à´                 ‚à´ ‚à´     B0
=     Àúb ‚ãÖ‚àá(v2‚à•fe)dv+      vD ‚ãÖ‚àá (v‚à•fe)dv +    Œ¥E-√ó-b ‚ãÖ‚àá(v‚à•fe)dv
  ‚à´ ‚à´                      ‚à´ ‚à´                B0      ‚à´ ‚à´
=     Àúb ‚ãÖ‚àá(v2fe)2œÄB-dv dŒº+     vD ‚ãÖ‚àá (v fe)2œÄB-dv dŒº +     Œ¥E-√ó-b ‚ãÖ‚àá(v fe)2œÄ B-dvdŒº
  ‚à´      (  ‚à•     m   ‚à•)    ‚à´  ‚à´       ‚à•    m   ‚à•      ‚à´ ‚à´  B0       ‚à•     m  ‚à•
    Àú      2    1-                            B-           Œ¥E-√ó-b           B-
=   b ‚ãÖ‚àá  v‚à•fe2œÄm dv‚à•dŒº B +      vD ‚ãÖ‚àá(v‚à•fe)2œÄ m dv‚à•dŒº +       B0   ‚ãÖ‚àá (v‚à•fe)2œÄm dv‚à•dŒº
      ( p‚à•)    ‚à´ ‚à´              B         ‚à´ ‚à´ Œ¥E √ó b           B
= Àúb‚ãÖ‚àá   B- B +      vD ‚ãÖ‚àá (v‚à•fe)2œÄm-dv‚à•dŒº +     --B--- ‚ãÖ‚àá(v‚à•fe)2œÄ m-dv‚à•dŒº
      ( p )    ‚à´ ‚à´                               0  ‚à´ ‚à´
= Àúb‚ãÖ‚àá   -‚à• B +      -1-b √ó (Œº‚àáB )‚ãÖ‚àá (v‚à•fe)2œÄ B-dv‚à•dŒº+      -1-b √ó (mv2‚à•Œ∫)‚ãÖ‚àá (v‚à•fe)2œÄB-dv‚à•dŒº
  ‚à´ ‚à´   B           mŒ©                     m             mŒ©                     m
+     Œ¥E-√ó-b ‚ãÖ‚àá(v‚à•fe)2œÄ B-dv‚à•dŒº
        B0             m
" class="math-display"  /></center>
</div>
<!--l. 5656--><p class="indent" >   ¬†
</p><!--l. 5659--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">J   </span> <a 
 id="x1-89000J"></a>Derivation of Eq. (123), not Ô¨Ånished</h3>
<!--l. 5661--><p class="noindent" >¬†
</p><!--l. 5663--><p class="indent" >   ¬†
</p><!--l. 5665--><p class="indent" >   ¬†
</p><!--l. 5667--><p class="indent" >   From the deÔ¨Ånition of <span 
class="cmmi-10">Œº</span>, we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-89001r419"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation494x.png" alt="‚àÇŒº     v2  ‚àÇB     1  ‚àÇv2     Œº ‚àÇB    ‚àÇv    v
---= ‚àí -‚ä•2---0-+ ------‚ä•-= ‚àí------0+ ---‚ä• ‚ãÖ-‚ä•-
‚àÇx     2B0 ‚àÇx    2B0 ‚àÇx     B0  ‚àÇx    ‚àÇx   B0
" class="math-display"  /></center></td><td class="equation-label">(419)</td></tr></table>
                                                                                

                                                                                
<!--l. 5675--><p class="nopar" >
Using
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-89002r420"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation495x.png" alt="‚àÇv     ‚àÇ[v ‚àí ve ]      ‚àÇe    ‚àÇv
--‚ä•-=  ------‚à•‚à•--= ‚àí v‚à•-‚à• ‚àí --‚à•e‚à•,
 ‚àÇx       ‚àÇx           ‚àÇx   ‚àÇx
" class="math-display"  /></center></td><td class="equation-label">(420)</td></tr></table>
<!--l. 5682--><p class="nopar" >
expression (<a 
href="#x1-89001r419">419<!--tex4ht:ref: 16-9-21-3 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-89003r421"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation496x.png" alt="‚àÇŒº-    Œº-‚àÇB0-    ‚àÇe-‚à• v‚ä•-
‚àÇx = ‚àí B0 ‚àÇx  ‚àí v‚à• ‚àÇx ‚ãÖB0 ,
" class="math-display"  /></center></td><td class="equation-label">(421)</td></tr></table>
<!--l. 5689--><p class="nopar" >
which agrees with Eq. (10) in Frieman-Chen‚Äôs paper<span class="cite">[<a 
href="#Xfrieman1982">3</a>]</span>. </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation497x.png" alt="   ‚à´
-1-  2œÄ dŒ±v‚ãÖ ‚àÇŒº-
2œÄ  0       ‚àÇx
   1 ‚à´ 2œÄ     (   Œº ‚àÇB0     ‚àÇe‚à•  v‚ä• )
= 2œÄ-    dŒ±v‚ãÖ  ‚àí B--‚àÇx-‚àí v‚à•-‚àÇx ‚ãÖB--
      0           0               0
=?0
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation498x.png" alt="  ‚à´        [           ]
1-- 2œÄ          -‚àÇ-(e‚à•)   ‚àÇŒ¥G0-
2œÄ  0 dŒ±v ‚ãÖ v √ó ‚àÇx  Œ©    ‚ãÖ ‚àÇX
=
" class="math-display"  /></center>
</div>Using the fact that <span 
class="cmmi-10">Œ¥G</span><sub><span 
class="cmr-7">0</span></sub> is independent of <span 
class="cmmi-10">Œ±</span>, the left-hand side of Eq. (<a 
href="#x1-27004r123">123<!--tex4ht:ref: 18-9-11-p3 --></a>) is written as
<div class="eqnarray">
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation499x.png" alt="  ‚ü®v‚ãÖ[‚à´ŒªB2œÄ1 + ŒªB2{ ]Œ¥[G0‚ü©Œ± (   )]                          }
= -1-    dŒ±v ‚ãÖ  v √ó ‚àÇ-- e‚à•   ‚ãÖ ‚àÇŒ¥G0-+ ‚àÇŒº-‚àÇŒ¥G0-+ ‚àÇŒ±-‚àÇŒ¥G0
  2œÄ  0             ‚àÇx  Œ©      ‚àÇX    ‚àÇx  ‚àÇŒº    ‚àÇx  ‚àÇŒ±
   1 ‚à´ 2œÄ     { [    ‚àÇ ( e‚à•)]  ‚àÇŒ¥G0   ‚àÇŒº ‚àÇŒ¥G0}
= 2œÄ-    dŒ±v ‚ãÖ  v √ó ‚àÇx- Œ©-   ‚ãÖ-‚àÇX--+ ‚àÇx--‚àÇŒº--
      0
" class="math-display"  /></center>
</div>
<!--l. 5727--><p class="indent" >   ¬†
                                                                                

                                                                                
</p><!--l. 5729--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">K   </span> <a 
 id="x1-90000K"></a>Modern view of gyrokinetic equation</h3>
<!--l. 5731--><p class="noindent" >Frimain-Chen equation was obtained by Ô¨Årst transforming to the guiding-center coordinates and then
using the classical perturbation expansion for the distribution function (to separate gyro-phase
independent part form the gyro-phase dependent one). Note that the guiding-center transform does not
involve the perturbed Ô¨Åeld.
</p><!--l. 5737--><p class="indent" >   The modern form of the nonlinear gyrokinetic equation is in the total-f form. This way of deriving
the gyrokinetic equation is to use coordinate transforms to eliminate gyro-phase dependence of the
total distribution function (rather than splitting the distribution function itself) and thus obtain an
equation for the resulting gyro-phase independent distribution function (called gyro-center distribution
function). The coordinate transform involves the perturbed Ô¨Åelds besides the equilibrium
Ô¨Åeld.
</p><!--l. 5745--><p class="indent" >   The resulting equation for the gyro-center distribution function is given by (see Baojian‚Äôs
paper)
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-90001r422"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation500x.png" alt="( ‚àÇ             ‚àÇ  )
  ‚àÇt +XÀô ‚ãÖ‚àá + vÀô‚à•‚àÇv-  f(X, v‚à•,Œº,t) = 0,
                 ‚à•
" class="math-display"  /></center></td><td class="equation-label">(422)</td></tr></table>
<!--l. 5751--><p class="nopar" >
where
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-90002r423"></a>
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation501x.png" alt="          e              ‚ü®Œ¥B  ‚ü©
ÀôR = VD + --‚à•√ó ‚ü®‚àá Œ¥Œ¶‚ü©Œ± + v‚à•--‚ä•-Œ±-
         B0                B0
" class="math-display"  /></center></td><td class="equation-label">(423)</td></tr></table>
<!--l. 5757--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-90003r424"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="nonlinear_gyrokinetic_equation502x.png" alt="      1-B-‚ãÜ                   q-‚àÇ‚ü®Œ¥A‚à•‚ü©Œ±
Àôv‚à• = ‚àí m B‚à•‚ãÜ‚ãÖ(q‚àá‚ü®Œ¥Œ¶‚ü©+ Œº‚àáB0 )‚àí m   ‚àÇt   .
" class="math-display"  /></center></td><td class="equation-label">(424)</td></tr></table>
<!--l. 5764--><p class="nopar" >
Here the independent variables are gyro-center position <span 
class="cmbx-10">X</span>, magnetic moment <span 
class="cmmi-10">Œº </span>and parallel velocity
<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">‚à•</span></sub>.
</p><!--l. 5768--><p class="indent" >   The gyro-phase dependence of the particle distribution can be recovered by the inverse
transformation of the transformation used before. The pull-back transformation (inverse gyro-center
transform) gives rise to the polarization density term. (phase-space-Lagrangian Lie perturbation
method (Littlejohn, 1982a, 1983), I need to read these two papers.).
</p><!--l. 5774--><p class="indent" >   The learning curve of modern Lie tansform gyrokinetic is steep: the name Lie transform itself is
already very scaring.
</p><!--l. 5777--><p class="indent" >   To derive the Frieman-Chen equation, you just need some patience.
</p><!--l. 5779--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">L   </span> <a 
 id="x1-91000L"></a>About this document</h3>
<!--l. 5781--><p class="noindent" >These notes were initially written when I visited University of Colorado at Boulder (Sept.-Nov. 2016),
where I worked with Dr. Yang Chen, who said that most gyrokinetic simulations essentially employ
Frieman-Chen‚Äôs nonlinear gyrokinetic equation. Therefore a careful re-derivation of the equation to get
familiar to the gyrokinetic orderings and physics included in the model is highly desirable, which
motivates me to write this note.
</p><!--l. 5788--><p class="indent" >   This document was written by using TeXmacs<span class="cite">[<a 
href="#Xtexmacs">5</a>]</span>, a structured wysiwyw (what you see is what you
want) editor for scientists. The HTML version of this document is generated by Ô¨Årst converting the
TeXmacs Ô¨Åle to TeX format and then using <span 
class="cmtt-10">htlatex</span> to convert the TeX Ô¨Åle to HTML
format.
</p><!--l. 5794--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-92000L"></a>References</h3>
<!--l. 5794--><p class="noindent" >
  </p><div class="thebibliography">
  <p class="bibitem" ><span class="biblabel">
<span 
class="cmr-9">[1]</span> <span class="bibsp"><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span></span></span><a 
 id="XCatto1978"></a><span 
class="cmr-9">P</span><span 
class="cmr-9">¬†J Catto. Linearized gyro-kinetics.</span> <span 
class="cmti-9">Plasma Physics</span><span 
class="cmr-9">, 20(7):719, 1978.</span>
  </p>
  <p class="bibitem" ><span class="biblabel">
<span 
class="cmr-9">[2]</span> <span class="bibsp"><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span></span></span><a 
 id="Xychen2009"></a><span 
class="cmr-9">Yang Chen and Scott</span><span 
class="cmr-9">¬†E.</span><span 
class="cmr-9">¬†Parker.  Particle-in-cell simulation with vlasov ions and drift kinetic</span>
  <span 
class="cmr-9">electrons.</span> <span 
class="cmti-9">Phys. Plasmas</span><span 
class="cmr-9">, 16:52305, 2009.</span>
                                                                                

                                                                                
  </p>
  <p class="bibitem" ><span class="biblabel">
<span 
class="cmr-9">[3]</span> <span class="bibsp"><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span></span></span><a 
 id="Xfrieman1982"></a><span 
class="cmr-9">E.</span><span 
class="cmr-9">¬†A.</span><span 
class="cmr-9">¬†Frieman and Liu Chen. Nonlinear gyrokinetic equations for low-frequency electromagnetic</span>
  <span 
class="cmr-9">waves in general plasma equilibria.</span> <span 
class="cmti-9">Physics of Fluids</span><span 
class="cmr-9">, 25(3):502‚Äì508, 1982.</span>
  </p>
  <p class="bibitem" ><span class="biblabel">
<span 
class="cmr-9">[4]</span> <span class="bibsp"><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span></span></span><a 
 id="XMISHCHENKO2019194"></a><span 
class="cmr-9">A.</span><span 
class="cmr-9">¬†Mishchenko,  A.</span><span 
class="cmr-9">¬†Bottino,  A.</span><span 
class="cmr-9">¬†Biancalani,  R.</span><span 
class="cmr-9">¬†Hatzky,  T.</span><span 
class="cmr-9">¬†Hayward-Schneider,  N.</span><span 
class="cmr-9">¬†Ohana,</span>
  <span 
class="cmr-9">E.</span><span 
class="cmr-9">¬†Lanti,  S.</span><span 
class="cmr-9">¬†Brunner,  L.</span><span 
class="cmr-9">¬†Villard,  M.</span><span 
class="cmr-9">¬†Borchardt,  R.</span><span 
class="cmr-9">¬†Kleiber,  and  A.</span><span 
class="cmr-9">¬†K</span><span 
class="cmr-9">√∂nies.   Pullback  scheme</span>
  <span 
class="cmr-9">implementation in orb5.</span> <span 
class="cmti-9">Computer Physics Communications</span><span 
class="cmr-9">, 238:194‚Äì202, 2019.</span>
  </p>
  <p class="bibitem" ><span class="biblabel">
<span 
class="cmr-9">[5]</span> <span class="bibsp"><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span><span 
class="cmr-9">¬†</span></span></span><a 
 id="Xtexmacs"></a><span 
class="cmr-9">Joris van der</span><span 
class="cmr-9">¬†Hoeven.  Gnu texmacs, a structured wysiwyw (what you see is what you want)</span>
  <span 
class="cmr-9">editor for scientists. </span><a 
href="http://www.texmacs.org/" class="url" ><span 
class="cmtt-9">http://www.texmacs.org/</span></a><span 
class="cmr-9">, 2007. [Online].</span></p></div>
    
</body></html> 

                                                                                


