<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Phase-space sampling and Phase space volume sampled by a marker</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="tmp.tex" /> 
<meta name="date" content="2019-01-24 14:36:00" /> 
<link rel="stylesheet" type="text/css" href="tmp.css" /> 
</head><body 
>
   <!--l. 121--><div class="crosslinks"><p class="noindent">[<a 
href="tmpsu3.html" >next</a>] [<a 
href="#tailtmpsu2.html">tail</a>] [<a 
href="tmpse2.html#tmpsu2.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x5-40002.1"></a>Phase-space sampling and Phase space volume sampled by a marker</h4>
<!--l. 123--><p class="noindent" >Suppose the phase space <span 
class="cmbx-10">Z</span> = (<span 
class="cmbx-10">r</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span>) is described by general curvlinear coordinates (<span 
class="cmmi-10">&alpha;,&beta;,&gamma;,v</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&gamma;</span></sub>). Given a probability
density function <span 
class="cmmi-10">P </span>= <span 
class="cmmi-10">P</span>(<span 
class="cmmi-10">&alpha;,&beta;,&gamma;,v</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&gamma;</span></sub>) that satisÔ¨Åes the following normalization condition
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4001r1"></a>
   <center class="math-display" >
<img 
src="tmp0x.png" alt="&int;
  P dV = 1,
 &Omega;
" class="math-display"  /></center></td><td class="equation-label">(1)</td></tr></table>
<!--l. 130--><p class="nopar" >
where &Omega; is the phase space region of interest, <span 
class="cmmi-10">dV </span>is the phase-space volume element. In terms of the (<span 
class="cmmi-10">&alpha;,&beta;,&gamma;,v</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&gamma;</span></sub>)
coordinates, <span 
class="cmmi-10">dV </span>is given by <span 
class="cmmi-10">dV </span>= <span 
class="cmsy-10">|ùí•</span><sub><span 
class="cmmi-7">r</span></sub><span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">v</span></sub><span 
class="cmsy-10">|</span><span 
class="cmmi-10">d&alpha;d&beta;d&gamma;dv</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmmi-7">&gamma;</span></sub>, where <span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">r</span></sub> is the Jacobian of transformation from Cartesian
space coordinates (<span 
class="cmmi-10">x,y,z</span>) to curvlinear coordinates (<span 
class="cmmi-10">&alpha;,&beta;,&gamma;</span>), and <span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">v</span></sub> is the Jacobian of transformation from Cartesian
velocity coordinates (<span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">x</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">y</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">z</span></sub>) to curvlinear coordinates (<span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&gamma;</span></sub>). Using this, the normalization condition (<a 
href="#x5-4001r1">1<!--tex4ht:ref: 18-9-20-p1 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4002r2"></a>

   <center class="math-display" >
<img 
src="tmp1x.png" alt="&int;

 &Omega;P |ùí•r ùí•v|d&alpha;d&beta;d &gamma;dv&alpha;dv&beta;dv&gamma; = 1.
" class="math-display"  /></center></td><td class="equation-label">(2)</td></tr></table>
<!--l. 144--><p class="nopar" >
Use this probability density function to sample the phase space region &Omega; with <span 
class="cmmi-10">N </span>markers, then the marker distribution
function <span 
class="cmmi-10">g </span>is given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4003r3"></a>
   <center class="math-display" >
<img 
src="tmp2x.png" alt="g = N √ó P.
" class="math-display"  /></center></td><td class="equation-label">(3)</td></tr></table>
<!--l. 150--><p class="nopar" >
The deÔ¨Ånition of <span 
class="cmmi-10">g </span>implies that the number of markers within a small volume of phase-space <span 
class="cmmi-10">dV </span>is given
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4004r4"></a>
   <center class="math-display" >
<img 
src="tmp3x.png" alt="dN  = gdV = g|ùí•rùí•v |d&alpha;d&beta;d &gamma;dv&alpha;dv&beta;dv&gamma;.
" class="math-display"  /></center></td><td class="equation-label">(4)</td></tr></table>
<!--l. 156--><p class="nopar" >
Therefore the average phase space volume occupied (or sampled) by a marker, <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">p</span></sub>, is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4005r5"></a>
   <center class="math-display" >
<img 
src="tmp4x.png" alt="     dV    1
Vp &equiv; dN-=  g.

" class="math-display"  /></center></td><td class="equation-label">(5)</td></tr></table>
<!--l. 161--><p class="nopar" >
In practical numerical implementation in a curvlinear coordinate system, I prefer to deÔ¨Åne <span 
class="cmmi-10">P</span><span 
class="cmsy-10">&prime; </span>and <span 
class="cmmi-10">g</span><span 
class="cmsy-10">&prime; </span>by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4006r6"></a>
   <center class="math-display" >
<img 
src="tmp5x.png" alt="P &prime; = P|ùí•rùí•v|,
" class="math-display"  /></center></td><td class="equation-label">(6)</td></tr></table>
<!--l. 166--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4007r7"></a>
   <center class="math-display" >
<img 
src="tmp6x.png" alt=" &prime;
g = g|ùí•rùí•v |,
" class="math-display"  /></center></td><td class="equation-label">(7)</td></tr></table>
<!--l. 170--><p class="nopar" >
where I explicitly include the coordinates transform Jacobian in the deÔ¨Ånition of <span 
class="cmmi-10">P</span><span 
class="cmsy-10">&prime; </span>and <span 
class="cmmi-10">g</span><span 
class="cmsy-10">&prime;</span>. Then equation (<a 
href="#x5-4001r1">1<!--tex4ht:ref: 18-9-20-p1 --></a>) is written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4008r8"></a>
   <center class="math-display" >
<img 
src="tmp7x.png" alt="&int;
   P&prime;d&alpha;d&beta;d&gamma;dv dv dv  = 1,
 &Omega;           &alpha;  &beta;  &gamma;
" class="math-display"  /></center></td><td class="equation-label">(8)</td></tr></table>
<!--l. 176--><p class="nopar" >
equation (<a 
href="#x5-4003r3">3<!--tex4ht:ref: 18-10-27-p1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4009r9"></a>

   <center class="math-display" >
<img 
src="tmp8x.png" alt="g&prime; = N √ó P&prime;,
" class="math-display"  /></center></td><td class="equation-label">(9)</td></tr></table>
<!--l. 180--><p class="nopar" >
and the number of particle within the phase-space element <span 
class="cmmi-10">d&alpha;d&beta;d&gamma;dv</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">dv</span><sub><span 
class="cmmi-7">&gamma;</span></sub> is given by
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4010r10"></a>
   <center class="math-display" >
<img 
src="tmp9x.png" alt="dN = g&prime;d&alpha;d&beta;d&gamma;dv&alpha;dv&beta;dv&gamma;
" class="math-display"  /></center></td><td class="equation-label">(10)</td></tr></table>
<!--l. 185--><p class="nopar" >
i.e., <span 
class="cmmi-10">P</span><span 
class="cmsy-10">&prime; </span>and <span 
class="cmmi-10">g</span><span 
class="cmsy-10">&prime; </span>act respectively like a probability density function and distribution function in terms of variables
(<span 
class="cmmi-10">&alpha;,&beta;,&gamma;,v</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&gamma;</span></sub>) with the Jacobian equal to unity (i.e., <span 
class="cmmi-10">&alpha;,&beta;,&beta;,v</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&gamma;</span></sub> act as Cartesian coordinates). The reason I do
this is as follows. In many simulations, markers are required to be loaded directly in (<span 
class="cmmi-10">&alpha;,&beta;,&gamma;,v</span><sub><span 
class="cmmi-7">&alpha;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&beta;</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">&gamma;</span></sub>) coordinates, i.e.,
these coordinates are directly sampled. Then working in terms of <span 
class="cmmi-10">P</span><span 
class="cmsy-10">&prime; </span>and <span 
class="cmmi-10">g</span><span 
class="cmsy-10">&prime; </span>is more intuitive to me. In terms of <span 
class="cmmi-10">g</span><span 
class="cmsy-10">&prime;</span>, the
average phase space volume occupied by a marker is now written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-4011r11"></a>
   <center class="math-display" >
<img 
src="tmp10x.png" alt="     |ùí• ùí• |
Vp = -r&prime;v-.
      g
" class="math-display"  /></center></td><td class="equation-label">(11)</td></tr></table>
<!--l. 198--><p class="nopar" >
The methods of generating random numbers satisfying a given probability density function are discussed in Sec.
<a 
href="tmpse7.html#x40-450007">7<!--tex4ht:ref: 10-11-e1 --></a>.
</p><!--l. 202--><p class="indent" >   If we use Cartesian coordinates (<span 
class="cmmi-10">x,y,z,v</span><sub><span 
class="cmmi-7">x</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">y</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmmi-7">z</span></sub>) to describe the phase space, then it is obvious that <span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">r</span></sub> = 1 and
<span 
class="cmsy-10">ùí•</span><sub><span 
class="cmmi-7">v</span></sub> = 1.
</p><!--l. 206--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x5-50002.1.1"></a>Time evolution of phase-space volume occupied by a marker</h5>
<!--l. 208--><p class="noindent" >Evaluate <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">p</span></sub> at the initial location of each marker and then assign this value, <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span><span 
class="cmr-7">0</span></sub>, to the corresponding marker,
i.e.,
</p>

   <table 
class="equation"><tr><td><a 
 id="x5-5001r12"></a>
   <center class="math-display" >
<img 
src="tmp11x.png" alt="Vpj0 = ----1----= |ùí•r(rj0&prime;)ùí•v(rj0,vj0)|,
      g(rj0,vj0)      g (rj0,vj0)
" class="math-display"  /></center></td><td class="equation-label">(12)</td></tr></table>
<!--l. 214--><p class="nopar" >
where <span 
class="cmbx-10">r</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">0</span></sub> and <span 
class="cmbx-10">v</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">0</span></sub> are the initial coordinates of the <span 
class="cmmi-10">j</span> th markers.
</p><!--l. 218--><p class="indent" >   Further note that any particle distribution function <span 
class="cmmi-10">g </span>in any non-relativistic continuous electromagnetic Ô¨Åeld evolves as
<span 
class="cmmi-10">dg‚àïdt </span>= 0, where <span 
class="cmmi-10">d‚àïdt </span>is the convective derivative in the phase space, i.e., the distribution function is constant along a
characteristic line. Since <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">p</span></sub> = 1<span 
class="cmmi-10">‚àïg</span>, it follows that,
</p>
   <table 
class="equation"><tr><td><a 
 id="x5-5002r13"></a>
   <center class="math-display" >
<img 
src="tmp12x.png" alt=" d
--(Vpj) = 0,
dt
" class="math-display"  /></center></td><td class="equation-label">(13)</td></tr></table>
<!--l. 225--><p class="nopar" >
Therefore, <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span></sub> associated with a marker at later time is always equal to the volume initially assigned to it, i.e., <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span></sub> = <span 
class="cmmi-10">V</span> <sub><span 
class="cmmi-7">pj</span><span 
class="cmr-7">0</span></sub>.
This is assumed in most collisionless PIC simulation codes and related to the issue of discrete particle noise. In practical
simulation, we use Ô¨Ånite number rather than inÔ¨Ånite number of markers to represent the marker distribution function
<span 
class="cmmi-10">g</span>. Due to this reason (the so-called discrete particle eÔ¨Äect), <span 
class="cmmi-10">dg</span><sub><span 
class="cmr-7">numerical</span></sub><span 
class="cmmi-10">‚àïdt </span>is never exactly zero. We can
examine how accurate <span 
class="cmmi-10">dg</span><sub><span 
class="cmr-7">numerical</span></sub><span 
class="cmmi-10">‚àïdt </span><span 
class="cmsy-10">&asymp; </span>0 is by numerically count the number of markers &Delta;<span 
class="cmmi-10">N </span>in a small phase
volume &Delta;<span 
class="cmmi-10">V </span>around a marker and examining the evolution of &Delta;<span 
class="cmmi-10">N‚àï</span>&Delta;<span 
class="cmmi-10">V </span>. Some choices of the initial state
<span 
class="cmmi-10">g</span>(<span 
class="cmbx-10">x</span><span 
class="cmmi-10">,</span><span 
class="cmbx-10">v</span><span 
class="cmmi-10">,t </span>= 0) can make <span 
class="cmmi-10">d</span>(&Delta;<span 
class="cmmi-10">N‚àï</span>&Delta;<span 
class="cmmi-10">V </span>)<span 
class="cmmi-10">‚àïdt </span>smaller and thus reduce the noise introduced by the discrete particle
eÔ¨Äect.

</p>
   <!--l. 240--><div class="crosslinks"><p class="noindent">[<a 
href="tmpsu3.html" >next</a>] [<a 
href="tmpsu2.html" >front</a>] [<a 
href="tmpse2.html#tmpsu2.html" >up</a>] </p></div>
<!--l. 240--><p class="indent" >   <a 
 id="tailtmpsu2.html"></a>  </p> 
</body></html> 
