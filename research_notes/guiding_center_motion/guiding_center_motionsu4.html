<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Equilibrium magnetic ﬁeld in tokamak</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="guiding_center_motion.tex" /> 
<meta name="date" content="2019-01-05 20:39:00" /> 
<link rel="stylesheet" type="text/css" href="guiding_center_motion.css" /> 
</head><body 
>
   <!--l. 708--><div class="crosslinks"><p class="noindent">[<a 
href="guiding_center_motionsu5.html" >next</a>] [<a 
href="guiding_center_motionsu3.html" >prev</a>] [<a 
href="guiding_center_motionsu3.html#tailguiding_center_motionsu3.html" >prev-tail</a>] [<a 
href="#tailguiding_center_motionsu4.html">tail</a>] [<a 
href="guiding_center_motionse1.html#guiding_center_motionsu4.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">1.4   </span> <a 
 id="x6-70001.4"></a>Equilibrium magnetic ﬁeld in tokamak</h4>
<!--l. 710--><p class="noindent" >The tokamak equilbrium magnetic ﬁeld can be written
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7001r54"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion66x.png" alt="B = &nabla; &Psi;× &nabla; ϕ +g(&Psi; )&nabla; ϕ.
" class="math-display"  /></center></td><td class="equation-label">(54)</td></tr></table>
<!--l. 714--><p class="nopar" >
In my code, the values of the two free functions, &Psi; = &Psi;(<span 
class="cmmi-10">R,Z</span>) and <span 
class="cmmi-10">g</span>(&Psi;), which sepcify the magnetic ﬁeld,
is read from the output ﬁle “G-eqdsk-ﬁle” of EFIT code. Using Eq. (<a 
href="#x6-7001r54">54<!--tex4ht:ref: 10-28-e1 --></a>), the axisymmetric equilibrium
magnetic ﬁeld can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7002r55"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion67x.png" alt="       1&part; &Psi;
BR = &minus; ----,
       R &part;Z
" class="math-display"  /></center></td><td class="equation-label">(55)</td></tr></table>
<!--l. 721--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7003r56"></a>
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion68x.png" alt="B   = 1-&part;&Psi;-,
  Z   R &part;R
" class="math-display"  /></center></td><td class="equation-label">(56)</td></tr></table>
<!--l. 724--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7004r57"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion69x.png" alt="B  = g(&Psi;).
 ϕ    R
" class="math-display"  /></center></td><td class="equation-label">(57)</td></tr></table>
<!--l. 727--><p class="nopar" >
The partial derivative of the component of the magnetic ﬁeld is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7005r58"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion70x.png" alt="&part;BR-   1-&part;&Psi;-   1-&part;2&Psi;---
&part;R  =  R2&part;Z  &minus; R &part;Z&part;R
" class="math-display"  /></center></td><td class="equation-label">(58)</td></tr></table>
<!--l. 733--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7006r59"></a>
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion71x.png" alt="&part;BR-    1-&part;2&Psi;-
 &part;Z = &minus; R &part;Z2
" class="math-display"  /></center></td><td class="equation-label">(59)</td></tr></table>
<!--l. 737--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7007r60"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion72x.png" alt="&part;BZ-    -1-&part;&Psi;-  -1&part;2&Psi;-
&part;R  = &minus; R2 &part;R + R &part;R2
" class="math-display"  /></center></td><td class="equation-label">(60)</td></tr></table>
<!--l. 741--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7008r61"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion73x.png" alt="&part;BZ-   1-&part;2&Psi;---
&part;Z  =  R &part;R&part;Z
" class="math-display"  /></center></td><td class="equation-label">(61)</td></tr></table>
<!--l. 745--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7009r62"></a>
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion74x.png" alt="&part;Bϕ-= &minus; 1-g(&Psi;) + 1g&prime;(&Psi;)&part;&Psi;-
&part;R      R2       R     &part;R
" class="math-display"  /></center></td><td class="equation-label">(62)</td></tr></table>
<!--l. 750--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7010r63"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion75x.png" alt="&part;B-ϕ=  1g&prime;(&Psi; )&part;&Psi;-
&part;Z     R     &part;Z
" class="math-display"  /></center></td><td class="equation-label">(63)</td></tr></table>
<!--l. 754--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-7011r64"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion76x.png" alt="        ∘ --------------------
       1  ( &part;&Psi;)2   ( &part;&Psi;)2
&rArr; B = R-    &part;R-  +   &part;Z-  + g2
" class="math-display"  /></center></td><td class="equation-label">(64)</td></tr></table>
<!--l. 761--><p class="nopar" >
</p>
   <div class="eqnarray">
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion77x.png" alt="                         (                            )
&part;B-  =  &minus; -1-BR + -11 -1-- 2&part;&Psi;-&part;2&Psi;-+ 2&part;&Psi;--&part;2&Psi;--+ 2g &part;g
&part;R        R2      R 2 BR    &part;R &part;R2    &part;Z &part;Z &part;R     &part;R
          B     1  ( &part;&Psi; &part;2&Psi;   &part;&Psi;  &part;2&Psi;     &part;g )
     =  &minus; R-+ BR2-   &part;R-&part;R2-+ &part;Z-&part;Z&part;R--+ g&part;R-                    (65)
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion78x.png" alt="               (                            )
&part;B-     -11 -1--  &part;&Psi;--&part;2&Psi;--   &part;&Psi;-&part;2&Psi;-    &part;g-
&part;Z   =  R 2 BR   2&part;R &part;R &part;Z + 2&part;Z &part;Z2 + 2g&part;Z
          1  ( &part;&Psi; &part;2&Psi;     &part;&Psi; &part;2&Psi;    &part;g )
     =  ---2   --------+  -----2-+ g---                     (66)
        BR     &part;R &part;R&part;Z    &part;Z &part;Z     &part;Z
" class="math-display"  /></center>
</div>
<!--l. 787--><p class="indent" >   In my numerical code, the numerical data of the poloidal ﬂux function &Psi;(<span 
class="cmmi-10">R,Z</span>) and toroidal ﬁeld
function <span 
class="cmmi-10">g</span>(&Psi;) are read in from the output G-eqdsk ﬁle of the EFIT code. Then all the partial derivatives
are calculated by using central ﬁnite-diﬀerence. Then the linear interpolation is used to evaluate the
various quantities that are needed at the instantenous location of guiding-centers to push the
orbits.
</p><!--l. 794--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">1.4.1   </span> <a 
 id="x6-80001.4.1"></a>Solovév equilibrium</h5>
<!--l. 796--><p class="noindent" >When I began to write the guiding center orbit code, in order to avoid the numerical interpolating, I use
Solovev&#x2019;s analytic equilibrium. (The latest version of my code constructs magnetic ﬁeld by reading the
output G-eqdsk ﬁle of the EFIT code and thus can treat general tokamak magnetic ﬁeld.) The
Solovév equilibrium is an analytic equilibrium in which the poloidal ﬂux function &Psi; is given
by
                                                                                  
                                                                                  
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-8001r67"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion79x.png" alt="            [        2         ]
&Psi; = ---B20--  R2Z2 + &kappa;0(R2 &minus; R20)2 ,
    2R 0&kappa;0q0          4
" class="math-display"  /></center></td><td class="equation-label">(67)</td></tr></table>
<!--l. 805--><p class="nopar" >
where <span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>, <span 
class="cmmi-10">R</span><sub><span 
class="cmr-7">0</span></sub>, <span 
class="cmmi-10">&kappa;</span><sub><span 
class="cmr-7">0</span></sub>, <span 
class="cmmi-10">q</span><sub><span 
class="cmr-7">0</span></sub> are constant parameters. Using Eq. (<a 
href="#x6-8001r67">67<!--tex4ht:ref: 11-21-p1 --></a>), the partial derivatives are written
as
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-8002r68"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion80x.png" alt="&part;&Psi;      B                         &part;&Psi;     B
---=  --20---[2RZ2 + &kappa;20(R2 &minus; R20)R],---= --2-0- R2Z.
&part;R    2R0&kappa;0q0                     &part;Z   R 0&kappa;0q0
" class="math-display"  /></center></td><td class="equation-label">(68)</td></tr></table>
<!--l. 812--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-8003r69"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion81x.png" alt="&part;2&Psi;      B
---2 = --20---[2Z2 + &kappa;20(3R2 &minus; R20)]
&part;R     2R 0&kappa;0q0
                                                                                  
                                                                                  
" class="math-display"  /></center></td><td class="equation-label">(69)</td></tr></table>
<!--l. 817--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-8004r70"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion82x.png" alt=" 2                2
&part;-&Psi;2 = -B20---R2,-&part;-&Psi;--= --22B0- RZ
&part;Z     R0&kappa;0q0   &part;R &part;Z   R 0&kappa;0q0
" class="math-display"  /></center></td><td class="equation-label">(70)</td></tr></table>
<!--l. 822--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-8005r71"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion83x.png" alt="
" class="math-display"  /></center></td><td class="equation-label">(71)</td></tr></table>
<!--l. 825--><p class="nopar" >
The toroidal ﬁeld function <span 
class="cmmi-10">g </span>is a constant function, <span 
class="cmmi-10">g </span>= <span 
class="cmmi-10">c</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">R</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub>, where <span 
class="cmmi-10">c</span><sub><span 
class="cmmi-7">g</span></sub> is a dimensionless
constant.
                                                                                  
                                                                                  
</p>
   <!--l. 829--><div class="crosslinks"><p class="noindent">[<a 
href="guiding_center_motionsu5.html" >next</a>] [<a 
href="guiding_center_motionsu3.html" >prev</a>] [<a 
href="guiding_center_motionsu3.html#tailguiding_center_motionsu3.html" >prev-tail</a>] [<a 
href="guiding_center_motionsu4.html" >front</a>] [<a 
href="guiding_center_motionse1.html#guiding_center_motionsu4.html" >up</a>] </p></div>
<!--l. 829--><p class="indent" >   <a 
 id="tailguiding_center_motionsu4.html"></a>  </p> 
</body></html> 
