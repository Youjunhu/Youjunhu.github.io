<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Equilibrium magnetic ﬁeld in tokamak</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="guiding_center_motion.tex" /> 
<link rel="stylesheet" type="text/css" href="guiding_center_motion.css" /> 
</head><body 
>
   <!--l. 2119--><div class="crosslinks"><p class="noindent"><span 
class="ecrm-1000">[</span><a 
href="#tailguiding_center_motionsu16.html"><span 
class="ecrm-1000">tail</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motionse8.html#guiding_center_motionsu16.html" ><span 
class="ecrm-1000">up</span></a><span 
class="ecrm-1000">] </span></p></div>
   <h4 class="subsectionHead"><span class="titlemark"><span 
class="ecrm-1000">8.1   </span></span> <a 
 id="x25-270008.1"></a><span 
class="ecrm-1000">Equilibrium magnetic ﬁeld in tokamak</span></h4>
<!--l. 2121--><p class="noindent" ><span 
class="ecrm-1000">The tokamak equilbrium magnetic ﬁeld can be written</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27001r154"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion205x.png" alt="B = ∇Ψ × ∇ ϕ+ g(Ψ)∇ ϕ.
" class="math-display"  /></center></td><td class="equation-label">(154)</td></tr></table>
<!--l. 2125--><p class="nopar" >
<span 
class="ecrm-1000">In my code, the values of the two free functions, </span>Ψ = Ψ(<span 
class="cmmi-10">R,Z</span>) <span 
class="ecrm-1000">and </span><span 
class="cmmi-10">g</span>(Ψ)<span 
class="ecrm-1000">, which sepcify the magnetic</span>
<span 
class="ecrm-1000">ﬁeld, is read from the output ﬁle “G-eqdsk-ﬁle” of EFIT code. Using Eq. (</span><a 
href="#x25-27001r154"><span 
class="ecrm-1000">154</span><!--tex4ht:ref: 10-28-e1 --></a><span 
class="ecrm-1000">), the axisymmetric</span>
<span 
class="ecrm-1000">equilibrium magnetic ﬁeld can be written as</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27002r155"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion206x.png" alt="      -1∂Ψ-
BR = −R ∂Z ,
" class="math-display"  /></center></td><td class="equation-label">(155)</td></tr></table>
<!--l. 2132--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27003r156"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion207x.png" alt="      1-∂Ψ-
BZ =  R ∂R,
" class="math-display"  /></center></td><td class="equation-label">(156)</td></tr></table>
<!--l. 2135--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27004r157"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion208x.png" alt="     g(Ψ)
Bϕ = ----.
      R
" class="math-display"  /></center></td><td class="equation-label">(157)</td></tr></table>
<!--l. 2138--><p class="nopar" >
<span 
class="ecrm-1000">The partial derivative of the component of the magnetic ﬁeld is written as</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27005r158"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion209x.png" alt="                  2
∂BR-= -12 ∂Ψ-− 1-∂-Ψ--
∂R    R  ∂Z    R∂Z ∂R
" class="math-display"  /></center></td><td class="equation-label">(158)</td></tr></table>
<!--l. 2144--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27006r159"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion210x.png" alt="           2
∂BR-= − 1-∂-Ψ2
∂Z      R ∂Z
" class="math-display"  /></center></td><td class="equation-label">(159)</td></tr></table>
<!--l. 2148--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27007r160"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion211x.png" alt="                   2
∂BZ-= − -12-∂Ψ-+ 1-∂-Ψ2
∂R      R  ∂R   R ∂R
" class="math-display"  /></center></td><td class="equation-label">(160)</td></tr></table>
<!--l. 2152--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27008r161"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion212x.png" alt="          2
∂BZ-= -1-∂-Ψ--
∂Z    R ∂R ∂Z
" class="math-display"  /></center></td><td class="equation-label">(161)</td></tr></table>
<!--l. 2156--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27009r162"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion213x.png" alt="∂B      1        1     ∂Ψ
--ϕ-= − -2g(Ψ) + -g′(Ψ)---
∂R      R        R     ∂R
" class="math-display"  /></center></td><td class="equation-label">(162)</td></tr></table>
<!--l. 2161--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27010r163"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion214x.png" alt="∂B     1     ∂Ψ
--ϕ-= --g′(Ψ )---
∂Z    R      ∂Z
" class="math-display"  /></center></td><td class="equation-label">(163)</td></tr></table>
<!--l. 2165--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-27011r164"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion215x.png" alt="         ∘ (---)2---(---)2-----
⇒  B = 1-   ∂-Ψ   +  ∂-Ψ   + g2
       R    ∂R        ∂Z
" class="math-display"  /></center></td><td class="equation-label">(164)</td></tr></table>
<!--l. 2172--><p class="nopar" >
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion216x.png" alt="                         (      2          2          )
∂B-  =  − -1-BR + 1-1--1- 2 ∂Ψ-∂-Ψ-+ 2∂Ψ--∂-Ψ--+ 2g ∂g
∂R        R2      R(2BR     ∂R ∂R2    ∂Z ∂Z∂R)      ∂R
          B-  --1-  ∂-Ψ∂2Ψ-   ∂Ψ--∂2Ψ--   ∂g-
     =  − R + BR2   ∂R ∂R2  + ∂Z ∂Z∂R  +g ∂R                   (165)
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion217x.png" alt="∂B       11  1 (  ∂Ψ  ∂2Ψ     ∂Ψ ∂2Ψ     ∂g )
∂Z-  =  R-2 BR-- 2∂R-∂R∂Z--+ 2∂Z-∂Z2-+ 2g∂Z-
             (     2          2       )
     =  --1-  ∂-Ψ-∂-Ψ--+ ∂Ψ-∂-Ψ- +g ∂g-                   (166)
        BR2   ∂R ∂R ∂Z   ∂Z ∂Z2     ∂Z
" class="math-display"  /></center>
</div>
<!--l. 2198--><p class="indent" >   <span 
class="ecrm-1000">In my numerical code, the numerical data of the poloidal ﬂux function </span>Ψ(<span 
class="cmmi-10">R,Z</span>) <span 
class="ecrm-1000">and toroidal ﬁeld</span>
<span 
class="ecrm-1000">function </span><span 
class="cmmi-10">g</span>(Ψ) <span 
class="ecrm-1000">are read in from the output G-eqdsk ﬁle of the EFIT code. Then all the partial</span>
<span 
class="ecrm-1000">derivatives are calculated by using central ﬁnite-diﬀerence. The linear interpolation is used to evaluate</span>
<span 
class="ecrm-1000">the various quantities that are needed at the instantenous location of guiding-centers to push the</span>
<span 
class="ecrm-1000">orbits.</span>
</p><!--l. 2205--><p class="indent" >   <span 
class="ecrm-1000"> </span>
</p><!--l. 2207--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark"><span 
class="ecrm-1000">8.1.1   </span></span> <a 
 id="x25-280008.1.1"></a><span 
class="ecrm-1000">Solov</span><span 
class="ecrm-1000">év equilibrium</span></h5>
<!--l. 2209--><p class="noindent" ><span 
class="ecrm-1000">When I began to write the guiding center orbit code, in order to avoid the numerical interpolating, I</span>
<span 
class="ecrm-1000">use Solovev’s analytic equilibrium. (The latest version of my code constructs magnetic ﬁeld by reading</span>
<span 
class="ecrm-1000">the output G-eqdsk ﬁle of the EFIT code and thus can treat general tokamak magnetic ﬁeld.) The</span>
<span 
class="ecrm-1000">Solov</span><span 
class="ecrm-1000">év equilibrium is an analytic equilibrium in which the poloidal ﬂux function </span>Ψ <span 
class="ecrm-1000">is given</span>
<span 
class="ecrm-1000">by</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-28001r167"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion218x.png" alt="            [                  ]
Ψ = ---B0--  R2Z2 + κ20(R2 − R2 )2 ,
    2R20κ0q0         4        0
" class="math-display"  /></center></td><td class="equation-label">(167)</td></tr></table>
<!--l. 2218--><p class="nopar" >
<span 
class="ecrm-1000">where </span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub><span 
class="ecrm-1000">, </span><span 
class="cmmi-10">R</span><sub><span 
class="cmr-7">0</span></sub><span 
class="ecrm-1000">, </span><span 
class="cmmi-10">κ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="ecrm-1000">, </span><span 
class="cmmi-10">q</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="ecrm-1000">are constant parameters. Using Eq. (</span><a 
href="#x25-28001r167"><span 
class="ecrm-1000">167</span><!--tex4ht:ref: 11-21-p1 --></a><span 
class="ecrm-1000">), the partial derivatives are written</span>
<span 
class="ecrm-1000">as</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-28002r168"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion219x.png" alt="∂Ψ      B                         ∂Ψ     B
---= ---20-- [2RZ2 + κ20(R2 − R20)R],---= --2-0-R2Z.
∂R   2R 0κ0q0                     ∂Z   R 0κ0q0
" class="math-display"  /></center></td><td class="equation-label">(168)</td></tr></table>
<!--l. 2225--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-28003r169"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion220x.png" alt="∂2Ψ      B
---2 =---20-- [2Z2 + κ20(3R2 − R20)]
∂R    2R 0κ0q0
" class="math-display"  /></center></td><td class="equation-label">(169)</td></tr></table>
<!--l. 2230--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-28004r170"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion221x.png" alt="∂2Ψ     B        ∂2Ψ      2B
---2 = -2-0--R2,------= --2-0-RZ
∂Z     R0κ0q0   ∂R ∂Z   R 0κ0q0
" class="math-display"  /></center></td><td class="equation-label">(170)</td></tr></table>
<!--l. 2235--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x25-28005r171"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion222x.png" alt="
" class="math-display"  /></center></td><td class="equation-label">(171)</td></tr></table>
<!--l. 2238--><p class="nopar" >
<span 
class="ecrm-1000">The toroidal ﬁeld function </span><span 
class="cmmi-10">g </span><span 
class="ecrm-1000">is a constant function, </span><span 
class="cmmi-10">g </span>= <span 
class="cmmi-10">c</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">R</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub><span 
class="ecrm-1000">, where </span><span 
class="cmmi-10">c</span><sub><span 
class="cmmi-7">g</span></sub> <span 
class="ecrm-1000">is a dimensionless</span>
<span 
class="ecrm-1000">constant.</span>
                                                                                

                                                                                
</p>
   <!--l. 2242--><div class="crosslinks"><p class="noindent"><span 
class="ecrm-1000">[</span><a 
href="guiding_center_motionsu16.html" ><span 
class="ecrm-1000">front</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motionse8.html#guiding_center_motionsu16.html" ><span 
class="ecrm-1000">up</span></a><span 
class="ecrm-1000">] </span></p></div>
<!--l. 2242--><p class="indent" >   <a 
 id="tailguiding_center_motionsu16.html"></a>  </p> 
</body></html> 
