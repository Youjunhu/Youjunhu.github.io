<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Equation of guding-center motion in Ô¨Åeld-line-following coordinates</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="guiding_center_motion.tex" /> 
<meta name="date" content="2019-01-05 20:39:00" /> 
<link rel="stylesheet" type="text/css" href="guiding_center_motion.css" /> 
</head><body 
>
   <!--l. 174--><div class="crosslinks"><p class="noindent">[<a 
href="guiding_center_motionsu3.html" >next</a>] [<a 
href="guiding_center_motionsu1.html" >prev</a>] [<a 
href="guiding_center_motionsu1.html#tailguiding_center_motionsu1.html" >prev-tail</a>] [<a 
href="#tailguiding_center_motionsu2.html">tail</a>] [<a 
href="guiding_center_motionse1.html#guiding_center_motionsu2.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">1.2   </span> <a 
 id="x4-30001.2"></a>Equation of guding-center motion in Ô¨Åeld-line-following coordinates</h4>
<!--l. 176--><p class="noindent" >This section documents what I did when developing the fully kinetic ions and drift-kinetic electrons
module in GEM code which uses Ô¨Åeld-line-folloiwng coordinates. In Ô¨Åeld-line-following coordinates
(<span 
class="cmmi-10">&psi;,ùúÉ,&alpha;</span>), the equation of guiding-center drift is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3001r13"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion12x.png" alt="d&psi;-= vd &sdot;&nabla;-&psi;,
dt
" class="math-display"  /></center></td><td class="equation-label">(13)</td></tr></table>
<!--l. 183--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3002r14"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion13x.png" alt="dùúÉ = vd &sdot;&nabla;-ùúÉ,
dt
" class="math-display"  /></center></td><td class="equation-label">(14)</td></tr></table>
<!--l. 187--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3003r15"></a>
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion14x.png" alt="d&alpha;-= v-&sdot;&nabla;-&alpha;,
dt    d
" class="math-display"  /></center></td><td class="equation-label">(15)</td></tr></table>
<!--l. 192--><p class="nopar" >
where <span 
class="cmmi-10">&alpha; </span>is the generalized toroidal angle deÔ¨Åned by (refer to my notes on tokamak equilibrium) <span 
class="cmmi-10">&alpha; </span>= <span 
class="cmmi-10">œï</span><span 
class="cmsy-10">&minus;</span><span class="overline"><span 
class="cmmi-10">&delta;</span></span>
with <span class="overline"><span 
class="cmmi-10">&delta;</span></span> = <span 
class="cmex-10">&int;</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ùúÉ</span></sup><img 
src="guiding_center_motion15x.png" alt="ÀÜq"  class="circ"  /> <span 
class="cmmi-10">dùúÉ </span>and <img 
src="guiding_center_motion16x.png" alt="ÀÜq"  class="circ"  /> = <span 
class="cmbx-10">B </span><span 
class="cmsy-10">&sdot;&nabla;</span><span 
class="cmmi-10">œï‚àï</span>(<span 
class="cmbx-10">B </span><span 
class="cmsy-10">&sdot;&nabla;</span><span 
class="cmmi-10">ùúÉ</span>), which is the local safety factor. Using the expression of <span class="overline"><span 
class="cmbx-10">v</span></span><sub><span 
class="cmmi-7">d</span></sub>
given by Eq. (<a 
href="guiding_center_motionsu1.html#x3-2002r9">9<!--tex4ht:ref: 18-3-29-p1 --></a>), the right-hand-sides of Eqs. (<a 
href="#x4-3001r13">13<!--tex4ht:ref: 17-8-21-p1 --></a>)-(<a 
href="#x4-3003r15">15<!--tex4ht:ref: 17-8-21-p3 --></a>) to can be written as (presently dropping the <span 
class="cmbx-10">E</span><span 
class="cmsy-10">√ó</span><span 
class="cmbx-10">B</span>
drift): </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion17x.png" alt="                      ----
--  --      -       Z|Z|v2‚à•&pi;&nabla; √ó b       --    Z            &mu;-           1 -- ---- --
vd &sdot;&nabla;&psi;  =   v‚à•--(----Z--v‚à•---------)-&sdot;&nabla; &psi; + |Z-|--(----Z-- v‚à•-------)--2-B √ó&nabla; B &sdot;&nabla;(&psi;1,6)
              B  1+ |Z|2&pi;Bb &sdot;&nabla; √ó b           2&pi; 1 + |Z |2&pi;B b&sdot;&nabla; √ó b  B
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion18x.png" alt="                 --     v‚à•-
-- --      - ----B-+-Z|Z|2&pi;&nabla;-√ó-b----- --   Z------------&mu;-----------1---  ---- --
vd &sdot;&nabla; ùúÉ =  v‚à•B-(1+  Z--v‚à•b &sdot;&nabla;-√ó b) &sdot;&nabla;ùúÉ + |Z |2&pi;(1 + Z--v‚à•b &sdot;&nabla;-√ó b) B2B √ó &nabla; B &sdot;&nabla;(ùúÉ1,7)
                    |Z|2&pi;B                          |Z|2&pi;B
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion19x.png" alt="                      ----
--  --      -       Z|Z|v2‚à•&pi;&nabla; √ó b        --   Z            &mu;-           1--  ---- --
vd &sdot;&nabla;&alpha;  =   v‚à•--(----Z--v‚à•---------)-&sdot;&nabla;&alpha; + |Z-|--(----Z--v‚à•--------)--2B √ó &nabla; B &sdot;&nabla;(&alpha;1.8)
              B  1+ |Z|2&pi;Bb &sdot;&nabla; √ó b           2&pi; 1 + |Z|2&pi;B-b&sdot;&nabla; √ó b  B
" class="math-display"  /></center>
</div>where use has been made of <span 
class="cmbx-10">B </span><span 
class="cmsy-10">&sdot;&nabla;</span><span 
class="cmmi-10">&psi; </span>= 0 and <span 
class="cmbx-10">B </span><span 
class="cmsy-10">&sdot;&nabla;</span><span 
class="cmmi-10">&alpha; </span>= 0. The parallel acceleration equation is written as
(presently dropping the electric Ô¨Åeld acceleration term)
   <table 
class="equation"><tr><td><a 
 id="x4-3007r19"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion20x.png" alt="            --     ---
dv‚à•    --   B + Z|Z-|2v‚à•&pi;&nabla; √ó b      ---
dt-= &minus; &mu;--(----Z--v‚à•--------)-&sdot;&nabla;B
        B  1 + |Z|2&pi;Bb &sdot;&nabla; √ó b
" class="math-display"  /></center></td><td class="equation-label">(19)</td></tr></table>
<!--l. 255--><p class="nopar" >
For a general tokamak magnetic conÔ¨Åguration specifed numerically, all the above 2D equilibrium quantitis
are computed by interpolating pre-computed numerical tables. We deÔ¨Åne the following numerical
tables:
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3008r20"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion21x.png" alt="W1(&psi;,ùúÉ) = 1b &sdot;&nabla;-√ó b,
          B
" class="math-display"  /></center></td><td class="equation-label">(20)</td></tr></table>
                                                                                  
                                                                                  
<!--l. 262--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3009r21"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion22x.png" alt="          -- --
W2(&psi;,ùúÉ) = B-&sdot;&nabla;ùúÉ,
          B
" class="math-display"  /></center></td><td class="equation-label">(21)</td></tr></table>
<!--l. 266--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3010r22"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion23x.png" alt="          --
W3(&psi;,ùúÉ) = &nabla;-√ó-b&sdot;&nabla;-&psi;,
           B
" class="math-display"  /></center></td><td class="equation-label">(22)</td></tr></table>
<!--l. 270--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3011r23"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion24x.png" alt="          --     --
W4(&psi;,ùúÉ) = &nabla;-√ó-b-&sdot;&nabla;ùúÉ,
            B
" class="math-display"  /></center></td><td class="equation-label">(23)</td></tr></table>
<!--l. 274--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3012r24"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion25x.png" alt="            --          --          --
W5 (&psi;,ùúÉ,&alpha;) = &nabla;-√ó-b-&sdot;&nabla;&alpha; = &nabla;-√ó-b-&sdot;&nabla;-œï&minus; &nabla;-√ó-b-&sdot;&nabla;-&delta;
              B           B           B
" class="math-display"  /></center></td><td class="equation-label">(24)</td></tr></table>
<!--l. 281--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3013r25"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion26x.png" alt="            --  ---- --
W6(&psi;,ùúÉ) = 12B √ó &nabla; B &sdot;&nabla;&psi;,
          B
" class="math-display"  /></center></td><td class="equation-label">(25)</td></tr></table>
<!--l. 286--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3014r26"></a>
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion27x.png" alt="W (&psi;,ùúÉ) = 1-B-√ó &nabla;B--&sdot;&nabla;ùúÉ,
 7        B2
" class="math-display"  /></center></td><td class="equation-label">(26)</td></tr></table>
<!--l. 291--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3015r27"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion28x.png" alt="W8 (&psi;,ùúÉ,&alpha;) = 1-B-√ó &nabla;B--&sdot;&nabla;&alpha; = -1-B-√ó &nabla;B-&sdot;&nabla;-œï&minus; -1-B-√ó &nabla;B--&sdot;&nabla;-&delta;
             B2              B2              B2
" class="math-display"  /></center></td><td class="equation-label">(27)</td></tr></table>
<!--l. 299--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3016r28"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion29x.png" alt="          --
W  (&psi;,ùúÉ) = B &sdot;&nabla;B,-
  9       B
" class="math-display"  /></center></td><td class="equation-label">(28)</td></tr></table>
<!--l. 304--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3017r29"></a>
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion30x.png" alt="           --
           &nabla;-√ó-b- ---
W10 (&psi;,ùúÉ) =   B-  &sdot;&nabla;B.
" class="math-display"  /></center></td><td class="equation-label">(29)</td></tr></table>
<!--l. 309--><p class="nopar" >
Next, let us disscuss the <span 
class="cmmi-10">E </span><span 
class="cmsy-10">√ó </span><span 
class="cmmi-10">B </span>drift:
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3018r30"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion31x.png" alt="--          -1----  -- --
vE√óB &sdot;&nabla; &psi; = BB-‚ãÜ‚à•E √ó B &sdot;&nabla;&psi;
" class="math-display"  /></center></td><td class="equation-label">(30)</td></tr></table>
<!--l. 315--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3019r31"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion32x.png" alt="--          -1----  -- --
vE √óB &sdot;&nabla; ùúÉ = BB-‚ãÜ‚à•E √ó B &sdot;&nabla;ùúÉ
" class="math-display"  /></center></td><td class="equation-label">(31)</td></tr></table>
<!--l. 321--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3020r32"></a>
                                                                                  
                                                                                  
   <center class="math-display" >
<img 
src="guiding_center_motion33x.png" alt="v-   &sdot;&nabla; &alpha; = -1--E-√ó B-&sdot;&nabla;&alpha;
 E√óB        BB ‚ãÜ‚à•
" class="math-display"  /></center></td><td class="equation-label">(32)</td></tr></table>
<!--l. 327--><p class="nopar" >
Using <span 
class="cmmi-10">&delta;</span><span class="overline"><span 
class="cmbx-10">E</span></span> = <span 
class="cmmi-10">&delta;</span><span class="overline"><span 
class="cmmi-10">E</span></span><sub><span 
class="cmsy-7">‚à•</span></sub><span 
class="cmbx-10">b </span>+ <span 
class="cmmi-10">&delta;</span><span class="overline"><span 
class="cmmi-10">E</span></span><sub><span 
class="cmmi-7">x</span></sub><span class="overline"><span 
class="cmsy-10">&nabla;</span></span><span 
class="cmmi-10">x </span>+ <span 
class="cmmi-10">&delta;</span><span class="overline"><span 
class="cmmi-10">E</span></span><sub><span 
class="cmmi-7">y</span></sub><span class="overline"><span 
class="cmsy-10">&nabla;</span></span><span 
class="cmmi-10">y</span>, the above drifts are written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion34x.png" alt="vE√óB &sdot;&nabla;x   =  --1‚ãÜ(&delta;Ex &nabla;x + &delta;Ey &nabla;y )√ó B-&sdot;&nabla;x
              B B‚à•
                 1    ----    ----    --  --
           =  &minus; ---‚ãÜ(&delta;Ex&nabla;x + &delta;Ey&nabla;y )√ó &nabla;x &sdot;B
                BB ‚à•
           =  &minus; -1-‚ãÜ(&delta;Ey&nabla;y )√ó &nabla;x &sdot;B-
                BB ‚à•
                1   -- --   --  --
           =  ---‚ãÜ(&delta;Ey )&nabla;x √ó &nabla;y &sdot;B
              B B‚à•      --
              --1-  -- -B- --
           =  BB-‚ãÜ‚à•(&delta;Ey )&Psi;-&prime; &sdot;B                              (33)
" class="math-display"  /></center>
</div><div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion35x.png" alt="--              1   -- --   -- --    -- --
vE√óB &sdot;&nabla;y   =  BB-‚ãÜ(&delta;Ex &nabla;x + &delta;Ey &nabla;y )√ó B &sdot;&nabla;y
                 ‚à•
           =  &minus; -1-‚ãÜ(&delta;Ex&nabla;x + &delta;Ey&nabla;y )√ó &nabla;y &sdot;B-
                BB ‚à•
                 1    ----    --  --
           =  &minus; BB-‚ãÜ(&delta;Ex&nabla;x )√ó &nabla;y &sdot;B
                   ‚à•     --
           =  &minus; -1--(&delta;E-)B--&sdot;B-                            (34)
                BB ‚ãÜ‚à•   x &Psi;&prime;
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion36x.png" alt="v-   &sdot;&nabla;ùúÉ  =   -1--(&delta;E-&nabla;-&psi; +&delta;E- &nabla;&alpha; )√ó B-&sdot;&nabla;ùúÉ
 E√óB          BB ‚ãÜ‚à•   x        y
                 1   -- -- --   --    ---- --   --
          =   &minus;---‚ãÜ (&delta;Ex B &sdot;&nabla;&psi; √ó &nabla;ùúÉ + &delta;EyB &sdot;&nabla; &alpha;√ó &nabla; ùúÉ).           (35)
               B B‚à•
" class="math-display"  /><a 
 id="x4-3023r35"></a></center>
</div>The two terms in expression (<a 
href="#x4-3023r35">35<!--tex4ht:ref: 18-10-17-p1 --></a>) and be written as
   <table 
class="equation"><tr><td><a 
 id="x4-3024r36"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion37x.png" alt="                 |             |
-- --    --   -- || e&part;R&psi;  eœï  e&part;Z&psi;  ||  -- (&part;&psi;  &part;ùúÉ   &part;&psi; &part;ùúÉ)
B &sdot;(&nabla; &psi; √ó &nabla;ùúÉ) = B &sdot;|| &part;R  0  &part;Z- ||= Bœï  &part;Z-&part;R- &minus; &part;R-&part;Z- &equiv; W14
                 | &part;&part;ùúÉR-  0  &part;&part;ùúÉZ- |
" class="math-display"  /></center></td><td class="equation-label">(36)</td></tr></table>
                                                                                  
                                                                                  
<!--l. 388--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-3025r37"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion38x.png" alt="               || e    e    e  ||     (         )    (               )     (          )
B&sdot;(&nabla;&alpha;√ó &nabla;ùúÉ) = B&sdot;|| &part;R&alpha;- 1-œï&part;&alpha;  &part;Z&alpha;-||= B-   1-&part;&alpha;-&part;ùúÉ- +B-   &part;&alpha;-&part;ùúÉ-&minus; &part;-&alpha;-&part;ùúÉ +B--  &minus; 1-&part;&alpha;-&part;ùúÉ-  &equiv; W
               || &part;&part;RùúÉ- R &part;œï  &part;&part;ZùúÉ-||    R  R &part;œï &part;Z     œï  &part;Z &part;R   &part;R &part;Z      Z   R &part;œï &part;R      15
                 &part;R   0    &part;Z
" class="math-display"  /></center></td><td class="equation-label">(37)</td></tr></table>
<!--l. 406--><p class="nopar" >
</p><!--l. 409--><p class="indent" >   ¬†
</p><!--l. 412--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.1   </span> <a 
 id="x4-40001.2.1"></a>Periodic conditions of particle trajactory in Ô¨Åeld-line-following coordinates</h5>
<!--l. 414--><p class="noindent" >Note that <span 
class="cmmi-10">ùúÉ</span>(<span 
class="cmbx-10">r</span>) and <span 
class="cmmi-10">œï</span>(<span 
class="cmbx-10">r</span>) are multi-valued functions, while <span 
class="cmsy-10">&nabla;</span><span 
class="cmmi-10">ùúÉ</span>(<span 
class="cmbx-10">r</span>) and <span 
class="cmsy-10">&nabla;</span><span 
class="cmmi-10">œï</span>(<span 
class="cmbx-10">r</span>) happens to be a single-valued
function. However <span 
class="cmsy-10">&nabla;</span><span 
class="cmmi-10">&alpha;</span>(<span 
class="cmbx-10">r</span>) and <span 
class="cmsy-10">&nabla;</span><span class="overline"><span 
class="cmmi-10">&delta;</span></span>(<span 
class="cmbx-10">r</span>) are still multi-valued functions. [It is ready to see this point by
examing the special case that <span 
class="cmmi-10">ùúÉ </span>is a straight-Ô¨Åeld line poloidal angle, in which <span 
class="cmex-10">&int;</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ùúÉ</span></sup><img 
src="guiding_center_motion39x.png" alt="ÀÜq"  class="circ"  /> <span 
class="cmmi-10">dùúÉ </span>is simpliÔ¨Åed to <span 
class="cmmi-10">qùúÉ</span>.
Then <span 
class="cmsy-10">&nabla;</span><span class="overline"><span 
class="cmmi-10">&delta;</span></span> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x4-4001r38"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion40x.png" alt="  -
&nabla; &delta; = ùúÉ&nabla;q + q&nabla; ùúÉ,
" class="math-display"  /></center></td><td class="equation-label">(38)</td></tr></table>
                                                                                  
                                                                                  
<!--l. 424--><p class="nopar" >
where the Ô¨Årst term <span 
class="cmmi-10">ùúÉ</span><span 
class="cmsy-10">&nabla;</span><span 
class="cmmi-10">q </span>is a multi-valued function since <span 
class="cmmi-10">ùúÉ </span>is multi-valued.] For multi-valued functions, if a
single branch is chosen, then there will be discontinuity at the the branch cut.
</p><!--l. 429--><p class="indent" >   In numerically constructing the coordinates (<span 
class="cmmi-10">&psi;,ùúÉ,&alpha;</span>), the principal value of <span 
class="cmmi-10">ùúÉ </span>is chosen in the range
[<span 
class="cmsy-10">&minus;</span><span 
class="cmmi-10">&pi; </span>: <span 
class="cmmi-10">&pi;</span>] and the branch cut for <span 
class="cmmi-10">ùúÉ </span>is chosen on the high-Ô¨Åeld-side midplane. The toroidal shift
<span class="overline"><span 
class="cmmi-10">&delta;</span></span> = <span 
class="cmex-10">&int;</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ùúÉ</span></sup><img 
src="guiding_center_motion41x.png" alt="ÀÜq"  class="circ"  /> <span 
class="cmmi-10">dùúÉ </span>can be considered as a derived angle based on <span 
class="cmmi-10">ùúÉ </span>and thus its principal value and
branch cut are determined by those of <span 
class="cmmi-10">ùúÉ</span>. SpeciÔ¨Åcly, the principal value of <span class="overline"><span 
class="cmmi-10">&delta;</span></span> is in the range
[<span 
class="cmsy-10">&minus;</span><span 
class="cmmi-10">&pi;q </span>: <span 
class="cmmi-10">&pi;q</span>] for up-down symmetrical equilibria and the branch cut is also on the high-Ô¨Åeld-side
midplane.
</p><!--l. 439--><p class="indent" >   The (<span 
class="cmmi-10">&psi;,ùúÉ,&alpha;</span>) coordinates of a particle change continously when they are evolved by using Eqs.
(<a 
href="#x4-3001r13">13<!--tex4ht:ref: 17-8-21-p1 --></a>)-(<a 
href="#x4-3003r15">15<!--tex4ht:ref: 17-8-21-p3 --></a>), during which <span 
class="cmmi-10">ùúÉ </span>can move beyond [<span 
class="cmsy-10">&minus;</span><span 
class="cmmi-10">&pi;,&pi;</span>]. When a particle&#x2019;s <span 
class="cmmi-10">ùúÉ </span>moves beyong the range [<span 
class="cmsy-10">&minus;</span><span 
class="cmmi-10">&pi; </span>: <span 
class="cmmi-10">&pi;</span>],
one or multiple <span 
class="cmsy-10">¬±</span>2<span 
class="cmmi-10">&pi; </span>shifts are imposed on <span 
class="cmmi-10">ùúÉ </span>until <span 
class="cmmi-10">ùúÉ </span>are within [<span 
class="cmsy-10">&minus;</span><span 
class="cmmi-10">&pi; </span>: <span 
class="cmmi-10">&pi;</span>]. Note that a cooresponding shift in
<span 
class="cmmi-10">&alpha; </span>is needed to keep the particle at the same spatial location when doing the <span 
class="cmmi-10">ùúÉ </span>shift. This is because,
although (<span 
class="cmmi-10">&psi;,ùúÉ,œï</span>) and (<span 
class="cmmi-10">&psi;,ùúÉ </span><span 
class="cmsy-10">&minus; </span>2<span 
class="cmmi-10">&pi;,œï</span>) correspond to the same spatial location, points (<span 
class="cmmi-10">&psi;,ùúÉ,&alpha;</span>) and
(<span 
class="cmmi-10">&psi;,ùúÉ </span><span 
class="cmsy-10">&minus; </span>2<span 
class="cmmi-10">&pi;,&alpha;</span>) do not. SpeciÔ¨Åcly, the usual toroidal angle <span 
class="cmmi-10">œï </span>of point (<span 
class="cmmi-10">&psi;,ùúÉ,&alpha;</span>) is <span 
class="cmmi-10">œï</span><sub><span 
class="cmr-7">1</span></sub> = <span 
class="cmmi-10">&alpha; </span>+ <span 
class="cmex-10">&int;</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ùúÉ</span></sup><img 
src="guiding_center_motion42x.png" alt="ÀÜq"  class="circ"  /> <span 
class="cmmi-10">dùúÉ </span>while <span 
class="cmmi-10">œï </span>of
point (<span 
class="cmmi-10">&psi;,ùúÉ </span><span 
class="cmsy-10">&minus; </span>2<span 
class="cmmi-10">&pi;,&alpha;</span>) is <span 
class="cmmi-10">œï</span><sub><span 
class="cmr-7">2</span></sub> = <span 
class="cmmi-10">&alpha; </span>+ <span 
class="cmex-10">&int;</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ùúÉ</span><span 
class="cmsy-7">&minus;</span><span 
class="cmr-7">2</span><span 
class="cmmi-7">&pi;</span></sup><img 
src="guiding_center_motion43x.png" alt="ÀÜq"  class="circ"  /> <span 
class="cmmi-10">dùúÉ</span>. The diÔ¨Äerence between <span 
class="cmmi-10">œï</span><sub><span 
class="cmr-7">1</span></sub> and <span 
class="cmmi-10">œï</span><sub><span 
class="cmr-7">2</span></sub> is <span 
class="cmmi-10">œï</span><sub><span 
class="cmr-7">2</span></sub> <span 
class="cmsy-10">&minus; </span><span 
class="cmmi-10">œï</span><sub><span 
class="cmr-7">1</span></sub> = <span 
class="cmsy-10">&minus;</span>2<span 
class="cmmi-10">&pi;q</span>. This
indicates that, to keep the point at the same spatial location when shifting <span 
class="cmmi-10">ùúÉ </span>by <span 
class="cmsy-10">&minus;</span>2<span 
class="cmmi-10">&pi;</span>, <span 
class="cmmi-10">&alpha; </span>should be
shifted by +2<span 
class="cmmi-10">&pi;q</span>, i.e., the new coordinates of the point should be (<span 
class="cmmi-10">&psi;,ùúÉ </span><span 
class="cmsy-10">&minus; </span>2<span 
class="cmmi-10">&pi;,&alpha; </span>+ 2<span 
class="cmmi-10">&pi;q</span>). This
process is illustrated in Fig. <a 
href="#x4-40021">1<!--tex4ht:ref: 17-11-4-1 --></a> and a typical evolution of (<span 
class="cmmi-10">ùúÉ,&alpha;</span>) involving shifting is shown in Fig.
(<a 
href="#x4-40032">2<!--tex4ht:ref: 18-2-4-p1 --></a>).
</p><!--l. 459--><p class="indent" >   ¬†
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                  
                                                                                  
<a 
 id="x4-40021"></a>
                                                                                  
                                                                                  
<!--l. 462--><p class="noindent" > <img 
src="my_figure/home/yj/theory/guiding_center_motion/figures/fig1/shift-1.png" alt="pict"  
 width="265.99374pt" />
<br /> </p><div class="caption" 
><span class="id">Figure¬†1: </span><span  
class="content">To keep the point at the same spatial location when shifting <span 
class="cmmi-10">ùúÉ </span>by <span 
class="cmsy-10">&minus;</span>2<span 
class="cmmi-10">&pi;</span>, <span 
class="cmmi-10">&alpha; </span>should be
shifted by +2<span 
class="cmmi-10">&pi;q</span>. Here <span 
class="cmmi-10">A </span>and <span 
class="cmmi-10">C </span>correspond to the same spatial location, but <span 
class="cmmi-10">B </span>is at a diÔ¨Äerent
location.</span></div><!--tex4ht:label?: x4-40021 -->
                                                                                  
                                                                                  
   </div><hr class="endfigure" />
<!--l. 469--><p class="indent" >   ¬†
</p><!--l. 471--><p class="indent" >   ¬†
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                  
                                                                                  
<a 
 id="x4-40032"></a>
                                                                                  
                                                                                  
<!--l. 474--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/fig_lorentz/fig2018-2-3e1/f.png" alt="pict"  
 width="524.96124pt" />
<br /> </p><div class="caption" 
><span class="id">Figure¬†2: </span><span  
class="content">Temporal evolution of (<span 
class="cmmi-10">&psi;,ùúÉ,&alpha;</span>) of a passing electron. The range of <span 
class="cmmi-10">ùúÉ </span>is chosen to be
[<span 
class="cmsy-10">&minus;</span><span 
class="cmmi-10">&pi; </span>: <span 
class="cmmi-10">&pi;</span>] and the range of <span 
class="cmmi-10">&alpha; </span>and <span 
class="cmmi-10">œï </span>is [0 : 2<span 
class="cmmi-10">&pi;</span>]. When <span 
class="cmmi-10">ùúÉ </span>exeed the range, a 2<span 
class="cmmi-10">&pi; </span>shift is imposed, which
generate the jump of <span 
class="cmmi-10">ùúÉ </span>in (b) and also the corresponding jump of <span 
class="cmmi-10">&alpha; </span>in (c). Note that when a jump
in (<span 
class="cmmi-10">ùúÉ,&alpha;</span>) ocurs, no jump in <span 
class="cmmi-10">œï</span>, which is what we expect, otherwise there must be something wrong.
Also note that there are also jumps of <span 
class="cmmi-10">œï </span>shown in (c), which is due to <span 
class="cmmi-10">œï </span>exceeding the range [0 : 2<span 
class="cmmi-10">&pi;</span>]
and a 2<span 
class="cmmi-10">&pi; </span>shift being imposed and this jump has nothing to do with the jump in <span 
class="cmmi-10">ùúÉ </span>or <span 
class="cmmi-10">&alpha; </span>and usually
occur at diÔ¨Äerent time (one jump of <span 
class="cmmi-10">œï </span>is near the jump of <span 
class="cmmi-10">&alpha;</span>, which is only a coincidence). Here <span 
class="cmmi-10">œï </span>is
computed using <span 
class="cmmi-10">œï </span>= <span 
class="cmmi-10">&alpha; </span>+<span class="overline"> <span 
class="cmmi-10">&delta;</span></span>, where <span class="overline"><span 
class="cmmi-10">&delta;</span></span> is obtained by interpolating the 2D numerical table of <span class="overline"><span 
class="cmmi-10">&delta;</span></span>(<span 
class="cmmi-10">&psi;,ùúÉ</span>).
DIID-D cyclone base case</span></div><!--tex4ht:label?: x4-40032 -->
                                                                                  
                                                                                  
   </div><hr class="endfigure" />
<!--l. 492--><p class="indent" >   ¬†
</p><!--l. 494--><p class="indent" >   (When <span 
class="cmmi-10">&alpha; </span>of a particle moves beyong the range [0 : 2<span 
class="cmmi-10">&pi;</span>], one or multiple <span 
class="cmsy-10">¬±</span>2<span 
class="cmmi-10">&pi; </span>shifts are imposed
on <span 
class="cmmi-10">&alpha; </span>until <span 
class="cmmi-10">&alpha; </span>are within [0 : 2<span 
class="cmmi-10">&pi;</span>]. Since, for Ô¨Åxed <span 
class="cmmi-10">&psi; </span>and <span 
class="cmmi-10">ùúÉ</span>, the generalized toroidal angle <span 
class="cmmi-10">&alpha; </span>is
equivalent to the usual toroidal angle <span 
class="cmmi-10">œï</span>. No complication like the case of <span 
class="cmmi-10">ùúÉ </span>arises when doing the <span 
class="cmmi-10">&alpha;</span>
shift.)
</p><!--l. 500--><p class="indent" >   One way of avoiding the subtle (<span 
class="cmmi-10">ùúÉ,&alpha;</span>) shift problem is to evolve particles&#x2019; <span 
class="cmmi-10">œï</span>, instead of <span 
class="cmmi-10">&alpha;</span>. In this case,
we have
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion44x.png" alt="        --            --  v‚à•--         --            --           --  ------
dœï-= vd &sdot;&nabla; œï =  v‚à•--(-B-+-2&pi;&nabla;-√ó-b---) &sdot;&nabla;œï + --(------&mu;--------)-12B √ó &nabla; B &sdot;&nabla; œï(,39)
dt                B  1 + 2v‚à•&pi;Bb &sdot;&nabla; √ó b        2&pi; 1 + 2v‚à•&pi;Bb &sdot;&nabla; √ó b B
" class="math-display"  /></center>
</div>After geting <span 
class="cmmi-10">œï</span>, we use <span 
class="cmmi-10">&alpha; </span>= <span 
class="cmmi-10">œï </span><span 
class="cmsy-10">&minus;</span><span class="overline"><span 
class="cmmi-10">&delta;</span></span>(<span 
class="cmmi-10">&psi;,ùúÉ</span>) to get particles&#x2019; <span 
class="cmmi-10">&alpha;</span>, where <span class="overline"><span 
class="cmmi-10">&delta;</span></span> is obtained by interpolating the
numerical table in (<span 
class="cmmi-10">&psi;,ùúÉ</span>) plane. I have tested the two ways of computing evolution of <span 
class="cmmi-10">&alpha;</span>, which indicates
their results agree with each other. In the Ô¨Ånal codes, I use the (<span 
class="cmmi-10">ùúÉ,&alpha;</span>) shift method, because this methods
involve less interpolation and thus more eÔ¨Écient.
   <h5 class="subsubsectionHead"><span class="titlemark">1.2.2   </span> <a 
 id="x4-50001.2.2"></a>Benchmarking cases</h5>
<!--l. 526--><p class="noindent" >To verify code implementation, two methods are used to compute the guiding-center orbits. The Ô¨Årst
method uses the cylindrical coordinates and then interpolate the orbits into magnetic coordinates using
pre-computed mapping table between the cylindrical and magnetic coordinates. The second method
directly uses the magnetic coordinates in pushing the orbits. The following Ô¨Ågures compare the results
obtained by these two methods, which indicates they agree with each other. This provdies conÔ¨Ådence on
the correctness of the numerical implementation.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                  
                                                                                  
<a 
 id="x4-50013"></a>
                                                                                  
                                                                                  
<!--l. 536--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/fig_lorentz/fig2018-2-3e1/figb/f.png" alt="pict"  
 width="518.93875pt" />
<br /> </p><div class="caption" 
><span class="id">Figure¬†3: </span><span  
class="content">Comparison between the temporal evolution of (<span 
class="cmmi-10">&psi;,ùúÉ,&alpha;</span>) of a passing electron computed
by two methods: the blue lines are the results computed directly in (<span 
class="cmmi-10">&psi;,ùúÉ,&alpha;</span>) Ô¨Åeld-line-following
coordinates, the red lines are results computed in cylindrical coordinates and then interpolated to
the Ô¨Åeld-line-following coordinates. There is sysmetical discrepancy between <span 
class="cmmi-10">&psi; </span>computed by the
two methods. The results are actually very close to each other and the diÔ¨Äerebce becomes obvious
because the variation of <span 
class="cmmi-10">&psi; </span>is very small for a passing electron. The results of <span 
class="cmmi-10">&alpha; </span>from the two methods
also agree with each other. The discrepancy near <span 
class="cmmi-10">t</span>&Omega;<sub><span 
class="cmmi-7">i</span></sub> = 400 is due to that <span 
class="cmmi-10">&alpha; </span>is close to 2<span 
class="cmmi-10">&pi;</span>, and one
result becomes zero, which is equivalent to 2<span 
class="cmmi-10">&pi;</span>. equilibrium is the DIID-D cyclone base case</span></div><!--tex4ht:label?: x4-50013 -->
                                                                                  
                                                                                  
   </div><hr class="endfigure" />
<!--l. 552--><p class="indent" >   ¬†
</p><!--l. 554--><p class="indent" >   ¬†
</p><!--l. 556--><p class="indent" >   ¬†
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                  
                                                                                  
<a 
 id="x4-50024"></a>
                                                                                  
                                                                                  

<!--l. 559--><p class="noindent" ><img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2e/p.png" alt="pict"  
 width="102.38249pt" /> <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2/p.png" alt="pict"  
 width="218.8175pt" />
<br /> </p><div class="caption" 
><span class="id">Figure¬†4: </span><span  
class="content">Left: orbit on poloidal plane. Right: <span 
class="cmmi-10">&alpha; </span>is deÔ¨Åned by <span 
class="cmmi-10">&alpha; </span>= <span 
class="cmmi-10">œï </span><span 
class="cmsy-10">&minus;</span><span 
class="cmex-10">&int;</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ùúÉ</span></sup><img 
src="guiding_center_motion45x.png" alt="ÀÜq"  class="circ"  /> <span 
class="cmmi-10">dùúÉ, </span>where <span 
class="cmmi-10">œï </span>is the
usual cylindrical toroidal angle.</span></div><!--tex4ht:label?: x4-50024 -->
                                                                                  
                                                                                  
   </div><hr class="endfigure" />
<!--l. 565--><p class="indent" >   ¬†
</p><!--l. 567--><p class="indent" >   ¬†
</p><!--l. 569--><p class="indent" >   ¬†
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                  
                                                                                  
<a 
 id="x4-50035"></a>
                                                                                  
                                                                                  
<!--l. 572--><p class="noindent" >¬†
</p><!--l. 574--><p class="noindent" ><img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2c/p.png" alt="pict"  
 width="221.82875pt" /> <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2f/p.png" alt="pict"  
 width="222.8325pt" />
</p><!--l. 576--><p class="noindent" ><img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2b/p.png" alt="pict"  
 width="218.8175pt" /> <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2d/p.png" alt="pict"  
 width="218.8175pt" />
<br /> </p><div class="caption" 
><span class="id">Figure¬†5: </span><span  
class="content">The evolutions of the poloidal angles <span 
class="cmmi-10">ùúÉ </span>and generalized toroidal anglecal <span 
class="cmmi-10">&alpha; </span>culated by
the two methods agree with each other.   <span 
class="cmmi-10">r </span>= <img 
src="guiding_center_motion46x.png" alt="‚àò ------
  &Psi;&Psi;&minus;b&Psi;&minus;0&Psi;0"  class="sqrt"  /></span></div><!--tex4ht:label?: x4-50035 -->
                                                                                  
                                                                                  
   </div><hr class="endfigure" />
<!--l. 582--><p class="indent" >   ¬†
                                                                                  
                                                                                  
</p>
   <!--l. 584--><div class="crosslinks"><p class="noindent">[<a 
href="guiding_center_motionsu3.html" >next</a>] [<a 
href="guiding_center_motionsu1.html" >prev</a>] [<a 
href="guiding_center_motionsu1.html#tailguiding_center_motionsu1.html" >prev-tail</a>] [<a 
href="guiding_center_motionsu2.html" >front</a>] [<a 
href="guiding_center_motionse1.html#guiding_center_motionsu2.html" >up</a>] </p></div>
<!--l. 584--><p class="indent" >   <a 
 id="tailguiding_center_motionsu2.html"></a>  </p> 
</body></html> 
