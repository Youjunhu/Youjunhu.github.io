<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Equations of guiding-center motion</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="guiding_center_motion.tex" /> 
<link rel="stylesheet" type="text/css" href="guiding_center_motion.css" /> 
</head><body 
>
   <!--l. 43--><div class="crosslinks"><p class="noindent">[<a 
href="guiding_center_motionse2.html" >next</a>] [<a 
href="#tailguiding_center_motionse1.html">tail</a>] [<a 
href="guiding_center_motion.html#guiding_center_motionse1.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x2-10001"></a>Equations of guiding-center motion</h3>
<!--l. 45--><p class="noindent" >The equations of guiding center motion are given by<span class="cite">[<a 
href="guiding_center_motionli1.html#Xtodo2006">1</a>]</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-1001r1"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion0x.png" alt="dX-=  B⋆v  + --μ--B × ∇B  + -1--E × B
dt    B⋆∥ ∥   mΩB ⋆∥          BB ⋆∥
" class="math-display"  /></center></td><td class="equation-label">(1)</td></tr></table>
<!--l. 51--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-1002r2"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion1x.png" alt="dv∥    -μB-⋆       Ze-B⋆-
 dt = −m B ⋆∥ ⋅∇B  + m  B⋆∥ ⋅E
" class="math-display"  /></center></td><td class="equation-label">(2)</td></tr></table>
<!--l. 56--><p class="nopar" >
where <span 
class="cmbx-10">X </span>is the guiding-center position, <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">∥</span></sub> is the parallel (to the magnetic ﬁeld) velocity deﬁned by
<span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">∥</span></sub> = <span 
class="cmbx-10">B</span><span 
class="cmsy-10">⋅</span><span 
class="cmbx-10">v</span><span 
class="cmmi-10">∕B</span>; Here <span 
class="cmmi-10">m</span>, <span 
class="cmmi-10">Ze</span>, and <span 
class="cmbx-10">v </span>are the mass, charge and velocity of the particle, respectively, <span 
class="cmmi-10">μ </span>is the
magnetic moment deﬁned by <span 
class="cmmi-10">μ </span>= <span 
class="cmmi-10">mv</span><sub><span 
class="cmsy-7">⊥</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">∕</span>(2<span 
class="cmmi-10">B</span>) with <span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">⊥</span></sub> being the perpendicular speed; Ω = <span 
class="cmmi-10">BZe∕m </span>is
the cyclotron angular frequency,  <span 
class="cmbx-10">B</span><sup><span 
class="cmmi-7">⋆</span></sup> and <span 
class="cmmi-10">B</span><sub><span 
class="cmsy-7">∥</span></sub><sup><span 
class="cmmi-7">⋆</span></sup> are deﬁned by
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-1003r3"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion2x.png" alt="B ⋆ = B + B v∥∇ × b,
           Ω
" class="math-display"  /></center></td><td class="equation-label">(3)</td></tr></table>
<!--l. 67--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-1004r4"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion3x.png" alt="               (   v         )
B ⋆∥ ≡ b ⋅B⋆ = B 1+ -∥b ⋅∇ × b ,
                   Ω
" class="math-display"  /></center></td><td class="equation-label">(4)</td></tr></table>
<!--l. 73--><p class="nopar" >
respectively, where <span 
class="cmbx-10">b </span>= <span 
class="cmbx-10">B</span><span 
class="cmmi-10">∕B</span>. If we use the approximation <span 
class="cmmi-10">B</span><sub><span 
class="cmsy-7">∥</span></sub><sup><span 
class="cmmi-7">⋆</span></sup> <span 
class="cmsy-10">≈ </span><span 
class="cmmi-10">B</span>, then the drift velocity in Eq. (<a 
href="#x2-1001r1">1<!--tex4ht:ref: 5-15-p2 --></a>)
can be written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-1005r5"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion4x.png" alt="                         2
dX-= v∥e∥ + VD = v∥b+   v∥-∇ × b + --μ--B × ∇B0 + -1-E ×B ,
dt                     ◟Ω-◝◜--◞   m◟-ΩB-◝◜-----◞  B◟2-◝◜--◞
                      curvaturedrift     ∇B drift      E×Bdrift
" class="math-display"  /></center></td><td class="equation-label">(5)</td></tr></table>
<!--l. 84--><p class="nopar" >
where the usual drifts can be recognized. Before getting to know the above form of the equations of
the guiding-center motion, I used the following form of the equations (refer to my notes
“collisionless_drift_kinetic_equation.tm”):
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-1006r6"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion5x.png" alt="                (                  )
dX- = bv∥ + 1-b × μ-∇B  +v2∥κ − ZeE   ,
 dt        Ω      m            m
" class="math-display"  /></center></td><td class="equation-label">(6)</td></tr></table>
<!--l. 93--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-1007r7"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion6x.png" alt="dv∥ = − μ-b ⋅∇B + v∥μ-κ⋅b × ∇B + Ze-b ⋅E,
 dt    m         m Ω             m
" class="math-display"  /></center></td><td class="equation-label">(7)</td></tr></table>
<!--l. 98--><p class="nopar" >
which does not conserve the toroidal angular momentum <span 
class="cmmi-10">P</span><sub><span 
class="cmmi-7">ϕ</span></sub> exactly in an axisymmetrical
equilibrium magnetic ﬁeld (this has been tested numerically) while the new form given in
Eqs. (<a 
href="#x2-1001r1">1<!--tex4ht:ref: 5-15-p2 --></a>)-(<a 
href="#x2-1004r4">4<!--tex4ht:ref: 5-15-p8 --></a>) can conserve <span 
class="cmmi-10">P</span><sub><span 
class="cmmi-7">ϕ</span></sub> exactly. My latest numerical code uses Eqs. (<a 
href="#x2-1001r1">1<!--tex4ht:ref: 5-15-p2 --></a>)-(<a 
href="#x2-1004r4">4<!--tex4ht:ref: 5-15-p8 --></a>) as the
                                                                                

                                                                                
the equations of guiding center motion. The toroidal angular momentum <span 
class="cmmi-10">P</span><sub><span 
class="cmmi-7">ϕ</span></sub> is deﬁned
by
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-1008r8"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion7x.png" alt="       g(Ψ-)
Pϕ = m  B  v∥ + ZeΨ,
" class="math-display"  /></center></td><td class="equation-label">(8)</td></tr></table>
<!--l. 107--><p class="nopar" >
where Ψ = <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">ϕ</span></sub><span 
class="cmmi-10">R </span>with <span 
class="cmmi-10">A</span><sub><span 
class="cmmi-7">ϕ</span></sub> being the toroidal component of the magnetic vector potential.
</p><!--l. 111--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">1.1   </span> <a 
 id="x2-20001.1"></a>Deﬁne new units</h4>
<!--l. 113--><p class="noindent" >The above formulas are in SI units, which are good since SI units are widely used and thus these
formulas are accessible to most people, making communications easier. However, many physicists prefer
to deﬁne new units for a speciﬁc problem and write the equations in terms of these new units. This
process is often called normalization. This has the advantage of possibly reducing the number of free
parameters in a problem. Another advantage is that, by chosen proper characteristic quantities as units,
the magnitude of quantities in terms of the new units are easier to be appreciated. A third
advantage is that the magnitude of normalized quantities may be in the vicinity of 1 (if
suitable units are chosen), and thus numerical overﬂow in a numerical computation may be
avoided, making the computation more accurate. The disadvantages of the normalization
are (1) the additional work associated with performing the transformation between two
units systems, (2) possible confusions about which units are used in a numerical code and
the potential of introducing bugs due to this confusion when writing or revising numerical
codes.
</p><!--l. 130--><p class="indent" >   The units I adopted are as follows. Choose a characteristic magnetic ﬁeld strength <span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub> and a
characteristic length <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub>. Using <span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub> and <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub>, we deﬁne a characteristic time <span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">n</span></sub> <span 
class="cmsy-10">≡ </span>2<span 
class="cmmi-10">π∕</span>Ω<sub><span 
class="cmmi-7">n</span></sub>, where
Ω<sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmsy-10">|</span><span 
class="cmmi-10">Ze</span><span 
class="cmsy-10">|</span><span 
class="cmmi-10">∕m</span>, a characteristic velocity <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">∕t</span><sub><span 
class="cmmi-7">n</span></sub>,  and a characteristic magnetic moment
<span 
class="cmmi-10">μ</span><sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmmi-10">mv</span><sub><span 
class="cmmi-7">n</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">∕B</span><sub><span 
class="cmmi-7">n</span></sub>. Using these characteristic quantities as units, I deﬁne the following normalized
quantities:
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-2001r9"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion8x.png" alt="                                                              ⋆
X-=  X-,∇-= L  ∇,t =-t,v  = v∥,μ-= μ-,B-= -B-,B-⋆ = B-⋆,B⋆-= B∥-,E =-E--.
     Ln       n     tn  ∥   vn     μn     Bn       Bn   ∥   Bn      Bnvn
" class="math-display"  /></center></td><td class="equation-label">(9)</td></tr></table>
<!--l. 145--><p class="nopar" >
In terms of the above normalized quantities, Eqs. (<a 
href="#x2-1001r1">1<!--tex4ht:ref: 5-15-p2 --></a>)-(<a 
href="#x2-1004r4">4<!--tex4ht:ref: 5-15-p8 --></a>) are written, respectively, as
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-2002r10"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion9x.png" alt=" --   ---
dX-   B⋆-    Z----μ-----  ---  --1- -- --
dt =  B⋆v∥ + |Z |2πBB-⋆B × ∇B + BB--⋆E ×B,
       ∥             ∥             ∥
" class="math-display"  /></center></td><td class="equation-label">(10)</td></tr></table>
<!--l. 156--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-2003r11"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion10x.png" alt="dv∥    --B⋆- ---   Z   B ⋆ --
-dt = −μ B⋆-⋅∇B + |Z|2πB-⋆⋅E,
          ∥              ∥
" class="math-display"  /></center></td><td class="equation-label">(11)</td></tr></table>
<!--l. 164--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-2004r12"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion11x.png" alt="---  --  Z   v--
B⋆ = B + ----∥∇ × b,
         |Z |2π
" class="math-display"  /></center></td><td class="equation-label">(12)</td></tr></table>
<!--l. 169--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x2-2005r13"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion12x.png" alt="---  --   Z  v∥  --
B ⋆∥ = B +------b⋅∇ × b.
         |Z|2π
" class="math-display"  /></center></td><td class="equation-label">(13)</td></tr></table>
<!--l. 175--><p class="nopar" >
In the normalized form, there is only one parameter for distinguishing particle species, namely the sign
of particle’s charge <span 
class="cmmi-10">Z∕</span><span 
class="cmsy-10">|</span><span 
class="cmmi-10">Z</span><span 
class="cmsy-10">|</span>. The other parameters for particle species enters via the normalization factor
Ω<sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmsy-10">|</span><span 
class="cmmi-10">Ze</span><span 
class="cmsy-10">|</span><span 
class="cmmi-10">∕m</span>.
</p><!--l. 181--><p class="indent" >   The toroidal angular momentum <span 
class="cmmi-10">P</span><sub><span 
class="cmmi-7">ϕ</span></sub> is normalized by <span 
class="cmmi-10">ZeB</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub><sup><span 
class="cmr-7">2</span></sup>.
</p><!--l. 183--><p class="indent" >   In TEK code, I choose <span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub> = 1<span 
class="cmmi-10">T </span>and <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub> = 1<span 
class="cmmi-10">m</span>, i.e., they are identical to the corresponding SI units.
This choice makes my unit system become bad because it is hard to relate <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">n</span></sub> deﬁned above to any
typical velocity in a tokamak plasma. A better choice would be choose <span 
class="cmmi-10">B</span><sub><span 
class="cmmi-7">n</span></sub> to the magnetic
ﬁeld magnitude at the magnetic axis and choose <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub> to be <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub><span 
class="cmmi-10">∕</span>Ω<sub><span 
class="cmmi-7">n</span></sub>, i.e., the Larmor radius of
a typical particles, where <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub> is the thermal velocity of a species. Then deﬁne <span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">n</span></sub> = 1<span 
class="cmmi-10">∕</span>Ω<sub><span 
class="cmmi-7">n</span></sub>
and deﬁne <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">n</span></sub> by <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmmi-10">L</span><sub><span 
class="cmmi-7">n</span></sub><span 
class="cmmi-10">∕t</span><sub><span 
class="cmmi-7">n</span></sub> = <span 
class="cmmi-10">v</span><sub><span 
class="cmmi-7">t</span></sub>, which is a typical particle velocity. In future, I may
change TEK code to using this unit system, but presently I stick to using the above unit
system.
                                                                                

                                                                                
</p>
   <!--l. 194--><div class="crosslinks"><p class="noindent">[<a 
href="guiding_center_motionse2.html" >next</a>] [<a 
href="guiding_center_motionse1.html" >front</a>] [<a 
href="guiding_center_motion.html#guiding_center_motionse1.html" >up</a>] </p></div>
<!--l. 194--><p class="indent" >   <a 
 id="tailguiding_center_motionse1.html"></a>  </p> 
</body></html> 
