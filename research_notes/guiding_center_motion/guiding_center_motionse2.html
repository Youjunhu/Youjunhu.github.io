<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Equation of guiding-center motion in ï¬eld-line-following coordinates</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="guiding_center_motion.tex" /> 
<link rel="stylesheet" type="text/css" href="guiding_center_motion.css" /> 
</head><body 
>
   <!--l. 195--><div class="crosslinks"><p class="noindent">[<a 
href="guiding_center_motionse3.html" >next</a>] [<a 
href="guiding_center_motionse1.html" >prev</a>] [<a 
href="guiding_center_motionse1.html#tailguiding_center_motionse1.html" >prev-tail</a>] [<a 
href="#tailguiding_center_motionse2.html">tail</a>] [<a 
href="guiding_center_motion.html#guiding_center_motionse2.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x3-30002"></a>Equation of guiding-center motion in ï¬eld-line-following coordinates</h3>
<!--l. 197--><p class="noindent" >Consider the ï¬eld-line-following coordinates (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>), where <span 
class="cmmi-10">Î± </span>is the generalized toroidal angle deï¬ned
by <span 
class="cmmi-10">Î± </span>= <span 
class="cmmi-10">Ï• </span><span 
class="cmsy-10">âˆ’</span><span class="overline"><span 
class="cmmi-10">Î´</span></span> with <span class="overline"><span 
class="cmmi-10">Î´</span></span> = <span 
class="cmex-10">âˆ«</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ğœƒ</span></sup><img 
src="guiding_center_motion13x.png" alt="Ë†q"  class="circ"  /> <span 
class="cmmi-10">dğœƒ </span>and <img 
src="guiding_center_motion14x.png" alt="Ë†q"  class="circ"  /> = <span 
class="cmbx-10">B </span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">Ï•âˆ•</span>(<span 
class="cmbx-10">B </span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">ğœƒ</span>), which is the local safety factor. The time
evolution of (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) of a guiding-center is then written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3001r14"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion15x.png" alt="           --        --
dÏˆ-= âˆ‚Ïˆ-+ dX-â‹…âˆ‡-Ïˆ = dX-â‹…âˆ‡-Ïˆ,
dt   âˆ‚t    dt        dt
" class="math-display"  /></center></td><td class="equation-label">(14)</td></tr></table>
<!--l. 208--><p class="nopar" >
and similarly
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3002r15"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion16x.png" alt="      --
dğœƒ=  dX-â‹…âˆ‡ğœƒ,
dt   dt
" class="math-display"  /></center></td><td class="equation-label">(15)</td></tr></table>
<!--l. 213--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3003r16"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion17x.png" alt="       -- --
dÎ±-=  dX-â‹…âˆ‡Î±,
 dt   dt
" class="math-display"  /></center></td><td class="equation-label">(16)</td></tr></table>
<!--l. 218--><p class="nopar" >
Using the expression of <span 
class="cmmi-10">d</span><span class="overline"><span 
class="cmbx-10">X</span></span><span 
class="cmmi-10">âˆ•dt </span>given by Eq. (<a 
href="guiding_center_motionse1.html#x2-2002r10">10<!--tex4ht:ref: 18-3-29-p1 --></a>), Eqs. (<a 
href="#x3-3001r14">14<!--tex4ht:ref: 17-8-21-p1 --></a>)-(<a 
href="#x3-3003r16">16<!--tex4ht:ref: 17-8-21-p3 --></a>) can be written as (presently dropping
the <span 
class="cmbx-10">E </span><span 
class="cmsy-10">Ã— </span><span 
class="cmbx-10">B </span>drift, which will be discussed later): </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion18x.png" alt="                Z- vâˆ¥-                             --
dÏˆ- =   v --(---|Z|2Ï€âˆ‡-Ã—-b-----)-â‹…âˆ‡Ïˆ + -Z---(-------Î¼---------)--1-B-Ã—âˆ‡B--â‹…âˆ‡(Ïˆ1,7)
dt       âˆ¥B- 1+ -Z--vâˆ¥-b â‹…âˆ‡-Ã— b        |Z|2Ï€  1+ Z--vâˆ¥-bâ‹…âˆ‡-Ã— b  B2
                |Z|2Ï€B                          |Z |2Ï€B
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion19x.png" alt="             --  Z- vâˆ¥-                           --
dğœƒ  =  vâˆ¥--(-B-+-|Z|2Ï€âˆ‡-Ã—-b---)-â‹…âˆ‡ğœƒ + Z----(-------Î¼---------)--1B-Ã— âˆ‡B--â‹…âˆ‡ğœƒ(,18)
dt       B  1+  Z|Z|-vâˆ¥b â‹…âˆ‡ Ã— b        |Z |2Ï€ 1 + Z|Z|-vâˆ¥b â‹…âˆ‡ Ã— b  B2
                  2Ï€B                            2Ï€B
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion20x.png" alt="                Z- vâˆ¥-                             --
dÎ±-  =  vâˆ¥--(---|Z|2Ï€âˆ‡-Ã—-b-----)-â‹…âˆ‡Î± + Z----(-------Î¼---------)--1-B-Ã—âˆ‡B--â‹…âˆ‡(Î±1.9)
dt        B  1+ |ZZ|-vâˆ¥-b â‹…âˆ‡ Ã— b        |Z |2Ï€ 1 + Z|Z-|vâˆ¥-bâ‹…âˆ‡ Ã— b  B2
                   2Ï€B                            2Ï€B
" class="math-display"  /></center>
</div>where use has been made of <span 
class="cmbx-10">B</span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">Ïˆ </span>= 0 and <span 
class="cmbx-10">B</span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">Î± </span>= 0. The parallel acceleration equation is written as
(presently dropping the electric ï¬eld acceleration term)
   <table 
class="equation"><tr><td><a 
 id="x3-3007r20"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion21x.png" alt=" -          --  Z- vâˆ¥-
dvâˆ¥= âˆ’ Î¼--(-B-+-|Z|2Ï€âˆ‡-Ã—-b---)-â‹…âˆ‡B-
dt      B- 1+  Z|Z|-vâˆ¥b â‹…âˆ‡-Ã— b
                 2Ï€B
" class="math-display"  /></center></td><td class="equation-label">(20)</td></tr></table>
<!--l. 275--><p class="nopar" >
For a general tokamak magnetic conï¬guration speciï¬ed numerically, all the above 2D equilibrium
quantities are computed by interpolating pre-computed numerical tables. We deï¬ne the following
numerical tables:
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3008r21"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion22x.png" alt="          1-  --
W1(Ïˆ,ğœƒ) = Bb â‹…âˆ‡ Ã— b,
" class="math-display"  /></center></td><td class="equation-label">(21)</td></tr></table>
<!--l. 282--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3009r22"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion23x.png" alt="           -- --
W2 (Ïˆ,ğœƒ) = B-â‹…âˆ‡ğœƒ,
           B
" class="math-display"  /></center></td><td class="equation-label">(22)</td></tr></table>
<!--l. 286--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3010r23"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion24x.png" alt="          --
W3(Ïˆ,ğœƒ) = âˆ‡-Ã—b-â‹…âˆ‡-Ïˆ,
           B
" class="math-display"  /></center></td><td class="equation-label">(23)</td></tr></table>
<!--l. 290--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3011r24"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion25x.png" alt="          --
W4(Ïˆ,ğœƒ) = âˆ‡-Ã—-b-â‹…âˆ‡-ğœƒ,
            B
" class="math-display"  /></center></td><td class="equation-label">(24)</td></tr></table>
<!--l. 294--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3012r25"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion26x.png" alt="            --     --   --     --   --     ---
W5(Ïˆ,ğœƒ,Î±) = âˆ‡-Ã—-b-â‹…âˆ‡Î± = âˆ‡-Ã—-b-â‹…âˆ‡ Ï•âˆ’ âˆ‡-Ã—-b-â‹…âˆ‡ Î´
              B           B           B
" class="math-display"  /></center></td><td class="equation-label">(25)</td></tr></table>
<!--l. 301--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3013r26"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion27x.png" alt="           1 --  --- --
W6 (Ïˆ,ğœƒ) =--2B Ã— âˆ‡B â‹…âˆ‡ Ïˆ,
          B
" class="math-display"  /></center></td><td class="equation-label">(26)</td></tr></table>
<!--l. 306--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3014r27"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion28x.png" alt="          1 --  ---- --
W7(Ïˆ,ğœƒ) = -2B Ã— âˆ‡ B â‹…âˆ‡ğœƒ,
          B
" class="math-display"  /></center></td><td class="equation-label">(27)</td></tr></table>
<!--l. 311--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3015r28"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion29x.png" alt="             1 --  ------     1 --  --- --    1 --  --- ---
W8 (Ïˆ,ğœƒ,Î±) =--2B Ã— âˆ‡ B â‹…âˆ‡ Î± = --2B Ã— âˆ‡B â‹…âˆ‡ Ï•âˆ’ --2B Ã— âˆ‡B â‹…âˆ‡ Î´
            B                B               B
" class="math-display"  /></center></td><td class="equation-label">(28)</td></tr></table>
<!--l. 319--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3016r29"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion30x.png" alt="          B- ----
W9 (Ïˆ,ğœƒ) =--â‹…âˆ‡ B,
          B
" class="math-display"  /></center></td><td class="equation-label">(29)</td></tr></table>
<!--l. 324--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3017r30"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion31x.png" alt="           --     ---
W10(Ïˆ,ğœƒ) = âˆ‡-Ã—-b-â‹…âˆ‡B.
             B
" class="math-display"  /></center></td><td class="equation-label">(30)</td></tr></table>
<!--l. 329--><p class="nopar" >
Next, let us discuss the <span 
class="cmbx-10">E </span><span 
class="cmsy-10">Ã— </span><span 
class="cmbx-10">B </span>drift:
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3018r31"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion32x.png" alt="--           1  --  -- --
vEÃ—B â‹…âˆ‡ Ïˆ = ---â‹†E Ã— B â‹…âˆ‡Ïˆ
            BB âˆ¥
" class="math-display"  /></center></td><td class="equation-label">(31)</td></tr></table>
<!--l. 335--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3019r32"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion33x.png" alt="--           1  --  -- --
vE Ã—B â‹…âˆ‡ ğœƒ =---â‹†E Ã— B â‹…âˆ‡ğœƒ
            BB âˆ¥
" class="math-display"  /></center></td><td class="equation-label">(32)</td></tr></table>
<!--l. 341--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-3020r33"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion34x.png" alt="             1  --  -- --
vEÃ—B â‹…âˆ‡ Î± = ---â‹†E Ã— B â‹…âˆ‡Î±
            BB âˆ¥
" class="math-display"  /></center></td><td class="equation-label">(33)</td></tr></table>
<!--l. 347--><p class="nopar" >
Using <span 
class="cmmi-10">Î´</span><span class="overline"><span 
class="cmbx-10">E</span></span> = <span 
class="cmmi-10">Î´</span><span class="overline"><span 
class="cmmi-10">E</span></span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmbx-10">b </span>+ <span 
class="cmmi-10">Î´</span><span class="overline"><span 
class="cmmi-10">E</span></span><sub><span 
class="cmmi-7">x</span></sub><span class="overline"><span 
class="cmsy-10">âˆ‡</span></span><span 
class="cmmi-10">x </span>+ <span 
class="cmmi-10">Î´</span><span class="overline"><span 
class="cmmi-10">E</span></span><sub><span 
class="cmmi-7">y</span></sub><span class="overline"><span 
class="cmsy-10">âˆ‡</span></span><span 
class="cmmi-10">y</span>, where <span 
class="cmmi-10">x </span>= <span 
class="cmmi-10">Ïˆ </span>and <span 
class="cmmi-10">y </span>= <span 
class="cmmi-10">Î±</span>, the above drifts are written as
</p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion35x.png" alt="--              1   ----    -- --   -- --
vEÃ—B â‹…âˆ‡x   =  BB-â‹†(Î´Exâˆ‡x  +Î´Ey âˆ‡y) Ã—B â‹…âˆ‡x
                 âˆ¥
           =  âˆ’ -1-â‹†(Î´Ex âˆ‡x + Î´Eyâˆ‡y )Ã— âˆ‡x â‹…B-
                BB âˆ¥
                 1   -- --    --  --
           =  âˆ’ BB-â‹†(Î´Ey âˆ‡y) Ã— âˆ‡x â‹…B
                   âˆ¥
           =  --1â‹†(Î´Ey)âˆ‡x Ã— âˆ‡y â‹…B-
              B Bâˆ¥
                1   --  B- --
           =  ---â‹†(Î´Ey)--â€² â‹…B                             (34)
              B Bâˆ¥     Î¨
" class="math-display"  /></center>
</div><div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion36x.png" alt="--              1   ----    -- --   -- --
vEÃ—B â‹…âˆ‡y   =  ---â‹†(Î´Exâˆ‡x  +Î´Ey âˆ‡y) Ã—B â‹…âˆ‡y
              B Bâˆ¥
           =  âˆ’ -1--(Î´E- âˆ‡x + Î´E-âˆ‡y )Ã— âˆ‡y â‹…B-
                BB â‹†âˆ¥   x       y
                 1   -- --    --  --
           =  âˆ’ ---â‹†(Î´Ex âˆ‡x )Ã— âˆ‡y â‹…B
                BB âˆ¥     --
                -1-- --  B-- --
           =  âˆ’ BB-â‹†(Î´Ex )Î¨â€² â‹…B                            (35)
                   âˆ¥
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion37x.png" alt="--              1    ----    -- --    ----
vE Ã—B â‹…âˆ‡ğœƒ  =   BB-â‹†(Î´Exâˆ‡ Ïˆ+ Î´Ey âˆ‡Î±) Ã— Bâ‹…âˆ‡ ğœƒ
                  âˆ¥
           =   âˆ’--1â‹†(Î´ExB--â‹…âˆ‡-Ïˆ Ã— âˆ‡ğœƒ + Î´EyB--â‹…âˆ‡Î± Ã— âˆ‡-ğœƒ).          (36)
                B Bâˆ¥
" class="math-display"  /><a 
 id="x3-3023r36"></a></center>
</div>The two terms in expression (<a 
href="#x3-3023r36">36<!--tex4ht:ref: 18-10-17-p1 --></a>) can be written as <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion38x.png" alt="                    |            |
-- --    --      -- || eR  eÏ•  eZ ||
B â‹…(âˆ‡ Ïˆ Ã— âˆ‡ğœƒ)  =  B â‹…|| âˆ‚âˆ‚ÏˆR-  0  âˆ‚âˆ‚ÏˆZ-||
                    | âˆ‚âˆ‚ğœƒR-  0  âˆ‚âˆ‚ğœƒZ-|
                 -- ( âˆ‚Ïˆ âˆ‚ğœƒ   âˆ‚Ïˆ âˆ‚ğœƒ )
              =  B Ï•  âˆ‚Z-âˆ‚R-âˆ’ âˆ‚R-âˆ‚Z-

              â‰¡  W14
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion39x.png" alt="                    |               |
--  --   --      -- || eR   eÏ•   eZ  ||
B â‹…(âˆ‡Î± Ã— âˆ‡ğœƒ)  =  B â‹…|| âˆ‚âˆ‚Î±R-  1Râˆ‚âˆ‚Î±Ï•  âˆ‚âˆ‚Î±Z- ||
                    | âˆ‚âˆ‚ğœƒR-   0   âˆ‚âˆ‚ğœƒZ- |
                 -- ( 1 âˆ‚Î± âˆ‚ğœƒ )  -- ( âˆ‚Î± âˆ‚ğœƒ   âˆ‚Î±  âˆ‚ğœƒ)   -- (  1 âˆ‚Î± âˆ‚ğœƒ)
              =  BR   R-âˆ‚Ï•-âˆ‚Z- + B Ï•  âˆ‚Z-âˆ‚R-âˆ’ âˆ‚R-âˆ‚Z-  + BZ  âˆ’ R-âˆ‚Ï•-âˆ‚R-

              â‰¡  W15
" class="math-display"  /></center>
</div>
<!--l. 434--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">2.0.1   </span> <a 
 id="x3-40002.0.1"></a>Periodic conditions of particle trajectory in ï¬eld-line-following coordinates</h5>
<!--l. 436--><p class="noindent" >Note that <span 
class="cmmi-10">ğœƒ</span>(<span 
class="cmbx-10">r</span>) and <span 
class="cmmi-10">Ï•</span>(<span 
class="cmbx-10">r</span>) are multi-valued functions whereas <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">ğœƒ</span>(<span 
class="cmbx-10">r</span>) and <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">Ï•</span>(<span 
class="cmbx-10">r</span>) happen to be
single-valued functions. However <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">Î±</span>(<span 
class="cmbx-10">r</span>) and <span 
class="cmsy-10">âˆ‡</span><span class="overline"><span 
class="cmmi-10">Î´</span></span>(<span 
class="cmbx-10">r</span>) are still multi-valued functions. [It is ready to see
this by examining the special case that <span 
class="cmmi-10">ğœƒ </span>is a straight-ï¬eld line poloidal angle, in which <span class="overline"><span 
class="cmmi-10">Î´</span></span> = <span 
class="cmex-10">âˆ«</span>
 <sub><span 
class="cmmi-7">ğœƒ</span><sub><span 
class="cmr-5">ref</span></sub></sub><sup><span 
class="cmmi-7">ğœƒ</span></sup><img 
src="guiding_center_motion40x.png" alt="Ë†q"  class="circ"  /> <span 
class="cmmi-10">dğœƒ </span>is
simpliï¬ed to <span 
class="cmmi-10">qğœƒ</span>. Then <span 
class="cmsy-10">âˆ‡</span><span class="overline"><span 
class="cmmi-10">Î´</span></span> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x3-4001r37"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion41x.png" alt="  -
âˆ‡ Î´ = ğœƒâˆ‡q + qâˆ‡ ğœƒ,
" class="math-display"  /></center></td><td class="equation-label">(37)</td></tr></table>
<!--l. 446--><p class="nopar" >
where the ï¬rst term <span 
class="cmmi-10">ğœƒ</span><span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">q </span>is a multi-valued function since <span 
class="cmmi-10">ğœƒ </span>is multi-valued.]
</p><!--l. 450--><p class="indent" >   For multi-valued functions, if a single branch is chosen, then there will be discontinuity at the the
branch cut. In numerically constructing the coordinates (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>), the principal value of <span 
class="cmmi-10">ğœƒ </span>is chosen in
the range [<span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>: <span 
class="cmmi-10">Ï€</span>) and the branch cut for <span 
class="cmmi-10">ğœƒ </span>is chosen on the high-ï¬eld-side midplane. The toroidal shift
<span class="overline"><span 
class="cmmi-10">Î´</span></span> = <span 
class="cmex-10">âˆ«</span>
 <sub><span 
class="cmmi-7">ğœƒ</span><sub><span 
class="cmr-5">ref</span></sub></sub><sup><span 
class="cmmi-7">ğœƒ</span></sup><img 
src="guiding_center_motion42x.png" alt="Ë†q"  class="circ"  /> <span 
class="cmmi-10">dğœƒ </span>can be considered as a derived angle based on <span 
class="cmmi-10">ğœƒ </span>and thus its principal value and branch
cut are determined by those of <span 
class="cmmi-10">ğœƒ</span>.
</p><!--l. 459--><p class="indent" >   The (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) coordinates of a particle change continuously when we evolve them by integrating Eqs.
(<a 
href="#x3-3001r14">14<!--tex4ht:ref: 17-8-21-p1 --></a>)-(<a 
href="#x3-3003r16">16<!--tex4ht:ref: 17-8-21-p3 --></a>), during which <span 
class="cmmi-10">ğœƒ </span>can move beyond [<span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€,Ï€</span>). When a particleâ€™s <span 
class="cmmi-10">ğœƒ </span>moves beyond the range
[<span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>: <span 
class="cmmi-10">Ï€</span>), one or multiple <span 
class="cmsy-10">Â±</span>2<span 
class="cmmi-10">Ï€ </span>shifts are imposed on <span 
class="cmmi-10">ğœƒ </span>until <span 
class="cmmi-10">ğœƒ </span>are within [<span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>: <span 
class="cmmi-10">Ï€</span>). Note that a
corresponding shift in <span 
class="cmmi-10">Î± </span>is needed to keep the particle at the same spatial location when doing the <span 
class="cmmi-10">ğœƒ</span>
shift. This is because, although (<span 
class="cmmi-10">Ïˆ,ğœƒ,Ï•</span>) and (<span 
class="cmmi-10">Ïˆ,ğœƒ </span><span 
class="cmsy-10">âˆ’ </span>2<span 
class="cmmi-10">mÏ€,Ï•</span>) correspond to the same spatial location,
points (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) and (<span 
class="cmmi-10">Ïˆ,ğœƒ </span><span 
class="cmsy-10">âˆ’ </span>2<span 
class="cmmi-10">mÏ€,Î±</span>) do not, where <span 
class="cmmi-10">m </span>is an integer. Speciï¬cally, the usual
toroidal angle <span 
class="cmmi-10">Ï• </span>of point (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) is <span 
class="cmmi-10">Ï•</span><sub><span 
class="cmr-7">1</span></sub> = <span 
class="cmmi-10">Î± </span>+ <span 
class="cmex-10">âˆ«</span>
 <sub><span 
class="cmmi-7">ğœƒ</span><sub><span 
class="cmr-5">ref</span></sub></sub><sup><span 
class="cmmi-7">ğœƒ</span></sup><img 
src="guiding_center_motion43x.png" alt="Ë†q"  class="circ"  /> <span 
class="cmmi-10">dğœƒ </span>while <span 
class="cmmi-10">Ï• </span>of point (<span 
class="cmmi-10">Ïˆ,ğœƒ </span><span 
class="cmsy-10">âˆ’ </span>2<span 
class="cmmi-10">mÏ€,Î±</span>) is
<span 
class="cmmi-10">Ï•</span><sub><span 
class="cmr-7">2</span></sub> = <span 
class="cmmi-10">Î± </span>+ <span 
class="cmex-10">âˆ«</span>
 <sub><span 
class="cmmi-7">ğœƒ</span><sub><span 
class="cmr-5">ref</span></sub></sub><sup><span 
class="cmmi-7">ğœƒ</span><span 
class="cmsy-7">âˆ’</span><span 
class="cmr-7">2</span><span 
class="cmmi-7">mÏ€</span></sup><img 
src="guiding_center_motion44x.png" alt="qË†"  class="circ"  /> <span 
class="cmmi-10">dğœƒ</span>. The diï¬€erence between <span 
class="cmmi-10">Ï•</span><sub><span 
class="cmr-7">1</span></sub> and <span 
class="cmmi-10">Ï•</span><sub><span 
class="cmr-7">2</span></sub> is <span 
class="cmmi-10">Ï•</span><sub><span 
class="cmr-7">2</span></sub> <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï•</span><sub><span 
class="cmr-7">1</span></sub> = <span 
class="cmsy-10">âˆ’</span>2<span 
class="cmmi-10">mÏ€q</span>. This indicates that, to
keep the point at the same spatial location when shifting <span 
class="cmmi-10">ğœƒ </span>by <span 
class="cmsy-10">âˆ’</span>2<span 
class="cmmi-10">mÏ€</span>, <span 
class="cmmi-10">Î± </span>should be shifted
                                                                                

                                                                                
by +2<span 
class="cmmi-10">mÏ€q</span>, i.e., the new coordinates of the point should be (<span 
class="cmmi-10">Ïˆ,ğœƒ </span><span 
class="cmsy-10">âˆ’ </span>2<span 
class="cmmi-10">mÏ€,Î± </span>+ 2<span 
class="cmmi-10">mÏ€q</span>). This
process is illustrated in Fig. <a 
href="#x3-40021">1<!--tex4ht:ref: 17-11-4-1 --></a>. A typical evolution of (<span 
class="cmmi-10">ğœƒ,Î±</span>) involving shifting is shown in Fig.
<a 
href="#x3-40032">2<!--tex4ht:ref: 18-2-4-p1 --></a>.
</p><!--l. 481--><p class="indent" >   Â 
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x3-40021"></a>
                                                                                

                                                                                
<!--l. 484--><p class="noindent" > <img 
src="my_figure/home/yj/theory/guiding_center_motion/figures/fig1/shift-1.png" alt="pict"  
 width="265.99374pt" />
<br /> </p><div class="caption" 
><span class="id">FigureÂ 1: </span><span  
class="content">To keep the point at the same spatial location when shifting <span 
class="cmmi-10">ğœƒ </span>by <span 
class="cmsy-10">âˆ’</span>2<span 
class="cmmi-10">Ï€</span>, <span 
class="cmmi-10">Î± </span>should be
shifted by +2<span 
class="cmmi-10">Ï€q</span>. Here <span 
class="cmmi-10">A </span>and <span 
class="cmmi-10">C </span>correspond to the same spatial location, but <span 
class="cmmi-10">B </span>is at a diï¬€erent
location.</span></div><!--tex4ht:label?: x3-40021 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 491--><p class="indent" >   Â 
</p><!--l. 493--><p class="indent" >   Â 
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x3-40032"></a>
                                                                                

                                                                                
<!--l. 496--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/fig_lorentz/fig2018-2-3e1/f.png" alt="pict"  
 width="524.96124pt" />
<br /> </p><div class="caption" 
><span class="id">FigureÂ 2: </span><span  
class="content">Temporal evolution of (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) of a passing electron. The range of <span 
class="cmmi-10">ğœƒ </span>is chosen to be
[<span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>: <span 
class="cmmi-10">Ï€</span>] and the range of <span 
class="cmmi-10">Î± </span>and <span 
class="cmmi-10">Ï• </span>is [0 : 2<span 
class="cmmi-10">Ï€</span>]. When <span 
class="cmmi-10">ğœƒ </span>exceed the range, a 2<span 
class="cmmi-10">Ï€ </span>shift is imposed,
which generate the jump of <span 
class="cmmi-10">ğœƒ </span>in (b) and also the corresponding jump of <span 
class="cmmi-10">Î± </span>in (c). Note that
when a jump in (<span 
class="cmmi-10">ğœƒ,Î±</span>) occurs, no jump in <span 
class="cmmi-10">Ï•</span>, which is what we expect, otherwise there must
be something wrong. Also note that there are also jumps of <span 
class="cmmi-10">Ï• </span>shown in (c), which is due to <span 
class="cmmi-10">Ï•</span>
exceeding the range [0 : 2<span 
class="cmmi-10">Ï€</span>] and a 2<span 
class="cmmi-10">Ï€ </span>shift being imposed. This jump has nothing to do with the
jump in <span 
class="cmmi-10">ğœƒ </span>or <span 
class="cmmi-10">Î± </span>and usually occur at diï¬€erent time (one jump of <span 
class="cmmi-10">Ï• </span>is near the jump of <span 
class="cmmi-10">Î±</span>, which
is only a coincidence). Here <span 
class="cmmi-10">Ï• </span>is computed using <span 
class="cmmi-10">Ï• </span>= <span 
class="cmmi-10">Î± </span>+<span class="overline"> <span 
class="cmmi-10">Î´</span></span>, where <span class="overline"><span 
class="cmmi-10">Î´</span></span> is obtained by interpolating
the 2D numerical table of <span class="overline"><span 
class="cmmi-10">Î´</span></span>(<span 
class="cmmi-10">Ïˆ,ğœƒ</span>). DIID-D cyclone base case</span></div><!--tex4ht:label?: x3-40032 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 514--><p class="indent" >   Â 
</p><!--l. 516--><p class="indent" >   When <span 
class="cmmi-10">Î± </span>exceeds the range [0 : 2<span 
class="cmmi-10">Ï€</span>], one or multiple <span 
class="cmsy-10">Â±</span>2<span 
class="cmmi-10">Ï€ </span>shifts are imposed on <span 
class="cmmi-10">Î± </span>until <span 
class="cmmi-10">Î±</span>
are within [0 : 2<span 
class="cmmi-10">Ï€</span>]. Since, for ï¬xed <span 
class="cmmi-10">Ïˆ </span>and <span 
class="cmmi-10">ğœƒ</span>, the generalized toroidal angle <span 
class="cmmi-10">Î± </span>is equivalent
to the usual toroidal angle <span 
class="cmmi-10">Ï•</span>. No complication like the case of <span 
class="cmmi-10">ğœƒ </span>arises when doing the <span 
class="cmmi-10">Î±</span>
shift.
</p><!--l. 522--><p class="indent" >   One way of avoiding the subtle (<span 
class="cmmi-10">ğœƒ,Î±</span>) shift problem is to evolve particlesâ€™ <span 
class="cmmi-10">Ï•</span>, instead of <span 
class="cmmi-10">Î±</span>. In this
case, we have
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion45x.png" alt="                      --  ----
dÏ•-  -- --      - ----B-+-v2âˆ¥Ï€âˆ‡-Ã—-b---- --    ---------Î¼----------1---  --- --
dt = vd â‹…âˆ‡ Ï• =  vâˆ¥--(    -vâˆ¥--  --   ) â‹…âˆ‡ Ï• +   (    vâˆ¥--  --   )B2 B Ã— âˆ‡B â‹…âˆ‡(Ï•3,8)
                  B  1 + 2Ï€Bb â‹…âˆ‡ Ã— b        2Ï€ 1 + 2Ï€Bb â‹…âˆ‡ Ã—b
" class="math-display"  /></center>
</div>After getting <span 
class="cmmi-10">Ï•</span>, we use <span 
class="cmmi-10">Î± </span>= <span 
class="cmmi-10">Ï• </span><span 
class="cmsy-10">âˆ’</span><span class="overline"><span 
class="cmmi-10">Î´</span></span>(<span 
class="cmmi-10">Ïˆ,ğœƒ</span>) to get particlesâ€™ <span 
class="cmmi-10">Î±</span>, where <span class="overline"><span 
class="cmmi-10">Î´</span></span> is obtained by interpolating the
numerical table in (<span 
class="cmmi-10">Ïˆ,ğœƒ</span>) plane. I have tested the two ways of computing evolution of <span 
class="cmmi-10">Î±</span>, which indicates
their results agree with each other. In the ï¬nal codes, I use the (<span 
class="cmmi-10">ğœƒ,Î±</span>) shift method, because this
methods involve less interpolation and thus more eï¬ƒcient.
   <h5 class="subsubsectionHead"><span class="titlemark">2.0.2   </span> <a 
 id="x3-50002.0.2"></a>Benchmarking cases</h5>
<!--l. 548--><p class="noindent" >To verify code implementation, two methods are used to compute the guiding-center orbits. The ï¬rst
method uses the cylindrical coordinates and then interpolate the orbits into magnetic coordinates using
pre-computed mapping table between the cylindrical and magnetic coordinates. The second method
directly uses the magnetic coordinates in pushing the orbits. The following ï¬gures compare the results
obtained by these two methods, which indicates they agree with each other. This provides conï¬dence
on the correctness of the numerical implementation.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x3-50013"></a>
                                                                                

                                                                                
<!--l. 558--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/fig_lorentz/fig2018-2-3e1/figb/f.png" alt="pict"  
 width="518.93875pt" />
<br /> </p><div class="caption" 
><span class="id">FigureÂ 3: </span><span  
class="content">Comparison between the temporal evolution of (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) of a passing electron computed
by two methods: the blue lines are the results computed directly in (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) ï¬eld-line-following
coordinates, the red lines are results computed in cylindrical coordinates and then interpolated
to the ï¬eld-line-following coordinates. There is systematical discrepancy between <span 
class="cmmi-10">Ïˆ </span>computed by
the two methods. The results are actually very close to each other and the diï¬€erence becomes
obvious because the variation of <span 
class="cmmi-10">Ïˆ </span>is very small for a passing electron. The results of <span 
class="cmmi-10">Î± </span>from the
two methods also agree with each other. The discrepancy near <span 
class="cmmi-10">t</span>Î©<sub><span 
class="cmmi-7">i</span></sub> = 400 is due to that <span 
class="cmmi-10">Î± </span>is close
to 2<span 
class="cmmi-10">Ï€</span>, and one result becomes zero, which is equivalent to 2<span 
class="cmmi-10">Ï€</span>. equilibrium is the DIID-D cyclone
base case</span></div><!--tex4ht:label?: x3-50013 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 574--><p class="indent" >   Â 
</p><!--l. 576--><p class="indent" >   Â 
</p><!--l. 578--><p class="indent" >   Â 
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x3-50024"></a>
                                                                                

                                                                                
<!--l. 581--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2e/p.png" alt="pict"  
 width="102.38249pt" /> <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2/p.png" alt="pict"  
 width="218.8175pt" />
<br /> </p><div class="caption" 
><span class="id">FigureÂ 4: </span><span  
class="content">Left: orbit on poloidal plane. Right: <span 
class="cmmi-10">Î± </span>is deï¬ned by <span 
class="cmmi-10">Î± </span>= <span 
class="cmmi-10">Ï• </span><span 
class="cmsy-10">âˆ’</span><span 
class="cmex-10">âˆ«</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ğœƒ</span></sup><img 
src="guiding_center_motion46x.png" alt="Ë†q"  class="circ"  /> <span 
class="cmmi-10">dğœƒ, </span>where <span 
class="cmmi-10">Ï• </span>is the
usual cylindrical toroidal angle.</span></div><!--tex4ht:label?: x3-50024 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 587--><p class="indent" >   Â 
</p><!--l. 589--><p class="indent" >   Â 
</p><!--l. 591--><p class="indent" >   Â 
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                

                                                                                
<a 
 id="x3-50035"></a>
                                                                                

                                                                                
<!--l. 594--><p class="noindent" >Â 
</p><!--l. 596--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2c/p.png" alt="pict"  
 width="221.82875pt" />                                 <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2f/p.png" alt="pict"  
 width="222.8325pt" />
</p><!--l. 598--><p class="noindent" > <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2b/p.png" alt="pict"  
 width="218.8175pt" />                                 <img 
src="my_figure/home/yj/project_new/lorentz_ions/figures/fig2d/p.png" alt="pict"  
 width="218.8175pt" />
<br /> </p><div class="caption" 
><span class="id">FigureÂ 5: </span><span  
class="content">The evolutions of the poloidal angles <span 
class="cmmi-10">ğœƒ </span>and generalized toroidal angle <span 
class="cmmi-10">Î± </span>calculated by
the two methods agree with each other.   <span 
class="cmmi-10">r </span>= <img 
src="guiding_center_motion47x.png" alt="âˆ˜ ------
  Î¨Î¨âˆ’bÎ¨âˆ’0Î¨0"  class="sqrt"  /></span></div><!--tex4ht:label?: x3-50035 -->
                                                                                

                                                                                
   </div><hr class="endfigure" />
<!--l. 604--><p class="indent" >   Â 
                                                                                

                                                                                
</p>
   <!--l. 606--><div class="crosslinks"><p class="noindent">[<a 
href="guiding_center_motionse3.html" >next</a>] [<a 
href="guiding_center_motionse1.html" >prev</a>] [<a 
href="guiding_center_motionse1.html#tailguiding_center_motionse1.html" >prev-tail</a>] [<a 
href="guiding_center_motionse2.html" >front</a>] [<a 
href="guiding_center_motion.html#guiding_center_motionse2.html" >up</a>] </p></div>
<!--l. 606--><p class="indent" >   <a 
 id="tailguiding_center_motionse2.html"></a>  </p> 
</body></html> 
