<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Equations of guiding-center motion—outdated, will be deleted</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,2,charset=utf-8,html --> 
<meta name="src" content="guiding_center_motion.tex" /> 
<link rel="stylesheet" type="text/css" href="guiding_center_motion.css" /> 
</head><body 
>
   <!--l. 2051--><div class="crosslinks"><p class="noindent"><span 
class="ecrm-1000">[</span><a 
href="guiding_center_motionli1.html" ><span 
class="ecrm-1000">next</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motionse7.html" ><span 
class="ecrm-1000">prev</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motionse7.html#tailguiding_center_motionse7.html" ><span 
class="ecrm-1000">prev-tail</span></a><span 
class="ecrm-1000">] [</span><a 
href="#tailguiding_center_motionse8.html"><span 
class="ecrm-1000">tail</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motion.html#guiding_center_motionse8.html" ><span 
class="ecrm-1000">up</span></a><span 
class="ecrm-1000">] </span></p></div>
   <h3 class="sectionHead"><span class="titlemark"><span 
class="ecrm-1000">8   </span></span> <a 
 id="x9-260008"></a><span 
class="ecrm-1000">Equations of guiding-center motion—outdated, will be deleted</span></h3>
<!--l. 2053--><p class="noindent" ><span 
class="ecrm-1000">YJ’s remark: This section is outdated because I have found a more accurate form of the equations of</span>
<span 
class="ecrm-1000">the guiding center motion, as given in Sec. </span><a 
href="guiding_center_motionse1.html#x2-10001"><span 
class="ecrm-1000">1</span><!--tex4ht:ref: 5-15-e1 --></a><span 
class="ecrm-1000">. Besides to be more accurate, the new form is compact and</span>
<span 
class="ecrm-1000">suitable for numerical implemention</span>
</p><!--l. 2058--><p class="indent" >   <span 
class="ecrm-1000">The equations for the guiding center motion are given by (refer to my note</span>
<span 
class="ecrm-1000">“collisionless_drift_kinetic_equation.tm”)</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-26001r147"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion197x.png" alt="               (           )
X˙ = v∥b + 1-b×   μ-∇B + v2∥κ ,
          Ω      m
" class="math-display"  /></center></td><td class="equation-label">(147)</td></tr></table>
<!--l. 2064--><p class="nopar" >
<span 
class="ecrm-1000">and</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-26002r148"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion198x.png" alt="       μ
v˙∥ = −m-b ⋅∇B + v∥κ ⋅ ˙X,
" class="math-display"  /></center></td><td class="equation-label">(148)</td></tr></table>
<!--l. 2069--><p class="nopar" >
<span 
class="ecrm-1000">where </span><span 
class="cmmi-10">μ </span><span 
class="cmsy-10">≡ </span><span 
class="cmmi-10">mv</span><sub><span 
class="cmsy-7">⊥</span></sub><sup><span 
class="cmr-7">2</span></sup><span 
class="cmmi-10">∕</span>(2<span 
class="cmmi-10">B</span>)<span 
class="ecrm-1000">, </span><span 
class="cmbx-10">b </span>= <span 
class="cmbx-10">B</span><span 
class="cmmi-10">∕B</span><span 
class="ecrm-1000">. The term </span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">∥</span></sub><span 
class="cmmi-10">κ</span><span 
class="cmsy-10">⋅</span><img 
src="guiding_center_motion199x.png" alt="˙
X"  class="dot"  /> <span 
class="ecrm-1000">in Eq. (</span><a 
href="#x9-26002r148"><span 
class="ecrm-1000">148</span><!--tex4ht:ref: 1-28-p1 --></a><span 
class="ecrm-1000">) can be further simpliﬁed by using Eq.</span>
<span 
class="ecrm-1000">(</span><a 
href="#x9-26001r147"><span 
class="ecrm-1000">147</span><!--tex4ht:ref: 11-17-7 --></a><span 
class="ecrm-1000">), which gives</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-26003r149"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion200x.png" alt="       μ         v∥μ
v˙∥ = −m-b ⋅∇B +  mΩ-κ⋅b × ∇B
" class="math-display"  /></center></td><td class="equation-label">(149)</td></tr></table>
<!--l. 2077--><p class="nopar" >
<span 
class="ecrm-1000">where use has been made of that the curvature </span><span 
class="cmmi-10">κ </span><span 
class="ecrm-1000">is perpendicular to </span><span 
class="cmbx-10">b</span><span 
class="ecrm-1000">.</span>
</p><!--l. 2081--><p class="indent" >   <span 
class="ecrm-1000">[Benchmark: In GTC simulation (refer to H. Zhang’s paper</span><span class="cite"><span 
class="ecrm-1000">[</span><a 
href="guiding_center_motionli1.html#Xzhang2010"><span 
class="ecrm-1000">6</span></a><span 
class="ecrm-1000">]</span></span><span 
class="ecrm-1000">), the time derivative of </span><span 
class="cmmi-10">v</span><sub><span 
class="cmsy-7">∥</span></sub> <span 
class="ecrm-1000">is given</span>
<span 
class="ecrm-1000">by</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-26004r150"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion201x.png" alt="      B + Bv∥∕Ωα∇ × b
˙v∥ = −------mB--------⋅μ∇B
" class="math-display"  /></center></td><td class="equation-label">(150)</td></tr></table>
<!--l. 2086--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-26005r151"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion202x.png" alt="          μ-        v∥μ-
=⇒  ˙v∥ = − m b⋅∇B − mΩ ∇ × b ⋅∇B,
" class="math-display"  /></center></td><td class="equation-label">(151)</td></tr></table>
<!--l. 2091--><p class="nopar" >
<span 
class="ecrm-1000">Next, I prove Eq. (</span><a 
href="#x9-26003r149"><span 
class="ecrm-1000">149</span><!--tex4ht:ref: 11-17-8 --></a><span 
class="ecrm-1000">) is equivalent to Eq. (</span><a 
href="#x9-26005r151"><span 
class="ecrm-1000">151</span><!--tex4ht:ref: 1-31-1 --></a><span 
class="ecrm-1000">). Using </span><span 
class="cmmi-10">κ </span><span 
class="cmsy-10">≡ </span><span 
class="cmbx-10">b</span><span 
class="cmsy-10">⋅∇</span><span 
class="cmbx-10">b </span>= <span 
class="cmsy-10">−</span><span 
class="cmbx-10">b</span><span 
class="cmsy-10">×∇×</span><span 
class="cmbx-10">b</span><span 
class="ecrm-1000">, the second term on</span>
<span 
class="ecrm-1000">the right-hand side of Eq. (</span><a 
href="#x9-26003r149"><span 
class="ecrm-1000">149</span><!--tex4ht:ref: 11-17-8 --></a><span 
class="ecrm-1000">) is written as</span> </p><div class="eqnarray">
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion203x.png" alt="v∥μ-                v∥μ-
m Ω κ⋅b × ∇B   =  − m Ω(b ×∇ × b )⋅(b × ∇B )
               =  − v∥μ∇ × b ⋅∇B + v∥μ-(b ⋅∇B )(∇ ×b ⋅b)
                    m Ω            m Ω
               ≈  − v∥μ∇ × b ⋅∇B + 0,                          (152)
                    m Ω
" class="math-display"  /><a 
 id="x9-26006r152"></a></center>
</div><span 
class="ecrm-1000">where in obtaining the last equality, use has been made of that </span><span 
class="cmsy-10">∇× </span><span 
class="cmbx-10">b </span><span 
class="cmsy-10">⋅ </span><span 
class="cmbx-10">b </span><span 
class="cmsy-10">≈ </span>0 <span 
class="ecrm-1000">(note that this is</span>
<span 
class="ecrm-1000">correct to the order considered here, I will discuss this later). Using </span><span 
class="ecrm-1000"> Eq. (</span><a 
href="#x9-26006r152"><span 
class="ecrm-1000">152</span><!--tex4ht:ref: 1-29-1 --></a><span 
class="ecrm-1000">) in Eq. (</span><a 
href="#x9-26003r149"><span 
class="ecrm-1000">149</span><!--tex4ht:ref: 11-17-8 --></a><span 
class="ecrm-1000">)</span>
<span 
class="ecrm-1000">yields</span>
   <table 
class="equation"><tr><td><a 
 id="x9-26007r153"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion204x.png" alt="      μ         v∥μ
˙v∥ = − m-b⋅∇B − m-Ω∇ × b ⋅∇B,
" class="math-display"  /></center></td><td class="equation-label">(153)</td></tr></table>
<!--l. 2114--><p class="nopar" >
<span 
class="ecrm-1000">which is identical with Eq. (</span><a 
href="#x9-26005r151"><span 
class="ecrm-1000">151</span><!--tex4ht:ref: 1-31-1 --></a><span 
class="ecrm-1000">).]</span>
</p><!--l. 2117--><p class="indent" >   <span 
class="ecrm-1000"> </span>
</p><!--l. 2119--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark"><span 
class="ecrm-1000">8.1   </span></span> <a 
 id="x9-270008.1"></a><span 
class="ecrm-1000">Equilibrium magnetic ﬁeld in tokamak</span></h4>
<!--l. 2121--><p class="noindent" ><span 
class="ecrm-1000">The tokamak equilbrium magnetic ﬁeld can be written</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27001r154"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion205x.png" alt="B = ∇Ψ × ∇ ϕ+ g(Ψ)∇ ϕ.
" class="math-display"  /></center></td><td class="equation-label">(154)</td></tr></table>
<!--l. 2125--><p class="nopar" >
<span 
class="ecrm-1000">In my code, the values of the two free functions, </span>Ψ = Ψ(<span 
class="cmmi-10">R,Z</span>) <span 
class="ecrm-1000">and </span><span 
class="cmmi-10">g</span>(Ψ)<span 
class="ecrm-1000">, which sepcify the magnetic</span>
<span 
class="ecrm-1000">ﬁeld, is read from the output ﬁle “G-eqdsk-ﬁle” of EFIT code. Using Eq. (</span><a 
href="#x9-27001r154"><span 
class="ecrm-1000">154</span><!--tex4ht:ref: 10-28-e1 --></a><span 
class="ecrm-1000">), the axisymmetric</span>
<span 
class="ecrm-1000">equilibrium magnetic ﬁeld can be written as</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27002r155"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion206x.png" alt="BR = −-1∂Ψ-,
      R ∂Z
" class="math-display"  /></center></td><td class="equation-label">(155)</td></tr></table>
<!--l. 2132--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27003r156"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion207x.png" alt="BZ =  1-∂Ψ,
      R ∂R
" class="math-display"  /></center></td><td class="equation-label">(156)</td></tr></table>
<!--l. 2135--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27004r157"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="guiding_center_motion208x.png" alt="     g(Ψ)
Bϕ =  R  .
" class="math-display"  /></center></td><td class="equation-label">(157)</td></tr></table>
<!--l. 2138--><p class="nopar" >
<span 
class="ecrm-1000">The partial derivative of the component of the magnetic ﬁeld is written as</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27005r158"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion209x.png" alt="∂BR-  -1-∂Ψ-   1-∂2Ψ--
∂R  = R2 ∂Z −  R∂Z ∂R
" class="math-display"  /></center></td><td class="equation-label">(158)</td></tr></table>
<!--l. 2144--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27006r159"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion210x.png" alt="∂BR-    1-∂2Ψ-
∂Z  = − R ∂Z2
" class="math-display"  /></center></td><td class="equation-label">(159)</td></tr></table>
<!--l. 2148--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27007r160"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion211x.png" alt="∂BZ-    -1-∂Ψ-  1-∂2Ψ-
∂R  = − R2 ∂R + R ∂R2
" class="math-display"  /></center></td><td class="equation-label">(160)</td></tr></table>
<!--l. 2152--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27008r161"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion212x.png" alt="∂BZ-  -1-∂2Ψ--
∂Z  = R ∂R ∂Z
" class="math-display"  /></center></td><td class="equation-label">(161)</td></tr></table>
<!--l. 2156--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27009r162"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion213x.png" alt="∂Bϕ-    1--      1-′   ∂Ψ-
∂R  = − R2g(Ψ) + Rg (Ψ)∂R
" class="math-display"  /></center></td><td class="equation-label">(162)</td></tr></table>
<!--l. 2161--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27010r163"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion214x.png" alt="∂Bϕ-= -1g′(Ψ )∂Ψ-
∂Z    R      ∂Z
" class="math-display"  /></center></td><td class="equation-label">(163)</td></tr></table>
<!--l. 2165--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-27011r164"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion215x.png" alt="         ∘ --------------------
       1   (∂ Ψ)2   (∂ Ψ)2
⇒  B = --   ---   +  ---   + g2
       R    ∂R        ∂Z
" class="math-display"  /></center></td><td class="equation-label">(164)</td></tr></table>
<!--l. 2172--><p class="nopar" >
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="guiding_center_motion216x.png" alt="∂B         1      1 1  1 (  ∂Ψ ∂2Ψ    ∂Ψ  ∂2Ψ      ∂g )
∂R-  =  − R2-BR + R-2BR-- 2 ∂R-∂R2-+ 2∂Z-∂Z∂R--+ 2g∂R-
                   (     2         2        )
     =  − B-+ --12  ∂-Ψ∂-Ψ2 + ∂Ψ--∂-Ψ--+g ∂g-                  (165)
          R   BR    ∂R ∂R     ∂Z ∂Z∂R     ∂R
" class="math-display"  /></center>
</div>
   <div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="guiding_center_motion217x.png" alt="               (                            )
∂B-  =  -11 -1-- 2∂Ψ--∂2Ψ--+ 2∂Ψ-∂2Ψ-+ 2g ∂g
∂Z      R 2 BR    ∂R ∂R∂Z     ∂Z ∂Z2     ∂Z
          1  (∂ Ψ ∂2Ψ    ∂Ψ ∂2Ψ     ∂g)
     =  BR2-  ∂R-∂R-∂Z-+ ∂Z-∂Z2- +g ∂Z-                   (166)
" class="math-display"  /></center>
</div>
<!--l. 2198--><p class="indent" >   <span 
class="ecrm-1000">In my numerical code, the numerical data of the poloidal ﬂux function </span>Ψ(<span 
class="cmmi-10">R,Z</span>) <span 
class="ecrm-1000">and toroidal ﬁeld</span>
<span 
class="ecrm-1000">function </span><span 
class="cmmi-10">g</span>(Ψ) <span 
class="ecrm-1000">are read in from the output G-eqdsk ﬁle of the EFIT code. Then all the partial</span>
<span 
class="ecrm-1000">derivatives are calculated by using central ﬁnite-diﬀerence. The linear interpolation is used to evaluate</span>
<span 
class="ecrm-1000">the various quantities that are needed at the instantenous location of guiding-centers to push the</span>
<span 
class="ecrm-1000">orbits.</span>
</p><!--l. 2205--><p class="indent" >   <span 
class="ecrm-1000"> </span>
</p><!--l. 2207--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark"><span 
class="ecrm-1000">8.1.1   </span></span> <a 
 id="x9-280008.1.1"></a><span 
class="ecrm-1000">Solov</span><span 
class="ecrm-1000">év equilibrium</span></h5>
<!--l. 2209--><p class="noindent" ><span 
class="ecrm-1000">When I began to write the guiding center orbit code, in order to avoid the numerical interpolating, I</span>
<span 
class="ecrm-1000">use Solovev’s analytic equilibrium. (The latest version of my code constructs magnetic ﬁeld by reading</span>
<span 
class="ecrm-1000">the output G-eqdsk ﬁle of the EFIT code and thus can treat general tokamak magnetic ﬁeld.) The</span>
<span 
class="ecrm-1000">Solov</span><span 
class="ecrm-1000">év equilibrium is an analytic equilibrium in which the poloidal ﬂux function </span>Ψ <span 
class="ecrm-1000">is given</span>
<span 
class="ecrm-1000">by</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-28001r167"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion218x.png" alt="       B    [       κ2         ]
Ψ = ---20--  R2Z2 + -0(R2 − R20)2 ,
    2R 0κ0q0         4
" class="math-display"  /></center></td><td class="equation-label">(167)</td></tr></table>
<!--l. 2218--><p class="nopar" >
<span 
class="ecrm-1000">where </span><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub><span 
class="ecrm-1000">, </span><span 
class="cmmi-10">R</span><sub><span 
class="cmr-7">0</span></sub><span 
class="ecrm-1000">, </span><span 
class="cmmi-10">κ</span><sub><span 
class="cmr-7">0</span></sub><span 
class="ecrm-1000">, </span><span 
class="cmmi-10">q</span><sub><span 
class="cmr-7">0</span></sub> <span 
class="ecrm-1000">are constant parameters. Using Eq. (</span><a 
href="#x9-28001r167"><span 
class="ecrm-1000">167</span><!--tex4ht:ref: 11-21-p1 --></a><span 
class="ecrm-1000">), the partial derivatives are written</span>
<span 
class="ecrm-1000">as</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-28002r168"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion219x.png" alt="∂Ψ      B                         ∂Ψ     B
---= ---20-- [2RZ2 + κ20(R2 − R20)R],---= --2-0-R2Z.
∂R   2R 0κ0q0                     ∂Z   R 0κ0q0
" class="math-display"  /></center></td><td class="equation-label">(168)</td></tr></table>
<!--l. 2225--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-28003r169"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion220x.png" alt="∂2Ψ      B
---2 =---20-- [2Z2 + κ20(3R2 − R20)]
∂R    2R 0κ0q0
" class="math-display"  /></center></td><td class="equation-label">(169)</td></tr></table>
<!--l. 2230--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-28004r170"></a>
   <center class="math-display" >
<img 
src="guiding_center_motion221x.png" alt="∂2Ψ     B        ∂2Ψ      2B
---2 = -2-0--R2,------= --2-0-RZ
∂Z     R0κ0q0   ∂R ∂Z   R 0κ0q0
" class="math-display"  /></center></td><td class="equation-label">(170)</td></tr></table>
<!--l. 2235--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x9-28005r171"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="guiding_center_motion222x.png" alt="
" class="math-display"  /></center></td><td class="equation-label">(171)</td></tr></table>
<!--l. 2238--><p class="nopar" >
<span 
class="ecrm-1000">The toroidal ﬁeld function </span><span 
class="cmmi-10">g </span><span 
class="ecrm-1000">is a constant function, </span><span 
class="cmmi-10">g </span>= <span 
class="cmmi-10">c</span><sub><span 
class="cmmi-7">g</span></sub><span 
class="cmmi-10">R</span><sub><span 
class="cmr-7">0</span></sub><span 
class="cmmi-10">B</span><sub><span 
class="cmr-7">0</span></sub><span 
class="ecrm-1000">, where </span><span 
class="cmmi-10">c</span><sub><span 
class="cmmi-7">g</span></sub> <span 
class="ecrm-1000">is a dimensionless</span>
<span 
class="ecrm-1000">constant.</span>
                                                                                

                                                                                
</p>
   <!--l. 2242--><div class="crosslinks"><p class="noindent"><span 
class="ecrm-1000">[</span><a 
href="guiding_center_motionli1.html" ><span 
class="ecrm-1000">next</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motionse7.html" ><span 
class="ecrm-1000">prev</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motionse7.html#tailguiding_center_motionse7.html" ><span 
class="ecrm-1000">prev-tail</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motionse8.html" ><span 
class="ecrm-1000">front</span></a><span 
class="ecrm-1000">] [</span><a 
href="guiding_center_motion.html#guiding_center_motionse8.html" ><span 
class="ecrm-1000">up</span></a><span 
class="ecrm-1000">] </span></p></div>
<!--l. 2242--><p class="indent" >   <a 
 id="tailguiding_center_motionse8.html"></a>   </p> 
</body></html> 
