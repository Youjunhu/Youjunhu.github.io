<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Finite diﬀerence form of toroidal elliptic operator in general coordinate system</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="tokamak_equilibrium.tex" /> 
<link rel="stylesheet" type="text/css" href="tokamak_equilibrium.css" /> 
</head><body 
>
   <!--l. 4800--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu60.html" >next</a>] [<a 
href="tokamak_equilibriumsu58.html" >prev</a>] [<a 
href="tokamak_equilibriumsu58.html#tailtokamak_equilibriumsu58.html" >prev-tail</a>] [<a 
href="#tailtokamak_equilibriumsu59.html">tail</a>] [<a 
href="tokamak_equilibriumse12.html#tokamak_equilibriumsu59.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">12.2   </span> <a 
 id="x72-9800012.2"></a>Finite diﬀerence form of toroidal elliptic operator in general coordinate system</h4>
<!--l. 4802--><p class="noindent" >The toroidal elliptic operator in Eq. (<a 
href="tokamak_equilibriumsu58.html#x71-97002r391">391<!--tex4ht:ref: 4-23-4 --></a>) can be written
</p>
   <table 
class="equation"><tr><td><a 
 id="x72-98001r395"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium516x.png" alt="      R2
△∗Ψ = -𝒥-[(hψψ Ψψ)ψ +(h𝜃𝜃Ψ𝜃)𝜃 + (hψ𝜃Ψ𝜃)ψ + (hψ𝜃Ψ ψ)𝜃],
" class="math-display"  /></center></td><td class="equation-label">(395)</td></tr></table>
<!--l. 4807--><p class="nopar" >
where <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">aβ</span></sup> is deﬁned by Eq. (<a 
href="tokamak_equilibriumsu27.html#x32-40005r149">149<!--tex4ht:ref: 4-25-e20 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x72-98002r396"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium517x.png" alt="      𝒥
hαβ = R2∇ α⋅∇ β.
" class="math-display"  /></center></td><td class="equation-label">(396)</td></tr></table>
<!--l. 4812--><p class="nopar" >
Next, we derive the ﬁnite diﬀerence form of the toroidal elliptic operator. The ﬁnite diﬀerence form of
the term (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψψ</span></sup>Ψ<sub><span 
class="cmmi-7">ψ</span></sub>)<sub><span 
class="cmmi-7">ψ</span></sub> is written </p><div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="tokamak_equilibrium518x.png" alt="                   [       (           )          (            )]
(hψψΨ  )|    =  -1- hψψ     Ψi,j+1 −-Ψi,j − hψψ      Ψi,j −-Ψi,j−1
     ψ ψ i,j     δψ   i,j+1∕2      δψ         i,j−1∕2      δψ
             =  H ψψ   (Ψi,j+1 − Ψi,j)− Hψψ  (Ψi,j − Ψi,j−1),         (397)
                  i,j+1∕2                i,j−1∕2
" class="math-display"  /></center>
</div>where
   <table 
class="equation"><tr><td><a 
 id="x72-98004r398"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium519x.png" alt="       hψψ
Hψψ = ----2.
      (δψ)
" class="math-display"  /></center></td><td class="equation-label">(398)</td></tr></table>
<!--l. 4828--><p class="nopar" >
The ﬁnite diﬀerence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">𝜃𝜃</span></sup>Ψ<sub><span 
class="cmmi-7">𝜃</span></sub>)<sub><span 
class="cmmi-7">𝜃</span></sub> is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium520x.png" alt="               1 [       ( Ψi+1,j − Ψi,j)        ( Ψi,j − Ψi− 1,j)]
(h 𝜃𝜃Ψ 𝜃)𝜃|i,j =   δ𝜃 h𝜃i𝜃+1∕2,j  ----δ𝜃-----  − h 𝜃𝜃i−1∕2,j ----δ𝜃-----
                𝜃𝜃                    𝜃𝜃
           =   Hi+1∕2,j(Ψi+1,j − Ψi,j)− H i−1∕2,j(Ψi,j − Ψi− 1,j),         (399)
" class="math-display"  /></center>
</div>where
   <table 
class="equation"><tr><td><a 
 id="x72-98006r400"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium521x.png" alt="  𝜃𝜃  -h𝜃𝜃-
H   = (δ𝜃)2.
" class="math-display"  /></center></td><td class="equation-label">(400)</td></tr></table>
<!--l. 4843--><p class="nopar" >
The ﬁnite diﬀerence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψ𝜃</span></sup>Ψ<sub><span 
class="cmmi-7">𝜃</span></sub>)<sub><span 
class="cmmi-7">ψ</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x72-98007r401"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium522x.png" alt="                [       (                    )          (                    ) ]
(Ψ hψ𝜃) ||  = -1- hψ𝜃     Ψi+1,j+1∕2 −-Ψi−1,j+1∕2 − hψ𝜃     Ψi+1,j−-1∕2 −-Ψi−1,j−-1∕2  .
  𝜃    ψ i,j  δψ   i,j+1∕2           2δ𝜃             i,j−1∕2           2δ𝜃
" class="math-display"  /></center></td><td class="equation-label">(401)</td></tr></table>
<!--l. 4852--><p class="nopar" >
Approximating the value of Ψ at the grid centers by the average of the value of Ψ at the neighbor grid
points, Eq. (<a 
href="#x72-98007r401">401<!--tex4ht:ref: 4-27-e1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x72-98008r402"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium523x.png" alt="(Ψ𝜃hψ𝜃)ψ|i,j = Hψi𝜃,j+1∕2(Ψi+1,j+ Ψi+1,j+1− Ψi−1,j− Ψi−1,j+1)− Hψi𝜃,j−1∕2(Ψi+1,j− 1+ Ψi+1,j− Ψi−1,j−1− Ψi−1,j).
" class="math-display"  /></center></td><td class="equation-label">(402)</td></tr></table>
<!--l. 4860--><p class="nopar" >
where
</p>
   <table 
class="equation"><tr><td><a 
 id="x72-98009r403"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="tokamak_equilibrium524x.png" alt="  ψ𝜃   -hψ𝜃--
H    = 4δψd𝜃.
" class="math-display"  /></center></td><td class="equation-label">(403)</td></tr></table>
<!--l. 4865--><p class="nopar" >
Similarly, the ﬁnite diﬀerence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψ𝜃</span></sup>Ψ<sub><span 
class="cmmi-7">ψ</span></sub>)<sub><span 
class="cmmi-7">𝜃</span></sub> is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium525x.png" alt="                  [       (                    )          (                    ) ]
(Ψ hψ𝜃) |   =   1- hψ𝜃     Ψi+1∕2,j+1 −-Ψi+1∕2,j−1 − hψ𝜃     Ψi−-1∕2,j+1 −-Ψi−-1∕2,j−1
  ψ    𝜃i,j      δ𝜃  i+1∕2,j          2δψ              i−1∕2,j          2δψ
            =  H ψ𝜃   (Ψ       +Ψ     − Ψ       − Ψ    )− Hψ 𝜃   (Ψ     + Ψ      − Ψ     − Ψ   (40)4.)
                 i+1∕2,j  i+1,j+1    i,j+1   i+1,j−1    i,j−1    i−1∕2,j  i,j+1   i−1,j+1    i,j−1   i−1,j−1
" class="math-display"  /></center>
</div>Using the above results, the ﬁnite diﬀerence form of the operator <span 
class="cmsy-10">𝒥△</span><sup><span 
class="cmmi-7">⋆</span></sup>Ψ<span 
class="cmmi-10">∕R</span><sup><span 
class="cmr-7">2</span></sup> is written as
<div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium526x.png" alt="       |
-𝒥-△∗Ψ ||   =   (hψ𝜃Ψ  ) + (hψψΨ  ) + (h𝜃𝜃Ψ  ) + (hψ𝜃Ψ  )
R2     |i,j           𝜃ψ        ψ ψ        𝜃𝜃        ψ 𝜃
           =   Hψψ   (Ψ     − Ψ  )− H ψψ   (Ψ  − Ψ    )
                i,j+1∕2  i,j+1    i,j     i,j−1∕2  i,j    i,j− 1
           +   H𝜃i𝜃+1∕2,j(Ψi+1,j − Ψi,j)− H 𝜃i−𝜃1∕2,j(Ψi,j − Ψi−1,j)
           +   Hψ𝜃   (Ψ     + Ψ      − Ψ     − Ψ      )− H ψ𝜃   (Ψ      + Ψ     − Ψ      − Ψ    )
                i,j+1∕2  i+1,j   i+1,j+1    i−1,j   i−1,j+1    i,j−1∕2  i+1,j−1   i+1,j    i−1,j−1    i−1,j
           +   Hψi𝜃+1∕2,j(Ψi+1,j+1 + Ψi,j+1 − Ψi+1,j−1 − Ψi,j−1)− Hiψ−𝜃1∕2,j(Ψi,j+1 + Ψi−1,j+1 − Ψi−1,j−1 − Ψi,j−1)
                      ψψ       ψψ       𝜃𝜃       𝜃𝜃
           =   Ψi,j(− H i,j+1∕2 − H i,j−1∕2 − H i+1∕2,j − Hi−1∕2,j)
           +   Ψi−1,j−1(H ψi𝜃,j−1∕2 + Hψi𝜃−1∕2,j)+ Ψi,j−1(Hψiψ,j−1∕2 − Hψi+𝜃1∕2,j + H ψi−𝜃1∕2,j)
                          ψ𝜃       ψ𝜃              𝜃𝜃       ψ𝜃       ψ𝜃
           +   Ψi+1,j−1(− H i,j−1∕2 − H i+1∕2,j)+ Ψi−1,j(H i−1∕2,j − H i,j+1∕2 + H i,j−1∕2)
           +   Ψi+1,j(H 𝜃𝜃    + Hψ𝜃    − H ψ𝜃   )+ Ψi−1,j+1(− H ψ𝜃  − H ψ𝜃   )
                      i+1∕2,j   i,j+1∕2   i,j−1∕2              i,j+1∕2    i− 1∕2,j
           +   Ψi,j+1(H ψiψ,j+1∕2 + Hψi𝜃+1∕2,j − Hiψ−𝜃1∕2,j)+ Ψi+1,j+1(Hψi𝜃,j+1∕2 + Hiψ+𝜃1∕2,j)
" class="math-display"  /></center>
</div>The coeﬃcients are given by
   <table 
class="equation"><tr><td><a 
 id="x72-98012r405"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium527x.png" alt="hψψ = -𝒥-|∇ ψ|2 =-1(R2 + Z2),
      R2        𝒥   𝜃    𝜃
" class="math-display"  /></center></td><td class="equation-label">(405)</td></tr></table>
<!--l. 4918--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x72-98013r406"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium528x.png" alt="h𝜃𝜃 = 𝒥-|∇ 𝜃|2 = 1(R2 + Z2 ),
      R2        𝒥   ψ   ψ
" class="math-display"  /></center></td><td class="equation-label">(406)</td></tr></table>
                                                                                

                                                                                
<!--l. 4922--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x72-98014r407"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium529x.png" alt="hψ𝜃 = 𝒥-∇ ψ ⋅∇𝜃 = −-1(R R  + Z Z  ),
      R2           𝒥   𝜃  ψ    𝜃 ψ
" class="math-display"  /></center></td><td class="equation-label">(407)</td></tr></table>
<!--l. 4927--><p class="nopar" >
where the Jacobian
</p>
   <table 
class="equation"><tr><td><a 
 id="x72-98015r408"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium530x.png" alt="𝒥 = R (R 𝜃Zψ − R ψZ𝜃).
" class="math-display"  /></center></td><td class="equation-label">(408)</td></tr></table>
<!--l. 4931--><p class="nopar" >
The partial derivatives, <span 
class="cmmi-10">R</span><sub><span 
class="cmmi-7">𝜃</span></sub>, <span 
class="cmmi-10">R</span><sub><span 
class="cmmi-7">ψ</span></sub>, <span 
class="cmmi-10">Z</span><sub><span 
class="cmmi-7">𝜃</span></sub>, and <span 
class="cmmi-10">Z</span><sub><span 
class="cmmi-7">ψ</span></sub>, appearing in Eqs. (<a 
href="#x72-98012r405">405<!--tex4ht:ref: 7-5-1 --></a>)-(<a 
href="#x72-98015r408">408<!--tex4ht:ref: 7-5-2 --></a>) are calculated by using the
central diﬀerence scheme. The values of <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψψ</span></sup>, <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">𝜃𝜃</span></sup>, <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψ𝜃</span></sup> and <span 
class="cmsy-10">𝒥 </span>at the middle points are approximated by
the linear average of their values at the neighbor grid points.
                                                                                

                                                                                
</p>
   <!--l. 4939--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu60.html" >next</a>] [<a 
href="tokamak_equilibriumsu58.html" >prev</a>] [<a 
href="tokamak_equilibriumsu58.html#tailtokamak_equilibriumsu58.html" >prev-tail</a>] [<a 
href="tokamak_equilibriumsu59.html" >front</a>] [<a 
href="tokamak_equilibriumse12.html#tokamak_equilibriumsu59.html" >up</a>] </p></div>
<!--l. 4939--><p class="indent" >   <a 
 id="tailtokamak_equilibriumsu59.html"></a> </p> 
</body></html> 
