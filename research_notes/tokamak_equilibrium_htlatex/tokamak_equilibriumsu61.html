<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Finite diï¬€erence form of toroidal elliptic operator in general coordinate system</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="tokamak_equilibrium.tex" /> 
<link rel="stylesheet" type="text/css" href="tokamak_equilibrium.css" /> 
</head><body 
>
   <!--l. 4866--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu62.html" >next</a>] [<a 
href="tokamak_equilibriumsu60.html" >prev</a>] [<a 
href="tokamak_equilibriumsu60.html#tailtokamak_equilibriumsu60.html" >prev-tail</a>] [<a 
href="#tailtokamak_equilibriumsu61.html">tail</a>] [<a 
href="tokamak_equilibriumse15.html#tokamak_equilibriumsu61.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">15.2   </span> <a 
 id="x77-10100015.2"></a>Finite diï¬€erence form of toroidal elliptic operator in general coordinate system</h4>
<!--l. 4868--><p class="noindent" >The toroidal elliptic operator in Eq. (<a 
href="tokamak_equilibriumsu60.html#x76-100002r392">392<!--tex4ht:ref: 4-23-4 --></a>) can be written
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101001r396"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium522x.png" alt="         2
â–³ âˆ—Î¨ = R--[(hÏˆÏˆÎ¨Ïˆ)Ïˆ + (h ğœƒğœƒÎ¨ğœƒ)ğœƒ + (hÏˆğœƒÎ¨ğœƒ)Ïˆ + (hÏˆğœƒÎ¨Ïˆ)ğœƒ],
       ğ’¥
" class="math-display"  /></center></td><td class="equation-label">(396)</td></tr></table>
<!--l. 4873--><p class="nopar" >
where <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">aÎ²</span></sup> is deï¬ned by Eq. (<a 
href="tokamak_equilibriumse7.html#x37-44005r151">151<!--tex4ht:ref: 4-25-e20 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101002r397"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium523x.png" alt="      ğ’¥
hÎ±Î² = -2âˆ‡ Î±â‹…âˆ‡ Î².
      R
" class="math-display"  /></center></td><td class="equation-label">(397)</td></tr></table>
<!--l. 4878--><p class="nopar" >
Next, we derive the ï¬nite diï¬€erence form of the toroidal elliptic operator. The ï¬nite diï¬€erence form of
the term (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ÏˆÏˆ</span></sup><span 
class="cmmi-10">Î¨</span><sub><span 
class="cmmi-7">Ïˆ</span></sub>)<sub><span 
class="cmmi-7">Ïˆ</span></sub> is written </p><div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="tokamak_equilibrium524x.png" alt="                [       (           )         (           ) ]
(hÏˆÏˆÎ¨ ) |  = -1- hÏˆÏˆ      Î¨i,j+1-âˆ’-Î¨i,j- âˆ’ hÏˆÏˆ     Î¨i,j âˆ’-Î¨i,jâˆ’1
     Ïˆ Ïˆ i,j  Î´Ïˆ   i,j+1âˆ•2      Î´Ïˆ          i,jâˆ’ 1âˆ•2      Î´Ïˆ
           = H ÏˆÏˆ   (Î¨i,j+1 âˆ’ Î¨i,j)âˆ’ H ÏˆÏˆ  (Î¨i,j âˆ’ Î¨i,jâˆ’1),           (398)
               i,j+1âˆ•2                i,jâˆ’ 1âˆ•2
" class="math-display"  /></center>
</div>where
   <table 
class="equation"><tr><td><a 
 id="x77-101004r399"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium525x.png" alt=" ÏˆÏˆ   -hÏˆÏˆ-
H   = (Î´Ïˆ)2.
" class="math-display"  /></center></td><td class="equation-label">(399)</td></tr></table>
<!--l. 4894--><p class="nopar" >
The ï¬nite diï¬€erence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ğœƒğœƒ</span></sup><span 
class="cmmi-10">Î¨</span><sub><span 
class="cmmi-7">ğœƒ</span></sub>)<sub><span 
class="cmmi-7">ğœƒ</span></sub> is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium526x.png" alt="            1 [       ( Î¨    âˆ’ Î¨  )          (Î¨   âˆ’ Î¨    )]
(hğœƒğœƒÎ¨ğœƒ)ğœƒ|i,j = -- h ğœƒğœƒi+1âˆ•2,j  -i+1,j---i,j- âˆ’ hğœƒiğœƒâˆ’1âˆ•2,j  -i,j----iâˆ’1,j
            Î´ğœƒ              Î´ğœƒ                    Î´ğœƒ
          = Hiğœƒğœƒ+1âˆ•2,j(Î¨i+1,j âˆ’ Î¨i,j)âˆ’ Hğœƒiğœƒâˆ’1âˆ•2,j(Î¨i,j âˆ’ Î¨iâˆ’1,j),             (400)
" class="math-display"  /></center>
</div>where
   <table 
class="equation"><tr><td><a 
 id="x77-101006r401"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium527x.png" alt="  ğœƒğœƒ  -hğœƒğœƒ-
H   = (Î´ğœƒ)2.
" class="math-display"  /></center></td><td class="equation-label">(401)</td></tr></table>
<!--l. 4909--><p class="nopar" >
The ï¬nite diï¬€erence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">Ïˆğœƒ</span></sup><span 
class="cmmi-10">Î¨</span><sub><span 
class="cmmi-7">ğœƒ</span></sub>)<sub><span 
class="cmmi-7">Ïˆ</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101007r402"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium528x.png" alt="                [       (                    )         (                    )]
(Î¨ hÏˆğœƒ) ||  = -1- hÏˆğœƒ     Î¨i+1,j+1âˆ•2 âˆ’-Î¨iâˆ’1,j+1âˆ•2 âˆ’ hÏˆğœƒ      Î¨i+1,jâˆ’-1âˆ•2 âˆ’-Î¨iâˆ’1,jâˆ’1âˆ•2  .
  ğœƒ    Ïˆ i,j  Î´Ïˆ   i,j+1âˆ•2          2Î´ğœƒ             i,jâˆ’1âˆ•2          2Î´ğœƒ
" class="math-display"  /></center></td><td class="equation-label">(402)</td></tr></table>
<!--l. 4918--><p class="nopar" >
Approximating the value of <span 
class="cmmi-10">Î¨ </span>at the grid centers by the average of the value of <span 
class="cmmi-10">Î¨ </span>at the neighbor grid
points, Eq. (<a 
href="#x77-101007r402">402<!--tex4ht:ref: 4-27-e1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101008r403"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium529x.png" alt="(Î¨ğœƒhÏˆğœƒ)Ïˆ|i,j = H Ïˆi,ğœƒj+1âˆ•2(Î¨i+1,j+Î¨i+1,j+1âˆ’ Î¨iâˆ’1,jâˆ’ Î¨iâˆ’1,j+1)âˆ’ H Ïˆi,ğœƒjâˆ’1âˆ•2(Î¨i+1,jâˆ’ 1+ Î¨i+1,jâˆ’ Î¨iâˆ’1,jâˆ’1âˆ’ Î¨iâˆ’ 1,j).
" class="math-display"  /></center></td><td class="equation-label">(403)</td></tr></table>
<!--l. 4926--><p class="nopar" >
where
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101009r404"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="tokamak_equilibrium530x.png" alt="  Ïˆğœƒ   -hÏˆğœƒ--
H    = 4Î´Ïˆdğœƒ.
" class="math-display"  /></center></td><td class="equation-label">(404)</td></tr></table>
<!--l. 4931--><p class="nopar" >
Similarly, the ï¬nite diï¬€erence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">Ïˆğœƒ</span></sup><span 
class="cmmi-10">Î¨</span><sub><span 
class="cmmi-7">Ïˆ</span></sub>)<sub><span 
class="cmmi-7">ğœƒ</span></sub> is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium531x.png" alt="               [       (                    )         (                    )]
    Ïˆğœƒ       1-  Ïˆğœƒ     Î¨i+1âˆ•2,j+1 âˆ’-Î¨i+1âˆ•2,jâˆ’1    Ïˆğœƒ      Î¨iâˆ’-1âˆ•2,j+1 âˆ’-Î¨iâˆ’1âˆ•2,jâˆ’1
(Î¨Ïˆh  )ğœƒ|i,j = Î´ğœƒ  hi+1âˆ•2,j         2Î´Ïˆ          âˆ’ hiâˆ’1âˆ•2,j          2Î´Ïˆ
              Ïˆğœƒ                                       Ïˆğœƒ
          = H i+1âˆ•2,j(Î¨i+1,j+1 + Î¨i,j+1 âˆ’ Î¨i+1,jâˆ’1 âˆ’ Î¨i,jâˆ’1) âˆ’ H iâˆ’1âˆ•2,j(Î¨i,j+1 + Î¨iâˆ’1,j+1 âˆ’ Î¨i,jâˆ’1 âˆ’ Î¨iâˆ’ 1,(jâˆ’4015).)
" class="math-display"  /></center>
</div>Using the above results, the ï¬nite diï¬€erence form of the operator <span 
class="cmsy-10">ğ’¥â–³</span><sup><span 
class="cmmi-7">â‹†</span></sup><span 
class="cmmi-10">Î¨âˆ•R</span><sup><span 
class="cmr-7">2</span></sup> is written as
<div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium532x.png" alt="       |
-ğ’¥-â–³âˆ—Î¨ ||  = (h ÏˆğœƒÎ¨ )  + (h ÏˆÏˆÎ¨ ) + (hğœƒğœƒÎ¨ ) + (h ÏˆğœƒÎ¨  )
R2     |i,j        ğœƒÏˆ        Ïˆ Ïˆ       ğœƒ ğœƒ       Ïˆ ğœƒ
          = HÏˆÏˆ    (Î¨     âˆ’ Î¨ ) âˆ’ HÏˆÏˆ   (Î¨   âˆ’ Î¨   )
             i,j+1âˆ•2 i,j+1    i,j    i,jâˆ’1âˆ•2 i,j    i,jâˆ’1
          + Hğœƒiğœƒ+1âˆ•2,j(Î¨i+1,j âˆ’ Î¨i,j) âˆ’ Hğœƒiğœƒâˆ’1âˆ•2,j(Î¨i,j âˆ’ Î¨iâˆ’1,j)
          + HÏˆğœƒ    (Î¨     + Î¨      âˆ’ Î¨    âˆ’ Î¨      )âˆ’ H Ïˆğœƒ   (Î¨       + Î¨    âˆ’ Î¨      âˆ’ Î¨    )
             i,j+1âˆ•2 i+1,j    i+1,j+1    iâˆ’ 1,j   iâˆ’1,j+1    i,jâˆ’1âˆ•2  i+1,jâˆ’1    i+1,j   iâˆ’ 1,jâˆ’1   iâˆ’1,j
          + HÏˆiğœƒ+1âˆ•2,j(Î¨i+1,j+1 +Î¨i,j+1 âˆ’ Î¨i+1,jâˆ’ 1 âˆ’ Î¨i,jâˆ’1)âˆ’ HiÏˆâˆ’ğœƒ1âˆ•2,j(Î¨i,j+1 + Î¨iâˆ’ 1,j+1 âˆ’ Î¨iâˆ’ 1,jâˆ’1 âˆ’ Î¨i,jâˆ’1)
                   ÏˆÏˆ       ÏˆÏˆ       ğœƒğœƒ       ğœƒğœƒ
          = Î¨i,j(âˆ’ Hi,j+1âˆ•2 âˆ’ H i,jâˆ’ 1âˆ•2 âˆ’ H i+1âˆ•2,j âˆ’ H iâˆ’1âˆ•2,j)
          + Î¨iâˆ’ 1,jâˆ’1(H Ïˆi,ğœƒjâˆ’1âˆ•2 +H Ïˆiğœƒâˆ’1âˆ•2,j) +Î¨i,jâˆ’1(H Ïˆi,Ïˆjâˆ’ 1âˆ•2 âˆ’ H Ïˆi+ğœƒ1âˆ•2,j +H Ïˆiğœƒâˆ’1âˆ•2,j)
                       Ïˆğœƒ       Ïˆğœƒ             ğœƒğœƒ       Ïˆ ğœƒ       Ïˆğœƒ
          + Î¨i+1,jâˆ’ 1(âˆ’ Hi,jâˆ’1âˆ•2 âˆ’ H i+1âˆ•2,j)+ Î¨iâˆ’1,j(Hiâˆ’1âˆ•2,j âˆ’ Hi,j+1âˆ•2 + Hi,jâˆ’1âˆ•2)
          + Î¨i+1,j(H ğœƒğœƒ    + HÏˆğœƒ    âˆ’ HÏˆğœƒ    )+ Î¨iâˆ’ 1,j+1(âˆ’ HÏˆğœƒ    âˆ’ H Ïˆğœƒ   )
                   i+1âˆ•2,j    i,j+1âˆ•2    i,jâˆ’1âˆ•2             i,j+1âˆ•2   iâˆ’1âˆ•2,j
          + Î¨i,j+1(H Ïˆi,Ïˆj+1âˆ•2 + HÏˆiğœƒ+1âˆ•2,j âˆ’ HÏˆiğœƒâˆ’1âˆ•2,j)+ Î¨i+1,j+1(H Ïˆi,ğœƒj+1âˆ•2 + H Ïˆi+ğœƒ1âˆ•2,j)
" class="math-display"  /></center>
</div>The coeï¬ƒcients are given by
   <table 
class="equation"><tr><td><a 
 id="x77-101012r406"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium533x.png" alt=" ÏˆÏˆ    ğ’¥     2   1  2    2
h   = R2-|âˆ‡ Ïˆ| = ğ’¥-(Rğœƒ + Zğœƒ),
" class="math-display"  /></center></td><td class="equation-label">(406)</td></tr></table>
<!--l. 4984--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101013r407"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium534x.png" alt="      ğ’¥         1
hğœƒğœƒ = -2|âˆ‡ ğœƒ|2 = -(R2Ïˆ + Z2Ïˆ ),
      R         ğ’¥
" class="math-display"  /></center></td><td class="equation-label">(407)</td></tr></table>
                                                                                

                                                                                
<!--l. 4988--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101014r408"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium535x.png" alt="hÏˆğœƒ = ğ’¥-âˆ‡ Ïˆ â‹…âˆ‡ğœƒ = âˆ’-1(R R  + Z Z  ),
      R2           ğ’¥   ğœƒ  Ïˆ    ğœƒ Ïˆ
" class="math-display"  /></center></td><td class="equation-label">(408)</td></tr></table>
<!--l. 4993--><p class="nopar" >
where the Jacobian
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101015r409"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium536x.png" alt="ğ’¥ = R (R ğœƒZÏˆ âˆ’ R ÏˆZğœƒ).
" class="math-display"  /></center></td><td class="equation-label">(409)</td></tr></table>
<!--l. 4997--><p class="nopar" >
The partial derivatives, <span 
class="cmmi-10">R</span><sub><span 
class="cmmi-7">ğœƒ</span></sub>, <span 
class="cmmi-10">R</span><sub><span 
class="cmmi-7">Ïˆ</span></sub>, <span 
class="cmmi-10">Z</span><sub><span 
class="cmmi-7">ğœƒ</span></sub>, and <span 
class="cmmi-10">Z</span><sub><span 
class="cmmi-7">Ïˆ</span></sub>, appearing in Eqs. (<a 
href="#x77-101012r406">406<!--tex4ht:ref: 7-5-1 --></a>)-(<a 
href="#x77-101015r409">409<!--tex4ht:ref: 7-5-2 --></a>) are calculated by using the
central diï¬€erence scheme. The values of <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ÏˆÏˆ</span></sup>, <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ğœƒğœƒ</span></sup>, <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">Ïˆğœƒ</span></sup> and <span 
class="cmsy-10">ğ’¥ </span>at the middle points are approximated by
the linear average of their values at the neighbor grid points.
                                                                                

                                                                                
</p>
   <!--l. 5005--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu62.html" >next</a>] [<a 
href="tokamak_equilibriumsu60.html" >prev</a>] [<a 
href="tokamak_equilibriumsu60.html#tailtokamak_equilibriumsu60.html" >prev-tail</a>] [<a 
href="tokamak_equilibriumsu61.html" >front</a>] [<a 
href="tokamak_equilibriumse15.html#tokamak_equilibriumsu61.html" >up</a>] </p></div>
<!--l. 5005--><p class="indent" >   <a 
 id="tailtokamak_equilibriumsu61.html"></a> </p> 
</body></html> 
