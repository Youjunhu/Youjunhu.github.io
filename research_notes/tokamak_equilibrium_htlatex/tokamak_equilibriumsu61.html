<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Finite diﬀerence form of toroidal elliptic operator in general coordinate system</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="tokamak_equilibrium.tex" /> 
<link rel="stylesheet" type="text/css" href="tokamak_equilibrium.css" /> 
</head><body 
>
   <!--l. 4866--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu62.html" >next</a>] [<a 
href="tokamak_equilibriumsu60.html" >prev</a>] [<a 
href="tokamak_equilibriumsu60.html#tailtokamak_equilibriumsu60.html" >prev-tail</a>] [<a 
href="#tailtokamak_equilibriumsu61.html">tail</a>] [<a 
href="tokamak_equilibriumse15.html#tokamak_equilibriumsu61.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">15.2   </span> <a 
 id="x77-10100015.2"></a>Finite diﬀerence form of toroidal elliptic operator in general coordinate system</h4>
<!--l. 4868--><p class="noindent" >The toroidal elliptic operator in Eq. (<a 
href="tokamak_equilibriumsu60.html#x76-100002r392">392<!--tex4ht:ref: 4-23-4 --></a>) can be written
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101001r396"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium522x.png" alt="         2
△ ∗Ψ = R--[(hψψΨψ)ψ + (h 𝜃𝜃Ψ𝜃)𝜃 + (hψ𝜃Ψ𝜃)ψ + (hψ𝜃Ψψ)𝜃],
       𝒥
" class="math-display"  /></center></td><td class="equation-label">(396)</td></tr></table>
<!--l. 4873--><p class="nopar" >
where <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">aβ</span></sup> is deﬁned by Eq. (<a 
href="tokamak_equilibriumse7.html#x37-44005r151">151<!--tex4ht:ref: 4-25-e20 --></a>), i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101002r397"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium523x.png" alt="      𝒥
hαβ = -2∇ α⋅∇ β.
      R
" class="math-display"  /></center></td><td class="equation-label">(397)</td></tr></table>
<!--l. 4878--><p class="nopar" >
Next, we derive the ﬁnite diﬀerence form of the toroidal elliptic operator. The ﬁnite diﬀerence form of
the term (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψψ</span></sup><span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">ψ</span></sub>)<sub><span 
class="cmmi-7">ψ</span></sub> is written </p><div class="eqnarray">
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="tokamak_equilibrium524x.png" alt="                [       (           )         (           ) ]
(hψψΨ ) |  = -1- hψψ      Ψi,j+1-−-Ψi,j- − hψψ     Ψi,j −-Ψi,j−1
     ψ ψ i,j  δψ   i,j+1∕2      δψ          i,j− 1∕2      δψ
           = H ψψ   (Ψi,j+1 − Ψi,j)− H ψψ  (Ψi,j − Ψi,j−1),           (398)
               i,j+1∕2                i,j− 1∕2
" class="math-display"  /></center>
</div>where
   <table 
class="equation"><tr><td><a 
 id="x77-101004r399"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium525x.png" alt=" ψψ   -hψψ-
H   = (δψ)2.
" class="math-display"  /></center></td><td class="equation-label">(399)</td></tr></table>
<!--l. 4894--><p class="nopar" >
The ﬁnite diﬀerence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">𝜃𝜃</span></sup><span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">𝜃</span></sub>)<sub><span 
class="cmmi-7">𝜃</span></sub> is written </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium526x.png" alt="            1 [       ( Ψ    − Ψ  )          (Ψ   − Ψ    )]
(h𝜃𝜃Ψ𝜃)𝜃|i,j = -- h 𝜃𝜃i+1∕2,j  -i+1,j---i,j- − h𝜃i𝜃−1∕2,j  -i,j----i−1,j
            δ𝜃              δ𝜃                    δ𝜃
          = Hi𝜃𝜃+1∕2,j(Ψi+1,j − Ψi,j)− H𝜃i𝜃−1∕2,j(Ψi,j − Ψi−1,j),             (400)
" class="math-display"  /></center>
</div>where
   <table 
class="equation"><tr><td><a 
 id="x77-101006r401"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium527x.png" alt="  𝜃𝜃  -h𝜃𝜃-
H   = (δ𝜃)2.
" class="math-display"  /></center></td><td class="equation-label">(401)</td></tr></table>
<!--l. 4909--><p class="nopar" >
The ﬁnite diﬀerence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψ𝜃</span></sup><span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">𝜃</span></sub>)<sub><span 
class="cmmi-7">ψ</span></sub> is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101007r402"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium528x.png" alt="                [       (                    )         (                    )]
(Ψ hψ𝜃) ||  = -1- hψ𝜃     Ψi+1,j+1∕2 −-Ψi−1,j+1∕2 − hψ𝜃      Ψi+1,j−-1∕2 −-Ψi−1,j−1∕2  .
  𝜃    ψ i,j  δψ   i,j+1∕2          2δ𝜃             i,j−1∕2          2δ𝜃
" class="math-display"  /></center></td><td class="equation-label">(402)</td></tr></table>
<!--l. 4918--><p class="nopar" >
Approximating the value of <span 
class="cmmi-10">Ψ </span>at the grid centers by the average of the value of <span 
class="cmmi-10">Ψ </span>at the neighbor grid
points, Eq. (<a 
href="#x77-101007r402">402<!--tex4ht:ref: 4-27-e1 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101008r403"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium529x.png" alt="(Ψ𝜃hψ𝜃)ψ|i,j = H ψi,𝜃j+1∕2(Ψi+1,j+Ψi+1,j+1− Ψi−1,j− Ψi−1,j+1)− H ψi,𝜃j−1∕2(Ψi+1,j− 1+ Ψi+1,j− Ψi−1,j−1− Ψi− 1,j).
" class="math-display"  /></center></td><td class="equation-label">(403)</td></tr></table>
<!--l. 4926--><p class="nopar" >
where
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101009r404"></a>
   <center class="math-display" >
                                                                                

                                                                                
<img 
src="tokamak_equilibrium530x.png" alt="  ψ𝜃   -hψ𝜃--
H    = 4δψd𝜃.
" class="math-display"  /></center></td><td class="equation-label">(404)</td></tr></table>
<!--l. 4931--><p class="nopar" >
Similarly, the ﬁnite diﬀerence form of (<span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψ𝜃</span></sup><span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">ψ</span></sub>)<sub><span 
class="cmmi-7">𝜃</span></sub> is written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium531x.png" alt="               [       (                    )         (                    )]
    ψ𝜃       1-  ψ𝜃     Ψi+1∕2,j+1 −-Ψi+1∕2,j−1    ψ𝜃      Ψi−-1∕2,j+1 −-Ψi−1∕2,j−1
(Ψψh  )𝜃|i,j = δ𝜃  hi+1∕2,j         2δψ          − hi−1∕2,j          2δψ
              ψ𝜃                                       ψ𝜃
          = H i+1∕2,j(Ψi+1,j+1 + Ψi,j+1 − Ψi+1,j−1 − Ψi,j−1) − H i−1∕2,j(Ψi,j+1 + Ψi−1,j+1 − Ψi,j−1 − Ψi− 1,(j−4015).)
" class="math-display"  /></center>
</div>Using the above results, the ﬁnite diﬀerence form of the operator <span 
class="cmsy-10">𝒥△</span><sup><span 
class="cmmi-7">⋆</span></sup><span 
class="cmmi-10">Ψ∕R</span><sup><span 
class="cmr-7">2</span></sup> is written as
<div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium532x.png" alt="       |
-𝒥-△∗Ψ ||  = (h ψ𝜃Ψ )  + (h ψψΨ ) + (h𝜃𝜃Ψ ) + (h ψ𝜃Ψ  )
R2     |i,j        𝜃ψ        ψ ψ       𝜃 𝜃       ψ 𝜃
          = Hψψ    (Ψ     − Ψ ) − Hψψ   (Ψ   − Ψ   )
             i,j+1∕2 i,j+1    i,j    i,j−1∕2 i,j    i,j−1
          + H𝜃i𝜃+1∕2,j(Ψi+1,j − Ψi,j) − H𝜃i𝜃−1∕2,j(Ψi,j − Ψi−1,j)
          + Hψ𝜃    (Ψ     + Ψ      − Ψ    − Ψ      )− H ψ𝜃   (Ψ       + Ψ    − Ψ      − Ψ    )
             i,j+1∕2 i+1,j    i+1,j+1    i− 1,j   i−1,j+1    i,j−1∕2  i+1,j−1    i+1,j   i− 1,j−1   i−1,j
          + Hψi𝜃+1∕2,j(Ψi+1,j+1 +Ψi,j+1 − Ψi+1,j− 1 − Ψi,j−1)− Hiψ−𝜃1∕2,j(Ψi,j+1 + Ψi− 1,j+1 − Ψi− 1,j−1 − Ψi,j−1)
                   ψψ       ψψ       𝜃𝜃       𝜃𝜃
          = Ψi,j(− Hi,j+1∕2 − H i,j− 1∕2 − H i+1∕2,j − H i−1∕2,j)
          + Ψi− 1,j−1(H ψi,𝜃j−1∕2 +H ψi𝜃−1∕2,j) +Ψi,j−1(H ψi,ψj− 1∕2 − H ψi+𝜃1∕2,j +H ψi𝜃−1∕2,j)
                       ψ𝜃       ψ𝜃             𝜃𝜃       ψ 𝜃       ψ𝜃
          + Ψi+1,j− 1(− Hi,j−1∕2 − H i+1∕2,j)+ Ψi−1,j(Hi−1∕2,j − Hi,j+1∕2 + Hi,j−1∕2)
          + Ψi+1,j(H 𝜃𝜃    + Hψ𝜃    − Hψ𝜃    )+ Ψi− 1,j+1(− Hψ𝜃    − H ψ𝜃   )
                   i+1∕2,j    i,j+1∕2    i,j−1∕2             i,j+1∕2   i−1∕2,j
          + Ψi,j+1(H ψi,ψj+1∕2 + Hψi𝜃+1∕2,j − Hψi𝜃−1∕2,j)+ Ψi+1,j+1(H ψi,𝜃j+1∕2 + H ψi+𝜃1∕2,j)
" class="math-display"  /></center>
</div>The coeﬃcients are given by
   <table 
class="equation"><tr><td><a 
 id="x77-101012r406"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium533x.png" alt=" ψψ    𝒥     2   1  2    2
h   = R2-|∇ ψ| = 𝒥-(R𝜃 + Z𝜃),
" class="math-display"  /></center></td><td class="equation-label">(406)</td></tr></table>
<!--l. 4984--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101013r407"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium534x.png" alt="      𝒥         1
h𝜃𝜃 = -2|∇ 𝜃|2 = -(R2ψ + Z2ψ ),
      R         𝒥
" class="math-display"  /></center></td><td class="equation-label">(407)</td></tr></table>
                                                                                

                                                                                
<!--l. 4988--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101014r408"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium535x.png" alt="hψ𝜃 = 𝒥-∇ ψ ⋅∇𝜃 = −-1(R R  + Z Z  ),
      R2           𝒥   𝜃  ψ    𝜃 ψ
" class="math-display"  /></center></td><td class="equation-label">(408)</td></tr></table>
<!--l. 4993--><p class="nopar" >
where the Jacobian
</p>
   <table 
class="equation"><tr><td><a 
 id="x77-101015r409"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium536x.png" alt="𝒥 = R (R 𝜃Zψ − R ψZ𝜃).
" class="math-display"  /></center></td><td class="equation-label">(409)</td></tr></table>
<!--l. 4997--><p class="nopar" >
The partial derivatives, <span 
class="cmmi-10">R</span><sub><span 
class="cmmi-7">𝜃</span></sub>, <span 
class="cmmi-10">R</span><sub><span 
class="cmmi-7">ψ</span></sub>, <span 
class="cmmi-10">Z</span><sub><span 
class="cmmi-7">𝜃</span></sub>, and <span 
class="cmmi-10">Z</span><sub><span 
class="cmmi-7">ψ</span></sub>, appearing in Eqs. (<a 
href="#x77-101012r406">406<!--tex4ht:ref: 7-5-1 --></a>)-(<a 
href="#x77-101015r409">409<!--tex4ht:ref: 7-5-2 --></a>) are calculated by using the
central diﬀerence scheme. The values of <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψψ</span></sup>, <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">𝜃𝜃</span></sup>, <span 
class="cmmi-10">h</span><sup><span 
class="cmmi-7">ψ𝜃</span></sup> and <span 
class="cmsy-10">𝒥 </span>at the middle points are approximated by
the linear average of their values at the neighbor grid points.
                                                                                

                                                                                
</p>
   <!--l. 5005--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu62.html" >next</a>] [<a 
href="tokamak_equilibriumsu60.html" >prev</a>] [<a 
href="tokamak_equilibriumsu60.html#tailtokamak_equilibriumsu60.html" >prev-tail</a>] [<a 
href="tokamak_equilibriumsu61.html" >front</a>] [<a 
href="tokamak_equilibriumse15.html#tokamak_equilibriumsu61.html" >up</a>] </p></div>
<!--l. 5005--><p class="indent" >   <a 
 id="tailtokamak_equilibriumsu61.html"></a> </p> 
</body></html> 
