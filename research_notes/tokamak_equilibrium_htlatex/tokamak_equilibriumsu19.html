<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Solving by inverting the Laplace operator</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="tokamak_equilibrium.tex" /> 
<link rel="stylesheet" type="text/css" href="tokamak_equilibrium.css" /> 
</head><body 
>
   <!--l. 959--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu20.html" >next</a>] [<a 
href="#tailtokamak_equilibriumsu19.html">tail</a>] [<a 
href="tokamak_equilibriumse4.html#tokamak_equilibriumsu19.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x24-300004.1"></a>Solving by inverting the Laplace operator</h4>
<!--l. 961--><p class="noindent" >If we want to invert the Laplace operator <span 
class="cmsy-10">△</span><sup><span 
class="cmsy-7">∗</span></sup> of the GS equation to solve for <span 
class="cmmi-10">Ψ</span>, we encounter two
issues: (1) the RHS of the GS equation involves functions of <span 
class="cmmi-10">Ψ</span>, where both the functions and <span 
class="cmmi-10">Ψ </span>are
unknown; (2) the values of <span 
class="cmmi-10">Ψ </span>on a given boundy should be prescribed, which in turn invovles two
issues: (a) how to choose the shape of the bounday? (b) how to know the value of <span 
class="cmmi-10">Ψ </span>on the boundary?
The answer to isssues (a) and (b) is that we can choose any boundy we like (e.g., rectangular region)
and guess the values of <span 
class="cmmi-10">Ψ </span>on it (which will be updated in iterations discussed later). The answer to
issue (1) is that the function forms are chosen by users, usually as polymials in <span 
class="cmmi-10">Ψ</span>, e.g.
<span class="cite">[<span 
class="cmbx-10">?</span>]</span>
</p>
   <table 
class="equation"><tr><td><a 
 id="x24-30001r70"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium105x.png" alt="dP (Ψ )  ∑np    n   np+1∑np
--dΨ--=    αnx  − x        αn,
        n=0            n=0
" class="math-display"  /></center></td><td class="equation-label">(70)</td></tr></table>
<!--l. 974--><p class="nopar" >
</p>
   <table 
class="equation"><tr><td><a 
 id="x24-30002r71"></a>
                                                                                

                                                                                
   <center class="math-display" >
<img 
src="tokamak_equilibrium106x.png" alt="  dg-  n∑g    n    ng+1 n∑g
2gdΨ =    βnx  − x       βn,
       n=0            n=0
" class="math-display"  /></center></td><td class="equation-label">(71)</td></tr></table>
<!--l. 979--><p class="nopar" >
where <span 
class="cmmi-10">x </span>= (<span 
class="cmmi-10">Ψ </span><span 
class="cmsy-10">− </span><span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">M</span></sub>)<span 
class="cmmi-10">∕</span>(<span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">B</span></sub> <span 
class="cmsy-10">− </span><span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">M</span></sub>), <span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">M</span></sub> and <span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">B</span></sub> are values of <span 
class="cmmi-10">Ψ </span>at the magnetic axis and LCFS
(but the locations of the axis and LCFS are unknown), the free parameters <span 
class="cmmi-10">α</span><sub><span 
class="cmmi-7">n</span></sub> and <span 
class="cmmi-10">β</span><sub><span 
class="cmmi-7">n</span></sub> are
assumed known (which will be later adjusted in the least-square-minimizing iteration to make
the resulting solution match some measurements and constraints imposed). To make the
RHS fully known, we need to guess values of <span 
class="cmmi-10">Ψ </span>in the inner region. Then inverting  <span 
class="cmsy-10">△</span><sup><span 
class="cmsy-7">∗</span></sup> to
get new <span 
class="cmmi-10">Ψ</span>. The values we obtained via inerting <span 
class="cmsy-10">△</span><sup><span 
class="cmsy-7">∗</span></sup> usually diﬀer from what we used in
the RHS, so we need to interate until convergence. We call this interation as the ﬁrst-level
iteration.
</p><!--l. 991--><p class="indent" >   After the ﬁrst-level iteration coverges, we can calculate <span 
class="cmmi-10">J</span><sub><span 
class="cmmi-7">ϕ</span></sub> through Eq. (<a 
href="tokamak_equilibriumsu15.html#x19-25006r67">67<!--tex4ht:ref: 24-5-29-p4 --></a>) or Eq. (<a 
href="tokamak_equilibriumsu13.html#x16-19003r54">54<!--tex4ht:ref: 6-9-a1 --></a>). After this,
all the current (current in the plasma, and current in the external coils, which are assumed to be
known) perpendicular to the poloidal plane is known, we can calculate the value of <span 
class="cmmi-10">Ψ </span>on the boundary,
<span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">b</span></sub>, by using the Biot-Savart Law (see (<a 
href="tokamak_equilibriumsu95.html#x114-143008r641">641<!--tex4ht:ref: 24-5-29-p1 --></a>)):
</p>
   <table 
class="equation"><tr><td><a 
 id="x24-30003r72"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium107x.png" alt="         ∫                        ∑Nc
Ψ(R,Z ) =   G(R′,Z′;R, Z)JϕdR′dZ′ +   G (Rci,Zci;R,Z)Ici,ϕ,
          P                       i=1
" class="math-display"  /></center></td><td class="equation-label">(72)</td></tr></table>
<!--l. 1000--><p class="nopar" >
where <span 
class="cmmi-10">G </span>is Green’s function given by </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium108x.png" alt="  G (R ′,Z ′,R,Z )
  μ R ∫ 2π              R ′cosϕ ′dϕ′
= --0-     ∘-------′2--------′----′2-----′---′2-            (73)
   4π   0    (Z − Z ) + (R − R cosϕ) + (R sinϕ )
" class="math-display"  /><a 
 id="x24-30004r73"></a></center>
</div>If <span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">b</span></sub> calculated this way diﬀers from the initial guess of the value of <span 
class="cmmi-10">Ψ </span>on the boundary,
we need to iterate: use the <span 
class="cmmi-10">Ψ</span><sub><span 
class="cmmi-7">b</span></sub> calculated as a new guess value of <span 
class="cmmi-10">Ψ </span>on the boundary and
repeat the above procedures until convergence. We call this iteration as the second-level
iteration.<span class="cite">[<span 
class="cmbx-10">?</span>]</span>.
<!--l. 1014--><p class="indent" >   The thrid level iteration is to iterate over the free parameters <span 
class="cmmi-10">α</span><sub><span 
class="cmmi-7">n</span></sub>, <span 
class="cmmi-10">β</span><sub><span 
class="cmmi-7">n</span></sub>, the PF coil currents, to make
the solution match match some measurements and constraints imposed. This iteration is an
optimization problem.
                                                                                

                                                                                
</p>
   <!--l. 1019--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu20.html" >next</a>] [<a 
href="tokamak_equilibriumsu19.html" >front</a>] [<a 
href="tokamak_equilibriumse4.html#tokamak_equilibriumsu19.html" >up</a>] </p></div>
<!--l. 1019--><p class="indent" >   <a 
 id="tailtokamak_equilibriumsu19.html"></a> </p> 
</body></html> 
