<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Deï¬nition of the ï¬eld-line-following coordinates (Ïˆ,ğœƒ,Î±)</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="tokamak_equilibrium.tex" /> 
<link rel="stylesheet" type="text/css" href="tokamak_equilibrium.css" /> 
</head><body 
>
   <!--l. 3411--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu50.html" >next</a>] [<a 
href="#tailtokamak_equilibriumsu49.html">tail</a>] [<a 
href="tokamak_equilibriumse11.html#tokamak_equilibriumsu49.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">11.1   </span> <a 
 id="x61-7600011.1"></a>Deï¬nition of the ï¬eld-line-following coordinates (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>)</h4>
<!--l. 3413--><p class="noindent" >In (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î¶</span>) coordinates, a magnetic ï¬eld line is straight in (<span 
class="cmmi-10">ğœƒ,Î¶</span>) plane with slope being <span 
class="cmmi-10">q</span>. Then the
equation for a magnetic ï¬eld line is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x61-76001r291"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium380x.png" alt="Î¶ = qğœƒ + Î±,
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(291)</td></tr></table>
<!--l. 3418--><p class="nopar" >
where <span 
class="cmmi-10">Î± </span>is a constant in (<span 
class="cmmi-10">ğœƒ,Î¶</span>) plane and can be used to label magnetic ï¬eld lines on a magnetic surface.
This motivates us to use <span 
class="cmmi-10">Î±</span>, i.e.,
</p>
   <table 
class="equation"><tr><td><a 
 id="x61-76002r292"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium381x.png" alt="Î± â‰¡ Î¶ âˆ’ qğœƒ,
" class="math-display"  /></center></td><td class="equation-label">(292)</td></tr></table>
<!--l. 3424--><p class="nopar" >
to replace <span 
class="cmmi-10">Î¶</span>. Then the magnetic ï¬eld in Eq. (<a 
href="tokamak_equilibriumsu40.html#x51-66003r261">261<!--tex4ht:ref: 3-13-p3 --></a>) is written as
</p>
   <table 
class="equation"><tr><td><a 
 id="x61-76003r293"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium382x.png" alt="B = Î¨ â€²âˆ‡ Ïˆ Ã— âˆ‡Î±,
" class="math-display"  /></center></td><td class="equation-label">(293)</td></tr></table>
<!--l. 3429--><p class="nopar" >
which is called the Clebsch form. The direction
</p>
   <table 
class="equation"><tr><td><a 
 id="x61-76004r294"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium383x.png" alt="âˆ‚r
--|Ïˆ,Î± = ğ’¥âˆ‡ Î±Ã— âˆ‡ Ïˆ,
âˆ‚ğœƒ
" class="math-display"  /></center></td><td class="equation-label">(294)</td></tr></table>
                                                                                

                                                                                
<!--l. 3434--><p class="nopar" >
is parallel (or anti-parallel) to the magnetic ï¬eld direction. Due to this fact, (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) coordinates are
usually called â€œï¬eld-line-following coordinatesâ€ or â€œï¬eld-aligned coordinatesâ€ <span class="cite">[<a 
href="tokamak_equilibriumli1.html#Xbeer1995">2</a>,Â <a 
href="tokamak_equilibriumli1.html#Xychen2003">6</a>]</span>.
</p><!--l. 3440--><p class="indent" >   Equation (<a 
href="#x61-76003r293">293<!--tex4ht:ref: 10-9-p1 --></a>) implies that
</p>
   <table 
class="equation"><tr><td><a 
 id="x61-76005r295"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium384x.png" alt="B â‹…âˆ‡Î± = 0,
" class="math-display"  /></center></td><td class="equation-label">(295)</td></tr></table>
<!--l. 3443--><p class="nopar" >
and
</p>
   <table 
class="equation"><tr><td><a 
 id="x61-76006r296"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium385x.png" alt="B â‹…âˆ‡Ïˆ = 0,
" class="math-display"  /></center></td><td class="equation-label">(296)</td></tr></table>
<!--l. 3447--><p class="nopar" >
i.e., both <span 
class="cmmi-10">Î± </span>and <span 
class="cmmi-10">Ïˆ </span>are constant along a magnetic ï¬eld line. Taking scalar product of Eq. (<a 
href="#x61-76003r293">293<!--tex4ht:ref: 10-9-p1 --></a>) with <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">ğœƒ</span>,
we obtain
</p>
   <table 
class="equation"><tr><td><a 
 id="x61-76007r297"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium386x.png" alt="            â€²
B â‹…âˆ‡ ğœƒ = âˆ’ Î¨-,
          ğ’¥
                                                                                

                                                                                
" class="math-display"  /></center></td><td class="equation-label">(297)</td></tr></table>
<!--l. 3452--><p class="nopar" >
which is nonzero, i.e., only <span 
class="cmmi-10">ğœƒ </span>among (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) is changing along a magnetic ï¬eld line. (Here
<span 
class="cmsy-10">ğ’¥ </span>= (<span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">Ïˆ </span><span 
class="cmsy-10">Ã—âˆ‡</span><span 
class="cmmi-10">ğœƒ </span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">Î±</span>)<sup><span 
class="cmsy-7">âˆ’</span><span 
class="cmr-7">1</span></sup> is the Jacobian of the coordinate system (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>), which happens to be equal to
the Jacobian of (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î¶</span>) coordinates.)
</p><!--l. 3459--><p class="indent" >   Using Eq. (<a 
href="#x61-76003r293">293<!--tex4ht:ref: 10-9-p1 --></a>), the magnetic diï¬€erential operator <span 
class="cmbx-10">B </span><span 
class="cmsy-10">â‹…âˆ‡ </span>in the new coordinate system (<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) is
written
</p>
   <table 
class="equation"><tr><td><a 
 id="x61-76008r298"></a>
   <center class="math-display" >
<img 
src="tokamak_equilibrium387x.png" alt="         Î¨ â€²âˆ‚
B â‹…âˆ‡f  = âˆ’-ğ’¥ âˆ‚ğœƒf,
" class="math-display"  /></center></td><td class="equation-label">(298)</td></tr></table>
<!--l. 3464--><p class="nopar" >
which is just a partial derivative over <span 
class="cmmi-10">ğœƒ</span>, as is expected, since only <span 
class="cmmi-10">ğœƒ </span>is changing along a magnetic ï¬eld
line.
</p><!--l. 3468--><p class="indent" >   By the way, note that (<span 
class="cmbx-10">B </span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">Î±</span>)<span 
class="cmmi-10">âˆ•</span>(<span 
class="cmbx-10">B </span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">ğœƒ</span>) = 0, i.e., the magnetic ï¬eld lines are straight with zero
slope on (<span 
class="cmmi-10">ğœƒ,Î±</span>) plane.
</p><!--l. 3472--><p class="indent" >   Using Eqs. (<a 
href="#x61-76002r292">292<!--tex4ht:ref: 17-3-18-1 --></a>) and (<a 
href="tokamak_equilibriumsu39.html#x50-65007r255">255<!--tex4ht:ref: 17-4-11-1 --></a>), <span 
class="cmmi-10">Î± </span>can be written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="tokamak_equilibrium388x.png" alt="       âˆ« ğœƒ
Î± = Ï• âˆ’   Ë†qdğœƒ,                            (299)
        0
" class="math-display"  /><a 
 id="x61-76009r299"></a></center>
</div>where <img 
src="tokamak_equilibrium389x.png" alt="Ë†q"  class="circ"  /> = <span 
class="cmbx-10">B </span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">Ï•âˆ•</span><span 
class="cmbx-10">B </span><span 
class="cmsy-10">â‹…âˆ‡</span><span 
class="cmmi-10">ğœƒ </span>is the local safety factor. (If we choose the straight-ï¬eld-line <span 
class="cmmi-10">ğœƒ</span>, then <span 
class="cmmi-10">Î± </span>is
written as <span 
class="cmmi-10">Î± </span>= <span 
class="cmmi-10">Ï•</span><span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">qğœƒ</span>.) Deï¬ne <span class="overline"><span 
class="cmmi-10">Î´</span></span> = <span 
class="cmex-10">âˆ«</span>
 <sub><span 
class="cmr-7">0</span></sub><sup><span 
class="cmmi-7">ğœƒ</span></sup><img 
src="tokamak_equilibrium390x.png" alt="Ë†q"  class="circ"  /> <span 
class="cmmi-10">dğœƒ</span>, which is called <span 
class="cmtt-10">tor</span><span 
class="cmtt-10">_shift</span> in <span 
class="cmtt-10">TEK</span> code, then <span 
class="cmmi-10">Î± </span>= <span 
class="cmmi-10">Ï•</span><span 
class="cmsy-10">âˆ’</span><span class="overline"><span 
class="cmmi-10">Î´</span></span>. In
<span 
class="cmtt-10">TEK</span>, I choose <span 
class="cmmi-10">ğœƒ </span><span 
class="cmsy-10">âˆˆ </span>[<span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€,Ï€</span>) with <span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>corresponding to the high-ï¬eld-side midplane, and <span 
class="cmmi-10">ğœƒ </span>is increasing
along the counter-clockwise direction viewed along <span 
class="cmsy-10">âˆ‡</span><span 
class="cmmi-10">Ï•</span>. Â The <span 
class="cmmi-10">ğœƒ </span>cut (<span 
class="cmmi-10">i.e.,ğœƒ </span>= <span 
class="cmsy-10">Â±</span><span 
class="cmmi-10">Ï€</span>) is far away from the
low-ï¬eld-side where ballooning modes often have larger amplitude. The (<span 
class="cmmi-10">x,y</span>) grid near the <span 
class="cmmi-10">ğœƒ </span>cut is
highly twisted in real space and interplation is needed in mapping physical quantity from the
grid at <span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>plane to that at <span 
class="cmmi-10">ğœƒ </span>= +<span 
class="cmmi-10">Ï€</span>. Numerical errors more likely appear there. So
we prefer that the <span 
class="cmmi-10">ğœƒ </span>cut is located in less important area (area where mode amplitude is
small).
                                                                                

                                                                                
<!--l. 3492--><p class="indent" >   It is widely believed that turbulence responsible for energy transport in tokamak plasmas usually
has <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmsy-10">â‰ª </span><span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">âŠ¥</span></sub>, where <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> and <span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">âŠ¥</span></sub> are the parallel and perpendicular wavenumbers, respectively. Due to
this elongated structure along the parallel direction, less grids can be used in the parallel direction than
that in the perpendicular direction in turbulence simulation. In this case, the ï¬eld-aligned coordinates
(<span 
class="cmmi-10">Ïˆ,ğœƒ,Î±</span>) provide suitable coordinates to be used, where less gridpoints can be used for <span 
class="cmmi-10">ğœƒ </span>coordinate in
simulations and even some <span 
class="cmmi-10">âˆ‚âˆ•âˆ‚ğœƒ </span>derivatives can be neglected (high-n approximation), which simpliï¬es
the equations that need to be solved. However, there is a more important reason why almost all
gyrokinetic codes use ï¬eld-aligned coordinates: the Â stability of numerical algorthims is improved
when we use coarse grids in the parallel direction because the parallel Courant condition
(for explicit schemes) <span 
class="cmmi-10">Î”t </span><span 
class="msam-10">â‰¤ </span><span 
class="cmmi-10">Î”L</span><sub><span 
class="cmsy-7">âˆ¥</span></sub><span 
class="cmmi-10">âˆ•v</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> can be more easily satisï¬ed (especially for the cases
with kinetic electrons), where <span 
class="cmmi-10">Î”L</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> is the parallel grid spacing, which is larger when coarse
grids are used in the parallel direction. This is also mentioned in Ref. <span class="cite">[<a 
href="tokamak_equilibriumli1.html#Xottaviani2011">21</a>]</span> and it seems
to be right from my experiences of testing several algorithm but a strict test is needed
to verify this. This can also be understood in the following way: the coarse parallel grid
automatically ï¬lters out physically irrelevant but numerically problematic high-<span 
class="cmmi-10">k</span><sub><span 
class="cmsy-7">âˆ¥</span></sub> modes,
permitting much longer time steps for explicit time stepping, in both particle and ï¬‚uid
codes<span class="cite">[<a 
href="tokamak_equilibriumli1.html#Xdimits1993">12</a>]</span>.
                                                                                

                                                                                
</p>
   <!--l. 3517--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu50.html" >next</a>] [<a 
href="tokamak_equilibriumsu49.html" >front</a>] [<a 
href="tokamak_equilibriumse11.html#tokamak_equilibriumsu49.html" >up</a>] </p></div>
<!--l. 3517--><p class="indent" >   <a 
 id="tailtokamak_equilibriumsu49.html"></a> </p> 
</body></html> 
