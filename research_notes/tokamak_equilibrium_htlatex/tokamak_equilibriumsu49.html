<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Field-line-following mesh in gyrokinetic turbulence simulation codes</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,4,charset=utf-8,html --> 
<meta name="src" content="tokamak_equilibrium.tex" /> 
<link rel="stylesheet" type="text/css" href="tokamak_equilibrium.css" /> 
</head><body 
>
   <!--l. 3911--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu50.html" >next</a>] [<a 
href="tokamak_equilibriumsu48.html" >prev</a>] [<a 
href="tokamak_equilibriumsu48.html#tailtokamak_equilibriumsu48.html" >prev-tail</a>] [<a 
href="#tailtokamak_equilibriumsu49.html">tail</a>] [<a 
href="tokamak_equilibriumse10.html#tokamak_equilibriumsu49.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">10.4   </span> <a 
 id="x60-8100010.4"></a>Field-line-following mesh in gyrokinetic turbulence simulation codes</h4>
<!--l. 3913--><p class="noindent" >Most gyrokinetic simulation codes in magnetic fusion community use ï¬eld-line-following coordinates in
constructing spatial mesh. The mesh is conceptually generated by the following three steps: (1)
selecting some initial points; (2) tracing out magnetic-ï¬eld-lines passing through these points; (3)
choose the intersecting points of these ï¬eld-lines with a series of chosen surfaces as the ï¬nal
grid-points. The initial points and the chosen surfaces used to obtain the intersecting points
diï¬€er among various codes and thus the resulting mesh diï¬€ers. Next, let us discuss some
examples.
</p><!--l. 3922--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">10.4.1   </span> <a 
 id="x60-8200010.4.1"></a>Mesh in GENE, GYRO, and GEM codes</h5>
<!--l. 3924--><p class="noindent" >Given the deï¬nition of (<span 
class="cmmi-10">Ïˆ,ğœƒ</span>) coordinates, choose toroidally symmetrical points (can be a toroidal
wedge) in <span 
class="cmmi-10">ğœƒ </span>= 0 plane (<span 
class="cmmi-10">ğœƒ </span>= 0 plane is usually chosen to be the low-ï¬eld-side midplane). And then trace
out the magnetic-ï¬eld-lines passing through these points for one poloidal circuit (usually chosen in the
range <span 
class="cmmi-10">ğœƒ </span><span 
class="cmsy-10">âˆˆ </span>[<span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€,Ï€</span>]) and record the intersection points of these ï¬eld-lines with various <span 
class="cmmi-10">ğœƒ </span>= const planes.
These points form the 3D mesh of <span 
class="cmtt-10">GENE</span>, <span 
class="cmtt-10">GYRO</span>, and <span 
class="cmtt-10">GEM </span>codes. The 3D grids of this type are sometimes
called â€œï¬‚ux tube gridsâ€. Note that the grids in <span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>plane usually do not coincide those in <span 
class="cmmi-10">ğœƒ </span>= +<span 
class="cmmi-10">Ï€</span>
plane due to the toroidal shift arising when the safety factor is irrational. Interpolation can
be used to map physical variables deï¬ned on grids in <span 
class="cmmi-10">ğœƒ </span>= <span 
class="cmsy-10">âˆ’</span><span 
class="cmmi-10">Ï€ </span>plane to those in <span 
class="cmmi-10">ğœƒ </span>= +<span 
class="cmmi-10">Ï€</span>
plane.
</p><!--l. 3938--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">10.4.2   </span> <a 
 id="x60-8300010.4.2"></a>Mesh in GTC and GTS codes<span class="cite">[<a 
href="tokamak_equilibriumli1.html#Xwxwang2006">25</a>]</span></h5>
<!--l. 3940--><p class="noindent" >Given the deï¬nition of (<span 
class="cmmi-10">Ïˆ,ğœƒ</span>) coordinates on the poloidal plane, 2D grid-points can be chosen on <span 
class="cmmi-10">Ï• </span>= 0
poloidal plane based on (<span 
class="cmmi-10">Ïˆ,ğœƒ</span>) coordinates. And then trace out the magnetic-ï¬eld-lines starting from
these points for one toroidal circuit and record the intersection points of these ï¬eld-lines with
<span 
class="cmmi-10">Ï•</span><sub><span 
class="cmmi-7">j</span></sub> = <span 
class="cmmi-10">j</span>Î”<span 
class="cmmi-10">Ï• </span>poloidal planes, where <span 
class="cmmi-10">j </span>= 1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span><span 
class="cmmi-10">â€¦</span><span 
class="cmmi-10">,N</span><sub><span 
class="cmmi-7">t</span></sub>, Î”<span 
class="cmmi-10">Ï• </span>= 2<span 
class="cmmi-10">Ï€âˆ•N</span><sub><span 
class="cmmi-7">t</span></sub>. It is obvious that the resulting
mesh are not toroidally symmetrical. And also the grids on <span 
class="cmmi-10">Ï• </span>= 0 plane diï¬€er from those on
<span 
class="cmmi-10">Ï• </span>= 2<span 
class="cmmi-10">Ï€</span>. Interpolation can be used to mapping physical variables deï¬ned on <span 
class="cmmi-10">Ï• </span>= 0 grids to
those on <span 
class="cmmi-10">Ï• </span>= 2<span 
class="cmmi-10">Ï€ </span>grids. In this case, the number of â€œtoroidal gridsâ€ <span 
class="cmmi-10">N</span><sub><span 
class="cmmi-7">t</span></sub> (i.e., the number of
poloidal planes) is actually the number of grids in the parallel direction within one toroidal
circuit.
</p><!--l. 3953--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">10.4.3   </span> <a 
 id="x60-8400010.4.3"></a>Mesh in XGC1 code</h5>
                                                                                

                                                                                
<!--l. 3955--><p class="noindent" ><span 
class="cmtt-10">XGC1 </span>can handle the region outside of the LCFS. Here we only discuss the region inside the LCFS. On
each radial location, select one point on <span 
class="cmmi-10">Ï• </span>= 0 plane and trace out the magnetic ï¬eld line starting form
this point for one poloidal circuit and record the intersection points of this ï¬eld-line with <span 
class="cmmi-10">Ï•</span><sub><span 
class="cmmi-7">j</span></sub> = <span 
class="cmmi-10">j</span>Î”<span 
class="cmmi-10">Ï•</span>
poloidal planes, where <span 
class="cmmi-10">j </span>= 1<span 
class="cmmi-10">,</span>2<span 
class="cmmi-10">,</span><span 
class="cmmi-10">â€¦</span><span 
class="cmmi-10">,N</span><sub><span 
class="cmmi-7">t</span></sub>, Î”<span 
class="cmmi-10">Ï• </span>= 2<span 
class="cmmi-10">Ï€âˆ•N</span><sub><span 
class="cmmi-7">t</span></sub>. For the case <span 
class="cmmi-10">q &#x003E; </span>1, one magnetic-ï¬eld-line will have
more than one intersection points on some poloidal planes. Repeat tracing the ï¬eld line for each radial
location. Then project (toroidally) all the intersection points on diï¬€erent poloidal planes to a single
poloidal plane and rotate (toroidally) these 2D grids to deï¬ne a 3D mesh that are toroidally
symmetrical.
                                                                                

                                                                                
</p>
   <!--l. 3967--><div class="crosslinks"><p class="noindent">[<a 
href="tokamak_equilibriumsu50.html" >next</a>] [<a 
href="tokamak_equilibriumsu48.html" >prev</a>] [<a 
href="tokamak_equilibriumsu48.html#tailtokamak_equilibriumsu48.html" >prev-tail</a>] [<a 
href="tokamak_equilibriumsu49.html" >front</a>] [<a 
href="tokamak_equilibriumse10.html#tokamak_equilibriumsu49.html" >up</a>] </p></div>
<!--l. 3967--><p class="indent" >   <a 
 id="tailtokamak_equilibriumsu49.html"></a>  </p> 
</body></html> 
